{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.excelSheetFromDataSet = exports.excelSheetFromAoA = exports.dateToNumber = exports.strToArrBuffer = undefined;\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) {\n  return typeof obj;\n} : function (obj) {\n  return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n};\n\nvar _xlsx = require('xlsx');\n\nvar _xlsx2 = _interopRequireDefault(_xlsx);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nvar strToArrBuffer = function strToArrBuffer(s) {\n  var buf = new ArrayBuffer(s.length);\n  var view = new Uint8Array(buf);\n\n  for (var i = 0; i != s.length; ++i) {\n    view[i] = s.charCodeAt(i) & 0xFF;\n  }\n\n  return buf;\n};\n\nvar dateToNumber = function dateToNumber(v, date1904) {\n  if (date1904) {\n    v += 1462;\n  }\n\n  var epoch = Date.parse(v);\n  return (epoch - new Date(Date.UTC(1899, 11, 30))) / (24 * 60 * 60 * 1000);\n};\n\nvar excelSheetFromDataSet = function excelSheetFromDataSet(dataSet) {\n  /*\n  Assuming the structure of dataset\n  {\n      xSteps?: number; //How many cells to skips from left\n      ySteps?: number; //How many rows to skips from last data\n      columns: [array | string]\n      data: [array_of_array | string|boolean|number | CellObject]\n      fill, font, numFmt, alignment, and border\n  }\n   */\n  if (dataSet === undefined || dataSet.length === 0) {\n    return {};\n  }\n\n  var ws = {};\n  var range = {\n    s: {\n      c: 10000000,\n      r: 10000000\n    },\n    e: {\n      c: 0,\n      r: 0\n    }\n  };\n  var rowCount = 0;\n  dataSet.forEach(function (dataSetItem) {\n    var columns = dataSetItem.columns;\n    var xSteps = typeof dataSetItem.xSteps === 'number' ? dataSetItem.xSteps : 0;\n    var ySteps = typeof dataSetItem.ySteps === 'number' ? dataSetItem.ySteps : 0;\n    var data = dataSetItem.data;\n\n    if (dataSet === undefined || dataSet.length === 0) {\n      return;\n    }\n\n    rowCount += ySteps;\n\n    if (columns.length >= 0) {\n      columns.forEach(function (col, index) {\n        var cellRef = _xlsx2.default.utils.encode_cell({\n          c: xSteps + index,\n          r: rowCount\n        });\n\n        fixRange(range, 0, 0, rowCount, xSteps, ySteps);\n        getHeaderCell(col, cellRef, ws);\n      });\n      rowCount += 1;\n    }\n\n    for (var R = 0; R != data.length; ++R, rowCount++) {\n      for (var C = 0; C != data[R].length; ++C) {\n        var cellRef = _xlsx2.default.utils.encode_cell({\n          c: C + xSteps,\n          r: rowCount\n        });\n\n        fixRange(range, R, C, rowCount, xSteps, ySteps);\n        getCell(data[R][C], cellRef, ws);\n      }\n    }\n  });\n\n  if (range.s.c < 10000000) {\n    ws['!ref'] = _xlsx2.default.utils.encode_range(range);\n  }\n\n  return ws;\n};\n\nfunction getHeaderCell(v, cellRef, ws) {\n  var cell = {};\n  var headerCellStyle = {\n    font: {\n      bold: true\n    }\n  };\n  cell.v = v;\n  cell.t = 's';\n  cell.s = headerCellStyle;\n  ws[cellRef] = cell;\n}\n\nfunction getCell(v, cellRef, ws) {\n  var cell = {};\n\n  if (v === null) {\n    return;\n  }\n\n  if (typeof v === 'number') {\n    cell.v = v;\n    cell.t = 'n';\n  } else if (typeof v === 'boolean') {\n    cell.v = v;\n    cell.t = 'b';\n  } else if (v instanceof Date) {\n    cell.t = 'n';\n    cell.z = _xlsx2.default.SSF._table[14];\n    cell.v = dateToNumber(cell.v);\n  } else if ((typeof v === 'undefined' ? 'undefined' : _typeof(v)) === 'object') {\n    cell.v = v.value;\n    cell.s = v.style;\n  } else {\n    cell.v = v;\n    cell.t = 's';\n  }\n\n  ws[cellRef] = cell;\n}\n\nfunction fixRange(range, R, C, rowCount, xSteps, ySteps) {\n  if (range.s.r > R + rowCount) {\n    range.s.r = R + rowCount;\n  }\n\n  if (range.s.c > C + xSteps) {\n    range.s.c = C + xSteps;\n  }\n\n  if (range.e.r < R + rowCount) {\n    range.e.r = R + rowCount;\n  }\n\n  if (range.e.c < C + xSteps) {\n    range.e.c = C + xSteps;\n  }\n}\n\nvar excelSheetFromAoA = function excelSheetFromAoA(data) {\n  var ws = {};\n  var range = {\n    s: {\n      c: 10000000,\n      r: 10000000\n    },\n    e: {\n      c: 0,\n      r: 0\n    }\n  };\n\n  for (var R = 0; R != data.length; ++R) {\n    for (var C = 0; C != data[R].length; ++C) {\n      if (range.s.r > R) {\n        range.s.r = R;\n      }\n\n      if (range.s.c > C) {\n        range.s.c = C;\n      }\n\n      if (range.e.r < R) {\n        range.e.r = R;\n      }\n\n      if (range.e.c < C) {\n        range.e.c = C;\n      }\n\n      var cell = {\n        v: data[R][C]\n      };\n\n      if (cell.v === null) {\n        continue;\n      }\n\n      var cellRef = _xlsx2.default.utils.encode_cell({\n        c: C,\n        r: R\n      });\n\n      if (typeof cell.v === 'number') {\n        cell.t = 'n';\n      } else if (typeof cell.v === 'boolean') {\n        cell.t = 'b';\n      } else if (cell.v instanceof Date) {\n        cell.t = 'n';\n        cell.z = _xlsx2.default.SSF._table[14];\n        cell.v = dateToNumber(cell.v);\n      } else {\n        cell.t = 's';\n      }\n\n      ws[cellRef] = cell;\n    }\n  }\n\n  if (range.s.c < 10000000) {\n    ws['!ref'] = _xlsx2.default.utils.encode_range(range);\n  }\n\n  return ws;\n};\n\nexports.strToArrBuffer = strToArrBuffer;\nexports.dateToNumber = dateToNumber;\nexports.excelSheetFromAoA = excelSheetFromAoA;\nexports.excelSheetFromDataSet = excelSheetFromDataSet;","map":{"version":3,"sources":["C:/Users/Tateh/Desktop/ReactJs/generador-descuentos/node_modules/react-export-excel/dist/ExcelPlugin/utils/DataUtil.js"],"names":["Object","defineProperty","exports","value","excelSheetFromDataSet","excelSheetFromAoA","dateToNumber","strToArrBuffer","undefined","_typeof","Symbol","iterator","obj","constructor","prototype","_xlsx","require","_xlsx2","_interopRequireDefault","__esModule","default","s","buf","ArrayBuffer","length","view","Uint8Array","i","charCodeAt","v","date1904","epoch","Date","parse","UTC","dataSet","ws","range","c","r","e","rowCount","forEach","dataSetItem","columns","xSteps","ySteps","data","col","index","cellRef","utils","encode_cell","fixRange","getHeaderCell","R","C","getCell","encode_range","cell","headerCellStyle","font","bold","t","z","SSF","_table","style"],"mappings":"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","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.excelSheetFromDataSet = exports.excelSheetFromAoA = exports.dateToNumber = exports.strToArrBuffer = undefined;\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _xlsx = require('xlsx');\n\nvar _xlsx2 = _interopRequireDefault(_xlsx);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar strToArrBuffer = function strToArrBuffer(s) {\n    var buf = new ArrayBuffer(s.length);\n    var view = new Uint8Array(buf);\n\n    for (var i = 0; i != s.length; ++i) {\n        view[i] = s.charCodeAt(i) & 0xFF;\n    }\n\n    return buf;\n};\n\nvar dateToNumber = function dateToNumber(v, date1904) {\n    if (date1904) {\n        v += 1462;\n    }\n\n    var epoch = Date.parse(v);\n\n    return (epoch - new Date(Date.UTC(1899, 11, 30))) / (24 * 60 * 60 * 1000);\n};\n\nvar excelSheetFromDataSet = function excelSheetFromDataSet(dataSet) {\n    /*\n    Assuming the structure of dataset\n    {\n        xSteps?: number; //How many cells to skips from left\n        ySteps?: number; //How many rows to skips from last data\n        columns: [array | string]\n        data: [array_of_array | string|boolean|number | CellObject]\n        fill, font, numFmt, alignment, and border\n    }\n     */\n    if (dataSet === undefined || dataSet.length === 0) {\n        return {};\n    }\n\n    var ws = {};\n    var range = { s: { c: 10000000, r: 10000000 }, e: { c: 0, r: 0 } };\n    var rowCount = 0;\n\n    dataSet.forEach(function (dataSetItem) {\n        var columns = dataSetItem.columns;\n        var xSteps = typeof dataSetItem.xSteps === 'number' ? dataSetItem.xSteps : 0;\n        var ySteps = typeof dataSetItem.ySteps === 'number' ? dataSetItem.ySteps : 0;\n        var data = dataSetItem.data;\n        if (dataSet === undefined || dataSet.length === 0) {\n            return;\n        }\n\n        rowCount += ySteps;\n\n        if (columns.length >= 0) {\n            columns.forEach(function (col, index) {\n                var cellRef = _xlsx2.default.utils.encode_cell({ c: xSteps + index, r: rowCount });\n                fixRange(range, 0, 0, rowCount, xSteps, ySteps);\n                getHeaderCell(col, cellRef, ws);\n            });\n\n            rowCount += 1;\n        }\n\n        for (var R = 0; R != data.length; ++R, rowCount++) {\n            for (var C = 0; C != data[R].length; ++C) {\n                var cellRef = _xlsx2.default.utils.encode_cell({ c: C + xSteps, r: rowCount });\n                fixRange(range, R, C, rowCount, xSteps, ySteps);\n                getCell(data[R][C], cellRef, ws);\n            }\n        }\n    });\n\n    if (range.s.c < 10000000) {\n        ws['!ref'] = _xlsx2.default.utils.encode_range(range);\n    }\n\n    return ws;\n};\n\nfunction getHeaderCell(v, cellRef, ws) {\n    var cell = {};\n    var headerCellStyle = { font: { bold: true } };\n    cell.v = v;\n    cell.t = 's';\n    cell.s = headerCellStyle;\n    ws[cellRef] = cell;\n}\n\nfunction getCell(v, cellRef, ws) {\n    var cell = {};\n    if (v === null) {\n        return;\n    }\n    if (typeof v === 'number') {\n        cell.v = v;\n        cell.t = 'n';\n    } else if (typeof v === 'boolean') {\n        cell.v = v;\n        cell.t = 'b';\n    } else if (v instanceof Date) {\n        cell.t = 'n';\n        cell.z = _xlsx2.default.SSF._table[14];\n        cell.v = dateToNumber(cell.v);\n    } else if ((typeof v === 'undefined' ? 'undefined' : _typeof(v)) === 'object') {\n        cell.v = v.value;\n        cell.s = v.style;\n    } else {\n        cell.v = v;\n        cell.t = 's';\n    }\n    ws[cellRef] = cell;\n}\n\nfunction fixRange(range, R, C, rowCount, xSteps, ySteps) {\n    if (range.s.r > R + rowCount) {\n        range.s.r = R + rowCount;\n    }\n\n    if (range.s.c > C + xSteps) {\n        range.s.c = C + xSteps;\n    }\n\n    if (range.e.r < R + rowCount) {\n        range.e.r = R + rowCount;\n    }\n\n    if (range.e.c < C + xSteps) {\n        range.e.c = C + xSteps;\n    }\n}\n\nvar excelSheetFromAoA = function excelSheetFromAoA(data) {\n    var ws = {};\n    var range = { s: { c: 10000000, r: 10000000 }, e: { c: 0, r: 0 } };\n\n    for (var R = 0; R != data.length; ++R) {\n        for (var C = 0; C != data[R].length; ++C) {\n            if (range.s.r > R) {\n                range.s.r = R;\n            }\n\n            if (range.s.c > C) {\n                range.s.c = C;\n            }\n\n            if (range.e.r < R) {\n                range.e.r = R;\n            }\n\n            if (range.e.c < C) {\n                range.e.c = C;\n            }\n\n            var cell = { v: data[R][C] };\n            if (cell.v === null) {\n                continue;\n            }\n\n            var cellRef = _xlsx2.default.utils.encode_cell({ c: C, r: R });\n            if (typeof cell.v === 'number') {\n                cell.t = 'n';\n            } else if (typeof cell.v === 'boolean') {\n                cell.t = 'b';\n            } else if (cell.v instanceof Date) {\n                cell.t = 'n';\n                cell.z = _xlsx2.default.SSF._table[14];\n                cell.v = dateToNumber(cell.v);\n            } else {\n                cell.t = 's';\n            }\n\n            ws[cellRef] = cell;\n        }\n    }\n\n    if (range.s.c < 10000000) {\n        ws['!ref'] = _xlsx2.default.utils.encode_range(range);\n    }\n\n    return ws;\n};\n\nexports.strToArrBuffer = strToArrBuffer;\nexports.dateToNumber = dateToNumber;\nexports.excelSheetFromAoA = excelSheetFromAoA;\nexports.excelSheetFromDataSet = excelSheetFromDataSet;"]},"metadata":{},"sourceType":"script"}