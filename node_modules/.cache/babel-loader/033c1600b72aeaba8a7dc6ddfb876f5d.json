{"ast":null,"code":"/* xlsx.js (C) 2013-2015 SheetJS -- http://sheetjs.com */\n\n/* vim: set ts=2: */\n\n/*jshint -W041 */\n\n/*jshint funcscope:true, eqnull:true */\nvar XLSX = {};\n\n(function make_xlsx(XLSX) {\n  XLSX.version = '0.8.20';\n  var current_codepage = 1200,\n      current_cptable;\n\n  if (typeof module !== \"undefined\" && typeof require !== 'undefined') {\n    if (typeof cptable === 'undefined') cptable = require('./dist/cpexcel');\n    current_cptable = cptable[current_codepage];\n  }\n\n  function reset_cp() {\n    set_cp(1200);\n  }\n\n  var set_cp = function set_cp(cp) {\n    current_codepage = cp;\n  };\n\n  function char_codes(data) {\n    var o = [];\n\n    for (var i = 0, len = data.length; i < len; ++i) {\n      o[i] = data.charCodeAt(i);\n    }\n\n    return o;\n  }\n\n  var debom_xml = function debom_xml(data) {\n    return data;\n  };\n\n  var _getchar = function _gc1(x) {\n    return String.fromCharCode(x);\n  };\n\n  if (typeof cptable !== 'undefined') {\n    set_cp = function set_cp(cp) {\n      current_codepage = cp;\n      current_cptable = cptable[cp];\n    };\n\n    debom_xml = function debom_xml(data) {\n      if (data.charCodeAt(0) === 0xFF && data.charCodeAt(1) === 0xFE) {\n        return cptable.utils.decode(1200, char_codes(data.substr(2)));\n      }\n\n      return data;\n    };\n\n    _getchar = function _gc2(x) {\n      if (current_codepage === 1200) return String.fromCharCode(x);\n      return cptable.utils.decode(current_codepage, [x & 255, x >> 8])[0];\n    };\n  }\n\n  var Base64 = function make_b64() {\n    var map = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\";\n    return {\n      encode: function encode(input, utf8) {\n        var o = \"\";\n        var c1, c2, c3, e1, e2, e3, e4;\n\n        for (var i = 0; i < input.length;) {\n          c1 = input.charCodeAt(i++);\n          c2 = input.charCodeAt(i++);\n          c3 = input.charCodeAt(i++);\n          e1 = c1 >> 2;\n          e2 = (c1 & 3) << 4 | c2 >> 4;\n          e3 = (c2 & 15) << 2 | c3 >> 6;\n          e4 = c3 & 63;\n\n          if (isNaN(c2)) {\n            e3 = e4 = 64;\n          } else if (isNaN(c3)) {\n            e4 = 64;\n          }\n\n          o += map.charAt(e1) + map.charAt(e2) + map.charAt(e3) + map.charAt(e4);\n        }\n\n        return o;\n      },\n      decode: function b64_decode(input, utf8) {\n        var o = \"\";\n        var c1, c2, c3;\n        var e1, e2, e3, e4;\n        input = input.replace(/[^A-Za-z0-9\\+\\/\\=]/g, \"\");\n\n        for (var i = 0; i < input.length;) {\n          e1 = map.indexOf(input.charAt(i++));\n          e2 = map.indexOf(input.charAt(i++));\n          e3 = map.indexOf(input.charAt(i++));\n          e4 = map.indexOf(input.charAt(i++));\n          c1 = e1 << 2 | e2 >> 4;\n          c2 = (e2 & 15) << 4 | e3 >> 2;\n          c3 = (e3 & 3) << 6 | e4;\n          o += String.fromCharCode(c1);\n\n          if (e3 != 64) {\n            o += String.fromCharCode(c2);\n          }\n\n          if (e4 != 64) {\n            o += String.fromCharCode(c3);\n          }\n        }\n\n        return o;\n      }\n    };\n  }();\n\n  var has_buf = typeof Buffer !== 'undefined';\n\n  function new_raw_buf(len) {\n    /* jshint -W056 */\n    return new (has_buf ? Buffer : Array)(len);\n    /* jshint +W056 */\n  }\n\n  function s2a(s) {\n    if (has_buf) return new Buffer(s, \"binary\");\n    return s.split(\"\").map(function (x) {\n      return x.charCodeAt(0) & 0xff;\n    });\n  }\n\n  var bconcat = function bconcat(bufs) {\n    return [].concat.apply([], bufs);\n  };\n\n  var chr0 = /\\u0000/g,\n      chr1 = /[\\u0001-\\u0006]/;\n  /* ssf.js (C) 2013-2014 SheetJS -- http://sheetjs.com */\n\n  /*jshint -W041 */\n\n  var SSF = {};\n\n  var make_ssf = function make_ssf(SSF) {\n    SSF.version = '0.8.1';\n\n    function _strrev(x) {\n      var o = \"\",\n          i = x.length - 1;\n\n      while (i >= 0) {\n        o += x.charAt(i--);\n      }\n\n      return o;\n    }\n\n    function fill(c, l) {\n      var o = \"\";\n\n      while (o.length < l) {\n        o += c;\n      }\n\n      return o;\n    }\n\n    function pad0(v, d) {\n      var t = \"\" + v;\n      return t.length >= d ? t : fill('0', d - t.length) + t;\n    }\n\n    function pad_(v, d) {\n      var t = \"\" + v;\n      return t.length >= d ? t : fill(' ', d - t.length) + t;\n    }\n\n    function rpad_(v, d) {\n      var t = \"\" + v;\n      return t.length >= d ? t : t + fill(' ', d - t.length);\n    }\n\n    function pad0r1(v, d) {\n      var t = \"\" + Math.round(v);\n      return t.length >= d ? t : fill('0', d - t.length) + t;\n    }\n\n    function pad0r2(v, d) {\n      var t = \"\" + v;\n      return t.length >= d ? t : fill('0', d - t.length) + t;\n    }\n\n    var p2_32 = Math.pow(2, 32);\n\n    function pad0r(v, d) {\n      if (v > p2_32 || v < -p2_32) return pad0r1(v, d);\n      var i = Math.round(v);\n      return pad0r2(i, d);\n    }\n\n    function isgeneral(s, i) {\n      return s.length >= 7 + i && (s.charCodeAt(i) | 32) === 103 && (s.charCodeAt(i + 1) | 32) === 101 && (s.charCodeAt(i + 2) | 32) === 110 && (s.charCodeAt(i + 3) | 32) === 101 && (s.charCodeAt(i + 4) | 32) === 114 && (s.charCodeAt(i + 5) | 32) === 97 && (s.charCodeAt(i + 6) | 32) === 108;\n    }\n    /* Options */\n\n\n    var opts_fmt = [[\"date1904\", 0], [\"output\", \"\"], [\"WTF\", false]];\n\n    function fixopts(o) {\n      for (var y = 0; y != opts_fmt.length; ++y) {\n        if (o[opts_fmt[y][0]] === undefined) o[opts_fmt[y][0]] = opts_fmt[y][1];\n      }\n    }\n\n    SSF.opts = opts_fmt;\n    var table_fmt = {\n      0: 'General',\n      1: '0',\n      2: '0.00',\n      3: '#,##0',\n      4: '#,##0.00',\n      9: '0%',\n      10: '0.00%',\n      11: '0.00E+00',\n      12: '# ?/?',\n      13: '# ??/??',\n      14: 'm/d/yy',\n      15: 'd-mmm-yy',\n      16: 'd-mmm',\n      17: 'mmm-yy',\n      18: 'h:mm AM/PM',\n      19: 'h:mm:ss AM/PM',\n      20: 'h:mm',\n      21: 'h:mm:ss',\n      22: 'm/d/yy h:mm',\n      37: '#,##0 ;(#,##0)',\n      38: '#,##0 ;[Red](#,##0)',\n      39: '#,##0.00;(#,##0.00)',\n      40: '#,##0.00;[Red](#,##0.00)',\n      45: 'mm:ss',\n      46: '[h]:mm:ss',\n      47: 'mmss.0',\n      48: '##0.0E+0',\n      49: '@',\n      56: '\"上午/下午 \"hh\"時\"mm\"分\"ss\"秒 \"',\n      65535: 'General'\n    };\n    var days = [['Sun', 'Sunday'], ['Mon', 'Monday'], ['Tue', 'Tuesday'], ['Wed', 'Wednesday'], ['Thu', 'Thursday'], ['Fri', 'Friday'], ['Sat', 'Saturday']];\n    var months = [['J', 'Jan', 'January'], ['F', 'Feb', 'February'], ['M', 'Mar', 'March'], ['A', 'Apr', 'April'], ['M', 'May', 'May'], ['J', 'Jun', 'June'], ['J', 'Jul', 'July'], ['A', 'Aug', 'August'], ['S', 'Sep', 'September'], ['O', 'Oct', 'October'], ['N', 'Nov', 'November'], ['D', 'Dec', 'December']];\n\n    function frac(x, D, mixed) {\n      var sgn = x < 0 ? -1 : 1;\n      var B = x * sgn;\n      var P_2 = 0,\n          P_1 = 1,\n          P = 0;\n      var Q_2 = 1,\n          Q_1 = 0,\n          Q = 0;\n      var A = Math.floor(B);\n\n      while (Q_1 < D) {\n        A = Math.floor(B);\n        P = A * P_1 + P_2;\n        Q = A * Q_1 + Q_2;\n        if (B - A < 0.0000000005) break;\n        B = 1 / (B - A);\n        P_2 = P_1;\n        P_1 = P;\n        Q_2 = Q_1;\n        Q_1 = Q;\n      }\n\n      if (Q > D) {\n        Q = Q_1;\n        P = P_1;\n      }\n\n      if (Q > D) {\n        Q = Q_2;\n        P = P_2;\n      }\n\n      if (!mixed) return [0, sgn * P, Q];\n      if (Q === 0) throw \"Unexpected state: \" + P + \" \" + P_1 + \" \" + P_2 + \" \" + Q + \" \" + Q_1 + \" \" + Q_2;\n      var q = Math.floor(sgn * P / Q);\n      return [q, sgn * P - q * Q, Q];\n    }\n\n    function general_fmt_int(v, opts) {\n      return \"\" + v;\n    }\n\n    SSF._general_int = general_fmt_int;\n\n    var general_fmt_num = function make_general_fmt_num() {\n      var gnr1 = /\\.(\\d*[1-9])0+$/,\n          gnr2 = /\\.0*$/,\n          gnr4 = /\\.(\\d*[1-9])0+/,\n          gnr5 = /\\.0*[Ee]/,\n          gnr6 = /(E[+-])(\\d)$/;\n\n      function gfn2(v) {\n        var w = v < 0 ? 12 : 11;\n        var o = gfn5(v.toFixed(12));\n        if (o.length <= w) return o;\n        o = v.toPrecision(10);\n        if (o.length <= w) return o;\n        return v.toExponential(5);\n      }\n\n      function gfn3(v) {\n        var o = v.toFixed(11).replace(gnr1, \".$1\");\n        if (o.length > (v < 0 ? 12 : 11)) o = v.toPrecision(6);\n        return o;\n      }\n\n      function gfn4(o) {\n        for (var i = 0; i != o.length; ++i) {\n          if ((o.charCodeAt(i) | 0x20) === 101) return o.replace(gnr4, \".$1\").replace(gnr5, \"E\").replace(\"e\", \"E\").replace(gnr6, \"$10$2\");\n        }\n\n        return o;\n      }\n\n      function gfn5(o) {\n        //for(var i = 0; i != o.length; ++i) if(o.charCodeAt(i) === 46) return o.replace(gnr2,\"\").replace(gnr1,\".$1\");\n        //return o;\n        return o.indexOf(\".\") > -1 ? o.replace(gnr2, \"\").replace(gnr1, \".$1\") : o;\n      }\n\n      return function general_fmt_num(v, opts) {\n        var V = Math.floor(Math.log(Math.abs(v)) * Math.LOG10E),\n            o;\n        if (V >= -4 && V <= -1) o = v.toPrecision(10 + V);else if (Math.abs(V) <= 9) o = gfn2(v);else if (V === 10) o = v.toFixed(10).substr(0, 12);else o = gfn3(v);\n        return gfn5(gfn4(o));\n      };\n    }();\n\n    SSF._general_num = general_fmt_num;\n\n    function general_fmt(v, opts) {\n      switch (typeof v) {\n        case 'string':\n          return v;\n\n        case 'boolean':\n          return v ? \"TRUE\" : \"FALSE\";\n\n        case 'number':\n          return (v | 0) === v ? general_fmt_int(v, opts) : general_fmt_num(v, opts);\n      }\n\n      throw new Error(\"unsupported value in General format: \" + v);\n    }\n\n    SSF._general = general_fmt;\n\n    function fix_hijri(date, o) {\n      return 0;\n    }\n\n    function parse_date_code(v, opts, b2) {\n      if (v > 2958465 || v < 0) return null;\n      var date = v | 0,\n          time = Math.floor(86400 * (v - date)),\n          dow = 0;\n      var dout = [];\n      var out = {\n        D: date,\n        T: time,\n        u: 86400 * (v - date) - time,\n        y: 0,\n        m: 0,\n        d: 0,\n        H: 0,\n        M: 0,\n        S: 0,\n        q: 0\n      };\n      if (Math.abs(out.u) < 1e-6) out.u = 0;\n      fixopts(opts != null ? opts : opts = []);\n      if (opts.date1904) date += 1462;\n\n      if (out.u > 0.999) {\n        out.u = 0;\n\n        if (++time == 86400) {\n          time = 0;\n          ++date;\n        }\n      }\n\n      if (date === 60) {\n        dout = b2 ? [1317, 10, 29] : [1900, 2, 29];\n        dow = 3;\n      } else if (date === 0) {\n        dout = b2 ? [1317, 8, 29] : [1900, 1, 0];\n        dow = 6;\n      } else {\n        if (date > 60) --date;\n        /* 1 = Jan 1 1900 */\n\n        var d = new Date(1900, 0, 1);\n        d.setDate(d.getDate() + date - 1);\n        dout = [d.getFullYear(), d.getMonth() + 1, d.getDate()];\n        dow = d.getDay();\n        if (date < 60) dow = (dow + 6) % 7;\n        if (b2) dow = fix_hijri(d, dout);\n      }\n\n      out.y = dout[0];\n      out.m = dout[1];\n      out.d = dout[2];\n      out.S = time % 60;\n      time = Math.floor(time / 60);\n      out.M = time % 60;\n      time = Math.floor(time / 60);\n      out.H = time;\n      out.q = dow;\n      return out;\n    }\n\n    SSF.parse_date_code = parse_date_code;\n    /*jshint -W086 */\n\n    function write_date(type, fmt, val, ss0) {\n      var o = \"\",\n          ss = 0,\n          tt = 0,\n          y = val.y,\n          out,\n          outl = 0;\n\n      switch (type) {\n        case 98:\n          /* 'b' buddhist year */\n          y = val.y + 543;\n\n        /* falls through */\n\n        case 121:\n          /* 'y' year */\n          switch (fmt.length) {\n            case 1:\n            case 2:\n              out = y % 100;\n              outl = 2;\n              break;\n\n            default:\n              out = y % 10000;\n              outl = 4;\n              break;\n          }\n\n          break;\n\n        case 109:\n          /* 'm' month */\n          switch (fmt.length) {\n            case 1:\n            case 2:\n              out = val.m;\n              outl = fmt.length;\n              break;\n\n            case 3:\n              return months[val.m - 1][1];\n\n            case 5:\n              return months[val.m - 1][0];\n\n            default:\n              return months[val.m - 1][2];\n          }\n\n          break;\n\n        case 100:\n          /* 'd' day */\n          switch (fmt.length) {\n            case 1:\n            case 2:\n              out = val.d;\n              outl = fmt.length;\n              break;\n\n            case 3:\n              return days[val.q][0];\n\n            default:\n              return days[val.q][1];\n          }\n\n          break;\n\n        case 104:\n          /* 'h' 12-hour */\n          switch (fmt.length) {\n            case 1:\n            case 2:\n              out = 1 + (val.H + 11) % 12;\n              outl = fmt.length;\n              break;\n\n            default:\n              throw 'bad hour format: ' + fmt;\n          }\n\n          break;\n\n        case 72:\n          /* 'H' 24-hour */\n          switch (fmt.length) {\n            case 1:\n            case 2:\n              out = val.H;\n              outl = fmt.length;\n              break;\n\n            default:\n              throw 'bad hour format: ' + fmt;\n          }\n\n          break;\n\n        case 77:\n          /* 'M' minutes */\n          switch (fmt.length) {\n            case 1:\n            case 2:\n              out = val.M;\n              outl = fmt.length;\n              break;\n\n            default:\n              throw 'bad minute format: ' + fmt;\n          }\n\n          break;\n\n        case 115:\n          /* 's' seconds */\n          if (val.u === 0) switch (fmt) {\n            case 's':\n            case 'ss':\n              return pad0(val.S, fmt.length);\n\n            case '.0':\n            case '.00':\n            case '.000':\n          }\n\n          switch (fmt) {\n            case 's':\n            case 'ss':\n            case '.0':\n            case '.00':\n            case '.000':\n              if (ss0 >= 2) tt = ss0 === 3 ? 1000 : 100;else tt = ss0 === 1 ? 10 : 1;\n              ss = Math.round(tt * (val.S + val.u));\n              if (ss >= 60 * tt) ss = 0;\n              if (fmt === 's') return ss === 0 ? \"0\" : \"\" + ss / tt;\n              o = pad0(ss, 2 + ss0);\n              if (fmt === 'ss') return o.substr(0, 2);\n              return \".\" + o.substr(2, fmt.length - 1);\n\n            default:\n              throw 'bad second format: ' + fmt;\n          }\n\n        case 90:\n          /* 'Z' absolute time */\n          switch (fmt) {\n            case '[h]':\n            case '[hh]':\n              out = val.D * 24 + val.H;\n              break;\n\n            case '[m]':\n            case '[mm]':\n              out = (val.D * 24 + val.H) * 60 + val.M;\n              break;\n\n            case '[s]':\n            case '[ss]':\n              out = ((val.D * 24 + val.H) * 60 + val.M) * 60 + Math.round(val.S + val.u);\n              break;\n\n            default:\n              throw 'bad abstime format: ' + fmt;\n          }\n\n          outl = fmt.length === 3 ? 1 : 2;\n          break;\n\n        case 101:\n          /* 'e' era */\n          out = y;\n          outl = 1;\n      }\n\n      if (outl > 0) return pad0(out, outl);else return \"\";\n    }\n    /*jshint +W086 */\n\n\n    function commaify(s) {\n      if (s.length <= 3) return s;\n      var j = s.length % 3,\n          o = s.substr(0, j);\n\n      for (; j != s.length; j += 3) {\n        o += (o.length > 0 ? \",\" : \"\") + s.substr(j, 3);\n      }\n\n      return o;\n    }\n\n    var write_num = function make_write_num() {\n      var pct1 = /%/g;\n\n      function write_num_pct(type, fmt, val) {\n        var sfmt = fmt.replace(pct1, \"\"),\n            mul = fmt.length - sfmt.length;\n        return write_num(type, sfmt, val * Math.pow(10, 2 * mul)) + fill(\"%\", mul);\n      }\n\n      function write_num_cm(type, fmt, val) {\n        var idx = fmt.length - 1;\n\n        while (fmt.charCodeAt(idx - 1) === 44) {\n          --idx;\n        }\n\n        return write_num(type, fmt.substr(0, idx), val / Math.pow(10, 3 * (fmt.length - idx)));\n      }\n\n      function write_num_exp(fmt, val) {\n        var o;\n        var idx = fmt.indexOf(\"E\") - fmt.indexOf(\".\") - 1;\n\n        if (fmt.match(/^#+0.0E\\+0$/)) {\n          var period = fmt.indexOf(\".\");\n          if (period === -1) period = fmt.indexOf('E');\n          var ee = Math.floor(Math.log(Math.abs(val)) * Math.LOG10E) % period;\n          if (ee < 0) ee += period;\n          o = (val / Math.pow(10, ee)).toPrecision(idx + 1 + (period + ee) % period);\n\n          if (o.indexOf(\"e\") === -1) {\n            var fakee = Math.floor(Math.log(Math.abs(val)) * Math.LOG10E);\n            if (o.indexOf(\".\") === -1) o = o[0] + \".\" + o.substr(1) + \"E+\" + (fakee - o.length + ee);else o += \"E+\" + (fakee - ee);\n\n            while (o.substr(0, 2) === \"0.\") {\n              o = o[0] + o.substr(2, period) + \".\" + o.substr(2 + period);\n              o = o.replace(/^0+([1-9])/, \"$1\").replace(/^0+\\./, \"0.\");\n            }\n\n            o = o.replace(/\\+-/, \"-\");\n          }\n\n          o = o.replace(/^([+-]?)(\\d*)\\.(\\d*)[Ee]/, function ($$, $1, $2, $3) {\n            return $1 + $2 + $3.substr(0, (period + ee) % period) + \".\" + $3.substr(ee) + \"E\";\n          });\n        } else o = val.toExponential(idx);\n\n        if (fmt.match(/E\\+00$/) && o.match(/e[+-]\\d$/)) o = o.substr(0, o.length - 1) + \"0\" + o[o.length - 1];\n        if (fmt.match(/E\\-/) && o.match(/e\\+/)) o = o.replace(/e\\+/, \"e\");\n        return o.replace(\"e\", \"E\");\n      }\n\n      var frac1 = /# (\\?+)( ?)\\/( ?)(\\d+)/;\n\n      function write_num_f1(r, aval, sign) {\n        var den = parseInt(r[4]),\n            rr = Math.round(aval * den),\n            base = Math.floor(rr / den);\n        var myn = rr - base * den,\n            myd = den;\n        return sign + (base === 0 ? \"\" : \"\" + base) + \" \" + (myn === 0 ? fill(\" \", r[1].length + 1 + r[4].length) : pad_(myn, r[1].length) + r[2] + \"/\" + r[3] + pad0(myd, r[4].length));\n      }\n\n      function write_num_f2(r, aval, sign) {\n        return sign + (aval === 0 ? \"\" : \"\" + aval) + fill(\" \", r[1].length + 2 + r[4].length);\n      }\n\n      var dec1 = /^#*0*\\.(0+)/;\n      var closeparen = /\\).*[0#]/;\n      var phone = /\\(###\\) ###\\\\?-####/;\n\n      function hashq(str) {\n        var o = \"\",\n            cc;\n\n        for (var i = 0; i != str.length; ++i) {\n          switch (cc = str.charCodeAt(i)) {\n            case 35:\n              break;\n\n            case 63:\n              o += \" \";\n              break;\n\n            case 48:\n              o += \"0\";\n              break;\n\n            default:\n              o += String.fromCharCode(cc);\n          }\n        }\n\n        return o;\n      }\n\n      function rnd(val, d) {\n        var dd = Math.pow(10, d);\n        return \"\" + Math.round(val * dd) / dd;\n      }\n\n      function dec(val, d) {\n        return Math.round((val - Math.floor(val)) * Math.pow(10, d));\n      }\n\n      function flr(val) {\n        if (val < 2147483647 && val > -2147483648) return \"\" + (val >= 0 ? val | 0 : val - 1 | 0);\n        return \"\" + Math.floor(val);\n      }\n\n      function write_num_flt(type, fmt, val) {\n        if (type.charCodeAt(0) === 40 && !fmt.match(closeparen)) {\n          var ffmt = fmt.replace(/\\( */, \"\").replace(/ \\)/, \"\").replace(/\\)/, \"\");\n          if (val >= 0) return write_num_flt('n', ffmt, val);\n          return '(' + write_num_flt('n', ffmt, -val) + ')';\n        }\n\n        if (fmt.charCodeAt(fmt.length - 1) === 44) return write_num_cm(type, fmt, val);\n        if (fmt.indexOf('%') !== -1) return write_num_pct(type, fmt, val);\n        if (fmt.indexOf('E') !== -1) return write_num_exp(fmt, val);\n        if (fmt.charCodeAt(0) === 36) return \"$\" + write_num_flt(type, fmt.substr(fmt[1] == ' ' ? 2 : 1), val);\n        var o, oo;\n        var r,\n            ri,\n            ff,\n            aval = Math.abs(val),\n            sign = val < 0 ? \"-\" : \"\";\n        if (fmt.match(/^00+$/)) return sign + pad0r(aval, fmt.length);\n\n        if (fmt.match(/^[#?]+$/)) {\n          o = pad0r(val, 0);\n          if (o === \"0\") o = \"\";\n          return o.length > fmt.length ? o : hashq(fmt.substr(0, fmt.length - o.length)) + o;\n        }\n\n        if ((r = fmt.match(frac1)) !== null) return write_num_f1(r, aval, sign);\n        if (fmt.match(/^#+0+$/) !== null) return sign + pad0r(aval, fmt.length - fmt.indexOf(\"0\"));\n\n        if ((r = fmt.match(dec1)) !== null) {\n          o = rnd(val, r[1].length).replace(/^([^\\.]+)$/, \"$1.\" + r[1]).replace(/\\.$/, \".\" + r[1]).replace(/\\.(\\d*)$/, function ($$, $1) {\n            return \".\" + $1 + fill(\"0\", r[1].length - $1.length);\n          });\n          return fmt.indexOf(\"0.\") !== -1 ? o : o.replace(/^0\\./, \".\");\n        }\n\n        fmt = fmt.replace(/^#+([0.])/, \"$1\");\n\n        if ((r = fmt.match(/^(0*)\\.(#*)$/)) !== null) {\n          return sign + rnd(aval, r[2].length).replace(/\\.(\\d*[1-9])0*$/, \".$1\").replace(/^(-?\\d*)$/, \"$1.\").replace(/^0\\./, r[1].length ? \"0.\" : \".\");\n        }\n\n        if ((r = fmt.match(/^#,##0(\\.?)$/)) !== null) return sign + commaify(pad0r(aval, 0));\n\n        if ((r = fmt.match(/^#,##0\\.([#0]*0)$/)) !== null) {\n          return val < 0 ? \"-\" + write_num_flt(type, fmt, -val) : commaify(\"\" + Math.floor(val)) + \".\" + pad0(dec(val, r[1].length), r[1].length);\n        }\n\n        if ((r = fmt.match(/^#,#*,#0/)) !== null) return write_num_flt(type, fmt.replace(/^#,#*,/, \"\"), val);\n\n        if ((r = fmt.match(/^([0#]+)(\\\\?-([0#]+))+$/)) !== null) {\n          o = _strrev(write_num_flt(type, fmt.replace(/[\\\\-]/g, \"\"), val));\n          ri = 0;\n          return _strrev(_strrev(fmt.replace(/\\\\/g, \"\")).replace(/[0#]/g, function (x) {\n            return ri < o.length ? o[ri++] : x === '0' ? '0' : \"\";\n          }));\n        }\n\n        if (fmt.match(phone) !== null) {\n          o = write_num_flt(type, \"##########\", val);\n          return \"(\" + o.substr(0, 3) + \") \" + o.substr(3, 3) + \"-\" + o.substr(6);\n        }\n\n        var oa = \"\";\n\n        if ((r = fmt.match(/^([#0?]+)( ?)\\/( ?)([#0?]+)/)) !== null) {\n          ri = Math.min(r[4].length, 7);\n          ff = frac(aval, Math.pow(10, ri) - 1, false);\n          o = \"\" + sign;\n          oa = write_num(\"n\", r[1], ff[1]);\n          if (oa[oa.length - 1] == \" \") oa = oa.substr(0, oa.length - 1) + \"0\";\n          o += oa + r[2] + \"/\" + r[3];\n          oa = rpad_(ff[2], ri);\n          if (oa.length < r[4].length) oa = hashq(r[4].substr(r[4].length - oa.length)) + oa;\n          o += oa;\n          return o;\n        }\n\n        if ((r = fmt.match(/^# ([#0?]+)( ?)\\/( ?)([#0?]+)/)) !== null) {\n          ri = Math.min(Math.max(r[1].length, r[4].length), 7);\n          ff = frac(aval, Math.pow(10, ri) - 1, true);\n          return sign + (ff[0] || (ff[1] ? \"\" : \"0\")) + \" \" + (ff[1] ? pad_(ff[1], ri) + r[2] + \"/\" + r[3] + rpad_(ff[2], ri) : fill(\" \", 2 * ri + 1 + r[2].length + r[3].length));\n        }\n\n        if ((r = fmt.match(/^[#0?]+$/)) !== null) {\n          o = pad0r(val, 0);\n          if (fmt.length <= o.length) return o;\n          return hashq(fmt.substr(0, fmt.length - o.length)) + o;\n        }\n\n        if ((r = fmt.match(/^([#0?]+)\\.([#0]+)$/)) !== null) {\n          o = \"\" + val.toFixed(Math.min(r[2].length, 10)).replace(/([^0])0+$/, \"$1\");\n          ri = o.indexOf(\".\");\n          var lres = fmt.indexOf(\".\") - ri,\n              rres = fmt.length - o.length - lres;\n          return hashq(fmt.substr(0, lres) + o + fmt.substr(fmt.length - rres));\n        }\n\n        if ((r = fmt.match(/^00,000\\.([#0]*0)$/)) !== null) {\n          ri = dec(val, r[1].length);\n          return val < 0 ? \"-\" + write_num_flt(type, fmt, -val) : commaify(flr(val)).replace(/^\\d,\\d{3}$/, \"0$&\").replace(/^\\d*$/, function ($$) {\n            return \"00,\" + ($$.length < 3 ? pad0(0, 3 - $$.length) : \"\") + $$;\n          }) + \".\" + pad0(ri, r[1].length);\n        }\n\n        switch (fmt) {\n          case \"#,###\":\n            var x = commaify(pad0r(aval, 0));\n            return x !== \"0\" ? sign + x : \"\";\n\n          default:\n        }\n\n        throw new Error(\"unsupported format |\" + fmt + \"|\");\n      }\n\n      function write_num_cm2(type, fmt, val) {\n        var idx = fmt.length - 1;\n\n        while (fmt.charCodeAt(idx - 1) === 44) {\n          --idx;\n        }\n\n        return write_num(type, fmt.substr(0, idx), val / Math.pow(10, 3 * (fmt.length - idx)));\n      }\n\n      function write_num_pct2(type, fmt, val) {\n        var sfmt = fmt.replace(pct1, \"\"),\n            mul = fmt.length - sfmt.length;\n        return write_num(type, sfmt, val * Math.pow(10, 2 * mul)) + fill(\"%\", mul);\n      }\n\n      function write_num_exp2(fmt, val) {\n        var o;\n        var idx = fmt.indexOf(\"E\") - fmt.indexOf(\".\") - 1;\n\n        if (fmt.match(/^#+0.0E\\+0$/)) {\n          var period = fmt.indexOf(\".\");\n          if (period === -1) period = fmt.indexOf('E');\n          var ee = Math.floor(Math.log(Math.abs(val)) * Math.LOG10E) % period;\n          if (ee < 0) ee += period;\n          o = (val / Math.pow(10, ee)).toPrecision(idx + 1 + (period + ee) % period);\n\n          if (!o.match(/[Ee]/)) {\n            var fakee = Math.floor(Math.log(Math.abs(val)) * Math.LOG10E);\n            if (o.indexOf(\".\") === -1) o = o[0] + \".\" + o.substr(1) + \"E+\" + (fakee - o.length + ee);else o += \"E+\" + (fakee - ee);\n            o = o.replace(/\\+-/, \"-\");\n          }\n\n          o = o.replace(/^([+-]?)(\\d*)\\.(\\d*)[Ee]/, function ($$, $1, $2, $3) {\n            return $1 + $2 + $3.substr(0, (period + ee) % period) + \".\" + $3.substr(ee) + \"E\";\n          });\n        } else o = val.toExponential(idx);\n\n        if (fmt.match(/E\\+00$/) && o.match(/e[+-]\\d$/)) o = o.substr(0, o.length - 1) + \"0\" + o[o.length - 1];\n        if (fmt.match(/E\\-/) && o.match(/e\\+/)) o = o.replace(/e\\+/, \"e\");\n        return o.replace(\"e\", \"E\");\n      }\n\n      function write_num_int(type, fmt, val) {\n        if (type.charCodeAt(0) === 40 && !fmt.match(closeparen)) {\n          var ffmt = fmt.replace(/\\( */, \"\").replace(/ \\)/, \"\").replace(/\\)/, \"\");\n          if (val >= 0) return write_num_int('n', ffmt, val);\n          return '(' + write_num_int('n', ffmt, -val) + ')';\n        }\n\n        if (fmt.charCodeAt(fmt.length - 1) === 44) return write_num_cm2(type, fmt, val);\n        if (fmt.indexOf('%') !== -1) return write_num_pct2(type, fmt, val);\n        if (fmt.indexOf('E') !== -1) return write_num_exp2(fmt, val);\n        if (fmt.charCodeAt(0) === 36) return \"$\" + write_num_int(type, fmt.substr(fmt[1] == ' ' ? 2 : 1), val);\n        var o;\n        var r,\n            ri,\n            ff,\n            aval = Math.abs(val),\n            sign = val < 0 ? \"-\" : \"\";\n        if (fmt.match(/^00+$/)) return sign + pad0(aval, fmt.length);\n\n        if (fmt.match(/^[#?]+$/)) {\n          o = \"\" + val;\n          if (val === 0) o = \"\";\n          return o.length > fmt.length ? o : hashq(fmt.substr(0, fmt.length - o.length)) + o;\n        }\n\n        if ((r = fmt.match(frac1)) !== null) return write_num_f2(r, aval, sign);\n        if (fmt.match(/^#+0+$/) !== null) return sign + pad0(aval, fmt.length - fmt.indexOf(\"0\"));\n\n        if ((r = fmt.match(dec1)) !== null) {\n          o = (\"\" + val).replace(/^([^\\.]+)$/, \"$1.\" + r[1]).replace(/\\.$/, \".\" + r[1]).replace(/\\.(\\d*)$/, function ($$, $1) {\n            return \".\" + $1 + fill(\"0\", r[1].length - $1.length);\n          });\n          return fmt.indexOf(\"0.\") !== -1 ? o : o.replace(/^0\\./, \".\");\n        }\n\n        fmt = fmt.replace(/^#+([0.])/, \"$1\");\n\n        if ((r = fmt.match(/^(0*)\\.(#*)$/)) !== null) {\n          return sign + (\"\" + aval).replace(/\\.(\\d*[1-9])0*$/, \".$1\").replace(/^(-?\\d*)$/, \"$1.\").replace(/^0\\./, r[1].length ? \"0.\" : \".\");\n        }\n\n        if ((r = fmt.match(/^#,##0(\\.?)$/)) !== null) return sign + commaify(\"\" + aval);\n\n        if ((r = fmt.match(/^#,##0\\.([#0]*0)$/)) !== null) {\n          return val < 0 ? \"-\" + write_num_int(type, fmt, -val) : commaify(\"\" + val) + \".\" + fill('0', r[1].length);\n        }\n\n        if ((r = fmt.match(/^#,#*,#0/)) !== null) return write_num_int(type, fmt.replace(/^#,#*,/, \"\"), val);\n\n        if ((r = fmt.match(/^([0#]+)(\\\\?-([0#]+))+$/)) !== null) {\n          o = _strrev(write_num_int(type, fmt.replace(/[\\\\-]/g, \"\"), val));\n          ri = 0;\n          return _strrev(_strrev(fmt.replace(/\\\\/g, \"\")).replace(/[0#]/g, function (x) {\n            return ri < o.length ? o[ri++] : x === '0' ? '0' : \"\";\n          }));\n        }\n\n        if (fmt.match(phone) !== null) {\n          o = write_num_int(type, \"##########\", val);\n          return \"(\" + o.substr(0, 3) + \") \" + o.substr(3, 3) + \"-\" + o.substr(6);\n        }\n\n        var oa = \"\";\n\n        if ((r = fmt.match(/^([#0?]+)( ?)\\/( ?)([#0?]+)/)) !== null) {\n          ri = Math.min(r[4].length, 7);\n          ff = frac(aval, Math.pow(10, ri) - 1, false);\n          o = \"\" + sign;\n          oa = write_num(\"n\", r[1], ff[1]);\n          if (oa[oa.length - 1] == \" \") oa = oa.substr(0, oa.length - 1) + \"0\";\n          o += oa + r[2] + \"/\" + r[3];\n          oa = rpad_(ff[2], ri);\n          if (oa.length < r[4].length) oa = hashq(r[4].substr(r[4].length - oa.length)) + oa;\n          o += oa;\n          return o;\n        }\n\n        if ((r = fmt.match(/^# ([#0?]+)( ?)\\/( ?)([#0?]+)/)) !== null) {\n          ri = Math.min(Math.max(r[1].length, r[4].length), 7);\n          ff = frac(aval, Math.pow(10, ri) - 1, true);\n          return sign + (ff[0] || (ff[1] ? \"\" : \"0\")) + \" \" + (ff[1] ? pad_(ff[1], ri) + r[2] + \"/\" + r[3] + rpad_(ff[2], ri) : fill(\" \", 2 * ri + 1 + r[2].length + r[3].length));\n        }\n\n        if ((r = fmt.match(/^[#0?]+$/)) !== null) {\n          o = \"\" + val;\n          if (fmt.length <= o.length) return o;\n          return hashq(fmt.substr(0, fmt.length - o.length)) + o;\n        }\n\n        if ((r = fmt.match(/^([#0]+)\\.([#0]+)$/)) !== null) {\n          o = \"\" + val.toFixed(Math.min(r[2].length, 10)).replace(/([^0])0+$/, \"$1\");\n          ri = o.indexOf(\".\");\n          var lres = fmt.indexOf(\".\") - ri,\n              rres = fmt.length - o.length - lres;\n          return hashq(fmt.substr(0, lres) + o + fmt.substr(fmt.length - rres));\n        }\n\n        if ((r = fmt.match(/^00,000\\.([#0]*0)$/)) !== null) {\n          return val < 0 ? \"-\" + write_num_int(type, fmt, -val) : commaify(\"\" + val).replace(/^\\d,\\d{3}$/, \"0$&\").replace(/^\\d*$/, function ($$) {\n            return \"00,\" + ($$.length < 3 ? pad0(0, 3 - $$.length) : \"\") + $$;\n          }) + \".\" + pad0(0, r[1].length);\n        }\n\n        switch (fmt) {\n          case \"#,###\":\n            var x = commaify(\"\" + aval);\n            return x !== \"0\" ? sign + x : \"\";\n\n          default:\n        }\n\n        throw new Error(\"unsupported format |\" + fmt + \"|\");\n      }\n\n      return function write_num(type, fmt, val) {\n        return (val | 0) === val ? write_num_int(type, fmt, val) : write_num_flt(type, fmt, val);\n      };\n    }();\n\n    function split_fmt(fmt) {\n      var out = [];\n      var in_str = false,\n          cc;\n\n      for (var i = 0, j = 0; i < fmt.length; ++i) {\n        switch (cc = fmt.charCodeAt(i)) {\n          case 34:\n            /* '\"' */\n            in_str = !in_str;\n            break;\n\n          case 95:\n          case 42:\n          case 92:\n            /* '_' '*' '\\\\' */\n            ++i;\n            break;\n\n          case 59:\n            /* ';' */\n            out[out.length] = fmt.substr(j, i - j);\n            j = i + 1;\n        }\n      }\n\n      out[out.length] = fmt.substr(j);\n      if (in_str === true) throw new Error(\"Format |\" + fmt + \"| unterminated string \");\n      return out;\n    }\n\n    SSF._split = split_fmt;\n    var abstime = /\\[[HhMmSs]*\\]/;\n\n    function eval_fmt(fmt, v, opts, flen) {\n      var out = [],\n          o = \"\",\n          i = 0,\n          c = \"\",\n          lst = 't',\n          q,\n          dt,\n          j,\n          cc;\n      var hr = 'H';\n      /* Tokenize */\n\n      while (i < fmt.length) {\n        switch (c = fmt[i]) {\n          case 'G':\n            /* General */\n            if (!isgeneral(fmt, i)) throw new Error('unrecognized character ' + c + ' in ' + fmt);\n            out[out.length] = {\n              t: 'G',\n              v: 'General'\n            };\n            i += 7;\n            break;\n\n          case '\"':\n            /* Literal text */\n            for (o = \"\"; (cc = fmt.charCodeAt(++i)) !== 34 && i < fmt.length;) {\n              o += String.fromCharCode(cc);\n            }\n\n            out[out.length] = {\n              t: 't',\n              v: o\n            };\n            ++i;\n            break;\n\n          case '\\\\':\n            var w = fmt[++i],\n                t = w === \"(\" || w === \")\" ? w : 't';\n            out[out.length] = {\n              t: t,\n              v: w\n            };\n            ++i;\n            break;\n\n          case '_':\n            out[out.length] = {\n              t: 't',\n              v: \" \"\n            };\n            i += 2;\n            break;\n\n          case '@':\n            /* Text Placeholder */\n            out[out.length] = {\n              t: 'T',\n              v: v\n            };\n            ++i;\n            break;\n\n          case 'B':\n          case 'b':\n            if (fmt[i + 1] === \"1\" || fmt[i + 1] === \"2\") {\n              if (dt == null) {\n                dt = parse_date_code(v, opts, fmt[i + 1] === \"2\");\n                if (dt == null) return \"\";\n              }\n\n              out[out.length] = {\n                t: 'X',\n                v: fmt.substr(i, 2)\n              };\n              lst = c;\n              i += 2;\n              break;\n            }\n\n          /* falls through */\n\n          case 'M':\n          case 'D':\n          case 'Y':\n          case 'H':\n          case 'S':\n          case 'E':\n            c = c.toLowerCase();\n\n          /* falls through */\n\n          case 'm':\n          case 'd':\n          case 'y':\n          case 'h':\n          case 's':\n          case 'e':\n          case 'g':\n            if (v < 0) return \"\";\n\n            if (dt == null) {\n              dt = parse_date_code(v, opts);\n              if (dt == null) return \"\";\n            }\n\n            o = c;\n\n            while (++i < fmt.length && fmt[i].toLowerCase() === c) {\n              o += c;\n            }\n\n            if (c === 'm' && lst.toLowerCase() === 'h') c = 'M';\n            /* m = minute */\n\n            if (c === 'h') c = hr;\n            out[out.length] = {\n              t: c,\n              v: o\n            };\n            lst = c;\n            break;\n\n          case 'A':\n            q = {\n              t: c,\n              v: \"A\"\n            };\n            if (dt == null) dt = parse_date_code(v, opts);\n\n            if (fmt.substr(i, 3) === \"A/P\") {\n              if (dt != null) q.v = dt.H >= 12 ? \"P\" : \"A\";\n              q.t = 'T';\n              hr = 'h';\n              i += 3;\n            } else if (fmt.substr(i, 5) === \"AM/PM\") {\n              if (dt != null) q.v = dt.H >= 12 ? \"PM\" : \"AM\";\n              q.t = 'T';\n              i += 5;\n              hr = 'h';\n            } else {\n              q.t = \"t\";\n              ++i;\n            }\n\n            if (dt == null && q.t === 'T') return \"\";\n            out[out.length] = q;\n            lst = c;\n            break;\n\n          case '[':\n            o = c;\n\n            while (fmt[i++] !== ']' && i < fmt.length) {\n              o += fmt[i];\n            }\n\n            if (o.substr(-1) !== ']') throw 'unterminated \"[\" block: |' + o + '|';\n\n            if (o.match(abstime)) {\n              if (dt == null) {\n                dt = parse_date_code(v, opts);\n                if (dt == null) return \"\";\n              }\n\n              out[out.length] = {\n                t: 'Z',\n                v: o.toLowerCase()\n              };\n            } else {\n              o = \"\";\n            }\n\n            break;\n\n          /* Numbers */\n\n          case '.':\n            if (dt != null) {\n              o = c;\n\n              while ((c = fmt[++i]) === \"0\") {\n                o += c;\n              }\n\n              out[out.length] = {\n                t: 's',\n                v: o\n              };\n              break;\n            }\n\n          /* falls through */\n\n          case '0':\n          case '#':\n            o = c;\n\n            while (\"0#?.,E+-%\".indexOf(c = fmt[++i]) > -1 || c == '\\\\' && fmt[i + 1] == \"-\" && \"0#\".indexOf(fmt[i + 2]) > -1) {\n              o += c;\n            }\n\n            out[out.length] = {\n              t: 'n',\n              v: o\n            };\n            break;\n\n          case '?':\n            o = c;\n\n            while (fmt[++i] === c) {\n              o += c;\n            }\n\n            q = {\n              t: c,\n              v: o\n            };\n            out[out.length] = q;\n            lst = c;\n            break;\n\n          case '*':\n            ++i;\n            if (fmt[i] == ' ' || fmt[i] == '*') ++i;\n            break;\n          // **\n\n          case '(':\n          case ')':\n            out[out.length] = {\n              t: flen === 1 ? 't' : c,\n              v: c\n            };\n            ++i;\n            break;\n\n          case '1':\n          case '2':\n          case '3':\n          case '4':\n          case '5':\n          case '6':\n          case '7':\n          case '8':\n          case '9':\n            o = c;\n\n            while (\"0123456789\".indexOf(fmt[++i]) > -1) {\n              o += fmt[i];\n            }\n\n            out[out.length] = {\n              t: 'D',\n              v: o\n            };\n            break;\n\n          case ' ':\n            out[out.length] = {\n              t: c,\n              v: c\n            };\n            ++i;\n            break;\n\n          default:\n            if (\",$-+/():!^&'~{}<>=€acfijklopqrtuvwxz\".indexOf(c) === -1) throw new Error('unrecognized character ' + c + ' in ' + fmt);\n            out[out.length] = {\n              t: 't',\n              v: c\n            };\n            ++i;\n            break;\n        }\n      }\n\n      var bt = 0,\n          ss0 = 0,\n          ssm;\n\n      for (i = out.length - 1, lst = 't'; i >= 0; --i) {\n        switch (out[i].t) {\n          case 'h':\n          case 'H':\n            out[i].t = hr;\n            lst = 'h';\n            if (bt < 1) bt = 1;\n            break;\n\n          case 's':\n            if (ssm = out[i].v.match(/\\.0+$/)) ss0 = Math.max(ss0, ssm[0].length - 1);\n            if (bt < 3) bt = 3;\n\n          /* falls through */\n\n          case 'd':\n          case 'y':\n          case 'M':\n          case 'e':\n            lst = out[i].t;\n            break;\n\n          case 'm':\n            if (lst === 's') {\n              out[i].t = 'M';\n              if (bt < 2) bt = 2;\n            }\n\n            break;\n\n          case 'X':\n            if (out[i].v === \"B2\") ;\n            break;\n\n          case 'Z':\n            if (bt < 1 && out[i].v.match(/[Hh]/)) bt = 1;\n            if (bt < 2 && out[i].v.match(/[Mm]/)) bt = 2;\n            if (bt < 3 && out[i].v.match(/[Ss]/)) bt = 3;\n        }\n      }\n\n      switch (bt) {\n        case 0:\n          break;\n\n        case 1:\n          if (dt.u >= 0.5) {\n            dt.u = 0;\n            ++dt.S;\n          }\n\n          if (dt.S >= 60) {\n            dt.S = 0;\n            ++dt.M;\n          }\n\n          if (dt.M >= 60) {\n            dt.M = 0;\n            ++dt.H;\n          }\n\n          break;\n\n        case 2:\n          if (dt.u >= 0.5) {\n            dt.u = 0;\n            ++dt.S;\n          }\n\n          if (dt.S >= 60) {\n            dt.S = 0;\n            ++dt.M;\n          }\n\n          break;\n      }\n      /* replace fields */\n\n\n      var nstr = \"\",\n          jj;\n\n      for (i = 0; i < out.length; ++i) {\n        switch (out[i].t) {\n          case 't':\n          case 'T':\n          case ' ':\n          case 'D':\n            break;\n\n          case 'X':\n            out[i] = undefined;\n            break;\n\n          case 'd':\n          case 'm':\n          case 'y':\n          case 'h':\n          case 'H':\n          case 'M':\n          case 's':\n          case 'e':\n          case 'b':\n          case 'Z':\n            out[i].v = write_date(out[i].t.charCodeAt(0), out[i].v, dt, ss0);\n            out[i].t = 't';\n            break;\n\n          case 'n':\n          case '(':\n          case '?':\n            jj = i + 1;\n\n            while (out[jj] != null && ((c = out[jj].t) === \"?\" || c === \"D\" || (c === \" \" || c === \"t\") && out[jj + 1] != null && (out[jj + 1].t === '?' || out[jj + 1].t === \"t\" && out[jj + 1].v === '/') || out[i].t === '(' && (c === ' ' || c === 'n' || c === ')') || c === 't' && (out[jj].v === '/' || '$€'.indexOf(out[jj].v) > -1 || out[jj].v === ' ' && out[jj + 1] != null && out[jj + 1].t == '?'))) {\n              out[i].v += out[jj].v;\n              out[jj] = undefined;\n              ++jj;\n            }\n\n            nstr += out[i].v;\n            i = jj - 1;\n            break;\n\n          case 'G':\n            out[i].t = 't';\n            out[i].v = general_fmt(v, opts);\n            break;\n        }\n      }\n\n      var vv = \"\",\n          myv,\n          ostr;\n\n      if (nstr.length > 0) {\n        myv = v < 0 && nstr.charCodeAt(0) === 45 ? -v : v;\n        /* '-' */\n\n        ostr = write_num(nstr.charCodeAt(0) === 40 ? '(' : 'n', nstr, myv);\n        /* '(' */\n\n        jj = ostr.length - 1;\n        var decpt = out.length;\n\n        for (i = 0; i < out.length; ++i) {\n          if (out[i] != null && out[i].v.indexOf(\".\") > -1) {\n            decpt = i;\n            break;\n          }\n        }\n\n        var lasti = out.length;\n\n        if (decpt === out.length && ostr.indexOf(\"E\") === -1) {\n          for (i = out.length - 1; i >= 0; --i) {\n            if (out[i] == null || 'n?('.indexOf(out[i].t) === -1) continue;\n\n            if (jj >= out[i].v.length - 1) {\n              jj -= out[i].v.length;\n              out[i].v = ostr.substr(jj + 1, out[i].v.length);\n            } else if (jj < 0) out[i].v = \"\";else {\n              out[i].v = ostr.substr(0, jj + 1);\n              jj = -1;\n            }\n\n            out[i].t = 't';\n            lasti = i;\n          }\n\n          if (jj >= 0 && lasti < out.length) out[lasti].v = ostr.substr(0, jj + 1) + out[lasti].v;\n        } else if (decpt !== out.length && ostr.indexOf(\"E\") === -1) {\n          jj = ostr.indexOf(\".\") - 1;\n\n          for (i = decpt; i >= 0; --i) {\n            if (out[i] == null || 'n?('.indexOf(out[i].t) === -1) continue;\n            j = out[i].v.indexOf(\".\") > -1 && i === decpt ? out[i].v.indexOf(\".\") - 1 : out[i].v.length - 1;\n            vv = out[i].v.substr(j + 1);\n\n            for (; j >= 0; --j) {\n              if (jj >= 0 && (out[i].v[j] === \"0\" || out[i].v[j] === \"#\")) vv = ostr[jj--] + vv;\n            }\n\n            out[i].v = vv;\n            out[i].t = 't';\n            lasti = i;\n          }\n\n          if (jj >= 0 && lasti < out.length) out[lasti].v = ostr.substr(0, jj + 1) + out[lasti].v;\n          jj = ostr.indexOf(\".\") + 1;\n\n          for (i = decpt; i < out.length; ++i) {\n            if (out[i] == null || 'n?('.indexOf(out[i].t) === -1 && i !== decpt) continue;\n            j = out[i].v.indexOf(\".\") > -1 && i === decpt ? out[i].v.indexOf(\".\") + 1 : 0;\n            vv = out[i].v.substr(0, j);\n\n            for (; j < out[i].v.length; ++j) {\n              if (jj < ostr.length) vv += ostr[jj++];\n            }\n\n            out[i].v = vv;\n            out[i].t = 't';\n            lasti = i;\n          }\n        }\n      }\n\n      for (i = 0; i < out.length; ++i) {\n        if (out[i] != null && 'n(?'.indexOf(out[i].t) > -1) {\n          myv = flen > 1 && v < 0 && i > 0 && out[i - 1].v === \"-\" ? -v : v;\n          out[i].v = write_num(out[i].t, out[i].v, myv);\n          out[i].t = 't';\n        }\n      }\n\n      var retval = \"\";\n\n      for (i = 0; i !== out.length; ++i) {\n        if (out[i] != null) retval += out[i].v;\n      }\n\n      return retval;\n    }\n\n    SSF._eval = eval_fmt;\n    var cfregex = /\\[[=<>]/;\n    var cfregex2 = /\\[([=<>]*)(-?\\d+\\.?\\d*)\\]/;\n\n    function chkcond(v, rr) {\n      if (rr == null) return false;\n      var thresh = parseFloat(rr[2]);\n\n      switch (rr[1]) {\n        case \"=\":\n          if (v == thresh) return true;\n          break;\n\n        case \">\":\n          if (v > thresh) return true;\n          break;\n\n        case \"<\":\n          if (v < thresh) return true;\n          break;\n\n        case \"<>\":\n          if (v != thresh) return true;\n          break;\n\n        case \">=\":\n          if (v >= thresh) return true;\n          break;\n\n        case \"<=\":\n          if (v <= thresh) return true;\n          break;\n      }\n\n      return false;\n    }\n\n    function choose_fmt(f, v) {\n      var fmt = split_fmt(f);\n      var l = fmt.length,\n          lat = fmt[l - 1].indexOf(\"@\");\n      if (l < 4 && lat > -1) --l;\n      if (fmt.length > 4) throw \"cannot find right format for |\" + fmt + \"|\";\n      if (typeof v !== \"number\") return [4, fmt.length === 4 || lat > -1 ? fmt[fmt.length - 1] : \"@\"];\n\n      switch (fmt.length) {\n        case 1:\n          fmt = lat > -1 ? [\"General\", \"General\", \"General\", fmt[0]] : [fmt[0], fmt[0], fmt[0], \"@\"];\n          break;\n\n        case 2:\n          fmt = lat > -1 ? [fmt[0], fmt[0], fmt[0], fmt[1]] : [fmt[0], fmt[1], fmt[0], \"@\"];\n          break;\n\n        case 3:\n          fmt = lat > -1 ? [fmt[0], fmt[1], fmt[0], fmt[2]] : [fmt[0], fmt[1], fmt[2], \"@\"];\n          break;\n\n        case 4:\n          break;\n      }\n\n      var ff = v > 0 ? fmt[0] : v < 0 ? fmt[1] : fmt[2];\n      if (fmt[0].indexOf(\"[\") === -1 && fmt[1].indexOf(\"[\") === -1) return [l, ff];\n\n      if (fmt[0].match(cfregex) != null || fmt[1].match(cfregex) != null) {\n        var m1 = fmt[0].match(cfregex2);\n        var m2 = fmt[1].match(cfregex2);\n        return chkcond(v, m1) ? [l, fmt[0]] : chkcond(v, m2) ? [l, fmt[1]] : [l, fmt[m1 != null && m2 != null ? 2 : 1]];\n      }\n\n      return [l, ff];\n    }\n\n    function format(fmt, v, o) {\n      fixopts(o != null ? o : o = []);\n      var sfmt = \"\";\n\n      switch (typeof fmt) {\n        case \"string\":\n          sfmt = fmt;\n          break;\n\n        case \"number\":\n          sfmt = (o.table != null ? o.table : table_fmt)[fmt];\n          break;\n      }\n\n      if (isgeneral(sfmt, 0)) return general_fmt(v, o);\n      var f = choose_fmt(sfmt, v);\n      if (isgeneral(f[1])) return general_fmt(v, o);\n      if (v === true) v = \"TRUE\";else if (v === false) v = \"FALSE\";else if (v === \"\" || v == null) return \"\";\n      return eval_fmt(f[1], v, o, f[0]);\n    }\n\n    SSF._table = table_fmt;\n\n    SSF.load = function load_entry(fmt, idx) {\n      table_fmt[idx] = fmt;\n    };\n\n    SSF.format = format;\n\n    SSF.get_table = function get_table() {\n      return table_fmt;\n    };\n\n    SSF.load_table = function load_table(tbl) {\n      for (var i = 0; i != 0x0188; ++i) {\n        if (tbl[i] !== undefined) SSF.load(tbl[i], i);\n      }\n    };\n  };\n\n  make_ssf(SSF);\n  /* map from xlml named formats to SSF TODO: localize */\n\n  var XLMLFormatMap = {\n    \"General Number\": \"General\",\n    \"General Date\": SSF._table[22],\n    \"Long Date\": \"dddd, mmmm dd, yyyy\",\n    \"Medium Date\": SSF._table[15],\n    \"Short Date\": SSF._table[14],\n    \"Long Time\": SSF._table[19],\n    \"Medium Time\": SSF._table[18],\n    \"Short Time\": SSF._table[20],\n    \"Currency\": '\"$\"#,##0.00_);[Red]\\\\(\"$\"#,##0.00\\\\)',\n    \"Fixed\": SSF._table[2],\n    \"Standard\": SSF._table[4],\n    \"Percent\": SSF._table[10],\n    \"Scientific\": SSF._table[11],\n    \"Yes/No\": '\"Yes\";\"Yes\";\"No\";@',\n    \"True/False\": '\"True\";\"True\";\"False\";@',\n    \"On/Off\": '\"Yes\";\"Yes\";\"No\";@'\n  };\n  var DO_NOT_EXPORT_CFB = true;\n  /* cfb.js (C) 2013-2014 SheetJS -- http://sheetjs.com */\n\n  /* vim: set ts=2: */\n\n  /*jshint eqnull:true */\n\n  /* [MS-CFB] v20130118 */\n\n  var CFB = function _CFB() {\n    var exports = {};\n    exports.version = '0.10.2';\n\n    function parse(file) {\n      var mver = 3; // major version\n\n      var ssz = 512; // sector size\n\n      var nmfs = 0; // number of mini FAT sectors\n\n      var ndfs = 0; // number of DIFAT sectors\n\n      var dir_start = 0; // first directory sector location\n\n      var minifat_start = 0; // first mini FAT sector location\n\n      var difat_start = 0; // first mini FAT sector location\n\n      var fat_addrs = []; // locations of FAT sectors\n\n      /* [MS-CFB] 2.2 Compound File Header */\n\n      var blob = file.slice(0, 512);\n      prep_blob(blob, 0);\n      /* major version */\n\n      var mv = check_get_mver(blob);\n      mver = mv[0];\n\n      switch (mver) {\n        case 3:\n          ssz = 512;\n          break;\n\n        case 4:\n          ssz = 4096;\n          break;\n\n        default:\n          throw \"Major Version: Expected 3 or 4 saw \" + mver;\n      }\n      /* reprocess header */\n\n\n      if (ssz !== 512) {\n        blob = file.slice(0, ssz);\n        prep_blob(blob, 28\n        /* blob.l */\n        );\n      }\n      /* Save header for final object */\n\n\n      var header = file.slice(0, ssz);\n      check_shifts(blob, mver); // Number of Directory Sectors\n\n      var nds = blob.read_shift(4, 'i');\n      if (mver === 3 && nds !== 0) throw '# Directory Sectors: Expected 0 saw ' + nds; // Number of FAT Sectors\n      //var nfs = blob.read_shift(4, 'i');\n\n      blob.l += 4; // First Directory Sector Location\n\n      dir_start = blob.read_shift(4, 'i'); // Transaction Signature\n\n      blob.l += 4; // Mini Stream Cutoff Size\n\n      blob.chk('00100000', 'Mini Stream Cutoff Size: '); // First Mini FAT Sector Location\n\n      minifat_start = blob.read_shift(4, 'i'); // Number of Mini FAT Sectors\n\n      nmfs = blob.read_shift(4, 'i'); // First DIFAT sector location\n\n      difat_start = blob.read_shift(4, 'i'); // Number of DIFAT Sectors\n\n      ndfs = blob.read_shift(4, 'i'); // Grab FAT Sector Locations\n\n      for (var q, j = 0; j < 109; ++j) {\n        /* 109 = (512 - blob.l)>>>2; */\n        q = blob.read_shift(4, 'i');\n        if (q < 0) break;\n        fat_addrs[j] = q;\n      }\n      /** Break the file up into sectors */\n\n\n      var sectors = sectorify(file, ssz);\n      sleuth_fat(difat_start, ndfs, sectors, ssz, fat_addrs);\n      /** Chains */\n\n      var sector_list = make_sector_list(sectors, dir_start, fat_addrs, ssz);\n      sector_list[dir_start].name = \"!Directory\";\n      if (nmfs > 0 && minifat_start !== ENDOFCHAIN) sector_list[minifat_start].name = \"!MiniFAT\";\n      sector_list[fat_addrs[0]].name = \"!FAT\";\n      sector_list.fat_addrs = fat_addrs;\n      sector_list.ssz = ssz;\n      /* [MS-CFB] 2.6.1 Compound File Directory Entry */\n\n      var files = {},\n          Paths = [],\n          FileIndex = [],\n          FullPaths = [],\n          FullPathDir = {};\n      read_directory(dir_start, sector_list, sectors, Paths, nmfs, files, FileIndex);\n      build_full_paths(FileIndex, FullPathDir, FullPaths, Paths);\n      var root_name = Paths.shift();\n      Paths.root = root_name;\n      /* [MS-CFB] 2.6.4 (Unicode 3.0.1 case conversion) */\n\n      var find_path = make_find_path(FullPaths, Paths, FileIndex, files, root_name);\n      return {\n        raw: {\n          header: header,\n          sectors: sectors\n        },\n        FileIndex: FileIndex,\n        FullPaths: FullPaths,\n        FullPathDir: FullPathDir,\n        find: find_path\n      };\n    } // parse\n\n    /* [MS-CFB] 2.2 Compound File Header -- read up to major version */\n\n\n    function check_get_mver(blob) {\n      // header signature 8\n      blob.chk(HEADER_SIGNATURE, 'Header Signature: '); // clsid 16\n\n      blob.chk(HEADER_CLSID, 'CLSID: '); // minor version 2\n\n      var mver = blob.read_shift(2, 'u');\n      return [blob.read_shift(2, 'u'), mver];\n    }\n\n    function check_shifts(blob, mver) {\n      var shift = 0x09; // Byte Order\n\n      blob.chk('feff', 'Byte Order: '); // Sector Shift\n\n      switch (shift = blob.read_shift(2)) {\n        case 0x09:\n          if (mver !== 3) throw 'MajorVersion/SectorShift Mismatch';\n          break;\n\n        case 0x0c:\n          if (mver !== 4) throw 'MajorVersion/SectorShift Mismatch';\n          break;\n\n        default:\n          throw 'Sector Shift: Expected 9 or 12 saw ' + shift;\n      } // Mini Sector Shift\n\n\n      blob.chk('0600', 'Mini Sector Shift: '); // Reserved\n\n      blob.chk('000000000000', 'Reserved: ');\n    }\n    /** Break the file up into sectors */\n\n\n    function sectorify(file, ssz) {\n      var nsectors = Math.ceil(file.length / ssz) - 1;\n      var sectors = new Array(nsectors);\n\n      for (var i = 1; i < nsectors; ++i) {\n        sectors[i - 1] = file.slice(i * ssz, (i + 1) * ssz);\n      }\n\n      sectors[nsectors - 1] = file.slice(nsectors * ssz);\n      return sectors;\n    }\n    /* [MS-CFB] 2.6.4 Red-Black Tree */\n\n\n    function build_full_paths(FI, FPD, FP, Paths) {\n      var i = 0,\n          L = 0,\n          R = 0,\n          C = 0,\n          j = 0,\n          pl = Paths.length;\n      var dad = new Array(pl),\n          q = new Array(pl);\n\n      for (; i < pl; ++i) {\n        dad[i] = q[i] = i;\n        FP[i] = Paths[i];\n      }\n\n      for (; j < q.length; ++j) {\n        i = q[j];\n        L = FI[i].L;\n        R = FI[i].R;\n        C = FI[i].C;\n\n        if (dad[i] === i) {\n          if (L !== -1\n          /*NOSTREAM*/\n          && dad[L] !== L) dad[i] = dad[L];\n          if (R !== -1 && dad[R] !== R) dad[i] = dad[R];\n        }\n\n        if (C !== -1\n        /*NOSTREAM*/\n        ) dad[C] = i;\n\n        if (L !== -1) {\n          dad[L] = dad[i];\n          q.push(L);\n        }\n\n        if (R !== -1) {\n          dad[R] = dad[i];\n          q.push(R);\n        }\n      }\n\n      for (i = 1; i !== pl; ++i) {\n        if (dad[i] === i) {\n          if (R !== -1\n          /*NOSTREAM*/\n          && dad[R] !== R) dad[i] = dad[R];else if (L !== -1 && dad[L] !== L) dad[i] = dad[L];\n        }\n      }\n\n      for (i = 1; i < pl; ++i) {\n        if (FI[i].type === 0\n        /* unknown */\n        ) continue;\n        j = dad[i];\n        if (j === 0) FP[i] = FP[0] + \"/\" + FP[i];else while (j !== 0) {\n          FP[i] = FP[j] + \"/\" + FP[i];\n          j = dad[j];\n        }\n        dad[i] = 0;\n      }\n\n      FP[0] += \"/\";\n\n      for (i = 1; i < pl; ++i) {\n        if (FI[i].type !== 2\n        /* stream */\n        ) FP[i] += \"/\";\n        FPD[FP[i]] = FI[i];\n      }\n    }\n    /* [MS-CFB] 2.6.4 */\n\n\n    function make_find_path(FullPaths, Paths, FileIndex, files, root_name) {\n      var UCFullPaths = new Array(FullPaths.length);\n      var UCPaths = new Array(Paths.length),\n          i;\n\n      for (i = 0; i < FullPaths.length; ++i) {\n        UCFullPaths[i] = FullPaths[i].toUpperCase().replace(chr0, '').replace(chr1, '!');\n      }\n\n      for (i = 0; i < Paths.length; ++i) {\n        UCPaths[i] = Paths[i].toUpperCase().replace(chr0, '').replace(chr1, '!');\n      }\n\n      return function find_path(path) {\n        var k;\n\n        if (path.charCodeAt(0) === 47\n        /* \"/\" */\n        ) {\n            k = true;\n            path = root_name + path;\n          } else k = path.indexOf(\"/\") !== -1;\n\n        var UCPath = path.toUpperCase().replace(chr0, '').replace(chr1, '!');\n        var w = k === true ? UCFullPaths.indexOf(UCPath) : UCPaths.indexOf(UCPath);\n        if (w === -1) return null;\n        return k === true ? FileIndex[w] : files[Paths[w]];\n      };\n    }\n    /** Chase down the rest of the DIFAT chain to build a comprehensive list\r\n        DIFAT chains by storing the next sector number as the last 32 bytes */\n\n\n    function sleuth_fat(idx, cnt, sectors, ssz, fat_addrs) {\n      var q;\n\n      if (idx === ENDOFCHAIN) {\n        if (cnt !== 0) throw \"DIFAT chain shorter than expected\";\n      } else if (idx !== -1\n      /*FREESECT*/\n      ) {\n          var sector = sectors[idx],\n              m = (ssz >>> 2) - 1;\n\n          for (var i = 0; i < m; ++i) {\n            if ((q = __readInt32LE(sector, i * 4)) === ENDOFCHAIN) break;\n            fat_addrs.push(q);\n          }\n\n          sleuth_fat(__readInt32LE(sector, ssz - 4), cnt - 1, sectors, ssz, fat_addrs);\n        }\n    }\n    /** Follow the linked list of sectors for a given starting point */\n\n\n    function get_sector_list(sectors, start, fat_addrs, ssz, chkd) {\n      var sl = sectors.length;\n      var buf, buf_chain;\n      if (!chkd) chkd = new Array(sl);\n      var modulus = ssz - 1,\n          j,\n          jj;\n      buf = [];\n      buf_chain = [];\n\n      for (j = start; j >= 0;) {\n        chkd[j] = true;\n        buf[buf.length] = j;\n        buf_chain.push(sectors[j]);\n        var addr = fat_addrs[Math.floor(j * 4 / ssz)];\n        jj = j * 4 & modulus;\n        if (ssz < 4 + jj) throw \"FAT boundary crossed: \" + j + \" 4 \" + ssz;\n        j = __readInt32LE(sectors[addr], jj);\n      }\n\n      return {\n        nodes: buf,\n        data: __toBuffer([buf_chain])\n      };\n    }\n    /** Chase down the sector linked lists */\n\n\n    function make_sector_list(sectors, dir_start, fat_addrs, ssz) {\n      var sl = sectors.length,\n          sector_list = new Array(sl);\n      var chkd = new Array(sl),\n          buf,\n          buf_chain;\n      var modulus = ssz - 1,\n          i,\n          j,\n          k,\n          jj;\n\n      for (i = 0; i < sl; ++i) {\n        buf = [];\n        k = i + dir_start;\n        if (k >= sl) k -= sl;\n        if (chkd[k] === true) continue;\n        buf_chain = [];\n\n        for (j = k; j >= 0;) {\n          chkd[j] = true;\n          buf[buf.length] = j;\n          buf_chain.push(sectors[j]);\n          var addr = fat_addrs[Math.floor(j * 4 / ssz)];\n          jj = j * 4 & modulus;\n          if (ssz < 4 + jj) throw \"FAT boundary crossed: \" + j + \" 4 \" + ssz;\n          j = __readInt32LE(sectors[addr], jj);\n        }\n\n        sector_list[k] = {\n          nodes: buf,\n          data: __toBuffer([buf_chain])\n        };\n      }\n\n      return sector_list;\n    }\n    /* [MS-CFB] 2.6.1 Compound File Directory Entry */\n\n\n    function read_directory(dir_start, sector_list, sectors, Paths, nmfs, files, FileIndex) {\n      var blob;\n      var minifat_store = 0,\n          pl = Paths.length ? 2 : 0;\n      var sector = sector_list[dir_start].data;\n      var i = 0,\n          namelen = 0,\n          name,\n          o,\n          ctime,\n          mtime;\n\n      for (; i < sector.length; i += 128) {\n        blob = sector.slice(i, i + 128);\n        prep_blob(blob, 64);\n        namelen = blob.read_shift(2);\n        if (namelen === 0) continue;\n        name = __utf16le(blob, 0, namelen - pl);\n        Paths.push(name);\n        o = {\n          name: name,\n          type: blob.read_shift(1),\n          color: blob.read_shift(1),\n          L: blob.read_shift(4, 'i'),\n          R: blob.read_shift(4, 'i'),\n          C: blob.read_shift(4, 'i'),\n          clsid: blob.read_shift(16),\n          state: blob.read_shift(4, 'i')\n        };\n        ctime = blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2);\n\n        if (ctime !== 0) {\n          o.ctime = ctime;\n          o.ct = read_date(blob, blob.l - 8);\n        }\n\n        mtime = blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2);\n\n        if (mtime !== 0) {\n          o.mtime = mtime;\n          o.mt = read_date(blob, blob.l - 8);\n        }\n\n        o.start = blob.read_shift(4, 'i');\n        o.size = blob.read_shift(4, 'i');\n\n        if (o.type === 5) {\n          /* root */\n          minifat_store = o.start;\n          if (nmfs > 0 && minifat_store !== ENDOFCHAIN) sector_list[minifat_store].name = \"!StreamData\";\n          /*minifat_size = o.size;*/\n        } else if (o.size >= 4096\n        /* MSCSZ */\n        ) {\n            o.storage = 'fat';\n            if (sector_list[o.start] === undefined) sector_list[o.start] = get_sector_list(sectors, o.start, sector_list.fat_addrs, sector_list.ssz);\n            sector_list[o.start].name = o.name;\n            o.content = sector_list[o.start].data.slice(0, o.size);\n            prep_blob(o.content, 0);\n          } else {\n          o.storage = 'minifat';\n\n          if (minifat_store !== ENDOFCHAIN && o.start !== ENDOFCHAIN) {\n            o.content = sector_list[minifat_store].data.slice(o.start * MSSZ, o.start * MSSZ + o.size);\n            prep_blob(o.content, 0);\n          }\n        }\n\n        files[name] = o;\n        FileIndex.push(o);\n      }\n    }\n\n    function read_date(blob, offset) {\n      return new Date((__readUInt32LE(blob, offset + 4) / 1e7 * Math.pow(2, 32) + __readUInt32LE(blob, offset) / 1e7 - 11644473600) * 1000);\n    }\n\n    var fs;\n\n    function readFileSync(filename, options) {\n      if (fs === undefined) fs = require('fs');\n      return parse(fs.readFileSync(filename), options);\n    }\n\n    function readSync(blob, options) {\n      switch (options !== undefined && options.type !== undefined ? options.type : \"base64\") {\n        case \"file\":\n          return readFileSync(blob, options);\n\n        case \"base64\":\n          return parse(s2a(Base64.decode(blob)), options);\n\n        case \"binary\":\n          return parse(s2a(blob), options);\n      }\n\n      return parse(blob);\n    }\n    /** CFB Constants */\n\n\n    var MSSZ = 64;\n    /* Mini Sector Size = 1<<6 */\n    //var MSCSZ = 4096; /* Mini Stream Cutoff Size */\n\n    /* 2.1 Compound File Sector Numbers and Types */\n\n    var ENDOFCHAIN = -2;\n    /* 2.2 Compound File Header */\n\n    var HEADER_SIGNATURE = 'd0cf11e0a1b11ae1';\n    var HEADER_CLSID = '00000000000000000000000000000000';\n    var consts = {\n      /* 2.1 Compund File Sector Numbers and Types */\n      MAXREGSECT: -6,\n      DIFSECT: -4,\n      FATSECT: -3,\n      ENDOFCHAIN: ENDOFCHAIN,\n      FREESECT: -1,\n\n      /* 2.2 Compound File Header */\n      HEADER_SIGNATURE: HEADER_SIGNATURE,\n      HEADER_MINOR_VERSION: '3e00',\n      MAXREGSID: -6,\n      NOSTREAM: -1,\n      HEADER_CLSID: HEADER_CLSID,\n\n      /* 2.6.1 Compound File Directory Entry */\n      EntryTypes: ['unknown', 'storage', 'stream', 'lockbytes', 'property', 'root']\n    };\n    exports.read = readSync;\n    exports.parse = parse;\n    exports.utils = {\n      ReadShift: ReadShift,\n      CheckField: CheckField,\n      prep_blob: prep_blob,\n      bconcat: bconcat,\n      consts: consts\n    };\n    return exports;\n  }();\n\n  if (typeof require !== 'undefined' && typeof module !== 'undefined' && typeof DO_NOT_EXPORT_CFB === 'undefined') {\n    module.exports = CFB;\n  }\n\n  function isval(x) {\n    return x !== undefined && x !== null;\n  }\n\n  function keys(o) {\n    return Object.keys(o);\n  }\n\n  function evert_key(obj, key) {\n    var o = [],\n        K = keys(obj);\n\n    for (var i = 0; i !== K.length; ++i) {\n      o[obj[K[i]][key]] = K[i];\n    }\n\n    return o;\n  }\n\n  function evert(obj) {\n    var o = [],\n        K = keys(obj);\n\n    for (var i = 0; i !== K.length; ++i) {\n      o[obj[K[i]]] = K[i];\n    }\n\n    return o;\n  }\n\n  function evert_num(obj) {\n    var o = [],\n        K = keys(obj);\n\n    for (var i = 0; i !== K.length; ++i) {\n      o[obj[K[i]]] = parseInt(K[i], 10);\n    }\n\n    return o;\n  }\n\n  function evert_arr(obj) {\n    var o = [],\n        K = keys(obj);\n\n    for (var i = 0; i !== K.length; ++i) {\n      if (o[obj[K[i]]] == null) o[obj[K[i]]] = [];\n      o[obj[K[i]]].push(K[i]);\n    }\n\n    return o;\n  }\n  /* TODO: date1904 logic */\n\n\n  function datenum(v, date1904) {\n    if (date1904) v += 1462;\n    var epoch = Date.parse(v);\n    return (epoch + 2209161600000) / (24 * 60 * 60 * 1000);\n  }\n\n  function cc2str(arr) {\n    var o = \"\";\n\n    for (var i = 0; i != arr.length; ++i) {\n      o += String.fromCharCode(arr[i]);\n    }\n\n    return o;\n  }\n\n  function getdata(data) {\n    if (!data) return null;\n\n    if (data.name.substr(-4) === \".bin\") {\n      if (data.data) return char_codes(data.data);\n      if (data.asNodeBuffer && has_buf) return data.asNodeBuffer();\n      if (data._data && data._data.getContent) return Array.prototype.slice.call(data._data.getContent());\n    } else {\n      if (data.data) return data.name.substr(-4) !== \".bin\" ? debom_xml(data.data) : char_codes(data.data);\n      if (data.asNodeBuffer && has_buf) return debom_xml(data.asNodeBuffer().toString('binary'));\n      if (data.asBinary) return debom_xml(data.asBinary());\n      if (data._data && data._data.getContent) return debom_xml(cc2str(Array.prototype.slice.call(data._data.getContent(), 0)));\n    }\n\n    return null;\n  }\n\n  function safegetzipfile(zip, file) {\n    var f = file;\n    if (zip.files[f]) return zip.files[f];\n    var lowerCaseFiles = {};\n\n    for (var key in zip.files) {\n      lowerCaseFiles[key.toLowerCase()] = zip.files[key];\n    }\n\n    f = file.toLowerCase();\n    if (lowerCaseFiles[f]) return lowerCaseFiles[f];\n    f = f.replace(/\\//g, '\\\\');\n    if (lowerCaseFiles[f]) return lowerCaseFiles[f];\n    return null;\n  }\n\n  function getzipfile(zip, file) {\n    var o = safegetzipfile(zip, file);\n    if (o == null) throw new Error(\"Cannot find file \" + file + \" in zip\");\n    return o;\n  }\n\n  function getzipdata(zip, file, safe) {\n    if (!safe) return getdata(getzipfile(zip, file));\n    if (!file) return null;\n\n    try {\n      return getzipdata(zip, file);\n    } catch (e) {\n      return null;\n    }\n  }\n\n  var _fs, jszip;\n\n  if (typeof JSZip !== 'undefined') jszip = JSZip;\n\n  if (typeof exports !== 'undefined') {\n    if (typeof module !== 'undefined' && module.exports) {\n      if (has_buf && typeof jszip === 'undefined') jszip = require('js' + 'zip');\n      if (typeof jszip === 'undefined') jszip = require('./js' + 'zip').JSZip;\n      _fs = require('f' + 's');\n    }\n  }\n\n  var attregexg = /([\\w:]+)=((?:\")([^\"]*)(?:\")|(?:')([^']*)(?:'))/g;\n  var tagregex = /<[^>]*>/g;\n  var nsregex = /<\\w*:/,\n      nsregex2 = /<(\\/?)\\w+:/;\n\n  function parsexmltag(tag, skip_root) {\n    var z = [];\n    var eq = 0,\n        c = 0;\n\n    for (; eq !== tag.length; ++eq) {\n      if ((c = tag.charCodeAt(eq)) === 32 || c === 10 || c === 13) break;\n    }\n\n    if (!skip_root) z[0] = tag.substr(0, eq);\n    if (eq === tag.length) return z;\n    var m = tag.match(attregexg),\n        j = 0,\n        w = \"\",\n        v = \"\",\n        i = 0,\n        q = \"\",\n        cc = \"\";\n    if (m) for (i = 0; i != m.length; ++i) {\n      cc = m[i];\n\n      for (c = 0; c != cc.length; ++c) {\n        if (cc.charCodeAt(c) === 61) break;\n      }\n\n      q = cc.substr(0, c);\n      v = cc.substring(c + 2, cc.length - 1);\n\n      for (j = 0; j != q.length; ++j) {\n        if (q.charCodeAt(j) === 58) break;\n      }\n\n      if (j === q.length) z[q] = v;else z[(j === 5 && q.substr(0, 5) === \"xmlns\" ? \"xmlns\" : \"\") + q.substr(j + 1)] = v;\n    }\n    return z;\n  }\n\n  function strip_ns(x) {\n    return x.replace(nsregex2, \"<$1\");\n  }\n\n  var encodings = {\n    '&quot;': '\"',\n    '&apos;': \"'\",\n    '&gt;': '>',\n    '&lt;': '<',\n    '&amp;': '&'\n  };\n  var rencoding = evert(encodings);\n  var rencstr = \"&<>'\\\"\".split(\"\"); // TODO: CP remap (need to read file version to determine OS)\n\n  var unescapexml = function () {\n    var encregex = /&[a-z]*;/g,\n        coderegex = /_x([\\da-fA-F]+)_/g;\n    return function unescapexml(text) {\n      var s = text + '';\n      return s.replace(encregex, function ($$) {\n        return encodings[$$];\n      }).replace(coderegex, function (m, c) {\n        return String.fromCharCode(parseInt(c, 16));\n      });\n    };\n  }();\n\n  var decregex = /[&<>'\"]/g,\n      charegex = /[\\u0000-\\u0008\\u000b-\\u001f]/g;\n\n  function escapexml(text) {\n    var s = text + '';\n    return s.replace(decregex, function (y) {\n      return rencoding[y];\n    }).replace(charegex, function (s) {\n      return \"_x\" + (\"000\" + s.charCodeAt(0).toString(16)).substr(-4) + \"_\";\n    });\n  }\n  /* TODO: handle codepages */\n\n\n  var xlml_fixstr = function () {\n    var entregex = /&#(\\d+);/g;\n\n    function entrepl($$, $1) {\n      return String.fromCharCode(parseInt($1, 10));\n    }\n\n    return function xlml_fixstr(str) {\n      return str.replace(entregex, entrepl);\n    };\n  }();\n\n  function parsexmlbool(value, tag) {\n    switch (value) {\n      case '1':\n      case 'true':\n      case 'TRUE':\n        return true;\n\n      /* case '0': case 'false': case 'FALSE':*/\n\n      default:\n        return false;\n    }\n  }\n\n  var utf8read = function utf8reada(orig) {\n    var out = \"\",\n        i = 0,\n        c = 0,\n        d = 0,\n        e = 0,\n        f = 0,\n        w = 0;\n\n    while (i < orig.length) {\n      c = orig.charCodeAt(i++);\n\n      if (c < 128) {\n        out += String.fromCharCode(c);\n        continue;\n      }\n\n      d = orig.charCodeAt(i++);\n\n      if (c > 191 && c < 224) {\n        out += String.fromCharCode((c & 31) << 6 | d & 63);\n        continue;\n      }\n\n      e = orig.charCodeAt(i++);\n\n      if (c < 240) {\n        out += String.fromCharCode((c & 15) << 12 | (d & 63) << 6 | e & 63);\n        continue;\n      }\n\n      f = orig.charCodeAt(i++);\n      w = ((c & 7) << 18 | (d & 63) << 12 | (e & 63) << 6 | f & 63) - 65536;\n      out += String.fromCharCode(0xD800 + (w >>> 10 & 1023));\n      out += String.fromCharCode(0xDC00 + (w & 1023));\n    }\n\n    return out;\n  };\n\n  if (has_buf) {\n    var utf8readb = function utf8readb(data) {\n      var out = new Buffer(2 * data.length),\n          w,\n          i,\n          j = 1,\n          k = 0,\n          ww = 0,\n          c;\n\n      for (i = 0; i < data.length; i += j) {\n        j = 1;\n        if ((c = data.charCodeAt(i)) < 128) w = c;else if (c < 224) {\n          w = (c & 31) * 64 + (data.charCodeAt(i + 1) & 63);\n          j = 2;\n        } else if (c < 240) {\n          w = (c & 15) * 4096 + (data.charCodeAt(i + 1) & 63) * 64 + (data.charCodeAt(i + 2) & 63);\n          j = 3;\n        } else {\n          j = 4;\n          w = (c & 7) * 262144 + (data.charCodeAt(i + 1) & 63) * 4096 + (data.charCodeAt(i + 2) & 63) * 64 + (data.charCodeAt(i + 3) & 63);\n          w -= 65536;\n          ww = 0xD800 + (w >>> 10 & 1023);\n          w = 0xDC00 + (w & 1023);\n        }\n\n        if (ww !== 0) {\n          out[k++] = ww & 255;\n          out[k++] = ww >>> 8;\n          ww = 0;\n        }\n\n        out[k++] = w % 256;\n        out[k++] = w >>> 8;\n      }\n\n      out.length = k;\n      return out.toString('ucs2');\n    };\n\n    var corpus = \"foo bar baz\\xE2\\x98\\x83\\xF0\\x9F\\x8D\\xA3\";\n    if (utf8read(corpus) == utf8readb(corpus)) utf8read = utf8readb;\n\n    var utf8readc = function utf8readc(data) {\n      return Buffer(data, 'binary').toString('utf8');\n    };\n\n    if (utf8read(corpus) == utf8readc(corpus)) utf8read = utf8readc;\n  } // matches <foo>...</foo> extracts content\n\n\n  var matchtag = function () {\n    var mtcache = {};\n    return function matchtag(f, g) {\n      var t = f + \"|\" + g;\n      if (mtcache[t] !== undefined) return mtcache[t];\n      return mtcache[t] = new RegExp('<(?:\\\\w+:)?' + f + \"(?: xml:space=\\\"preserve\\\")?(?:[^>]*)>([^\\u2603]*)</(?:\\\\w+:)?\" + f + '>', g || \"\");\n    };\n  }();\n\n  var vtregex = function () {\n    var vt_cache = {};\n    return function vt_regex(bt) {\n      if (vt_cache[bt] !== undefined) return vt_cache[bt];\n      return vt_cache[bt] = new RegExp(\"<vt:\" + bt + \">(.*?)</vt:\" + bt + \">\", 'g');\n    };\n  }();\n\n  var vtvregex = /<\\/?vt:variant>/g,\n      vtmregex = /<vt:([^>]*)>(.*)</;\n\n  function parseVector(data) {\n    var h = parsexmltag(data);\n    var matches = data.match(vtregex(h.baseType)) || [];\n    if (matches.length != h.size) throw \"unexpected vector length \" + matches.length + \" != \" + h.size;\n    var res = [];\n    matches.forEach(function (x) {\n      var v = x.replace(vtvregex, \"\").match(vtmregex);\n      res.push({\n        v: v[2],\n        t: v[1]\n      });\n    });\n    return res;\n  }\n\n  var wtregex = /(^\\s|\\s$|\\n)/;\n\n  function writetag(f, g) {\n    return '<' + f + (g.match(wtregex) ? ' xml:space=\"preserve\"' : \"\") + '>' + g + '</' + f + '>';\n  }\n\n  function wxt_helper(h) {\n    return keys(h).map(function (k) {\n      return \" \" + k + '=\"' + h[k] + '\"';\n    }).join(\"\");\n  }\n\n  function writextag(f, g, h) {\n    return '<' + f + (isval(h) ? wxt_helper(h) : \"\") + (isval(g) ? (g.match(wtregex) ? ' xml:space=\"preserve\"' : \"\") + '>' + g + '</' + f : \"/\") + '>';\n  }\n\n  function write_w3cdtf(d, t) {\n    try {\n      return d.toISOString().replace(/\\.\\d*/, \"\");\n    } catch (e) {\n      if (t) throw e;\n    }\n  }\n\n  function write_vt(s) {\n    switch (typeof s) {\n      case 'string':\n        return writextag('vt:lpwstr', s);\n\n      case 'number':\n        return writextag((s | 0) == s ? 'vt:i4' : 'vt:r8', String(s));\n\n      case 'boolean':\n        return writextag('vt:bool', s ? 'true' : 'false');\n    }\n\n    if (s instanceof Date) return writextag('vt:filetime', write_w3cdtf(s));\n    throw new Error(\"Unable to serialize \" + s);\n  }\n\n  var XML_HEADER = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\r\\n';\n  var XMLNS = {\n    'dc': 'http://purl.org/dc/elements/1.1/',\n    'dcterms': 'http://purl.org/dc/terms/',\n    'dcmitype': 'http://purl.org/dc/dcmitype/',\n    'mx': 'http://schemas.microsoft.com/office/mac/excel/2008/main',\n    'r': 'http://schemas.openxmlformats.org/officeDocument/2006/relationships',\n    'sjs': 'http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties',\n    'vt': 'http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes',\n    'xsi': 'http://www.w3.org/2001/XMLSchema-instance',\n    'xsd': 'http://www.w3.org/2001/XMLSchema'\n  };\n  XMLNS.main = ['http://schemas.openxmlformats.org/spreadsheetml/2006/main', 'http://purl.oclc.org/ooxml/spreadsheetml/main', 'http://schemas.microsoft.com/office/excel/2006/main', 'http://schemas.microsoft.com/office/excel/2006/2'];\n\n  function readIEEE754(buf, idx, isLE, nl, ml) {\n    if (isLE === undefined) isLE = true;\n    if (!nl) nl = 8;\n    if (!ml && nl === 8) ml = 52;\n    var e,\n        m,\n        el = nl * 8 - ml - 1,\n        eMax = (1 << el) - 1,\n        eBias = eMax >> 1;\n    var bits = -7,\n        d = isLE ? -1 : 1,\n        i = isLE ? nl - 1 : 0,\n        s = buf[idx + i];\n    i += d;\n    e = s & (1 << -bits) - 1;\n    s >>>= -bits;\n    bits += el;\n\n    for (; bits > 0; e = e * 256 + buf[idx + i], i += d, bits -= 8) {\n      ;\n    }\n\n    m = e & (1 << -bits) - 1;\n    e >>>= -bits;\n    bits += ml;\n\n    for (; bits > 0; m = m * 256 + buf[idx + i], i += d, bits -= 8) {\n      ;\n    }\n\n    if (e === eMax) return m ? NaN : (s ? -1 : 1) * Infinity;else if (e === 0) e = 1 - eBias;else {\n      m = m + Math.pow(2, ml);\n      e = e - eBias;\n    }\n    return (s ? -1 : 1) * m * Math.pow(2, e - ml);\n  }\n\n  var __toBuffer, ___toBuffer;\n\n  __toBuffer = ___toBuffer = function toBuffer_(bufs) {\n    var x = [];\n\n    for (var i = 0; i < bufs[0].length; ++i) {\n      x.push.apply(x, bufs[0][i]);\n    }\n\n    return x;\n  };\n\n  var __utf16le, ___utf16le;\n\n  __utf16le = ___utf16le = function utf16le_(b, s, e) {\n    var ss = [];\n\n    for (var i = s; i < e; i += 2) {\n      ss.push(String.fromCharCode(__readUInt16LE(b, i)));\n    }\n\n    return ss.join(\"\");\n  };\n\n  var __hexlify, ___hexlify;\n\n  __hexlify = ___hexlify = function hexlify_(b, s, l) {\n    return b.slice(s, s + l).map(function (x) {\n      return (x < 16 ? \"0\" : \"\") + x.toString(16);\n    }).join(\"\");\n  };\n\n  var __utf8, ___utf8;\n\n  __utf8 = ___utf8 = function ___utf8(b, s, e) {\n    var ss = [];\n\n    for (var i = s; i < e; i++) {\n      ss.push(String.fromCharCode(__readUInt8(b, i)));\n    }\n\n    return ss.join(\"\");\n  };\n\n  var __lpstr, ___lpstr;\n\n  __lpstr = ___lpstr = function lpstr_(b, i) {\n    var len = __readUInt32LE(b, i);\n\n    return len > 0 ? __utf8(b, i + 4, i + 4 + len - 1) : \"\";\n  };\n\n  var __lpwstr, ___lpwstr;\n\n  __lpwstr = ___lpwstr = function lpwstr_(b, i) {\n    var len = 2 * __readUInt32LE(b, i);\n\n    return len > 0 ? __utf8(b, i + 4, i + 4 + len - 1) : \"\";\n  };\n\n  var __double, ___double;\n\n  __double = ___double = function ___double(b, idx) {\n    return readIEEE754(b, idx);\n  };\n\n  var is_buf = function is_buf_a(a) {\n    return Array.isArray(a);\n  };\n\n  if (has_buf) {\n    __utf16le = function utf16le_b(b, s, e) {\n      if (!Buffer.isBuffer(b)) return ___utf16le(b, s, e);\n      return b.toString('utf16le', s, e);\n    };\n\n    __hexlify = function __hexlify(b, s, l) {\n      return Buffer.isBuffer(b) ? b.toString('hex', s, s + l) : ___hexlify(b, s, l);\n    };\n\n    __lpstr = function lpstr_b(b, i) {\n      if (!Buffer.isBuffer(b)) return ___lpstr(b, i);\n      var len = b.readUInt32LE(i);\n      return len > 0 ? b.toString('utf8', i + 4, i + 4 + len - 1) : \"\";\n    };\n\n    __lpwstr = function lpwstr_b(b, i) {\n      if (!Buffer.isBuffer(b)) return ___lpwstr(b, i);\n      var len = 2 * b.readUInt32LE(i);\n      return b.toString('utf16le', i + 4, i + 4 + len - 1);\n    };\n\n    __utf8 = function utf8_b(s, e) {\n      return this.toString('utf8', s, e);\n    };\n\n    __toBuffer = function __toBuffer(bufs) {\n      return bufs[0].length > 0 && Buffer.isBuffer(bufs[0][0]) ? Buffer.concat(bufs[0]) : ___toBuffer(bufs);\n    };\n\n    bconcat = function bconcat(bufs) {\n      return Buffer.isBuffer(bufs[0]) ? Buffer.concat(bufs) : [].concat.apply([], bufs);\n    };\n\n    __double = function double_(b, i) {\n      if (Buffer.isBuffer(b)) return b.readDoubleLE(i);\n      return ___double(b, i);\n    };\n\n    is_buf = function is_buf_b(a) {\n      return Buffer.isBuffer(a) || Array.isArray(a);\n    };\n  }\n  /* from js-xls */\n\n\n  if (typeof cptable !== 'undefined') {\n    __utf16le = function __utf16le(b, s, e) {\n      return cptable.utils.decode(1200, b.slice(s, e));\n    };\n\n    __utf8 = function __utf8(b, s, e) {\n      return cptable.utils.decode(65001, b.slice(s, e));\n    };\n\n    __lpstr = function __lpstr(b, i) {\n      var len = __readUInt32LE(b, i);\n\n      return len > 0 ? cptable.utils.decode(current_codepage, b.slice(i + 4, i + 4 + len - 1)) : \"\";\n    };\n\n    __lpwstr = function __lpwstr(b, i) {\n      var len = 2 * __readUInt32LE(b, i);\n\n      return len > 0 ? cptable.utils.decode(1200, b.slice(i + 4, i + 4 + len - 1)) : \"\";\n    };\n  }\n\n  var __readUInt8 = function __readUInt8(b, idx) {\n    return b[idx];\n  };\n\n  var __readUInt16LE = function __readUInt16LE(b, idx) {\n    return b[idx + 1] * (1 << 8) + b[idx];\n  };\n\n  var __readInt16LE = function __readInt16LE(b, idx) {\n    var u = b[idx + 1] * (1 << 8) + b[idx];\n    return u < 0x8000 ? u : (0xffff - u + 1) * -1;\n  };\n\n  var __readUInt32LE = function __readUInt32LE(b, idx) {\n    return b[idx + 3] * (1 << 24) + (b[idx + 2] << 16) + (b[idx + 1] << 8) + b[idx];\n  };\n\n  var __readInt32LE = function __readInt32LE(b, idx) {\n    return b[idx + 3] << 24 | b[idx + 2] << 16 | b[idx + 1] << 8 | b[idx];\n  };\n\n  var ___unhexlify = function ___unhexlify(s) {\n    return s.match(/../g).map(function (x) {\n      return parseInt(x, 16);\n    });\n  };\n\n  var __unhexlify = typeof Buffer !== \"undefined\" ? function (s) {\n    return Buffer.isBuffer(s) ? new Buffer(s, 'hex') : ___unhexlify(s);\n  } : ___unhexlify;\n\n  function ReadShift(size, t) {\n    var o = \"\",\n        oI,\n        oR,\n        oo = [],\n        w,\n        vv,\n        i,\n        loc;\n\n    switch (t) {\n      case 'dbcs':\n        loc = this.l;\n        if (has_buf && Buffer.isBuffer(this)) o = this.slice(this.l, this.l + 2 * size).toString(\"utf16le\");else for (i = 0; i != size; ++i) {\n          o += String.fromCharCode(__readUInt16LE(this, loc));\n          loc += 2;\n        }\n        size *= 2;\n        break;\n\n      case 'utf8':\n        o = __utf8(this, this.l, this.l + size);\n        break;\n\n      case 'utf16le':\n        size *= 2;\n        o = __utf16le(this, this.l, this.l + size);\n        break;\n\n      /* [MS-OLEDS] 2.1.4 LengthPrefixedAnsiString */\n\n      case 'lpstr':\n        o = __lpstr(this, this.l);\n        size = 5 + o.length;\n        break;\n\n      /* [MS-OLEDS] 2.1.5 LengthPrefixedUnicodeString */\n\n      case 'lpwstr':\n        o = __lpwstr(this, this.l);\n        size = 5 + o.length;\n        if (o[o.length - 1] == \"\\0\") size += 2;\n        break;\n\n      case 'cstr':\n        size = 0;\n        o = \"\";\n\n        while ((w = __readUInt8(this, this.l + size++)) !== 0) {\n          oo.push(_getchar(w));\n        }\n\n        o = oo.join(\"\");\n        break;\n\n      case 'wstr':\n        size = 0;\n        o = \"\";\n\n        while ((w = __readUInt16LE(this, this.l + size)) !== 0) {\n          oo.push(_getchar(w));\n          size += 2;\n        }\n\n        size += 2;\n        o = oo.join(\"\");\n        break;\n\n      /* sbcs and dbcs support continue records in the SST way TODO codepages */\n\n      case 'dbcs-cont':\n        o = \"\";\n        loc = this.l;\n\n        for (i = 0; i != size; ++i) {\n          if (this.lens && this.lens.indexOf(loc) !== -1) {\n            w = __readUInt8(this, loc);\n            this.l = loc + 1;\n            vv = ReadShift.call(this, size - i, w ? 'dbcs-cont' : 'sbcs-cont');\n            return oo.join(\"\") + vv;\n          }\n\n          oo.push(_getchar(__readUInt16LE(this, loc)));\n          loc += 2;\n        }\n\n        o = oo.join(\"\");\n        size *= 2;\n        break;\n\n      case 'sbcs-cont':\n        o = \"\";\n        loc = this.l;\n\n        for (i = 0; i != size; ++i) {\n          if (this.lens && this.lens.indexOf(loc) !== -1) {\n            w = __readUInt8(this, loc);\n            this.l = loc + 1;\n            vv = ReadShift.call(this, size - i, w ? 'dbcs-cont' : 'sbcs-cont');\n            return oo.join(\"\") + vv;\n          }\n\n          oo.push(_getchar(__readUInt8(this, loc)));\n          loc += 1;\n        }\n\n        o = oo.join(\"\");\n        break;\n\n      default:\n        switch (size) {\n          case 1:\n            oI = __readUInt8(this, this.l);\n            this.l++;\n            return oI;\n\n          case 2:\n            oI = (t === 'i' ? __readInt16LE : __readUInt16LE)(this, this.l);\n            this.l += 2;\n            return oI;\n\n          case 4:\n            if (t === 'i' || (this[this.l + 3] & 0x80) === 0) {\n              oI = __readInt32LE(this, this.l);\n              this.l += 4;\n              return oI;\n            } else {\n              oR = __readUInt32LE(this, this.l);\n              this.l += 4;\n              return oR;\n            }\n\n            break;\n\n          case 8:\n            if (t === 'f') {\n              oR = __double(this, this.l);\n              this.l += 8;\n              return oR;\n            }\n\n          /* falls through */\n\n          case 16:\n            o = __hexlify(this, this.l, size);\n            break;\n        }\n\n    }\n\n    this.l += size;\n    return o;\n  }\n\n  function WriteShift(t, val, f) {\n    var size, i;\n\n    if (f === 'dbcs') {\n      for (i = 0; i != val.length; ++i) {\n        this.writeUInt16LE(val.charCodeAt(i), this.l + 2 * i);\n      }\n\n      size = 2 * val.length;\n    } else switch (t) {\n      case 1:\n        size = 1;\n        this[this.l] = val & 255;\n        break;\n\n      case 3:\n        size = 3;\n        this[this.l + 2] = val & 255;\n        val >>>= 8;\n        this[this.l + 1] = val & 255;\n        val >>>= 8;\n        this[this.l] = val & 255;\n        break;\n\n      case 4:\n        size = 4;\n        this.writeUInt32LE(val, this.l);\n        break;\n\n      case 8:\n        size = 8;\n\n        if (f === 'f') {\n          this.writeDoubleLE(val, this.l);\n          break;\n        }\n\n      /* falls through */\n\n      case 16:\n        break;\n\n      case -4:\n        size = 4;\n        this.writeInt32LE(val, this.l);\n        break;\n    }\n\n    this.l += size;\n    return this;\n  }\n\n  function CheckField(hexstr, fld) {\n    var m = __hexlify(this, this.l, hexstr.length >> 1);\n\n    if (m !== hexstr) throw fld + 'Expected ' + hexstr + ' saw ' + m;\n    this.l += hexstr.length >> 1;\n  }\n\n  function prep_blob(blob, pos) {\n    blob.l = pos;\n    blob.read_shift = ReadShift;\n    blob.chk = CheckField;\n    blob.write_shift = WriteShift;\n  }\n\n  function parsenoop(blob, length) {\n    blob.l += length;\n  }\n\n  function writenoop(blob, length) {\n    blob.l += length;\n  }\n\n  function new_buf(sz) {\n    var o = new_raw_buf(sz);\n    prep_blob(o, 0);\n    return o;\n  }\n  /* [MS-XLSB] 2.1.4 Record */\n\n\n  function recordhopper(data, cb, opts) {\n    var tmpbyte, cntbyte, length;\n    prep_blob(data, data.l || 0);\n\n    while (data.l < data.length) {\n      var RT = data.read_shift(1);\n      if (RT & 0x80) RT = (RT & 0x7F) + ((data.read_shift(1) & 0x7F) << 7);\n      var R = XLSBRecordEnum[RT] || XLSBRecordEnum[0xFFFF];\n      tmpbyte = data.read_shift(1);\n      length = tmpbyte & 0x7F;\n\n      for (cntbyte = 1; cntbyte < 4 && tmpbyte & 0x80; ++cntbyte) {\n        length += ((tmpbyte = data.read_shift(1)) & 0x7F) << 7 * cntbyte;\n      }\n\n      var d = R.f(data, length, opts);\n      if (cb(d, R, RT)) return;\n    }\n  }\n  /* control buffer usage for fixed-length buffers */\n\n\n  function buf_array() {\n    var bufs = [],\n        blksz = 2048;\n\n    var newblk = function ba_newblk(sz) {\n      var o = new_buf(sz);\n      prep_blob(o, 0);\n      return o;\n    };\n\n    var curbuf = newblk(blksz);\n\n    var endbuf = function ba_endbuf() {\n      curbuf.length = curbuf.l;\n      if (curbuf.length > 0) bufs.push(curbuf);\n      curbuf = null;\n    };\n\n    var next = function ba_next(sz) {\n      if (sz < curbuf.length - curbuf.l) return curbuf;\n      endbuf();\n      return curbuf = newblk(Math.max(sz + 1, blksz));\n    };\n\n    var end = function ba_end() {\n      endbuf();\n      return __toBuffer([bufs]);\n    };\n\n    var push = function ba_push(buf) {\n      endbuf();\n      curbuf = buf;\n      next(blksz);\n    };\n\n    return {\n      next: next,\n      push: push,\n      end: end,\n      _bufs: bufs\n    };\n  }\n\n  function write_record(ba, type, payload, length) {\n    var t = evert_RE[type],\n        l;\n    if (!length) length = XLSBRecordEnum[t].p || (payload || []).length || 0;\n    l = 1 + (t >= 0x80 ? 1 : 0) + 1 + length;\n    if (length >= 0x80) ++l;\n    if (length >= 0x4000) ++l;\n    if (length >= 0x200000) ++l;\n    var o = ba.next(l);\n    if (t <= 0x7F) o.write_shift(1, t);else {\n      o.write_shift(1, (t & 0x7F) + 0x80);\n      o.write_shift(1, t >> 7);\n    }\n\n    for (var i = 0; i != 4; ++i) {\n      if (length >= 0x80) {\n        o.write_shift(1, (length & 0x7F) + 0x80);\n        length >>= 7;\n      } else {\n        o.write_shift(1, length);\n        break;\n      }\n    }\n\n    if (length > 0 && is_buf(payload)) ba.push(payload);\n  }\n  /* XLS ranges enforced */\n\n\n  function shift_cell_xls(cell, tgt) {\n    if (tgt.s) {\n      if (cell.cRel) cell.c += tgt.s.c;\n      if (cell.rRel) cell.r += tgt.s.r;\n    } else {\n      cell.c += tgt.c;\n      cell.r += tgt.r;\n    }\n\n    cell.cRel = cell.rRel = 0;\n\n    while (cell.c >= 0x100) {\n      cell.c -= 0x100;\n    }\n\n    while (cell.r >= 0x10000) {\n      cell.r -= 0x10000;\n    }\n\n    return cell;\n  }\n\n  function shift_range_xls(cell, range) {\n    cell.s = shift_cell_xls(cell.s, range.s);\n    cell.e = shift_cell_xls(cell.e, range.s);\n    return cell;\n  }\n\n  var OFFCRYPTO = {};\n\n  var make_offcrypto = function make_offcrypto(O, _crypto) {\n    var crypto;\n    if (typeof _crypto !== 'undefined') crypto = _crypto;else if (typeof require !== 'undefined') {\n      try {\n        crypto = require('cry' + 'pto');\n      } catch (e) {\n        crypto = null;\n      }\n    }\n\n    O.rc4 = function (key, data) {\n      var S = new Array(256);\n      var c = 0,\n          i = 0,\n          j = 0,\n          t = 0;\n\n      for (i = 0; i != 256; ++i) {\n        S[i] = i;\n      }\n\n      for (i = 0; i != 256; ++i) {\n        j = j + S[i] + key[i % key.length].charCodeAt(0) & 255;\n        t = S[i];\n        S[i] = S[j];\n        S[j] = t;\n      }\n\n      i = j = 0;\n      out = Buffer(data.length);\n\n      for (c = 0; c != data.length; ++c) {\n        i = i + 1 & 255;\n        j = (j + S[i]) % 256;\n        t = S[i];\n        S[i] = S[j];\n        S[j] = t;\n        out[c] = data[c] ^ S[S[i] + S[j] & 255];\n      }\n\n      return out;\n    };\n\n    if (crypto) {\n      O.md5 = function (hex) {\n        return crypto.createHash('md5').update(hex).digest('hex');\n      };\n    } else {\n      O.md5 = function (hex) {\n        throw \"unimplemented\";\n      };\n    }\n  };\n\n  make_offcrypto(OFFCRYPTO, typeof crypto !== \"undefined\" ? crypto : undefined);\n  /* [MS-XLSB] 2.5.143 */\n\n  function parse_StrRun(data, length) {\n    return {\n      ich: data.read_shift(2),\n      ifnt: data.read_shift(2)\n    };\n  }\n  /* [MS-XLSB] 2.1.7.121 */\n\n\n  function parse_RichStr(data, length) {\n    var start = data.l;\n    var flags = data.read_shift(1);\n    var str = parse_XLWideString(data);\n    var rgsStrRun = [];\n    var z = {\n      t: str,\n      h: str\n    };\n\n    if ((flags & 1) !== 0) {\n      /* fRichStr */\n\n      /* TODO: formatted string */\n      var dwSizeStrRun = data.read_shift(4);\n\n      for (var i = 0; i != dwSizeStrRun; ++i) {\n        rgsStrRun.push(parse_StrRun(data));\n      }\n\n      z.r = rgsStrRun;\n    } else z.r = \"<t>\" + escapexml(str) + \"</t>\";\n\n    if ((flags & 2) !== 0) {\n      /* fExtStr */\n\n      /* TODO: phonetic string */\n    }\n\n    data.l = start + length;\n    return z;\n  }\n\n  function write_RichStr(str, o) {\n    /* TODO: formatted string */\n    if (o == null) o = new_buf(5 + 2 * str.t.length);\n    o.write_shift(1, 0);\n    write_XLWideString(str.t, o);\n    return o;\n  }\n  /* [MS-XLSB] 2.5.9 */\n\n\n  function parse_XLSBCell(data) {\n    var col = data.read_shift(4);\n    var iStyleRef = data.read_shift(2);\n    iStyleRef += data.read_shift(1) << 16;\n    var fPhShow = data.read_shift(1);\n    return {\n      c: col,\n      iStyleRef: iStyleRef\n    };\n  }\n\n  function write_XLSBCell(cell, o) {\n    if (o == null) o = new_buf(8);\n    o.write_shift(-4, cell.c);\n    o.write_shift(3, cell.iStyleRef === undefined ? cell.iStyleRef : cell.s);\n    o.write_shift(1, 0);\n    /* fPhShow */\n\n    return o;\n  }\n  /* [MS-XLSB] 2.5.21 */\n\n\n  function parse_XLSBCodeName(data, length) {\n    return parse_XLWideString(data, length);\n  }\n  /* [MS-XLSB] 2.5.166 */\n\n\n  function parse_XLNullableWideString(data) {\n    var cchCharacters = data.read_shift(4);\n    return cchCharacters === 0 || cchCharacters === 0xFFFFFFFF ? \"\" : data.read_shift(cchCharacters, 'dbcs');\n  }\n\n  function write_XLNullableWideString(data, o) {\n    if (!o) o = new_buf(127);\n    o.write_shift(4, data.length > 0 ? data.length : 0xFFFFFFFF);\n    if (data.length > 0) o.write_shift(0, data, 'dbcs');\n    return o;\n  }\n  /* [MS-XLSB] 2.5.168 */\n\n\n  function parse_XLWideString(data) {\n    var cchCharacters = data.read_shift(4);\n    return cchCharacters === 0 ? \"\" : data.read_shift(cchCharacters, 'dbcs');\n  }\n\n  function write_XLWideString(data, o) {\n    if (o == null) o = new_buf(4 + 2 * data.length);\n    o.write_shift(4, data.length);\n    if (data.length > 0) o.write_shift(0, data, 'dbcs');\n    return o;\n  }\n  /* [MS-XLSB] 2.5.114 */\n\n\n  var parse_RelID = parse_XLNullableWideString;\n  var write_RelID = write_XLNullableWideString;\n  /* [MS-XLSB] 2.5.122 */\n\n  /* [MS-XLS] 2.5.217 */\n\n  function parse_RkNumber(data) {\n    var b = data.slice(data.l, data.l + 4);\n    var fX100 = b[0] & 1,\n        fInt = b[0] & 2;\n    data.l += 4;\n    b[0] &= 0xFC; // b[0] &= ~3;\n\n    var RK = fInt === 0 ? __double([0, 0, 0, 0, b[0], b[1], b[2], b[3]], 0) : __readInt32LE(b, 0) >> 2;\n    return fX100 ? RK / 100 : RK;\n  }\n  /* [MS-XLSB] 2.5.153 */\n\n\n  function parse_UncheckedRfX(data) {\n    var cell = {\n      s: {},\n      e: {}\n    };\n    cell.s.r = data.read_shift(4);\n    cell.e.r = data.read_shift(4);\n    cell.s.c = data.read_shift(4);\n    cell.e.c = data.read_shift(4);\n    return cell;\n  }\n\n  function write_UncheckedRfX(r, o) {\n    if (!o) o = new_buf(16);\n    o.write_shift(4, r.s.r);\n    o.write_shift(4, r.e.r);\n    o.write_shift(4, r.s.c);\n    o.write_shift(4, r.e.c);\n    return o;\n  }\n  /* [MS-XLSB] 2.5.171 */\n\n  /* [MS-XLS] 2.5.342 */\n\n\n  function parse_Xnum(data, length) {\n    return data.read_shift(8, 'f');\n  }\n\n  function write_Xnum(data, o) {\n    return (o || new_buf(8)).write_shift(8, 'f', data);\n  }\n  /* [MS-XLSB] 2.5.198.2 */\n\n\n  var BErr = {\n    0x00: \"#NULL!\",\n    0x07: \"#DIV/0!\",\n    0x0F: \"#VALUE!\",\n    0x17: \"#REF!\",\n    0x1D: \"#NAME?\",\n    0x24: \"#NUM!\",\n    0x2A: \"#N/A\",\n    0x2B: \"#GETTING_DATA\",\n    0xFF: \"#WTF?\"\n  };\n  var RBErr = evert_num(BErr);\n  /* [MS-XLSB] 2.4.321 BrtColor */\n\n  function parse_BrtColor(data, length) {\n    var out = {};\n    var d = data.read_shift(1);\n    out.fValidRGB = d & 1;\n    out.xColorType = d >>> 1;\n    out.index = data.read_shift(1);\n    out.nTintAndShade = data.read_shift(2, 'i');\n    out.bRed = data.read_shift(1);\n    out.bGreen = data.read_shift(1);\n    out.bBlue = data.read_shift(1);\n    out.bAlpha = data.read_shift(1);\n  }\n  /* [MS-XLSB] 2.5.52 */\n\n\n  function parse_FontFlags(data, length) {\n    var d = data.read_shift(1);\n    data.l++;\n    var out = {\n      fItalic: d & 0x2,\n      fStrikeout: d & 0x8,\n      fOutline: d & 0x10,\n      fShadow: d & 0x20,\n      fCondense: d & 0x40,\n      fExtend: d & 0x80\n    };\n    return out;\n  }\n  /* [MS-OLEPS] 2.2 PropertyType */\n\n\n  {\n    var VT_EMPTY = 0x0000;\n    var VT_NULL = 0x0001;\n    var VT_I2 = 0x0002;\n    var VT_I4 = 0x0003;\n    var VT_R4 = 0x0004;\n    var VT_R8 = 0x0005;\n    var VT_CY = 0x0006;\n    var VT_DATE = 0x0007;\n    var VT_BSTR = 0x0008;\n    var VT_ERROR = 0x000A;\n    var VT_BOOL = 0x000B;\n    var VT_VARIANT = 0x000C;\n    var VT_DECIMAL = 0x000E;\n    var VT_I1 = 0x0010;\n    var VT_UI1 = 0x0011;\n    var VT_UI2 = 0x0012;\n    var VT_UI4 = 0x0013;\n    var VT_I8 = 0x0014;\n    var VT_UI8 = 0x0015;\n    var VT_INT = 0x0016;\n    var VT_UINT = 0x0017;\n    var VT_LPSTR = 0x001E;\n    var VT_LPWSTR = 0x001F;\n    var VT_FILETIME = 0x0040;\n    var VT_BLOB = 0x0041;\n    var VT_STREAM = 0x0042;\n    var VT_STORAGE = 0x0043;\n    var VT_STREAMED_Object = 0x0044;\n    var VT_STORED_Object = 0x0045;\n    var VT_BLOB_Object = 0x0046;\n    var VT_CF = 0x0047;\n    var VT_CLSID = 0x0048;\n    var VT_VERSIONED_STREAM = 0x0049;\n    var VT_VECTOR = 0x1000;\n    var VT_ARRAY = 0x2000;\n    var VT_STRING = 0x0050; // 2.3.3.1.11 VtString\n\n    var VT_USTR = 0x0051; // 2.3.3.1.12 VtUnalignedString\n\n    var VT_CUSTOM = [VT_STRING, VT_USTR];\n  }\n  /* [MS-OSHARED] 2.3.3.2.2.1 Document Summary Information PIDDSI */\n\n  var DocSummaryPIDDSI = {\n    0x01: {\n      n: 'CodePage',\n      t: VT_I2\n    },\n    0x02: {\n      n: 'Category',\n      t: VT_STRING\n    },\n    0x03: {\n      n: 'PresentationFormat',\n      t: VT_STRING\n    },\n    0x04: {\n      n: 'ByteCount',\n      t: VT_I4\n    },\n    0x05: {\n      n: 'LineCount',\n      t: VT_I4\n    },\n    0x06: {\n      n: 'ParagraphCount',\n      t: VT_I4\n    },\n    0x07: {\n      n: 'SlideCount',\n      t: VT_I4\n    },\n    0x08: {\n      n: 'NoteCount',\n      t: VT_I4\n    },\n    0x09: {\n      n: 'HiddenCount',\n      t: VT_I4\n    },\n    0x0a: {\n      n: 'MultimediaClipCount',\n      t: VT_I4\n    },\n    0x0b: {\n      n: 'Scale',\n      t: VT_BOOL\n    },\n    0x0c: {\n      n: 'HeadingPair',\n      t: VT_VECTOR | VT_VARIANT\n    },\n    0x0d: {\n      n: 'DocParts',\n      t: VT_VECTOR | VT_LPSTR\n    },\n    0x0e: {\n      n: 'Manager',\n      t: VT_STRING\n    },\n    0x0f: {\n      n: 'Company',\n      t: VT_STRING\n    },\n    0x10: {\n      n: 'LinksDirty',\n      t: VT_BOOL\n    },\n    0x11: {\n      n: 'CharacterCount',\n      t: VT_I4\n    },\n    0x13: {\n      n: 'SharedDoc',\n      t: VT_BOOL\n    },\n    0x16: {\n      n: 'HLinksChanged',\n      t: VT_BOOL\n    },\n    0x17: {\n      n: 'AppVersion',\n      t: VT_I4,\n      p: 'version'\n    },\n    0x1A: {\n      n: 'ContentType',\n      t: VT_STRING\n    },\n    0x1B: {\n      n: 'ContentStatus',\n      t: VT_STRING\n    },\n    0x1C: {\n      n: 'Language',\n      t: VT_STRING\n    },\n    0x1D: {\n      n: 'Version',\n      t: VT_STRING\n    },\n    0xFF: {}\n  };\n  /* [MS-OSHARED] 2.3.3.2.1.1 Summary Information Property Set PIDSI */\n\n  var SummaryPIDSI = {\n    0x01: {\n      n: 'CodePage',\n      t: VT_I2\n    },\n    0x02: {\n      n: 'Title',\n      t: VT_STRING\n    },\n    0x03: {\n      n: 'Subject',\n      t: VT_STRING\n    },\n    0x04: {\n      n: 'Author',\n      t: VT_STRING\n    },\n    0x05: {\n      n: 'Keywords',\n      t: VT_STRING\n    },\n    0x06: {\n      n: 'Comments',\n      t: VT_STRING\n    },\n    0x07: {\n      n: 'Template',\n      t: VT_STRING\n    },\n    0x08: {\n      n: 'LastAuthor',\n      t: VT_STRING\n    },\n    0x09: {\n      n: 'RevNumber',\n      t: VT_STRING\n    },\n    0x0A: {\n      n: 'EditTime',\n      t: VT_FILETIME\n    },\n    0x0B: {\n      n: 'LastPrinted',\n      t: VT_FILETIME\n    },\n    0x0C: {\n      n: 'CreatedDate',\n      t: VT_FILETIME\n    },\n    0x0D: {\n      n: 'ModifiedDate',\n      t: VT_FILETIME\n    },\n    0x0E: {\n      n: 'PageCount',\n      t: VT_I4\n    },\n    0x0F: {\n      n: 'WordCount',\n      t: VT_I4\n    },\n    0x10: {\n      n: 'CharCount',\n      t: VT_I4\n    },\n    0x11: {\n      n: 'Thumbnail',\n      t: VT_CF\n    },\n    0x12: {\n      n: 'ApplicationName',\n      t: VT_LPSTR\n    },\n    0x13: {\n      n: 'DocumentSecurity',\n      t: VT_I4\n    },\n    0xFF: {}\n  };\n  /* [MS-OLEPS] 2.18 */\n\n  var SpecialProperties = {\n    0x80000000: {\n      n: 'Locale',\n      t: VT_UI4\n    },\n    0x80000003: {\n      n: 'Behavior',\n      t: VT_UI4\n    },\n    0x72627262: {}\n  };\n\n  (function () {\n    for (var y in SpecialProperties) {\n      if (SpecialProperties.hasOwnProperty(y)) DocSummaryPIDDSI[y] = SummaryPIDSI[y] = SpecialProperties[y];\n    }\n  })();\n  /* [MS-XLS] 2.4.63 Country/Region codes */\n\n\n  var CountryEnum = {\n    0x0001: \"US\",\n    // United States\n    0x0002: \"CA\",\n    // Canada\n    0x0003: \"\",\n    // Latin America (except Brazil)\n    0x0007: \"RU\",\n    // Russia\n    0x0014: \"EG\",\n    // Egypt\n    0x001E: \"GR\",\n    // Greece\n    0x001F: \"NL\",\n    // Netherlands\n    0x0020: \"BE\",\n    // Belgium\n    0x0021: \"FR\",\n    // France\n    0x0022: \"ES\",\n    // Spain\n    0x0024: \"HU\",\n    // Hungary\n    0x0027: \"IT\",\n    // Italy\n    0x0029: \"CH\",\n    // Switzerland\n    0x002B: \"AT\",\n    // Austria\n    0x002C: \"GB\",\n    // United Kingdom\n    0x002D: \"DK\",\n    // Denmark\n    0x002E: \"SE\",\n    // Sweden\n    0x002F: \"NO\",\n    // Norway\n    0x0030: \"PL\",\n    // Poland\n    0x0031: \"DE\",\n    // Germany\n    0x0034: \"MX\",\n    // Mexico\n    0x0037: \"BR\",\n    // Brazil\n    0x003d: \"AU\",\n    // Australia\n    0x0040: \"NZ\",\n    // New Zealand\n    0x0042: \"TH\",\n    // Thailand\n    0x0051: \"JP\",\n    // Japan\n    0x0052: \"KR\",\n    // Korea\n    0x0054: \"VN\",\n    // Viet Nam\n    0x0056: \"CN\",\n    // China\n    0x005A: \"TR\",\n    // Turkey\n    0x0069: \"JS\",\n    // Ramastan\n    0x00D5: \"DZ\",\n    // Algeria\n    0x00D8: \"MA\",\n    // Morocco\n    0x00DA: \"LY\",\n    // Libya\n    0x015F: \"PT\",\n    // Portugal\n    0x0162: \"IS\",\n    // Iceland\n    0x0166: \"FI\",\n    // Finland\n    0x01A4: \"CZ\",\n    // Czech Republic\n    0x0376: \"TW\",\n    // Taiwan\n    0x03C1: \"LB\",\n    // Lebanon\n    0x03C2: \"JO\",\n    // Jordan\n    0x03C3: \"SY\",\n    // Syria\n    0x03C4: \"IQ\",\n    // Iraq\n    0x03C5: \"KW\",\n    // Kuwait\n    0x03C6: \"SA\",\n    // Saudi Arabia\n    0x03CB: \"AE\",\n    // United Arab Emirates\n    0x03CC: \"IL\",\n    // Israel\n    0x03CE: \"QA\",\n    // Qatar\n    0x03D5: \"IR\",\n    // Iran\n    0xFFFF: \"US\" // United States\n\n  };\n  /* [MS-XLS] 2.5.127 */\n\n  var XLSFillPattern = [null, 'solid', 'mediumGray', 'darkGray', 'lightGray', 'darkHorizontal', 'darkVertical', 'darkDown', 'darkUp', 'darkGrid', 'darkTrellis', 'lightHorizontal', 'lightVertical', 'lightDown', 'lightUp', 'lightGrid', 'lightTrellis', 'gray125', 'gray0625'];\n\n  function rgbify(arr) {\n    return arr.map(function (x) {\n      return [x >> 16 & 255, x >> 8 & 255, x & 255];\n    });\n  }\n  /* [MS-XLS] 2.5.161 */\n\n\n  var XLSIcv = rgbify([\n  /* Color Constants */\n  0x000000, 0xFFFFFF, 0xFF0000, 0x00FF00, 0x0000FF, 0xFFFF00, 0xFF00FF, 0x00FFFF,\n  /* Defaults */\n  0x000000, 0xFFFFFF, 0xFF0000, 0x00FF00, 0x0000FF, 0xFFFF00, 0xFF00FF, 0x00FFFF, 0x800000, 0x008000, 0x000080, 0x808000, 0x800080, 0x008080, 0xC0C0C0, 0x808080, 0x9999FF, 0x993366, 0xFFFFCC, 0xCCFFFF, 0x660066, 0xFF8080, 0x0066CC, 0xCCCCFF, 0x000080, 0xFF00FF, 0xFFFF00, 0x00FFFF, 0x800080, 0x800000, 0x008080, 0x0000FF, 0x00CCFF, 0xCCFFFF, 0xCCFFCC, 0xFFFF99, 0x99CCFF, 0xFF99CC, 0xCC99FF, 0xFFCC99, 0x3366FF, 0x33CCCC, 0x99CC00, 0xFFCC00, 0xFF9900, 0xFF6600, 0x666699, 0x969696, 0x003366, 0x339966, 0x003300, 0x333300, 0x993300, 0x993366, 0x333399, 0x333333,\n  /* Sheet */\n  0xFFFFFF, 0x000000]);\n  /* Parts enumerated in OPC spec, MS-XLSB and MS-XLSX */\n\n  /* 12.3 Part Summary <SpreadsheetML> */\n\n  /* 14.2 Part Summary <DrawingML> */\n\n  /* [MS-XLSX] 2.1 Part Enumerations */\n\n  /* [MS-XLSB] 2.1.7 Part Enumeration */\n\n  var ct2type = {\n    /* Workbook */\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\": \"workbooks\",\n\n    /* Worksheet */\n    \"application/vnd.ms-excel.binIndexWs\": \"TODO\",\n\n    /* Binary Index */\n\n    /* Chartsheet */\n    \"application/vnd.ms-excel.chartsheet\": \"TODO\",\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml\": \"TODO\",\n\n    /* Dialogsheet */\n    \"application/vnd.ms-excel.dialogsheet\": \"TODO\",\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml\": \"TODO\",\n\n    /* Macrosheet */\n    \"application/vnd.ms-excel.macrosheet\": \"TODO\",\n    \"application/vnd.ms-excel.macrosheet+xml\": \"TODO\",\n    \"application/vnd.ms-excel.intlmacrosheet\": \"TODO\",\n    \"application/vnd.ms-excel.binIndexMs\": \"TODO\",\n\n    /* Binary Index */\n\n    /* File Properties */\n    \"application/vnd.openxmlformats-package.core-properties+xml\": \"coreprops\",\n    \"application/vnd.openxmlformats-officedocument.custom-properties+xml\": \"custprops\",\n    \"application/vnd.openxmlformats-officedocument.extended-properties+xml\": \"extprops\",\n\n    /* Custom Data Properties */\n    \"application/vnd.openxmlformats-officedocument.customXmlProperties+xml\": \"TODO\",\n\n    /* Comments */\n    \"application/vnd.ms-excel.comments\": \"comments\",\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml\": \"comments\",\n\n    /* PivotTable */\n    \"application/vnd.ms-excel.pivotTable\": \"TODO\",\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml\": \"TODO\",\n\n    /* Calculation Chain */\n    \"application/vnd.ms-excel.calcChain\": \"calcchains\",\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml\": \"calcchains\",\n\n    /* Printer Settings */\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings\": \"TODO\",\n\n    /* ActiveX */\n    \"application/vnd.ms-office.activeX\": \"TODO\",\n    \"application/vnd.ms-office.activeX+xml\": \"TODO\",\n\n    /* Custom Toolbars */\n    \"application/vnd.ms-excel.attachedToolbars\": \"TODO\",\n\n    /* External Data Connections */\n    \"application/vnd.ms-excel.connections\": \"TODO\",\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml\": \"TODO\",\n\n    /* External Links */\n    \"application/vnd.ms-excel.externalLink\": \"TODO\",\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml\": \"TODO\",\n\n    /* Metadata */\n    \"application/vnd.ms-excel.sheetMetadata\": \"TODO\",\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml\": \"TODO\",\n\n    /* PivotCache */\n    \"application/vnd.ms-excel.pivotCacheDefinition\": \"TODO\",\n    \"application/vnd.ms-excel.pivotCacheRecords\": \"TODO\",\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml\": \"TODO\",\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml\": \"TODO\",\n\n    /* Query Table */\n    \"application/vnd.ms-excel.queryTable\": \"TODO\",\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml\": \"TODO\",\n\n    /* Shared Workbook */\n    \"application/vnd.ms-excel.userNames\": \"TODO\",\n    \"application/vnd.ms-excel.revisionHeaders\": \"TODO\",\n    \"application/vnd.ms-excel.revisionLog\": \"TODO\",\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml\": \"TODO\",\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml\": \"TODO\",\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml\": \"TODO\",\n\n    /* Single Cell Table */\n    \"application/vnd.ms-excel.tableSingleCells\": \"TODO\",\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml\": \"TODO\",\n\n    /* Slicer */\n    \"application/vnd.ms-excel.slicer\": \"TODO\",\n    \"application/vnd.ms-excel.slicerCache\": \"TODO\",\n    \"application/vnd.ms-excel.slicer+xml\": \"TODO\",\n    \"application/vnd.ms-excel.slicerCache+xml\": \"TODO\",\n\n    /* Sort Map */\n    \"application/vnd.ms-excel.wsSortMap\": \"TODO\",\n\n    /* Table */\n    \"application/vnd.ms-excel.table\": \"TODO\",\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml\": \"TODO\",\n\n    /* Themes */\n    \"application/vnd.openxmlformats-officedocument.theme+xml\": \"themes\",\n\n    /* Timeline */\n    \"application/vnd.ms-excel.Timeline+xml\": \"TODO\",\n\n    /* verify */\n    \"application/vnd.ms-excel.TimelineCache+xml\": \"TODO\",\n\n    /* verify */\n\n    /* VBA */\n    \"application/vnd.ms-office.vbaProject\": \"vba\",\n    \"application/vnd.ms-office.vbaProjectSignature\": \"vba\",\n\n    /* Volatile Dependencies */\n    \"application/vnd.ms-office.volatileDependencies\": \"TODO\",\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml\": \"TODO\",\n\n    /* Control Properties */\n    \"application/vnd.ms-excel.controlproperties+xml\": \"TODO\",\n\n    /* Data Model */\n    \"application/vnd.openxmlformats-officedocument.model+data\": \"TODO\",\n\n    /* Survey */\n    \"application/vnd.ms-excel.Survey+xml\": \"TODO\",\n\n    /* Drawing */\n    \"application/vnd.openxmlformats-officedocument.drawing+xml\": \"TODO\",\n    \"application/vnd.openxmlformats-officedocument.drawingml.chart+xml\": \"TODO\",\n    \"application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml\": \"TODO\",\n    \"application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml\": \"TODO\",\n    \"application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml\": \"TODO\",\n    \"application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml\": \"TODO\",\n    \"application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml\": \"TODO\",\n\n    /* VML */\n    \"application/vnd.openxmlformats-officedocument.vmlDrawing\": \"TODO\",\n    \"application/vnd.openxmlformats-package.relationships+xml\": \"rels\",\n    \"application/vnd.openxmlformats-officedocument.oleObject\": \"TODO\",\n    \"sheet\": \"js\"\n  };\n\n  var CT_LIST = function () {\n    var o = {\n      workbooks: {\n        xlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\",\n        xlsm: \"application/vnd.ms-excel.sheet.macroEnabled.main+xml\",\n        xlsb: \"application/vnd.ms-excel.sheet.binary.macroEnabled.main\",\n        xltx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml\"\n      },\n      strs: {\n        /* Shared Strings */\n        xlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml\",\n        xlsb: \"application/vnd.ms-excel.sharedStrings\"\n      },\n      sheets: {\n        xlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml\",\n        xlsb: \"application/vnd.ms-excel.worksheet\"\n      },\n      styles: {\n        /* Styles */\n        xlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml\",\n        xlsb: \"application/vnd.ms-excel.styles\"\n      }\n    };\n    keys(o).forEach(function (k) {\n      if (!o[k].xlsm) o[k].xlsm = o[k].xlsx;\n    });\n    keys(o).forEach(function (k) {\n      keys(o[k]).forEach(function (v) {\n        ct2type[o[k][v]] = k;\n      });\n    });\n    return o;\n  }();\n\n  var type2ct = evert_arr(ct2type);\n  XMLNS.CT = 'http://schemas.openxmlformats.org/package/2006/content-types';\n\n  function parse_ct(data, opts) {\n    var ctext = {};\n    if (!data || !data.match) return data;\n    var ct = {\n      workbooks: [],\n      sheets: [],\n      calcchains: [],\n      themes: [],\n      styles: [],\n      coreprops: [],\n      extprops: [],\n      custprops: [],\n      strs: [],\n      comments: [],\n      vba: [],\n      TODO: [],\n      rels: [],\n      xmlns: \"\"\n    };\n    (data.match(tagregex) || []).forEach(function (x) {\n      var y = parsexmltag(x);\n\n      switch (y[0].replace(nsregex, \"<\")) {\n        case '<?xml':\n          break;\n\n        case '<Types':\n          ct.xmlns = y['xmlns' + (y[0].match(/<(\\w+):/) || [\"\", \"\"])[1]];\n          break;\n\n        case '<Default':\n          ctext[y.Extension] = y.ContentType;\n          break;\n\n        case '<Override':\n          if (ct[ct2type[y.ContentType]] !== undefined) ct[ct2type[y.ContentType]].push(y.PartName);else if (opts.WTF) console.error(y);\n          break;\n      }\n    });\n    if (ct.xmlns !== XMLNS.CT) throw new Error(\"Unknown Namespace: \" + ct.xmlns);\n    ct.calcchain = ct.calcchains.length > 0 ? ct.calcchains[0] : \"\";\n    ct.sst = ct.strs.length > 0 ? ct.strs[0] : \"\";\n    ct.style = ct.styles.length > 0 ? ct.styles[0] : \"\";\n    ct.defaults = ctext;\n    delete ct.calcchains;\n    return ct;\n  }\n\n  var CTYPE_XML_ROOT = writextag('Types', null, {\n    'xmlns': XMLNS.CT,\n    'xmlns:xsd': XMLNS.xsd,\n    'xmlns:xsi': XMLNS.xsi\n  });\n  var CTYPE_DEFAULTS = [['xml', 'application/xml'], ['bin', 'application/vnd.ms-excel.sheet.binary.macroEnabled.main'], ['rels', type2ct.rels[0]]].map(function (x) {\n    return writextag('Default', null, {\n      'Extension': x[0],\n      'ContentType': x[1]\n    });\n  });\n\n  function write_ct(ct, opts) {\n    var o = [],\n        v;\n    o[o.length] = XML_HEADER;\n    o[o.length] = CTYPE_XML_ROOT;\n    o = o.concat(CTYPE_DEFAULTS);\n\n    var f1 = function f1(w) {\n      if (ct[w] && ct[w].length > 0) {\n        v = ct[w][0];\n        o[o.length] = writextag('Override', null, {\n          'PartName': (v[0] == '/' ? \"\" : \"/\") + v,\n          'ContentType': CT_LIST[w][opts.bookType || 'xlsx']\n        });\n      }\n    };\n\n    var f2 = function f2(w) {\n      ct[w].forEach(function (v) {\n        o[o.length] = writextag('Override', null, {\n          'PartName': (v[0] == '/' ? \"\" : \"/\") + v,\n          'ContentType': CT_LIST[w][opts.bookType || 'xlsx']\n        });\n      });\n    };\n\n    var f3 = function f3(t) {\n      (ct[t] || []).forEach(function (v) {\n        o[o.length] = writextag('Override', null, {\n          'PartName': (v[0] == '/' ? \"\" : \"/\") + v,\n          'ContentType': type2ct[t][0]\n        });\n      });\n    };\n\n    f1('workbooks');\n    f2('sheets');\n    f3('themes');\n    ['strs', 'styles'].forEach(f1);\n    ['coreprops', 'extprops', 'custprops'].forEach(f3);\n\n    if (o.length > 2) {\n      o[o.length] = '</Types>';\n      o[1] = o[1].replace(\"/>\", \">\");\n    }\n\n    return o.join(\"\");\n  }\n  /* 9.3.2 OPC Relationships Markup */\n\n\n  var RELS = {\n    WB: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\",\n    SHEET: \"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument\"\n  };\n\n  function parse_rels(data, currentFilePath) {\n    if (!data) return data;\n\n    if (currentFilePath.charAt(0) !== '/') {\n      currentFilePath = '/' + currentFilePath;\n    }\n\n    var rels = {};\n    var hash = {};\n\n    var resolveRelativePathIntoAbsolute = function resolveRelativePathIntoAbsolute(to) {\n      var toksFrom = currentFilePath.split('/');\n      toksFrom.pop(); // folder path\n\n      var toksTo = to.split('/');\n      var reversed = [];\n\n      while (toksTo.length !== 0) {\n        var tokTo = toksTo.shift();\n\n        if (tokTo === '..') {\n          toksFrom.pop();\n        } else if (tokTo !== '.') {\n          toksFrom.push(tokTo);\n        }\n      }\n\n      return toksFrom.join('/');\n    };\n\n    data.match(tagregex).forEach(function (x) {\n      var y = parsexmltag(x);\n      /* 9.3.2.2 OPC_Relationships */\n\n      if (y[0] === '<Relationship') {\n        var rel = {};\n        rel.Type = y.Type;\n        rel.Target = y.Target;\n        rel.Id = y.Id;\n        rel.TargetMode = y.TargetMode;\n        var canonictarget = y.TargetMode === 'External' ? y.Target : resolveRelativePathIntoAbsolute(y.Target);\n        rels[canonictarget] = rel;\n        hash[y.Id] = rel;\n      }\n    });\n    rels[\"!id\"] = hash;\n    return rels;\n  }\n\n  XMLNS.RELS = 'http://schemas.openxmlformats.org/package/2006/relationships';\n  var RELS_ROOT = writextag('Relationships', null, {\n    //'xmlns:ns0': XMLNS.RELS,\n    'xmlns': XMLNS.RELS\n  });\n  /* TODO */\n\n  function write_rels(rels) {\n    var o = [];\n    o[o.length] = XML_HEADER;\n    o[o.length] = RELS_ROOT;\n    keys(rels['!id']).forEach(function (rid) {\n      var rel = rels['!id'][rid];\n      o[o.length] = writextag('Relationship', null, rel);\n    });\n\n    if (o.length > 2) {\n      o[o.length] = '</Relationships>';\n      o[1] = o[1].replace(\"/>\", \">\");\n    }\n\n    return o.join(\"\");\n  }\n  /* ECMA-376 Part II 11.1 Core Properties Part */\n\n  /* [MS-OSHARED] 2.3.3.2.[1-2].1 (PIDSI/PIDDSI) */\n\n\n  var CORE_PROPS = [[\"cp:category\", \"Category\"], [\"cp:contentStatus\", \"ContentStatus\"], [\"cp:keywords\", \"Keywords\"], [\"cp:lastModifiedBy\", \"LastAuthor\"], [\"cp:lastPrinted\", \"LastPrinted\"], [\"cp:revision\", \"RevNumber\"], [\"cp:version\", \"Version\"], [\"dc:creator\", \"Author\"], [\"dc:description\", \"Comments\"], [\"dc:identifier\", \"Identifier\"], [\"dc:language\", \"Language\"], [\"dc:subject\", \"Subject\"], [\"dc:title\", \"Title\"], [\"dcterms:created\", \"CreatedDate\", 'date'], [\"dcterms:modified\", \"ModifiedDate\", 'date']];\n  XMLNS.CORE_PROPS = \"http://schemas.openxmlformats.org/package/2006/metadata/core-properties\";\n  RELS.CORE_PROPS = 'http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties';\n\n  var CORE_PROPS_REGEX = function () {\n    var r = new Array(CORE_PROPS.length);\n\n    for (var i = 0; i < CORE_PROPS.length; ++i) {\n      var f = CORE_PROPS[i];\n      var g = \"(?:\" + f[0].substr(0, f[0].indexOf(\":\")) + \":)\" + f[0].substr(f[0].indexOf(\":\") + 1);\n      r[i] = new RegExp(\"<\" + g + \"[^>]*>(.*)<\\/\" + g + \">\");\n    }\n\n    return r;\n  }();\n\n  function parse_core_props(data) {\n    var p = {};\n\n    for (var i = 0; i < CORE_PROPS.length; ++i) {\n      var f = CORE_PROPS[i],\n          cur = data.match(CORE_PROPS_REGEX[i]);\n      if (cur != null && cur.length > 0) p[f[1]] = cur[1];\n      if (f[2] === 'date' && p[f[1]]) p[f[1]] = new Date(p[f[1]]);\n    }\n\n    return p;\n  }\n\n  var CORE_PROPS_XML_ROOT = writextag('cp:coreProperties', null, {\n    //'xmlns': XMLNS.CORE_PROPS,\n    'xmlns:cp': XMLNS.CORE_PROPS,\n    'xmlns:dc': XMLNS.dc,\n    'xmlns:dcterms': XMLNS.dcterms,\n    'xmlns:dcmitype': XMLNS.dcmitype,\n    'xmlns:xsi': XMLNS.xsi\n  });\n\n  function cp_doit(f, g, h, o, p) {\n    if (p[f] != null || g == null || g === \"\") return;\n    p[f] = g;\n    o[o.length] = h ? writextag(f, g, h) : writetag(f, g);\n  }\n\n  function write_core_props(cp, opts) {\n    var o = [XML_HEADER, CORE_PROPS_XML_ROOT],\n        p = {};\n\n    if (opts && opts.Props) {\n      if (opts.Props.title) o[o.length] = '<dc:title>' + opts.Props.title + '</dc:title>';\n      if (opts.Props.subject) o[o.length] = '<dc:subject>' + opts.Props.subject + '</dc:subject>';\n      if (opts.Props.creator) o[o.length] = '<dc:creator>' + opts.Props.creator + '</dc:creator>';\n      if (opts.Props.keywords) o[o.length] = '<cp:keywords>' + opts.Props.keywords + '</cp:keywords>';\n      if (opts.Props.description) o[o.length] = '<dc:description>' + opts.Props.description + '</dc:description>';\n    }\n\n    if (cp) {\n      if (cp.CreatedDate != null) cp_doit(\"dcterms:created\", typeof cp.CreatedDate === \"string\" ? cp.CreatedDate : write_w3cdtf(cp.CreatedDate, opts.WTF), {\n        \"xsi:type\": \"dcterms:W3CDTF\"\n      }, o, p);\n      if (cp.ModifiedDate != null) cp_doit(\"dcterms:modified\", typeof cp.ModifiedDate === \"string\" ? cp.ModifiedDate : write_w3cdtf(cp.ModifiedDate, opts.WTF), {\n        \"xsi:type\": \"dcterms:W3CDTF\"\n      }, o, p);\n\n      for (var i = 0; i != CORE_PROPS.length; ++i) {\n        var f = CORE_PROPS[i];\n        cp_doit(f[0], cp[f[1]], null, o, p);\n      }\n    }\n\n    if (o.length > 2) {\n      o[o.length] = '</cp:coreProperties>';\n      o[1] = o[1].replace(\"/>\", \">\");\n    }\n\n    return o.join(\"\");\n  }\n  /* 15.2.12.3 Extended File Properties Part */\n\n  /* [MS-OSHARED] 2.3.3.2.[1-2].1 (PIDSI/PIDDSI) */\n\n\n  var EXT_PROPS = [[\"Application\", \"Application\", \"string\"], [\"AppVersion\", \"AppVersion\", \"string\"], [\"Company\", \"Company\", \"string\"], [\"DocSecurity\", \"DocSecurity\", \"string\"], [\"Manager\", \"Manager\", \"string\"], [\"HyperlinksChanged\", \"HyperlinksChanged\", \"bool\"], [\"SharedDoc\", \"SharedDoc\", \"bool\"], [\"LinksUpToDate\", \"LinksUpToDate\", \"bool\"], [\"ScaleCrop\", \"ScaleCrop\", \"bool\"], [\"HeadingPairs\", \"HeadingPairs\", \"raw\"], [\"TitlesOfParts\", \"TitlesOfParts\", \"raw\"]];\n  XMLNS.EXT_PROPS = \"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties\";\n  RELS.EXT_PROPS = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties';\n\n  function parse_ext_props(data, p) {\n    var q = {};\n    if (!p) p = {};\n    EXT_PROPS.forEach(function (f) {\n      switch (f[2]) {\n        case \"string\":\n          p[f[1]] = (data.match(matchtag(f[0])) || [])[1];\n          break;\n\n        case \"bool\":\n          p[f[1]] = (data.match(matchtag(f[0])) || [])[1] === \"true\";\n          break;\n\n        case \"raw\":\n          var cur = data.match(new RegExp(\"<\" + f[0] + \"[^>]*>(.*)<\\/\" + f[0] + \">\"));\n          if (cur && cur.length > 0) q[f[1]] = cur[1];\n          break;\n      }\n    });\n\n    if (q.HeadingPairs && q.TitlesOfParts) {\n      var v = parseVector(q.HeadingPairs);\n      var j = 0,\n          widx = 0;\n\n      for (var i = 0; i !== v.length; ++i) {\n        switch (v[i].v) {\n          case \"Worksheets\":\n            widx = j;\n            p.Worksheets = +v[++i].v;\n            break;\n\n          case \"Named Ranges\":\n            ++i;\n            break;\n          // TODO: Handle Named Ranges\n        }\n      }\n\n      var parts = parseVector(q.TitlesOfParts).map(function (x) {\n        return utf8read(x.v);\n      });\n      p.SheetNames = parts.slice(widx, widx + p.Worksheets);\n    }\n\n    return p;\n  }\n\n  var EXT_PROPS_XML_ROOT = writextag('Properties', null, {\n    'xmlns': XMLNS.EXT_PROPS,\n    'xmlns:vt': XMLNS.vt\n  });\n\n  function write_ext_props(cp, opts) {\n    var o = [],\n        p = {},\n        W = writextag;\n    if (!cp) cp = {};\n    cp.Application = \"SheetJS\";\n    o[o.length] = XML_HEADER;\n    o[o.length] = EXT_PROPS_XML_ROOT;\n    EXT_PROPS.forEach(function (f) {\n      if (cp[f[1]] === undefined) return;\n      var v;\n\n      switch (f[2]) {\n        case 'string':\n          v = cp[f[1]];\n          break;\n\n        case 'bool':\n          v = cp[f[1]] ? 'true' : 'false';\n          break;\n      }\n\n      if (v !== undefined) o[o.length] = W(f[0], v);\n    });\n    /* TODO: HeadingPairs, TitlesOfParts */\n\n    o[o.length] = W('HeadingPairs', W('vt:vector', W('vt:variant', '<vt:lpstr>Worksheets</vt:lpstr>') + W('vt:variant', W('vt:i4', String(cp.Worksheets))), {\n      size: 2,\n      baseType: \"variant\"\n    }));\n    o[o.length] = W('TitlesOfParts', W('vt:vector', cp.SheetNames.map(function (s) {\n      return \"<vt:lpstr>\" + s + \"</vt:lpstr>\";\n    }).join(\"\"), {\n      size: cp.Worksheets,\n      baseType: \"lpstr\"\n    }));\n\n    if (o.length > 2) {\n      o[o.length] = '</Properties>';\n      o[1] = o[1].replace(\"/>\", \">\");\n    }\n\n    return o.join(\"\");\n  }\n  /* 15.2.12.2 Custom File Properties Part */\n\n\n  XMLNS.CUST_PROPS = \"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties\";\n  RELS.CUST_PROPS = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties';\n  var custregex = /<[^>]+>[^<]*/g;\n\n  function parse_cust_props(data, opts) {\n    var p = {},\n        name;\n    var m = data.match(custregex);\n    if (m) for (var i = 0; i != m.length; ++i) {\n      var x = m[i],\n          y = parsexmltag(x);\n\n      switch (y[0]) {\n        case '<?xml':\n          break;\n\n        case '<Properties':\n          if (y.xmlns !== XMLNS.CUST_PROPS) throw \"unrecognized xmlns \" + y.xmlns;\n          if (y.xmlnsvt && y.xmlnsvt !== XMLNS.vt) throw \"unrecognized vt \" + y.xmlnsvt;\n          break;\n\n        case '<property':\n          name = y.name;\n          break;\n\n        case '</property>':\n          name = null;\n          break;\n\n        default:\n          if (x.indexOf('<vt:') === 0) {\n            var toks = x.split('>');\n            var type = toks[0].substring(4),\n                text = toks[1];\n            /* 22.4.2.32 (CT_Variant). Omit the binary types from 22.4 (Variant Types) */\n\n            switch (type) {\n              case 'lpstr':\n              case 'lpwstr':\n              case 'bstr':\n              case 'lpwstr':\n                p[name] = unescapexml(text);\n                break;\n\n              case 'bool':\n                p[name] = parsexmlbool(text, '<vt:bool>');\n                break;\n\n              case 'i1':\n              case 'i2':\n              case 'i4':\n              case 'i8':\n              case 'int':\n              case 'uint':\n                p[name] = parseInt(text, 10);\n                break;\n\n              case 'r4':\n              case 'r8':\n              case 'decimal':\n                p[name] = parseFloat(text);\n                break;\n\n              case 'filetime':\n              case 'date':\n                p[name] = new Date(text);\n                break;\n\n              case 'cy':\n              case 'error':\n                p[name] = unescapexml(text);\n                break;\n\n              default:\n                if (typeof console !== 'undefined') console.warn('Unexpected', x, type, toks);\n            }\n          } else if (x.substr(0, 2) === \"</\") {} else if (opts.WTF) throw new Error(x);\n\n      }\n    }\n    return p;\n  }\n\n  var CUST_PROPS_XML_ROOT = writextag('Properties', null, {\n    'xmlns': XMLNS.CUST_PROPS,\n    'xmlns:vt': XMLNS.vt\n  });\n\n  function write_cust_props(cp, opts) {\n    var o = [XML_HEADER, CUST_PROPS_XML_ROOT];\n    if (!cp) return o.join(\"\");\n    var pid = 1;\n    keys(cp).forEach(function custprop(k) {\n      ++pid;\n      o[o.length] = writextag('property', write_vt(cp[k]), {\n        'fmtid': '{D5CDD505-2E9C-101B-9397-08002B2CF9AE}',\n        'pid': pid,\n        'name': k\n      });\n    });\n\n    if (o.length > 2) {\n      o[o.length] = '</Properties>';\n      o[1] = o[1].replace(\"/>\", \">\");\n    }\n\n    return o.join(\"\");\n  }\n\n  function xlml_set_prop(Props, tag, val) {\n    /* TODO: Normalize the properties */\n    switch (tag) {\n      case 'Description':\n        tag = 'Comments';\n        break;\n    }\n\n    Props[tag] = val;\n  }\n  /* [MS-DTYP] 2.3.3 FILETIME */\n\n  /* [MS-OLEDS] 2.1.3 FILETIME (Packet Version) */\n\n  /* [MS-OLEPS] 2.8 FILETIME (Packet Version) */\n\n\n  function parse_FILETIME(blob) {\n    var dwLowDateTime = blob.read_shift(4),\n        dwHighDateTime = blob.read_shift(4);\n    return new Date((dwHighDateTime / 1e7 * Math.pow(2, 32) + dwLowDateTime / 1e7 - 11644473600) * 1000).toISOString().replace(/\\.000/, \"\");\n  }\n  /* [MS-OSHARED] 2.3.3.1.4 Lpstr */\n\n\n  function parse_lpstr(blob, type, pad) {\n    var str = blob.read_shift(0, 'lpstr');\n    if (pad) blob.l += 4 - (str.length + 1 & 3) & 3;\n    return str;\n  }\n  /* [MS-OSHARED] 2.3.3.1.6 Lpwstr */\n\n\n  function parse_lpwstr(blob, type, pad) {\n    var str = blob.read_shift(0, 'lpwstr');\n    if (pad) blob.l += 4 - (str.length + 1 & 3) & 3;\n    return str;\n  }\n  /* [MS-OSHARED] 2.3.3.1.11 VtString */\n\n  /* [MS-OSHARED] 2.3.3.1.12 VtUnalignedString */\n\n\n  function parse_VtStringBase(blob, stringType, pad) {\n    if (stringType === 0x1F\n    /*VT_LPWSTR*/\n    ) return parse_lpwstr(blob);\n    return parse_lpstr(blob, stringType, pad);\n  }\n\n  function parse_VtString(blob, t, pad) {\n    return parse_VtStringBase(blob, t, pad === false ? 0 : 4);\n  }\n\n  function parse_VtUnalignedString(blob, t) {\n    if (!t) throw new Error(\"dafuq?\");\n    return parse_VtStringBase(blob, t, 0);\n  }\n  /* [MS-OSHARED] 2.3.3.1.9 VtVecUnalignedLpstrValue */\n\n\n  function parse_VtVecUnalignedLpstrValue(blob) {\n    var length = blob.read_shift(4);\n    var ret = [];\n\n    for (var i = 0; i != length; ++i) {\n      ret[i] = blob.read_shift(0, 'lpstr');\n    }\n\n    return ret;\n  }\n  /* [MS-OSHARED] 2.3.3.1.10 VtVecUnalignedLpstr */\n\n\n  function parse_VtVecUnalignedLpstr(blob) {\n    return parse_VtVecUnalignedLpstrValue(blob);\n  }\n  /* [MS-OSHARED] 2.3.3.1.13 VtHeadingPair */\n\n\n  function parse_VtHeadingPair(blob) {\n    var headingString = parse_TypedPropertyValue(blob, VT_USTR);\n    var headerParts = parse_TypedPropertyValue(blob, VT_I4);\n    return [headingString, headerParts];\n  }\n  /* [MS-OSHARED] 2.3.3.1.14 VtVecHeadingPairValue */\n\n\n  function parse_VtVecHeadingPairValue(blob) {\n    var cElements = blob.read_shift(4);\n    var out = [];\n\n    for (var i = 0; i != cElements / 2; ++i) {\n      out.push(parse_VtHeadingPair(blob));\n    }\n\n    return out;\n  }\n  /* [MS-OSHARED] 2.3.3.1.15 VtVecHeadingPair */\n\n\n  function parse_VtVecHeadingPair(blob) {\n    // NOTE: When invoked, wType & padding were already consumed\n    return parse_VtVecHeadingPairValue(blob);\n  }\n  /* [MS-OLEPS] 2.18.1 Dictionary (uses 2.17, 2.16) */\n\n\n  function parse_dictionary(blob, CodePage) {\n    var cnt = blob.read_shift(4);\n    var dict = {};\n\n    for (var j = 0; j != cnt; ++j) {\n      var pid = blob.read_shift(4);\n      var len = blob.read_shift(4);\n      dict[pid] = blob.read_shift(len, CodePage === 0x4B0 ? 'utf16le' : 'utf8').replace(chr0, '').replace(chr1, '!');\n    }\n\n    if (blob.l & 3) blob.l = blob.l >> 2 + 1 << 2;\n    return dict;\n  }\n  /* [MS-OLEPS] 2.9 BLOB */\n\n\n  function parse_BLOB(blob) {\n    var size = blob.read_shift(4);\n    var bytes = blob.slice(blob.l, blob.l + size);\n    if (size & 3 > 0) blob.l += 4 - (size & 3) & 3;\n    return bytes;\n  }\n  /* [MS-OLEPS] 2.11 ClipboardData */\n\n\n  function parse_ClipboardData(blob) {\n    // TODO\n    var o = {};\n    o.Size = blob.read_shift(4); //o.Format = blob.read_shift(4);\n\n    blob.l += o.Size;\n    return o;\n  }\n  /* [MS-OLEPS] 2.14 Vector and Array Property Types */\n\n\n  function parse_VtVector(blob, cb) {}\n  /* [MS-OLEPS] 2.14.2 VectorHeader */\n\n  /*\tvar Length = blob.read_shift(4);\r\n  \tvar o = [];\r\n  \tfor(var i = 0; i != Length; ++i) {\r\n  \t\to.push(cb(blob));\r\n  \t}\r\n  \treturn o;*/\n\n  /* [MS-OLEPS] 2.15 TypedPropertyValue */\n\n\n  function parse_TypedPropertyValue(blob, type, _opts) {\n    var t = blob.read_shift(2),\n        ret,\n        opts = _opts || {};\n    blob.l += 2;\n    if (type !== VT_VARIANT) if (t !== type && VT_CUSTOM.indexOf(type) === -1) throw new Error('Expected type ' + type + ' saw ' + t);\n\n    switch (type === VT_VARIANT ? t : type) {\n      case 0x02\n      /*VT_I2*/\n      :\n        ret = blob.read_shift(2, 'i');\n        if (!opts.raw) blob.l += 2;\n        return ret;\n\n      case 0x03\n      /*VT_I4*/\n      :\n        ret = blob.read_shift(4, 'i');\n        return ret;\n\n      case 0x0B\n      /*VT_BOOL*/\n      :\n        return blob.read_shift(4) !== 0x0;\n\n      case 0x13\n      /*VT_UI4*/\n      :\n        ret = blob.read_shift(4);\n        return ret;\n\n      case 0x1E\n      /*VT_LPSTR*/\n      :\n        return parse_lpstr(blob, t, 4).replace(chr0, '');\n\n      case 0x1F\n      /*VT_LPWSTR*/\n      :\n        return parse_lpwstr(blob);\n\n      case 0x40\n      /*VT_FILETIME*/\n      :\n        return parse_FILETIME(blob);\n\n      case 0x41\n      /*VT_BLOB*/\n      :\n        return parse_BLOB(blob);\n\n      case 0x47\n      /*VT_CF*/\n      :\n        return parse_ClipboardData(blob);\n\n      case 0x50\n      /*VT_STRING*/\n      :\n        return parse_VtString(blob, t, !opts.raw && 4).replace(chr0, '');\n\n      case 0x51\n      /*VT_USTR*/\n      :\n        return parse_VtUnalignedString(blob, t, 4).replace(chr0, '');\n\n      case 0x100C\n      /*VT_VECTOR|VT_VARIANT*/\n      :\n        return parse_VtVecHeadingPair(blob);\n\n      case 0x101E\n      /*VT_LPSTR*/\n      :\n        return parse_VtVecUnalignedLpstr(blob);\n\n      default:\n        throw new Error(\"TypedPropertyValue unrecognized type \" + type + \" \" + t);\n    }\n  }\n  /* [MS-OLEPS] 2.14.2 VectorHeader */\n\n  /*function parse_VTVectorVariant(blob) {\r\n  \tvar Length = blob.read_shift(4);\r\n  \r\n  \tif(Length & 1 !== 0) throw new Error(\"VectorHeader Length=\" + Length + \" must be even\");\r\n  \tvar o = [];\r\n  \tfor(var i = 0; i != Length; ++i) {\r\n  \t\to.push(parse_TypedPropertyValue(blob, VT_VARIANT));\r\n  \t}\r\n  \treturn o;\r\n  }*/\n\n  /* [MS-OLEPS] 2.20 PropertySet */\n\n\n  function parse_PropertySet(blob, PIDSI) {\n    var start_addr = blob.l;\n    var size = blob.read_shift(4);\n    var NumProps = blob.read_shift(4);\n    var Props = [],\n        i = 0;\n    var CodePage = 0;\n    var Dictionary = -1,\n        DictObj;\n\n    for (i = 0; i != NumProps; ++i) {\n      var PropID = blob.read_shift(4);\n      var Offset = blob.read_shift(4);\n      Props[i] = [PropID, Offset + start_addr];\n    }\n\n    var PropH = {};\n\n    for (i = 0; i != NumProps; ++i) {\n      if (blob.l !== Props[i][1]) {\n        var fail = true;\n        if (i > 0 && PIDSI) switch (PIDSI[Props[i - 1][0]].t) {\n          case 0x02\n          /*VT_I2*/\n          :\n            if (blob.l + 2 === Props[i][1]) {\n              blob.l += 2;\n              fail = false;\n            }\n\n            break;\n\n          case 0x50\n          /*VT_STRING*/\n          :\n            if (blob.l <= Props[i][1]) {\n              blob.l = Props[i][1];\n              fail = false;\n            }\n\n            break;\n\n          case 0x100C\n          /*VT_VECTOR|VT_VARIANT*/\n          :\n            if (blob.l <= Props[i][1]) {\n              blob.l = Props[i][1];\n              fail = false;\n            }\n\n            break;\n        }\n\n        if (!PIDSI && blob.l <= Props[i][1]) {\n          fail = false;\n          blob.l = Props[i][1];\n        }\n\n        if (fail) throw new Error(\"Read Error: Expected address \" + Props[i][1] + ' at ' + blob.l + ' :' + i);\n      }\n\n      if (PIDSI) {\n        var piddsi = PIDSI[Props[i][0]];\n        PropH[piddsi.n] = parse_TypedPropertyValue(blob, piddsi.t, {\n          raw: true\n        });\n        if (piddsi.p === 'version') PropH[piddsi.n] = String(PropH[piddsi.n] >> 16) + \".\" + String(PropH[piddsi.n] & 0xFFFF);\n        if (piddsi.n == \"CodePage\") switch (PropH[piddsi.n]) {\n          case 0:\n            PropH[piddsi.n] = 1252;\n\n          /* falls through */\n\n          case 10000: // OSX Roman\n\n          case 1252: // Windows Latin\n\n          case 874: // SB Windows Thai\n\n          case 1250: // SB Windows Central Europe\n\n          case 1251: // SB Windows Cyrillic\n\n          case 1253: // SB Windows Greek\n\n          case 1254: // SB Windows Turkish\n\n          case 1255: // SB Windows Hebrew\n\n          case 1256: // SB Windows Arabic\n\n          case 1257: // SB Windows Baltic\n\n          case 1258: // SB Windows Vietnam\n\n          case 932: // DB Windows Japanese Shift-JIS\n\n          case 936: // DB Windows Simplified Chinese GBK\n\n          case 949: // DB Windows Korean\n\n          case 950: // DB Windows Traditional Chinese Big5\n\n          case 1200: // UTF16LE\n\n          case 1201: // UTF16BE\n\n          case 65000:\n          case -536: // UTF-7\n\n          case 65001:\n          case -535:\n            // UTF-8\n            set_cp(CodePage = PropH[piddsi.n]);\n            break;\n\n          default:\n            throw new Error(\"Unsupported CodePage: \" + PropH[piddsi.n]);\n        }\n      } else {\n        if (Props[i][0] === 0x1) {\n          CodePage = PropH.CodePage = parse_TypedPropertyValue(blob, VT_I2);\n          set_cp(CodePage);\n\n          if (Dictionary !== -1) {\n            var oldpos = blob.l;\n            blob.l = Props[Dictionary][1];\n            DictObj = parse_dictionary(blob, CodePage);\n            blob.l = oldpos;\n          }\n        } else if (Props[i][0] === 0) {\n          if (CodePage === 0) {\n            Dictionary = i;\n            blob.l = Props[i + 1][1];\n            continue;\n          }\n\n          DictObj = parse_dictionary(blob, CodePage);\n        } else {\n          var name = DictObj[Props[i][0]];\n          var val;\n          /* [MS-OSHARED] 2.3.3.2.3.1.2 + PROPVARIANT */\n\n          switch (blob[blob.l]) {\n            case 0x41\n            /*VT_BLOB*/\n            :\n              blob.l += 4;\n              val = parse_BLOB(blob);\n              break;\n\n            case 0x1E\n            /*VT_LPSTR*/\n            :\n              blob.l += 4;\n              val = parse_VtString(blob, blob[blob.l - 4]);\n              break;\n\n            case 0x1F\n            /*VT_LPWSTR*/\n            :\n              blob.l += 4;\n              val = parse_VtString(blob, blob[blob.l - 4]);\n              break;\n\n            case 0x03\n            /*VT_I4*/\n            :\n              blob.l += 4;\n              val = blob.read_shift(4, 'i');\n              break;\n\n            case 0x13\n            /*VT_UI4*/\n            :\n              blob.l += 4;\n              val = blob.read_shift(4);\n              break;\n\n            case 0x05\n            /*VT_R8*/\n            :\n              blob.l += 4;\n              val = blob.read_shift(8, 'f');\n              break;\n\n            case 0x0B\n            /*VT_BOOL*/\n            :\n              blob.l += 4;\n              val = parsebool(blob, 4);\n              break;\n\n            case 0x40\n            /*VT_FILETIME*/\n            :\n              blob.l += 4;\n              val = new Date(parse_FILETIME(blob));\n              break;\n\n            default:\n              throw new Error(\"unparsed value: \" + blob[blob.l]);\n          }\n\n          PropH[name] = val;\n        }\n      }\n    }\n\n    blob.l = start_addr + size;\n    /* step ahead to skip padding */\n\n    return PropH;\n  }\n  /* [MS-OLEPS] 2.21 PropertySetStream */\n\n\n  function parse_PropertySetStream(file, PIDSI) {\n    var blob = file.content;\n    prep_blob(blob, 0);\n    var NumSets, FMTID0, FMTID1, Offset0, Offset1;\n    blob.chk('feff', 'Byte Order: ');\n    var vers = blob.read_shift(2); // TODO: check version\n\n    var SystemIdentifier = blob.read_shift(4);\n    blob.chk(CFB.utils.consts.HEADER_CLSID, 'CLSID: ');\n    NumSets = blob.read_shift(4);\n    if (NumSets !== 1 && NumSets !== 2) throw \"Unrecognized #Sets: \" + NumSets;\n    FMTID0 = blob.read_shift(16);\n    Offset0 = blob.read_shift(4);\n    if (NumSets === 1 && Offset0 !== blob.l) throw \"Length mismatch\";else if (NumSets === 2) {\n      FMTID1 = blob.read_shift(16);\n      Offset1 = blob.read_shift(4);\n    }\n    var PSet0 = parse_PropertySet(blob, PIDSI);\n    var rval = {\n      SystemIdentifier: SystemIdentifier\n    };\n\n    for (var y in PSet0) {\n      rval[y] = PSet0[y];\n    } //rval.blob = blob;\n\n\n    rval.FMTID = FMTID0; //rval.PSet0 = PSet0;\n\n    if (NumSets === 1) return rval;\n    if (blob.l !== Offset1) throw \"Length mismatch 2: \" + blob.l + \" !== \" + Offset1;\n    var PSet1;\n\n    try {\n      PSet1 = parse_PropertySet(blob, null);\n    } catch (e) {}\n\n    for (y in PSet1) {\n      rval[y] = PSet1[y];\n    }\n\n    rval.FMTID = [FMTID0, FMTID1]; // TODO: verify FMTID0/1\n\n    return rval;\n  }\n\n  function parsenoop2(blob, length) {\n    blob.read_shift(length);\n    return null;\n  }\n\n  function parslurp(blob, length, cb) {\n    var arr = [],\n        target = blob.l + length;\n\n    while (blob.l < target) {\n      arr.push(cb(blob, target - blob.l));\n    }\n\n    if (target !== blob.l) throw new Error(\"Slurp error\");\n    return arr;\n  }\n\n  function parslurp2(blob, length, cb) {\n    var arr = [],\n        target = blob.l + length,\n        len = blob.read_shift(2);\n\n    while (len-- !== 0) {\n      arr.push(cb(blob, target - blob.l));\n    }\n\n    if (target !== blob.l) throw new Error(\"Slurp error\");\n    return arr;\n  }\n\n  function parsebool(blob, length) {\n    return blob.read_shift(length) === 0x1;\n  }\n\n  function parseuint16(blob) {\n    return blob.read_shift(2, 'u');\n  }\n\n  function parseuint16a(blob, length) {\n    return parslurp(blob, length, parseuint16);\n  }\n  /* --- 2.5 Structures --- */\n\n  /* [MS-XLS] 2.5.14 Boolean */\n\n\n  var parse_Boolean = parsebool;\n  /* [MS-XLS] 2.5.10 Bes (boolean or error) */\n\n  function parse_Bes(blob) {\n    var v = blob.read_shift(1),\n        t = blob.read_shift(1);\n    return t === 0x01 ? v : v === 0x01;\n  }\n  /* [MS-XLS] 2.5.240 ShortXLUnicodeString */\n\n\n  function parse_ShortXLUnicodeString(blob, length, opts) {\n    var cch = blob.read_shift(1);\n    var width = 1,\n        encoding = 'sbcs-cont';\n    var cp = current_codepage;\n    if (opts && opts.biff >= 8) current_codepage = 1200;\n\n    if (opts === undefined || opts.biff !== 5) {\n      var fHighByte = blob.read_shift(1);\n\n      if (fHighByte) {\n        width = 2;\n        encoding = 'dbcs-cont';\n      }\n    }\n\n    var o = cch ? blob.read_shift(cch, encoding) : \"\";\n    current_codepage = cp;\n    return o;\n  }\n  /* 2.5.293 XLUnicodeRichExtendedString */\n\n\n  function parse_XLUnicodeRichExtendedString(blob) {\n    var cp = current_codepage;\n    current_codepage = 1200;\n    var cch = blob.read_shift(2),\n        flags = blob.read_shift(1);\n    var fHighByte = flags & 0x1,\n        fExtSt = flags & 0x4,\n        fRichSt = flags & 0x8;\n    var width = 1 + (flags & 0x1); // 0x0 -> utf8, 0x1 -> dbcs\n\n    var cRun, cbExtRst;\n    var z = {};\n    if (fRichSt) cRun = blob.read_shift(2);\n    if (fExtSt) cbExtRst = blob.read_shift(4);\n    var encoding = flags & 0x1 ? 'dbcs-cont' : 'sbcs-cont';\n    var msg = cch === 0 ? \"\" : blob.read_shift(cch, encoding);\n    if (fRichSt) blob.l += 4 * cRun; //TODO: parse this\n\n    if (fExtSt) blob.l += cbExtRst; //TODO: parse this\n\n    z.t = msg;\n\n    if (!fRichSt) {\n      z.raw = \"<t>\" + z.t + \"</t>\";\n      z.r = z.t;\n    }\n\n    current_codepage = cp;\n    return z;\n  }\n  /* 2.5.296 XLUnicodeStringNoCch */\n\n\n  function parse_XLUnicodeStringNoCch(blob, cch, opts) {\n    var retval;\n    var fHighByte = blob.read_shift(1);\n\n    if (fHighByte === 0) {\n      retval = blob.read_shift(cch, 'sbcs-cont');\n    } else {\n      retval = blob.read_shift(cch, 'dbcs-cont');\n    }\n\n    return retval;\n  }\n  /* 2.5.294 XLUnicodeString */\n\n\n  function parse_XLUnicodeString(blob, length, opts) {\n    var cch = blob.read_shift(opts !== undefined && opts.biff > 0 && opts.biff < 8 ? 1 : 2);\n\n    if (cch === 0) {\n      blob.l++;\n      return \"\";\n    }\n\n    return parse_XLUnicodeStringNoCch(blob, cch, opts);\n  }\n  /* BIFF5 override */\n\n\n  function parse_XLUnicodeString2(blob, length, opts) {\n    if (opts.biff !== 5 && opts.biff !== 2) return parse_XLUnicodeString(blob, length, opts);\n    var cch = blob.read_shift(1);\n\n    if (cch === 0) {\n      blob.l++;\n      return \"\";\n    }\n\n    return blob.read_shift(cch, 'sbcs-cont');\n  }\n  /* [MS-XLS] 2.5.61 ControlInfo */\n\n\n  var parse_ControlInfo = parsenoop;\n  /* [MS-OSHARED] 2.3.7.6 URLMoniker TODO: flags */\n\n  var parse_URLMoniker = function parse_URLMoniker(blob, length) {\n    var len = blob.read_shift(4),\n        start = blob.l;\n    var extra = false;\n\n    if (len > 24) {\n      /* look ahead */\n      blob.l += len - 24;\n      if (blob.read_shift(16) === \"795881f43b1d7f48af2c825dc4852763\") extra = true;\n      blob.l = start;\n    }\n\n    var url = blob.read_shift((extra ? len - 24 : len) >> 1, 'utf16le').replace(chr0, \"\");\n    if (extra) blob.l += 24;\n    return url;\n  };\n  /* [MS-OSHARED] 2.3.7.8 FileMoniker TODO: all fields */\n\n\n  var parse_FileMoniker = function parse_FileMoniker(blob, length) {\n    var cAnti = blob.read_shift(2);\n    var ansiLength = blob.read_shift(4);\n    var ansiPath = blob.read_shift(ansiLength, 'cstr');\n    var endServer = blob.read_shift(2);\n    var versionNumber = blob.read_shift(2);\n    var cbUnicodePathSize = blob.read_shift(4);\n    if (cbUnicodePathSize === 0) return ansiPath.replace(/\\\\/g, \"/\");\n    var cbUnicodePathBytes = blob.read_shift(4);\n    var usKeyValue = blob.read_shift(2);\n    var unicodePath = blob.read_shift(cbUnicodePathBytes >> 1, 'utf16le').replace(chr0, \"\");\n    return unicodePath;\n  };\n  /* [MS-OSHARED] 2.3.7.2 HyperlinkMoniker TODO: all the monikers */\n\n\n  var parse_HyperlinkMoniker = function parse_HyperlinkMoniker(blob, length) {\n    var clsid = blob.read_shift(16);\n    length -= 16;\n\n    switch (clsid) {\n      case \"e0c9ea79f9bace118c8200aa004ba90b\":\n        return parse_URLMoniker(blob, length);\n\n      case \"0303000000000000c000000000000046\":\n        return parse_FileMoniker(blob, length);\n\n      default:\n        throw \"unsupported moniker \" + clsid;\n    }\n  };\n  /* [MS-OSHARED] 2.3.7.9 HyperlinkString */\n\n\n  var parse_HyperlinkString = function parse_HyperlinkString(blob, length) {\n    var len = blob.read_shift(4);\n    var o = blob.read_shift(len, 'utf16le').replace(chr0, \"\");\n    return o;\n  };\n  /* [MS-OSHARED] 2.3.7.1 Hyperlink Object TODO: unify params with XLSX */\n\n\n  var parse_Hyperlink = function parse_Hyperlink(blob, length) {\n    var end = blob.l + length;\n    var sVer = blob.read_shift(4);\n    if (sVer !== 2) throw new Error(\"Unrecognized streamVersion: \" + sVer);\n    var flags = blob.read_shift(2);\n    blob.l += 2;\n    var displayName, targetFrameName, moniker, oleMoniker, location, guid, fileTime;\n    if (flags & 0x0010) displayName = parse_HyperlinkString(blob, end - blob.l);\n    if (flags & 0x0080) targetFrameName = parse_HyperlinkString(blob, end - blob.l);\n    if ((flags & 0x0101) === 0x0101) moniker = parse_HyperlinkString(blob, end - blob.l);\n    if ((flags & 0x0101) === 0x0001) oleMoniker = parse_HyperlinkMoniker(blob, end - blob.l);\n    if (flags & 0x0008) location = parse_HyperlinkString(blob, end - blob.l);\n    if (flags & 0x0020) guid = blob.read_shift(16);\n    if (flags & 0x0040) fileTime = parse_FILETIME(blob, 8);\n    blob.l = end;\n    var target = targetFrameName || moniker || oleMoniker;\n    if (location) target += \"#\" + location;\n    return {\n      Target: target\n    };\n  };\n  /* 2.5.178 LongRGBA */\n\n\n  function parse_LongRGBA(blob, length) {\n    var r = blob.read_shift(1),\n        g = blob.read_shift(1),\n        b = blob.read_shift(1),\n        a = blob.read_shift(1);\n    return [r, g, b, a];\n  }\n  /* 2.5.177 LongRGB */\n\n\n  function parse_LongRGB(blob, length) {\n    var x = parse_LongRGBA(blob, length);\n    x[3] = 0;\n    return x;\n  }\n  /* --- MS-XLS --- */\n\n  /* 2.5.19 */\n\n\n  function parse_XLSCell(blob, length) {\n    var rw = blob.read_shift(2); // 0-indexed\n\n    var col = blob.read_shift(2);\n    var ixfe = blob.read_shift(2);\n    return {\n      r: rw,\n      c: col,\n      ixfe: ixfe\n    };\n  }\n  /* 2.5.134 */\n\n\n  function parse_frtHeader(blob) {\n    var rt = blob.read_shift(2);\n    var flags = blob.read_shift(2); // TODO: parse these flags\n\n    blob.l += 8;\n    return {\n      type: rt,\n      flags: flags\n    };\n  }\n\n  function parse_OptXLUnicodeString(blob, length, opts) {\n    return length === 0 ? \"\" : parse_XLUnicodeString2(blob, length, opts);\n  }\n  /* 2.5.158 */\n\n\n  var HIDEOBJENUM = ['SHOWALL', 'SHOWPLACEHOLDER', 'HIDEALL'];\n  var parse_HideObjEnum = parseuint16;\n  /* 2.5.344 */\n\n  function parse_XTI(blob, length) {\n    var iSupBook = blob.read_shift(2),\n        itabFirst = blob.read_shift(2, 'i'),\n        itabLast = blob.read_shift(2, 'i');\n    return [iSupBook, itabFirst, itabLast];\n  }\n  /* 2.5.218 */\n\n\n  function parse_RkRec(blob, length) {\n    var ixfe = blob.read_shift(2);\n    var RK = parse_RkNumber(blob); //console.log(\"::\", ixfe, RK,\";;\");\n\n    return [ixfe, RK];\n  }\n  /* 2.5.1 */\n\n\n  function parse_AddinUdf(blob, length) {\n    blob.l += 4;\n    length -= 4;\n    var l = blob.l + length;\n    var udfName = parse_ShortXLUnicodeString(blob, length);\n    var cb = blob.read_shift(2);\n    l -= blob.l;\n    if (cb !== l) throw \"Malformed AddinUdf: padding = \" + l + \" != \" + cb;\n    blob.l += cb;\n    return udfName;\n  }\n  /* 2.5.209 TODO: Check sizes */\n\n\n  function parse_Ref8U(blob, length) {\n    var rwFirst = blob.read_shift(2);\n    var rwLast = blob.read_shift(2);\n    var colFirst = blob.read_shift(2);\n    var colLast = blob.read_shift(2);\n    return {\n      s: {\n        c: colFirst,\n        r: rwFirst\n      },\n      e: {\n        c: colLast,\n        r: rwLast\n      }\n    };\n  }\n  /* 2.5.211 */\n\n\n  function parse_RefU(blob, length) {\n    var rwFirst = blob.read_shift(2);\n    var rwLast = blob.read_shift(2);\n    var colFirst = blob.read_shift(1);\n    var colLast = blob.read_shift(1);\n    return {\n      s: {\n        c: colFirst,\n        r: rwFirst\n      },\n      e: {\n        c: colLast,\n        r: rwLast\n      }\n    };\n  }\n  /* 2.5.207 */\n\n\n  var parse_Ref = parse_RefU;\n  /* 2.5.143 */\n\n  function parse_FtCmo(blob, length) {\n    blob.l += 4;\n    var ot = blob.read_shift(2);\n    var id = blob.read_shift(2);\n    var flags = blob.read_shift(2);\n    blob.l += 12;\n    return [id, ot, flags];\n  }\n  /* 2.5.149 */\n\n\n  function parse_FtNts(blob, length) {\n    var out = {};\n    blob.l += 4;\n    blob.l += 16; // GUID TODO\n\n    out.fSharedNote = blob.read_shift(2);\n    blob.l += 4;\n    return out;\n  }\n  /* 2.5.142 */\n\n\n  function parse_FtCf(blob, length) {\n    var out = {};\n    blob.l += 4;\n    blob.cf = blob.read_shift(2);\n    return out;\n  }\n  /* 2.5.140 - 2.5.154 and friends */\n\n\n  var FtTab = {\n    0x15: parse_FtCmo,\n    0x13: parsenoop,\n\n    /* FtLbsData */\n    0x12: function _(blob, length) {\n      blob.l += 12;\n    },\n\n    /* FtCblsData */\n    0x11: function _(blob, length) {\n      blob.l += 8;\n    },\n\n    /* FtRboData */\n    0x10: parsenoop,\n\n    /* FtEdoData */\n    0x0F: parsenoop,\n\n    /* FtGboData */\n    0x0D: parse_FtNts,\n\n    /* FtNts */\n    0x0C: function _(blob, length) {\n      blob.l += 24;\n    },\n\n    /* FtSbs */\n    0x0B: function _(blob, length) {\n      blob.l += 10;\n    },\n\n    /* FtRbo */\n    0x0A: function _(blob, length) {\n      blob.l += 16;\n    },\n\n    /* FtCbls */\n    0x09: parsenoop,\n\n    /* FtPictFmla */\n    0x08: function _(blob, length) {\n      blob.l += 6;\n    },\n\n    /* FtPioGrbit */\n    0x07: parse_FtCf,\n\n    /* FtCf */\n    0x06: function _(blob, length) {\n      blob.l += 6;\n    },\n\n    /* FtGmo */\n    0x04: parsenoop,\n\n    /* FtMacro */\n    0x00: function _(blob, length) {\n      blob.l += 4;\n    }\n    /* FtEnding */\n\n  };\n\n  function parse_FtArray(blob, length, ot) {\n    var s = blob.l;\n    var fts = [];\n\n    while (blob.l < s + length) {\n      var ft = blob.read_shift(2);\n      blob.l -= 2;\n\n      try {\n        fts.push(FtTab[ft](blob, s + length - blob.l));\n      } catch (e) {\n        blob.l = s + length;\n        return fts;\n      }\n    }\n\n    if (blob.l != s + length) blob.l = s + length; //throw \"bad Object Ft-sequence\";\n\n    return fts;\n  }\n  /* 2.5.129 */\n\n\n  var parse_FontIndex = parseuint16;\n  /* --- 2.4 Records --- */\n\n  /* 2.4.21 */\n\n  function parse_BOF(blob, length) {\n    var o = {};\n    o.BIFFVer = blob.read_shift(2);\n    length -= 2;\n\n    switch (o.BIFFVer) {\n      case 0x0600:\n      /* BIFF8 */\n\n      case 0x0500:\n      /* BIFF5 */\n\n      case 0x0002:\n      case 0x0007:\n        /* BIFF2 */\n        break;\n\n      default:\n        throw \"Unexpected BIFF Ver \" + o.BIFFVer;\n    }\n\n    blob.read_shift(length);\n    return o;\n  }\n  /* 2.4.146 */\n\n\n  function parse_InterfaceHdr(blob, length) {\n    if (length === 0) return 0x04b0;\n    var q;\n    if ((q = blob.read_shift(2)) !== 0x04b0) throw 'InterfaceHdr codePage ' + q;\n    return 0x04b0;\n  }\n  /* 2.4.349 */\n\n\n  function parse_WriteAccess(blob, length, opts) {\n    if (opts.enc) {\n      blob.l += length;\n      return \"\";\n    }\n\n    var l = blob.l; // TODO: make sure XLUnicodeString doesnt overrun\n\n    var UserName = parse_XLUnicodeString(blob, 0, opts);\n    blob.read_shift(length + l - blob.l);\n    return UserName;\n  }\n  /* 2.4.28 */\n\n\n  function parse_BoundSheet8(blob, length, opts) {\n    var pos = blob.read_shift(4);\n    var hidden = blob.read_shift(1) >> 6;\n    var dt = blob.read_shift(1);\n\n    switch (dt) {\n      case 0:\n        dt = 'Worksheet';\n        break;\n\n      case 1:\n        dt = 'Macrosheet';\n        break;\n\n      case 2:\n        dt = 'Chartsheet';\n        break;\n\n      case 6:\n        dt = 'VBAModule';\n        break;\n    }\n\n    var name = parse_ShortXLUnicodeString(blob, 0, opts);\n    if (name.length === 0) name = \"Sheet1\";\n    return {\n      pos: pos,\n      hs: hidden,\n      dt: dt,\n      name: name\n    };\n  }\n  /* 2.4.265 TODO */\n\n\n  function parse_SST(blob, length) {\n    var cnt = blob.read_shift(4);\n    var ucnt = blob.read_shift(4);\n    var strs = [];\n\n    for (var i = 0; i != ucnt; ++i) {\n      strs.push(parse_XLUnicodeRichExtendedString(blob));\n    }\n\n    strs.Count = cnt;\n    strs.Unique = ucnt;\n    return strs;\n  }\n  /* 2.4.107 */\n\n\n  function parse_ExtSST(blob, length) {\n    var extsst = {};\n    extsst.dsst = blob.read_shift(2);\n    blob.l += length - 2;\n    return extsst;\n  }\n  /* 2.4.221 TODO*/\n\n\n  function parse_Row(blob, length) {\n    var rw = blob.read_shift(2),\n        col = blob.read_shift(2),\n        Col = blob.read_shift(2),\n        rht = blob.read_shift(2);\n    blob.read_shift(4); // reserved(2), unused(2)\n\n    var flags = blob.read_shift(1); // various flags\n\n    blob.read_shift(1); // reserved\n\n    blob.read_shift(2); //ixfe, other flags\n\n    return {\n      r: rw,\n      c: col,\n      cnt: Col - col\n    };\n  }\n  /* 2.4.125 */\n\n\n  function parse_ForceFullCalculation(blob, length) {\n    var header = parse_frtHeader(blob);\n    if (header.type != 0x08A3) throw \"Invalid Future Record \" + header.type;\n    var fullcalc = blob.read_shift(4);\n    return fullcalc !== 0x0;\n  }\n\n  var parse_CompressPictures = parsenoop2;\n  /* 2.4.55 Not interesting */\n\n  /* 2.4.215 rt */\n\n  function parse_RecalcId(blob, length) {\n    blob.read_shift(2);\n    return blob.read_shift(4);\n  }\n  /* 2.4.87 */\n\n\n  function parse_DefaultRowHeight(blob, length) {\n    var f = blob.read_shift(2),\n        miyRw;\n    miyRw = blob.read_shift(2); // flags & 0x02 -> hidden, else empty\n\n    var fl = {\n      Unsynced: f & 1,\n      DyZero: (f & 2) >> 1,\n      ExAsc: (f & 4) >> 2,\n      ExDsc: (f & 8) >> 3\n    };\n    return [fl, miyRw];\n  }\n  /* 2.4.345 TODO */\n\n\n  function parse_Window1(blob, length) {\n    var xWn = blob.read_shift(2),\n        yWn = blob.read_shift(2),\n        dxWn = blob.read_shift(2),\n        dyWn = blob.read_shift(2);\n    var flags = blob.read_shift(2),\n        iTabCur = blob.read_shift(2),\n        iTabFirst = blob.read_shift(2);\n    var ctabSel = blob.read_shift(2),\n        wTabRatio = blob.read_shift(2);\n    return {\n      Pos: [xWn, yWn],\n      Dim: [dxWn, dyWn],\n      Flags: flags,\n      CurTab: iTabCur,\n      FirstTab: iTabFirst,\n      Selected: ctabSel,\n      TabRatio: wTabRatio\n    };\n  }\n  /* 2.4.122 TODO */\n\n\n  function parse_Font(blob, length, opts) {\n    blob.l += 14;\n    var name = parse_ShortXLUnicodeString(blob, 0, opts);\n    return name;\n  }\n  /* 2.4.149 */\n\n\n  function parse_LabelSst(blob, length) {\n    var cell = parse_XLSCell(blob);\n    cell.isst = blob.read_shift(4);\n    return cell;\n  }\n  /* 2.4.148 */\n\n\n  function parse_Label(blob, length, opts) {\n    var cell = parse_XLSCell(blob, 6);\n    var str = parse_XLUnicodeString(blob, length - 6, opts);\n    cell.val = str;\n    return cell;\n  }\n  /* 2.4.126 Number Formats */\n\n\n  function parse_Format(blob, length, opts) {\n    var ifmt = blob.read_shift(2);\n    var fmtstr = parse_XLUnicodeString2(blob, 0, opts);\n    return [ifmt, fmtstr];\n  }\n  /* 2.4.90 */\n\n\n  function parse_Dimensions(blob, length) {\n    var w = length === 10 ? 2 : 4;\n    var r = blob.read_shift(w),\n        R = blob.read_shift(w),\n        c = blob.read_shift(2),\n        C = blob.read_shift(2);\n    blob.l += 2;\n    return {\n      s: {\n        r: r,\n        c: c\n      },\n      e: {\n        r: R,\n        c: C\n      }\n    };\n  }\n  /* 2.4.220 */\n\n\n  function parse_RK(blob, length) {\n    var rw = blob.read_shift(2),\n        col = blob.read_shift(2);\n    var rkrec = parse_RkRec(blob);\n    return {\n      r: rw,\n      c: col,\n      ixfe: rkrec[0],\n      rknum: rkrec[1]\n    };\n  }\n  /* 2.4.175 */\n\n\n  function parse_MulRk(blob, length) {\n    var target = blob.l + length - 2;\n    var rw = blob.read_shift(2),\n        col = blob.read_shift(2);\n    var rkrecs = [];\n\n    while (blob.l < target) {\n      rkrecs.push(parse_RkRec(blob));\n    }\n\n    if (blob.l !== target) throw \"MulRK read error\";\n    var lastcol = blob.read_shift(2);\n    if (rkrecs.length != lastcol - col + 1) throw \"MulRK length mismatch\";\n    return {\n      r: rw,\n      c: col,\n      C: lastcol,\n      rkrec: rkrecs\n    };\n  }\n  /* 2.5.20 2.5.249 TODO */\n\n\n  function parse_CellStyleXF(blob, length, style) {\n    var o = {};\n    var a = blob.read_shift(4),\n        b = blob.read_shift(4);\n    var c = blob.read_shift(4),\n        d = blob.read_shift(2);\n    o.patternType = XLSFillPattern[c >> 26];\n    o.icvFore = d & 0x7F;\n    o.icvBack = d >> 7 & 0x7F;\n    return o;\n  }\n\n  function parse_CellXF(blob, length) {\n    return parse_CellStyleXF(blob, length, 0);\n  }\n\n  function parse_StyleXF(blob, length) {\n    return parse_CellStyleXF(blob, length, 1);\n  }\n  /* 2.4.353 TODO: actually do this right */\n\n\n  function parse_XF(blob, length) {\n    var o = {};\n    o.ifnt = blob.read_shift(2);\n    o.ifmt = blob.read_shift(2);\n    o.flags = blob.read_shift(2);\n    o.fStyle = o.flags >> 2 & 0x01;\n    length -= 6;\n    o.data = parse_CellStyleXF(blob, length, o.fStyle);\n    return o;\n  }\n  /* 2.4.134 */\n\n\n  function parse_Guts(blob, length) {\n    blob.l += 4;\n    var out = [blob.read_shift(2), blob.read_shift(2)];\n    if (out[0] !== 0) out[0]--;\n    if (out[1] !== 0) out[1]--;\n    if (out[0] > 7 || out[1] > 7) throw \"Bad Gutters: \" + out;\n    return out;\n  }\n  /* 2.4.24 */\n\n\n  function parse_BoolErr(blob, length) {\n    var cell = parse_XLSCell(blob, 6);\n    var val = parse_Bes(blob, 2);\n    cell.val = val;\n    cell.t = val === true || val === false ? 'b' : 'e';\n    return cell;\n  }\n  /* 2.4.180 Number */\n\n\n  function parse_Number(blob, length) {\n    var cell = parse_XLSCell(blob, 6);\n    var xnum = parse_Xnum(blob, 8);\n    cell.val = xnum;\n    return cell;\n  }\n\n  var parse_XLHeaderFooter = parse_OptXLUnicodeString; // TODO: parse 2.4.136\n\n  /* 2.4.271 */\n\n  function parse_SupBook(blob, length, opts) {\n    var end = blob.l + length;\n    var ctab = blob.read_shift(2);\n    var cch = blob.read_shift(2);\n    var virtPath;\n    if (cch >= 0x01 && cch <= 0xff) virtPath = parse_XLUnicodeStringNoCch(blob, cch);\n    var rgst = blob.read_shift(end - blob.l);\n    opts.sbcch = cch;\n    return [cch, ctab, virtPath, rgst];\n  }\n  /* 2.4.105 TODO */\n\n\n  function parse_ExternName(blob, length, opts) {\n    var flags = blob.read_shift(2);\n    var body;\n    var o = {\n      fBuiltIn: flags & 0x01,\n      fWantAdvise: flags >>> 1 & 0x01,\n      fWantPict: flags >>> 2 & 0x01,\n      fOle: flags >>> 3 & 0x01,\n      fOleLink: flags >>> 4 & 0x01,\n      cf: flags >>> 5 & 0x3FF,\n      fIcon: flags >>> 15 & 0x01\n    };\n    if (opts.sbcch === 0x3A01) body = parse_AddinUdf(blob, length - 2); //else throw new Error(\"unsupported SupBook cch: \" + opts.sbcch);\n\n    o.body = body || blob.read_shift(length - 2);\n    return o;\n  }\n  /* 2.4.150 TODO */\n\n\n  function parse_Lbl(blob, length, opts) {\n    if (opts.biff < 8) return parse_Label(blob, length, opts);\n    var target = blob.l + length;\n    var flags = blob.read_shift(2);\n    var chKey = blob.read_shift(1);\n    var cch = blob.read_shift(1);\n    var cce = blob.read_shift(2);\n    blob.l += 2;\n    var itab = blob.read_shift(2);\n    blob.l += 4;\n    var name = parse_XLUnicodeStringNoCch(blob, cch, opts);\n    var rgce = parse_NameParsedFormula(blob, target - blob.l, opts, cce);\n    return {\n      chKey: chKey,\n      Name: name,\n      rgce: rgce\n    };\n  }\n  /* 2.4.106 TODO: verify supbook manipulation */\n\n\n  function parse_ExternSheet(blob, length, opts) {\n    if (opts.biff < 8) return parse_ShortXLUnicodeString(blob, length, opts);\n    var o = parslurp2(blob, length, parse_XTI);\n    var oo = [];\n\n    if (opts.sbcch === 0x0401) {\n      for (var i = 0; i != o.length; ++i) {\n        oo.push(opts.snames[o[i][1]]);\n      }\n\n      return oo;\n    } else return o;\n  }\n  /* 2.4.260 */\n\n\n  function parse_ShrFmla(blob, length, opts) {\n    var ref = parse_RefU(blob, 6);\n    blob.l++;\n    var cUse = blob.read_shift(1);\n    length -= 8;\n    return [parse_SharedParsedFormula(blob, length, opts), cUse];\n  }\n  /* 2.4.4 TODO */\n\n\n  function parse_Array(blob, length, opts) {\n    var ref = parse_Ref(blob, 6);\n    blob.l += 6;\n    length -= 12;\n    /* TODO: fAlwaysCalc */\n\n    return [ref, parse_ArrayParsedFormula(blob, length, opts, ref)];\n  }\n  /* 2.4.173 */\n\n\n  function parse_MTRSettings(blob, length) {\n    var fMTREnabled = blob.read_shift(4) !== 0x00;\n    var fUserSetThreadCount = blob.read_shift(4) !== 0x00;\n    var cUserThreadCount = blob.read_shift(4);\n    return [fMTREnabled, fUserSetThreadCount, cUserThreadCount];\n  }\n  /* 2.5.186 TODO: BIFF5 */\n\n\n  function parse_NoteSh(blob, length, opts) {\n    if (opts.biff < 8) return;\n    var row = blob.read_shift(2),\n        col = blob.read_shift(2);\n    var flags = blob.read_shift(2),\n        idObj = blob.read_shift(2);\n    var stAuthor = parse_XLUnicodeString2(blob, 0, opts);\n    if (opts.biff < 8) blob.read_shift(1);\n    return [{\n      r: row,\n      c: col\n    }, stAuthor, idObj, flags];\n  }\n  /* 2.4.179 */\n\n\n  function parse_Note(blob, length, opts) {\n    /* TODO: Support revisions */\n    return parse_NoteSh(blob, length, opts);\n  }\n  /* 2.4.168 */\n\n\n  function parse_MergeCells(blob, length) {\n    var merges = [];\n    var cmcs = blob.read_shift(2);\n\n    while (cmcs--) {\n      merges.push(parse_Ref8U(blob, length));\n    }\n\n    return merges;\n  }\n  /* 2.4.181 TODO: parse all the things! */\n\n\n  function parse_Obj(blob, length) {\n    var cmo = parse_FtCmo(blob, 22); // id, ot, flags\n\n    var fts = parse_FtArray(blob, length - 22, cmo[1]);\n    return {\n      cmo: cmo,\n      ft: fts\n    };\n  }\n  /* 2.4.329 TODO: parse properly */\n\n\n  function parse_TxO(blob, length, opts) {\n    var s = blob.l;\n\n    try {\n      blob.l += 4;\n      var ot = (opts.lastobj || {\n        cmo: [0, 0]\n      }).cmo[1];\n      var controlInfo;\n      if ([0, 5, 7, 11, 12, 14].indexOf(ot) == -1) blob.l += 6;else controlInfo = parse_ControlInfo(blob, 6, opts);\n      var cchText = blob.read_shift(2);\n      var cbRuns = blob.read_shift(2);\n      var ifntEmpty = parse_FontIndex(blob, 2);\n      var len = blob.read_shift(2);\n      blob.l += len; //var fmla = parse_ObjFmla(blob, s + length - blob.l);\n\n      var texts = \"\";\n\n      for (var i = 1; i < blob.lens.length - 1; ++i) {\n        if (blob.l - s != blob.lens[i]) throw \"TxO: bad continue record\";\n        var hdr = blob[blob.l];\n        var t = parse_XLUnicodeStringNoCch(blob, blob.lens[i + 1] - blob.lens[i] - 1);\n        texts += t;\n        if (texts.length >= (hdr ? cchText : 2 * cchText)) break;\n      }\n\n      if (texts.length !== cchText && texts.length !== cchText * 2) {\n        throw \"cchText: \" + cchText + \" != \" + texts.length;\n      }\n\n      blob.l = s + length;\n      /* 2.5.272 TxORuns */\n      //\tvar rgTxoRuns = [];\n      //\tfor(var j = 0; j != cbRuns/8-1; ++j) blob.l += 8;\n      //\tvar cchText2 = blob.read_shift(2);\n      //\tif(cchText2 !== cchText) throw \"TxOLastRun mismatch: \" + cchText2 + \" \" + cchText;\n      //\tblob.l += 6;\n      //\tif(s + length != blob.l) throw \"TxO \" + (s + length) + \", at \" + blob.l;\n\n      return {\n        t: texts\n      };\n    } catch (e) {\n      blob.l = s + length;\n      return {\n        t: texts || \"\"\n      };\n    }\n  }\n  /* 2.4.140 */\n\n\n  var parse_HLink = function parse_HLink(blob, length) {\n    var ref = parse_Ref8U(blob, 8);\n    blob.l += 16;\n    /* CLSID */\n\n    var hlink = parse_Hyperlink(blob, length - 24);\n    return [ref, hlink];\n  };\n  /* 2.4.141 */\n\n\n  var parse_HLinkTooltip = function parse_HLinkTooltip(blob, length) {\n    var end = blob.l + length;\n    blob.read_shift(2);\n    var ref = parse_Ref8U(blob, 8);\n    var wzTooltip = blob.read_shift((length - 10) / 2, 'dbcs-cont');\n    wzTooltip = wzTooltip.replace(chr0, \"\");\n    return [ref, wzTooltip];\n  };\n  /* 2.4.63 */\n\n\n  function parse_Country(blob, length) {\n    var o = [],\n        d;\n    d = blob.read_shift(2);\n    o[0] = CountryEnum[d] || d;\n    d = blob.read_shift(2);\n    o[1] = CountryEnum[d] || d;\n    return o;\n  }\n  /* 2.4.50 ClrtClient */\n\n\n  function parse_ClrtClient(blob, length) {\n    var ccv = blob.read_shift(2);\n    var o = [];\n\n    while (ccv-- > 0) {\n      o.push(parse_LongRGB(blob, 8));\n    }\n\n    return o;\n  }\n  /* 2.4.188 */\n\n\n  function parse_Palette(blob, length) {\n    var ccv = blob.read_shift(2);\n    var o = [];\n\n    while (ccv-- > 0) {\n      o.push(parse_LongRGB(blob, 8));\n    }\n\n    return o;\n  }\n  /* 2.4.354 */\n\n\n  function parse_XFCRC(blob, length) {\n    blob.l += 2;\n    var o = {\n      cxfs: 0,\n      crc: 0\n    };\n    o.cxfs = blob.read_shift(2);\n    o.crc = blob.read_shift(4);\n    return o;\n  }\n\n  var parse_Style = parsenoop;\n  var parse_StyleExt = parsenoop;\n  var parse_ColInfo = parsenoop;\n  var parse_Window2 = parsenoop;\n  var parse_Backup = parsebool;\n  /* 2.4.14 */\n\n  var parse_Blank = parse_XLSCell;\n  /* 2.4.20 Just the cell */\n\n  var parse_BottomMargin = parse_Xnum;\n  /* 2.4.27 */\n\n  var parse_BuiltInFnGroupCount = parseuint16;\n  /* 2.4.30 0x0E or 0x10 but excel 2011 generates 0x11? */\n\n  var parse_CalcCount = parseuint16;\n  /* 2.4.31 #Iterations */\n\n  var parse_CalcDelta = parse_Xnum;\n  /* 2.4.32 */\n\n  var parse_CalcIter = parsebool;\n  /* 2.4.33 1=iterative calc */\n\n  var parse_CalcMode = parseuint16;\n  /* 2.4.34 0=manual, 1=auto (def), 2=table */\n\n  var parse_CalcPrecision = parsebool;\n  /* 2.4.35 */\n\n  var parse_CalcRefMode = parsenoop2;\n  /* 2.4.36 */\n\n  var parse_CalcSaveRecalc = parsebool;\n  /* 2.4.37 */\n\n  var parse_CodePage = parseuint16;\n  /* 2.4.52 */\n\n  var parse_Compat12 = parsebool;\n  /* 2.4.54 true = no compatibility check */\n\n  var parse_Date1904 = parsebool;\n  /* 2.4.77 - 1=1904,0=1900 */\n\n  var parse_DefColWidth = parseuint16;\n  /* 2.4.89 */\n\n  var parse_DSF = parsenoop2;\n  /* 2.4.94 -- MUST be ignored */\n\n  var parse_EntExU2 = parsenoop2;\n  /* 2.4.102 -- Explicitly says to ignore */\n\n  var parse_EOF = parsenoop2;\n  /* 2.4.103 */\n\n  var parse_Excel9File = parsenoop2;\n  /* 2.4.104 -- Optional and unused */\n\n  var parse_FeatHdr = parsenoop2;\n  /* 2.4.112 */\n\n  var parse_FontX = parseuint16;\n  /* 2.4.123 */\n\n  var parse_Footer = parse_XLHeaderFooter;\n  /* 2.4.124 */\n\n  var parse_GridSet = parseuint16;\n  /* 2.4.132, =1 */\n\n  var parse_HCenter = parsebool;\n  /* 2.4.135 sheet centered horizontal on print */\n\n  var parse_Header = parse_XLHeaderFooter;\n  /* 2.4.136 */\n\n  var parse_HideObj = parse_HideObjEnum;\n  /* 2.4.139 */\n\n  var parse_InterfaceEnd = parsenoop2;\n  /* 2.4.145 -- noop */\n\n  var parse_LeftMargin = parse_Xnum;\n  /* 2.4.151 */\n\n  var parse_Mms = parsenoop2;\n  /* 2.4.169 -- Explicitly says to ignore */\n\n  var parse_ObjProtect = parsebool;\n  /* 2.4.183 -- must be 1 if present */\n\n  var parse_Password = parseuint16;\n  /* 2.4.191 */\n\n  var parse_PrintGrid = parsebool;\n  /* 2.4.202 */\n\n  var parse_PrintRowCol = parsebool;\n  /* 2.4.203 */\n\n  var parse_PrintSize = parseuint16;\n  /* 2.4.204 0:3 */\n\n  var parse_Prot4Rev = parsebool;\n  /* 2.4.205 */\n\n  var parse_Prot4RevPass = parseuint16;\n  /* 2.4.206 */\n\n  var parse_Protect = parsebool;\n  /* 2.4.207 */\n\n  var parse_RefreshAll = parsebool;\n  /* 2.4.217 -- must be 0 if not template */\n\n  var parse_RightMargin = parse_Xnum;\n  /* 2.4.219 */\n\n  var parse_RRTabId = parseuint16a;\n  /* 2.4.241 */\n\n  var parse_ScenarioProtect = parsebool;\n  /* 2.4.245 */\n\n  var parse_Scl = parseuint16a;\n  /* 2.4.247 num, den */\n\n  var parse_String = parse_XLUnicodeString;\n  /* 2.4.268 */\n\n  var parse_SxBool = parsebool;\n  /* 2.4.274 */\n\n  var parse_TopMargin = parse_Xnum;\n  /* 2.4.328 */\n\n  var parse_UsesELFs = parsebool;\n  /* 2.4.337 -- should be 0 */\n\n  var parse_VCenter = parsebool;\n  /* 2.4.342 */\n\n  var parse_WinProtect = parsebool;\n  /* 2.4.347 */\n\n  var parse_WriteProtect = parsenoop;\n  /* 2.4.350 empty record */\n\n  /* ---- */\n\n  var parse_VerticalPageBreaks = parsenoop;\n  var parse_HorizontalPageBreaks = parsenoop;\n  var parse_Selection = parsenoop;\n  var parse_Continue = parsenoop;\n  var parse_Pane = parsenoop;\n  var parse_Pls = parsenoop;\n  var parse_DCon = parsenoop;\n  var parse_DConRef = parsenoop;\n  var parse_DConName = parsenoop;\n  var parse_XCT = parsenoop;\n  var parse_CRN = parsenoop;\n  var parse_FileSharing = parsenoop;\n  var parse_Uncalced = parsenoop;\n  var parse_Template = parsenoop;\n  var parse_Intl = parsenoop;\n  var parse_WsBool = parsenoop;\n  var parse_Sort = parsenoop;\n  var parse_Sync = parsenoop;\n  var parse_LPr = parsenoop;\n  var parse_DxGCol = parsenoop;\n  var parse_FnGroupName = parsenoop;\n  var parse_FilterMode = parsenoop;\n  var parse_AutoFilterInfo = parsenoop;\n  var parse_AutoFilter = parsenoop;\n  var parse_Setup = parsenoop;\n  var parse_ScenMan = parsenoop;\n  var parse_SCENARIO = parsenoop;\n  var parse_SxView = parsenoop;\n  var parse_Sxvd = parsenoop;\n  var parse_SXVI = parsenoop;\n  var parse_SxIvd = parsenoop;\n  var parse_SXLI = parsenoop;\n  var parse_SXPI = parsenoop;\n  var parse_DocRoute = parsenoop;\n  var parse_RecipName = parsenoop;\n  var parse_MulBlank = parsenoop;\n  var parse_SXDI = parsenoop;\n  var parse_SXDB = parsenoop;\n  var parse_SXFDB = parsenoop;\n  var parse_SXDBB = parsenoop;\n  var parse_SXNum = parsenoop;\n  var parse_SxErr = parsenoop;\n  var parse_SXInt = parsenoop;\n  var parse_SXString = parsenoop;\n  var parse_SXDtr = parsenoop;\n  var parse_SxNil = parsenoop;\n  var parse_SXTbl = parsenoop;\n  var parse_SXTBRGIITM = parsenoop;\n  var parse_SxTbpg = parsenoop;\n  var parse_ObProj = parsenoop;\n  var parse_SXStreamID = parsenoop;\n  var parse_DBCell = parsenoop;\n  var parse_SXRng = parsenoop;\n  var parse_SxIsxoper = parsenoop;\n  var parse_BookBool = parsenoop;\n  var parse_DbOrParamQry = parsenoop;\n  var parse_OleObjectSize = parsenoop;\n  var parse_SXVS = parsenoop;\n  var parse_BkHim = parsenoop;\n  var parse_MsoDrawingGroup = parsenoop;\n  var parse_MsoDrawing = parsenoop;\n  var parse_MsoDrawingSelection = parsenoop;\n  var parse_PhoneticInfo = parsenoop;\n  var parse_SxRule = parsenoop;\n  var parse_SXEx = parsenoop;\n  var parse_SxFilt = parsenoop;\n  var parse_SxDXF = parsenoop;\n  var parse_SxItm = parsenoop;\n  var parse_SxName = parsenoop;\n  var parse_SxSelect = parsenoop;\n  var parse_SXPair = parsenoop;\n  var parse_SxFmla = parsenoop;\n  var parse_SxFormat = parsenoop;\n  var parse_SXVDEx = parsenoop;\n  var parse_SXFormula = parsenoop;\n  var parse_SXDBEx = parsenoop;\n  var parse_RRDInsDel = parsenoop;\n  var parse_RRDHead = parsenoop;\n  var parse_RRDChgCell = parsenoop;\n  var parse_RRDRenSheet = parsenoop;\n  var parse_RRSort = parsenoop;\n  var parse_RRDMove = parsenoop;\n  var parse_RRFormat = parsenoop;\n  var parse_RRAutoFmt = parsenoop;\n  var parse_RRInsertSh = parsenoop;\n  var parse_RRDMoveBegin = parsenoop;\n  var parse_RRDMoveEnd = parsenoop;\n  var parse_RRDInsDelBegin = parsenoop;\n  var parse_RRDInsDelEnd = parsenoop;\n  var parse_RRDConflict = parsenoop;\n  var parse_RRDDefName = parsenoop;\n  var parse_RRDRstEtxp = parsenoop;\n  var parse_LRng = parsenoop;\n  var parse_CUsr = parsenoop;\n  var parse_CbUsr = parsenoop;\n  var parse_UsrInfo = parsenoop;\n  var parse_UsrExcl = parsenoop;\n  var parse_FileLock = parsenoop;\n  var parse_RRDInfo = parsenoop;\n  var parse_BCUsrs = parsenoop;\n  var parse_UsrChk = parsenoop;\n  var parse_UserBView = parsenoop;\n  var parse_UserSViewBegin = parsenoop; // overloaded\n\n  var parse_UserSViewEnd = parsenoop;\n  var parse_RRDUserView = parsenoop;\n  var parse_Qsi = parsenoop;\n  var parse_CondFmt = parsenoop;\n  var parse_CF = parsenoop;\n  var parse_DVal = parsenoop;\n  var parse_DConBin = parsenoop;\n  var parse_Lel = parsenoop;\n  var parse_XLSCodeName = parse_XLUnicodeString;\n  var parse_SXFDBType = parsenoop;\n  var parse_ObNoMacros = parsenoop;\n  var parse_Dv = parsenoop;\n  var parse_Index = parsenoop;\n  var parse_Table = parsenoop;\n  var parse_BigName = parsenoop;\n  var parse_ContinueBigName = parsenoop;\n  var parse_WebPub = parsenoop;\n  var parse_QsiSXTag = parsenoop;\n  var parse_DBQueryExt = parsenoop;\n  var parse_ExtString = parsenoop;\n  var parse_TxtQry = parsenoop;\n  var parse_Qsir = parsenoop;\n  var parse_Qsif = parsenoop;\n  var parse_RRDTQSIF = parsenoop;\n  var parse_OleDbConn = parsenoop;\n  var parse_WOpt = parsenoop;\n  var parse_SXViewEx = parsenoop;\n  var parse_SXTH = parsenoop;\n  var parse_SXPIEx = parsenoop;\n  var parse_SXVDTEx = parsenoop;\n  var parse_SXViewEx9 = parsenoop;\n  var parse_ContinueFrt = parsenoop;\n  var parse_RealTimeData = parsenoop;\n  var parse_ChartFrtInfo = parsenoop;\n  var parse_FrtWrapper = parsenoop;\n  var parse_StartBlock = parsenoop;\n  var parse_EndBlock = parsenoop;\n  var parse_StartObject = parsenoop;\n  var parse_EndObject = parsenoop;\n  var parse_CatLab = parsenoop;\n  var parse_YMult = parsenoop;\n  var parse_SXViewLink = parsenoop;\n  var parse_PivotChartBits = parsenoop;\n  var parse_FrtFontList = parsenoop;\n  var parse_SheetExt = parsenoop;\n  var parse_BookExt = parsenoop;\n  var parse_SXAddl = parsenoop;\n  var parse_CrErr = parsenoop;\n  var parse_HFPicture = parsenoop;\n  var parse_Feat = parsenoop;\n  var parse_DataLabExt = parsenoop;\n  var parse_DataLabExtContents = parsenoop;\n  var parse_CellWatch = parsenoop;\n  var parse_FeatHdr11 = parsenoop;\n  var parse_Feature11 = parsenoop;\n  var parse_DropDownObjIds = parsenoop;\n  var parse_ContinueFrt11 = parsenoop;\n  var parse_DConn = parsenoop;\n  var parse_List12 = parsenoop;\n  var parse_Feature12 = parsenoop;\n  var parse_CondFmt12 = parsenoop;\n  var parse_CF12 = parsenoop;\n  var parse_CFEx = parsenoop;\n  var parse_AutoFilter12 = parsenoop;\n  var parse_ContinueFrt12 = parsenoop;\n  var parse_MDTInfo = parsenoop;\n  var parse_MDXStr = parsenoop;\n  var parse_MDXTuple = parsenoop;\n  var parse_MDXSet = parsenoop;\n  var parse_MDXProp = parsenoop;\n  var parse_MDXKPI = parsenoop;\n  var parse_MDB = parsenoop;\n  var parse_PLV = parsenoop;\n  var parse_DXF = parsenoop;\n  var parse_TableStyles = parsenoop;\n  var parse_TableStyle = parsenoop;\n  var parse_TableStyleElement = parsenoop;\n  var parse_NamePublish = parsenoop;\n  var parse_NameCmt = parsenoop;\n  var parse_SortData = parsenoop;\n  var parse_GUIDTypeLib = parsenoop;\n  var parse_FnGrp12 = parsenoop;\n  var parse_NameFnGrp12 = parsenoop;\n  var parse_HeaderFooter = parsenoop;\n  var parse_CrtLayout12 = parsenoop;\n  var parse_CrtMlFrt = parsenoop;\n  var parse_CrtMlFrtContinue = parsenoop;\n  var parse_ShapePropsStream = parsenoop;\n  var parse_TextPropsStream = parsenoop;\n  var parse_RichTextStream = parsenoop;\n  var parse_CrtLayout12A = parsenoop;\n  var parse_Units = parsenoop;\n  var parse_Chart = parsenoop;\n  var parse_Series = parsenoop;\n  var parse_DataFormat = parsenoop;\n  var parse_LineFormat = parsenoop;\n  var parse_MarkerFormat = parsenoop;\n  var parse_AreaFormat = parsenoop;\n  var parse_PieFormat = parsenoop;\n  var parse_AttachedLabel = parsenoop;\n  var parse_SeriesText = parsenoop;\n  var parse_ChartFormat = parsenoop;\n  var parse_Legend = parsenoop;\n  var parse_SeriesList = parsenoop;\n  var parse_Bar = parsenoop;\n  var parse_Line = parsenoop;\n  var parse_Pie = parsenoop;\n  var parse_Area = parsenoop;\n  var parse_Scatter = parsenoop;\n  var parse_CrtLine = parsenoop;\n  var parse_Axis = parsenoop;\n  var parse_Tick = parsenoop;\n  var parse_ValueRange = parsenoop;\n  var parse_CatSerRange = parsenoop;\n  var parse_AxisLine = parsenoop;\n  var parse_CrtLink = parsenoop;\n  var parse_DefaultText = parsenoop;\n  var parse_Text = parsenoop;\n  var parse_ObjectLink = parsenoop;\n  var parse_Frame = parsenoop;\n  var parse_Begin = parsenoop;\n  var parse_End = parsenoop;\n  var parse_PlotArea = parsenoop;\n  var parse_Chart3d = parsenoop;\n  var parse_PicF = parsenoop;\n  var parse_DropBar = parsenoop;\n  var parse_Radar = parsenoop;\n  var parse_Surf = parsenoop;\n  var parse_RadarArea = parsenoop;\n  var parse_AxisParent = parsenoop;\n  var parse_LegendException = parsenoop;\n  var parse_ShtProps = parsenoop;\n  var parse_SerToCrt = parsenoop;\n  var parse_AxesUsed = parsenoop;\n  var parse_SBaseRef = parsenoop;\n  var parse_SerParent = parsenoop;\n  var parse_SerAuxTrend = parsenoop;\n  var parse_IFmtRecord = parsenoop;\n  var parse_Pos = parsenoop;\n  var parse_AlRuns = parsenoop;\n  var parse_BRAI = parsenoop;\n  var parse_SerAuxErrBar = parsenoop;\n  var parse_SerFmt = parsenoop;\n  var parse_Chart3DBarShape = parsenoop;\n  var parse_Fbi = parsenoop;\n  var parse_BopPop = parsenoop;\n  var parse_AxcExt = parsenoop;\n  var parse_Dat = parsenoop;\n  var parse_PlotGrowth = parsenoop;\n  var parse_SIIndex = parsenoop;\n  var parse_GelFrame = parsenoop;\n  var parse_BopPopCustom = parsenoop;\n  var parse_Fbi2 = parsenoop;\n  /* --- Specific to versions before BIFF8 --- */\n\n  function parse_BIFF5String(blob) {\n    var len = blob.read_shift(1);\n    return blob.read_shift(len, 'sbcs-cont');\n  }\n  /* BIFF2_??? where ??? is the name from [XLS] */\n\n\n  function parse_BIFF2STR(blob, length, opts) {\n    var cell = parse_XLSCell(blob, 6);\n    ++blob.l;\n    var str = parse_XLUnicodeString2(blob, length - 7, opts);\n    cell.val = str;\n    return cell;\n  }\n\n  function parse_BIFF2NUM(blob, length, opts) {\n    var cell = parse_XLSCell(blob, 6);\n    ++blob.l;\n    var num = parse_Xnum(blob, 8);\n    cell.val = num;\n    return cell;\n  }\n  /* 18.4.1 charset to codepage mapping */\n\n\n  var CS2CP = {\n    0: 1252,\n\n    /* ANSI */\n    1: 65001,\n\n    /* DEFAULT */\n    2: 65001,\n\n    /* SYMBOL */\n    77: 10000,\n\n    /* MAC */\n    128: 932,\n\n    /* SHIFTJIS */\n    129: 949,\n\n    /* HANGUL */\n    130: 1361,\n\n    /* JOHAB */\n    134: 936,\n\n    /* GB2312 */\n    136: 950,\n\n    /* CHINESEBIG5 */\n    161: 1253,\n\n    /* GREEK */\n    162: 1254,\n\n    /* TURKISH */\n    163: 1258,\n\n    /* VIETNAMESE */\n    177: 1255,\n\n    /* HEBREW */\n    178: 1256,\n\n    /* ARABIC */\n    186: 1257,\n\n    /* BALTIC */\n    204: 1251,\n\n    /* RUSSIAN */\n    222: 874,\n\n    /* THAI */\n    238: 1250,\n\n    /* EASTEUROPE */\n    255: 1252,\n\n    /* OEM */\n    69: 6969\n    /* MISC */\n\n  };\n  /* Parse a list of <r> tags */\n\n  var parse_rs = function parse_rs_factory() {\n    var tregex = matchtag(\"t\"),\n        rpregex = matchtag(\"rPr\"),\n        rregex = /<r>/g,\n        rend = /<\\/r>/,\n        nlregex = /\\r\\n/g;\n    /* 18.4.7 rPr CT_RPrElt */\n\n    var parse_rpr = function parse_rpr(rpr, intro, outro) {\n      var font = {},\n          cp = 65001;\n      var m = rpr.match(tagregex),\n          i = 0;\n      if (m) for (; i != m.length; ++i) {\n        var y = parsexmltag(m[i]);\n\n        switch (y[0]) {\n          /* 18.8.12 condense CT_BooleanProperty */\n\n          /* ** not required . */\n          case '<condense':\n            break;\n\n          /* 18.8.17 extend CT_BooleanProperty */\n\n          /* ** not required . */\n\n          case '<extend':\n            break;\n\n          /* 18.8.36 shadow CT_BooleanProperty */\n\n          /* ** not required . */\n\n          case '<shadow':\n          /* falls through */\n\n          case '<shadow/>':\n            break;\n\n          /* 18.4.1 charset CT_IntProperty TODO */\n\n          case '<charset':\n            if (y.val == '1') break;\n            cp = CS2CP[parseInt(y.val, 10)];\n            break;\n\n          /* 18.4.2 outline CT_BooleanProperty TODO */\n\n          case '<outline':\n          /* falls through */\n\n          case '<outline/>':\n            break;\n\n          /* 18.4.5 rFont CT_FontName */\n\n          case '<rFont':\n            font.name = y.val;\n            break;\n\n          /* 18.4.11 sz CT_FontSize */\n\n          case '<sz':\n            font.sz = y.val;\n            break;\n\n          /* 18.4.10 strike CT_BooleanProperty */\n\n          case '<strike':\n            if (!y.val) break;\n\n          /* falls through */\n\n          case '<strike/>':\n            font.strike = 1;\n            break;\n\n          case '</strike>':\n            break;\n\n          /* 18.4.13 u CT_UnderlineProperty */\n\n          case '<u':\n            if (!y.val) break;\n\n          /* falls through */\n\n          case '<u/>':\n            font.u = 1;\n            break;\n\n          case '</u>':\n            break;\n\n          /* 18.8.2 b */\n\n          case '<b':\n            if (!y.val) break;\n\n          /* falls through */\n\n          case '<b/>':\n            font.b = 1;\n            break;\n\n          case '</b>':\n            break;\n\n          /* 18.8.26 i */\n\n          case '<i':\n            if (!y.val) break;\n\n          /* falls through */\n\n          case '<i/>':\n            font.i = 1;\n            break;\n\n          case '</i>':\n            break;\n\n          /* 18.3.1.15 color CT_Color TODO: tint, theme, auto, indexed */\n\n          case '<color':\n            if (y.rgb) font.color = y.rgb.substr(2, 6);\n            break;\n\n          /* 18.8.18 family ST_FontFamily */\n\n          case '<family':\n            font.family = y.val;\n            break;\n\n          /* 18.4.14 vertAlign CT_VerticalAlignFontProperty TODO */\n\n          case '<vertAlign':\n            break;\n\n          /* 18.8.35 scheme CT_FontScheme TODO */\n\n          case '<scheme':\n            break;\n\n          default:\n            if (y[0].charCodeAt(1) !== 47) throw 'Unrecognized rich format ' + y[0];\n        }\n      }\n      /* TODO: These should be generated styles, not inline */\n\n      var style = [];\n      if (font.b) style.push(\"font-weight: bold;\");\n      if (font.i) style.push(\"font-style: italic;\");\n      intro.push('<span style=\"' + style.join(\"\") + '\">');\n      outro.push(\"</span>\");\n      return cp;\n    };\n    /* 18.4.4 r CT_RElt */\n\n\n    function parse_r(r) {\n      var terms = [[], \"\", []];\n      /* 18.4.12 t ST_Xstring */\n\n      var t = r.match(tregex),\n          cp = 65001;\n      if (!isval(t)) return \"\";\n      terms[1] = t[1];\n      var rpr = r.match(rpregex);\n      if (isval(rpr)) cp = parse_rpr(rpr[1], terms[0], terms[2]);\n      return terms[0].join(\"\") + terms[1].replace(nlregex, '<br/>') + terms[2].join(\"\");\n    }\n\n    return function parse_rs(rs) {\n      return rs.replace(rregex, \"\").split(rend).map(parse_r).join(\"\");\n    };\n  }();\n  /* 18.4.8 si CT_Rst */\n\n\n  var sitregex = /<t[^>]*>([^<]*)<\\/t>/g,\n      sirregex = /<r>/;\n\n  function parse_si(x, opts) {\n    var html = opts ? opts.cellHTML : true;\n    var z = {};\n    if (!x) return null;\n    var y;\n    /* 18.4.12 t ST_Xstring (Plaintext String) */\n\n    if (x.charCodeAt(1) === 116) {\n      z.t = utf8read(unescapexml(x.substr(x.indexOf(\">\") + 1).split(/<\\/t>/)[0]));\n      z.r = x;\n      if (html) z.h = z.t;\n    }\n    /* 18.4.4 r CT_RElt (Rich Text Run) */\n    else if (y = x.match(sirregex)) {\n        z.r = x;\n        z.t = utf8read(unescapexml(x.match(sitregex).join(\"\").replace(tagregex, \"\")));\n        if (html) z.h = parse_rs(x);\n      }\n    /* 18.4.3 phoneticPr CT_PhoneticPr (TODO: needed for Asian support) */\n\n    /* 18.4.6 rPh CT_PhoneticRun (TODO: needed for Asian support) */\n\n\n    return z;\n  }\n  /* 18.4 Shared String Table */\n\n\n  var sstr0 = /<sst([^>]*)>([\\s\\S]*)<\\/sst>/;\n  var sstr1 = /<(?:si|sstItem)>/g;\n  var sstr2 = /<\\/(?:si|sstItem)>/;\n\n  function parse_sst_xml(data, opts) {\n    var s = [],\n        ss;\n    /* 18.4.9 sst CT_Sst */\n\n    var sst = data.match(sstr0);\n\n    if (isval(sst)) {\n      ss = sst[2].replace(sstr1, \"\").split(sstr2);\n\n      for (var i = 0; i != ss.length; ++i) {\n        var o = parse_si(ss[i], opts);\n        if (o != null) s[s.length] = o;\n      }\n\n      sst = parsexmltag(sst[1]);\n      s.Count = sst.count;\n      s.Unique = sst.uniqueCount;\n    }\n\n    return s;\n  }\n\n  RELS.SST = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings\";\n  var straywsregex = /^\\s|\\s$|[\\t\\n\\r]/;\n\n  function write_sst_xml(sst, opts) {\n    if (!opts.bookSST) return \"\";\n    var o = [XML_HEADER];\n    o[o.length] = writextag('sst', null, {\n      xmlns: XMLNS.main[0],\n      count: sst.Count,\n      uniqueCount: sst.Unique\n    });\n\n    for (var i = 0; i != sst.length; ++i) {\n      if (sst[i] == null) continue;\n      var s = sst[i];\n      var sitag = \"<si>\";\n      if (s.r) sitag += s.r;else {\n        sitag += \"<t\";\n        if (s.t.match(straywsregex)) sitag += ' xml:space=\"preserve\"';\n        sitag += \">\" + escapexml(s.t) + \"</t>\";\n      }\n      sitag += \"</si>\";\n      o[o.length] = sitag;\n    }\n\n    if (o.length > 2) {\n      o[o.length] = '</sst>';\n      o[1] = o[1].replace(\"/>\", \">\");\n    }\n\n    return o.join(\"\");\n  }\n  /* [MS-XLSB] 2.4.219 BrtBeginSst */\n\n\n  function parse_BrtBeginSst(data, length) {\n    return [data.read_shift(4), data.read_shift(4)];\n  }\n  /* [MS-XLSB] 2.1.7.45 Shared Strings */\n\n\n  function parse_sst_bin(data, opts) {\n    var s = [];\n    var pass = false;\n    recordhopper(data, function hopper_sst(val, R, RT) {\n      switch (R.n) {\n        case 'BrtBeginSst':\n          s.Count = val[0];\n          s.Unique = val[1];\n          break;\n\n        case 'BrtSSTItem':\n          s.push(val);\n          break;\n\n        case 'BrtEndSst':\n          return true;\n\n        /* TODO: produce a test case with a future record */\n\n        case 'BrtFRTBegin':\n          pass = true;\n          break;\n\n        case 'BrtFRTEnd':\n          pass = false;\n          break;\n\n        default:\n          if (!pass || opts.WTF) throw new Error(\"Unexpected record \" + RT + \" \" + R.n);\n      }\n    });\n    return s;\n  }\n\n  function write_BrtBeginSst(sst, o) {\n    if (!o) o = new_buf(8);\n    o.write_shift(4, sst.Count);\n    o.write_shift(4, sst.Unique);\n    return o;\n  }\n\n  var write_BrtSSTItem = write_RichStr;\n\n  function write_sst_bin(sst, opts) {\n    var ba = buf_array();\n    write_record(ba, \"BrtBeginSst\", write_BrtBeginSst(sst));\n\n    for (var i = 0; i < sst.length; ++i) {\n      write_record(ba, \"BrtSSTItem\", write_BrtSSTItem(sst[i]));\n    }\n\n    write_record(ba, \"BrtEndSst\");\n    return ba.end();\n  }\n\n  function _JS2ANSI(str) {\n    if (typeof cptable !== 'undefined') return cptable.utils.encode(1252, str);\n    return str.split(\"\").map(function (x) {\n      return x.charCodeAt(0);\n    });\n  }\n  /* [MS-OFFCRYPTO] 2.1.4 Version */\n\n\n  function parse_Version(blob, length) {\n    var o = {};\n    o.Major = blob.read_shift(2);\n    o.Minor = blob.read_shift(2);\n    return o;\n  }\n  /* [MS-OFFCRYPTO] 2.3.2 Encryption Header */\n\n\n  function parse_EncryptionHeader(blob, length) {\n    var o = {};\n    o.Flags = blob.read_shift(4); // Check if SizeExtra is 0x00000000\n\n    var tmp = blob.read_shift(4);\n    if (tmp !== 0) throw 'Unrecognized SizeExtra: ' + tmp;\n    o.AlgID = blob.read_shift(4);\n\n    switch (o.AlgID) {\n      case 0:\n      case 0x6801:\n      case 0x660E:\n      case 0x660F:\n      case 0x6610:\n        break;\n\n      default:\n        throw 'Unrecognized encryption algorithm: ' + o.AlgID;\n    }\n\n    parsenoop(blob, length - 12);\n    return o;\n  }\n  /* [MS-OFFCRYPTO] 2.3.3 Encryption Verifier */\n\n\n  function parse_EncryptionVerifier(blob, length) {\n    return parsenoop(blob, length);\n  }\n  /* [MS-OFFCRYPTO] 2.3.5.1 RC4 CryptoAPI Encryption Header */\n\n\n  function parse_RC4CryptoHeader(blob, length) {\n    var o = {};\n    var vers = o.EncryptionVersionInfo = parse_Version(blob, 4);\n    length -= 4;\n    if (vers.Minor != 2) throw 'unrecognized minor version code: ' + vers.Minor;\n    if (vers.Major > 4 || vers.Major < 2) throw 'unrecognized major version code: ' + vers.Major;\n    o.Flags = blob.read_shift(4);\n    length -= 4;\n    var sz = blob.read_shift(4);\n    length -= 4;\n    o.EncryptionHeader = parse_EncryptionHeader(blob, sz);\n    length -= sz;\n    o.EncryptionVerifier = parse_EncryptionVerifier(blob, length);\n    return o;\n  }\n  /* [MS-OFFCRYPTO] 2.3.6.1 RC4 Encryption Header */\n\n\n  function parse_RC4Header(blob, length) {\n    var o = {};\n    var vers = o.EncryptionVersionInfo = parse_Version(blob, 4);\n    length -= 4;\n    if (vers.Major != 1 || vers.Minor != 1) throw 'unrecognized version code ' + vers.Major + ' : ' + vers.Minor;\n    o.Salt = blob.read_shift(16);\n    o.EncryptedVerifier = blob.read_shift(16);\n    o.EncryptedVerifierHash = blob.read_shift(16);\n    return o;\n  }\n  /* [MS-OFFCRYPTO] 2.3.7.1 Binary Document Password Verifier Derivation */\n\n\n  function crypto_CreatePasswordVerifier_Method1(Password) {\n    var Verifier = 0x0000,\n        PasswordArray;\n\n    var PasswordDecoded = _JS2ANSI(Password);\n\n    var len = PasswordDecoded.length + 1,\n        i,\n        PasswordByte;\n    var Intermediate1, Intermediate2, Intermediate3;\n    PasswordArray = new_raw_buf(len);\n    PasswordArray[0] = PasswordDecoded.length;\n\n    for (i = 1; i != len; ++i) {\n      PasswordArray[i] = PasswordDecoded[i - 1];\n    }\n\n    for (i = len - 1; i >= 0; --i) {\n      PasswordByte = PasswordArray[i];\n      Intermediate1 = (Verifier & 0x4000) === 0x0000 ? 0 : 1;\n      Intermediate2 = Verifier << 1 & 0x7FFF;\n      Intermediate3 = Intermediate1 | Intermediate2;\n      Verifier = Intermediate3 ^ PasswordByte;\n    }\n\n    return Verifier ^ 0xCE4B;\n  }\n  /* [MS-OFFCRYPTO] 2.3.7.2 Binary Document XOR Array Initialization */\n\n\n  var crypto_CreateXorArray_Method1 = function () {\n    var PadArray = [0xBB, 0xFF, 0xFF, 0xBA, 0xFF, 0xFF, 0xB9, 0x80, 0x00, 0xBE, 0x0F, 0x00, 0xBF, 0x0F, 0x00];\n    var InitialCode = [0xE1F0, 0x1D0F, 0xCC9C, 0x84C0, 0x110C, 0x0E10, 0xF1CE, 0x313E, 0x1872, 0xE139, 0xD40F, 0x84F9, 0x280C, 0xA96A, 0x4EC3];\n    var XorMatrix = [0xAEFC, 0x4DD9, 0x9BB2, 0x2745, 0x4E8A, 0x9D14, 0x2A09, 0x7B61, 0xF6C2, 0xFDA5, 0xEB6B, 0xC6F7, 0x9DCF, 0x2BBF, 0x4563, 0x8AC6, 0x05AD, 0x0B5A, 0x16B4, 0x2D68, 0x5AD0, 0x0375, 0x06EA, 0x0DD4, 0x1BA8, 0x3750, 0x6EA0, 0xDD40, 0xD849, 0xA0B3, 0x5147, 0xA28E, 0x553D, 0xAA7A, 0x44D5, 0x6F45, 0xDE8A, 0xAD35, 0x4A4B, 0x9496, 0x390D, 0x721A, 0xEB23, 0xC667, 0x9CEF, 0x29FF, 0x53FE, 0xA7FC, 0x5FD9, 0x47D3, 0x8FA6, 0x0F6D, 0x1EDA, 0x3DB4, 0x7B68, 0xF6D0, 0xB861, 0x60E3, 0xC1C6, 0x93AD, 0x377B, 0x6EF6, 0xDDEC, 0x45A0, 0x8B40, 0x06A1, 0x0D42, 0x1A84, 0x3508, 0x6A10, 0xAA51, 0x4483, 0x8906, 0x022D, 0x045A, 0x08B4, 0x1168, 0x76B4, 0xED68, 0xCAF1, 0x85C3, 0x1BA7, 0x374E, 0x6E9C, 0x3730, 0x6E60, 0xDCC0, 0xA9A1, 0x4363, 0x86C6, 0x1DAD, 0x3331, 0x6662, 0xCCC4, 0x89A9, 0x0373, 0x06E6, 0x0DCC, 0x1021, 0x2042, 0x4084, 0x8108, 0x1231, 0x2462, 0x48C4];\n\n    var Ror = function Ror(Byte) {\n      return (Byte / 2 | Byte * 128) & 0xFF;\n    };\n\n    var XorRor = function XorRor(byte1, byte2) {\n      return Ror(byte1 ^ byte2);\n    };\n\n    var CreateXorKey_Method1 = function CreateXorKey_Method1(Password) {\n      var XorKey = InitialCode[Password.length - 1];\n      var CurrentElement = 0x68;\n\n      for (var i = Password.length - 1; i >= 0; --i) {\n        var Char = Password[i];\n\n        for (var j = 0; j != 7; ++j) {\n          if (Char & 0x40) XorKey ^= XorMatrix[CurrentElement];\n          Char *= 2;\n          --CurrentElement;\n        }\n      }\n\n      return XorKey;\n    };\n\n    return function (password) {\n      var Password = _JS2ANSI(password);\n\n      var XorKey = CreateXorKey_Method1(Password);\n      var Index = Password.length;\n      var ObfuscationArray = new_raw_buf(16);\n\n      for (var i = 0; i != 16; ++i) {\n        ObfuscationArray[i] = 0x00;\n      }\n\n      var Temp, PasswordLastChar, PadIndex;\n\n      if ((Index & 1) === 1) {\n        Temp = XorKey >> 8;\n        ObfuscationArray[Index] = XorRor(PadArray[0], Temp);\n        --Index;\n        Temp = XorKey & 0xFF;\n        PasswordLastChar = Password[Password.length - 1];\n        ObfuscationArray[Index] = XorRor(PasswordLastChar, Temp);\n      }\n\n      while (Index > 0) {\n        --Index;\n        Temp = XorKey >> 8;\n        ObfuscationArray[Index] = XorRor(Password[Index], Temp);\n        --Index;\n        Temp = XorKey & 0xFF;\n        ObfuscationArray[Index] = XorRor(Password[Index], Temp);\n      }\n\n      Index = 15;\n      PadIndex = 15 - Password.length;\n\n      while (PadIndex > 0) {\n        Temp = XorKey >> 8;\n        ObfuscationArray[Index] = XorRor(PadArray[PadIndex], Temp);\n        --Index;\n        --PadIndex;\n        Temp = XorKey & 0xFF;\n        ObfuscationArray[Index] = XorRor(Password[Index], Temp);\n        --Index;\n        --PadIndex;\n      }\n\n      return ObfuscationArray;\n    };\n  }();\n  /* [MS-OFFCRYPTO] 2.3.7.3 Binary Document XOR Data Transformation Method 1 */\n\n\n  var crypto_DecryptData_Method1 = function crypto_DecryptData_Method1(password, Data, XorArrayIndex, XorArray, O) {\n    /* If XorArray is set, use it; if O is not set, make changes in-place */\n    if (!O) O = Data;\n    if (!XorArray) XorArray = crypto_CreateXorArray_Method1(password);\n    var Index, Value;\n\n    for (Index = 0; Index != Data.length; ++Index) {\n      Value = Data[Index];\n      Value ^= XorArray[XorArrayIndex];\n      Value = (Value >> 5 | Value << 3) & 0xFF;\n      O[Index] = Value;\n      ++XorArrayIndex;\n    }\n\n    return [O, XorArrayIndex, XorArray];\n  };\n\n  var crypto_MakeXorDecryptor = function crypto_MakeXorDecryptor(password) {\n    var XorArrayIndex = 0,\n        XorArray = crypto_CreateXorArray_Method1(password);\n    return function (Data) {\n      var O = crypto_DecryptData_Method1(null, Data, XorArrayIndex, XorArray);\n      XorArrayIndex = O[1];\n      return O[0];\n    };\n  };\n  /* 2.5.343 */\n\n\n  function parse_XORObfuscation(blob, length, opts, out) {\n    var o = {\n      key: parseuint16(blob),\n      verificationBytes: parseuint16(blob)\n    };\n    if (opts.password) o.verifier = crypto_CreatePasswordVerifier_Method1(opts.password);\n    out.valid = o.verificationBytes === o.verifier;\n    if (out.valid) out.insitu_decrypt = crypto_MakeXorDecryptor(opts.password);\n    return o;\n  }\n  /* 2.4.117 */\n\n\n  function parse_FilePassHeader(blob, length, oo) {\n    var o = oo || {};\n    o.Info = blob.read_shift(2);\n    blob.l -= 2;\n    if (o.Info === 1) o.Data = parse_RC4Header(blob, length);else o.Data = parse_RC4CryptoHeader(blob, length);\n    return o;\n  }\n\n  function parse_FilePass(blob, length, opts) {\n    var o = {\n      Type: blob.read_shift(2)\n    };\n    /* wEncryptionType */\n\n    if (o.Type) parse_FilePassHeader(blob, length - 2, o);else parse_XORObfuscation(blob, length - 2, opts, o);\n    return o;\n  }\n\n  function hex2RGB(h) {\n    var o = h.substr(h[0] === \"#\" ? 1 : 0, 6);\n    return [parseInt(o.substr(0, 2), 16), parseInt(o.substr(2, 2), 16), parseInt(o.substr(4, 2), 16)];\n  }\n\n  function rgb2Hex(rgb) {\n    for (var i = 0, o = 1; i != 3; ++i) {\n      o = o * 256 + (rgb[i] > 255 ? 255 : rgb[i] < 0 ? 0 : rgb[i]);\n    }\n\n    return o.toString(16).toUpperCase().substr(1);\n  }\n\n  function rgb2HSL(rgb) {\n    var R = rgb[0] / 255,\n        G = rgb[1] / 255,\n        B = rgb[2] / 255;\n    var M = Math.max(R, G, B),\n        m = Math.min(R, G, B),\n        C = M - m;\n    if (C === 0) return [0, 0, R];\n    var H6 = 0,\n        S = 0,\n        L2 = M + m;\n    S = C / (L2 > 1 ? 2 - L2 : L2);\n\n    switch (M) {\n      case R:\n        H6 = ((G - B) / C + 6) % 6;\n        break;\n\n      case G:\n        H6 = (B - R) / C + 2;\n        break;\n\n      case B:\n        H6 = (R - G) / C + 4;\n        break;\n    }\n\n    return [H6 / 6, S, L2 / 2];\n  }\n\n  function hsl2RGB(hsl) {\n    var H = hsl[0],\n        S = hsl[1],\n        L = hsl[2];\n    var C = S * 2 * (L < 0.5 ? L : 1 - L),\n        m = L - C / 2;\n    var rgb = [m, m, m],\n        h6 = 6 * H;\n    var X;\n    if (S !== 0) switch (h6 | 0) {\n      case 0:\n      case 6:\n        X = C * h6;\n        rgb[0] += C;\n        rgb[1] += X;\n        break;\n\n      case 1:\n        X = C * (2 - h6);\n        rgb[0] += X;\n        rgb[1] += C;\n        break;\n\n      case 2:\n        X = C * (h6 - 2);\n        rgb[1] += C;\n        rgb[2] += X;\n        break;\n\n      case 3:\n        X = C * (4 - h6);\n        rgb[1] += X;\n        rgb[2] += C;\n        break;\n\n      case 4:\n        X = C * (h6 - 4);\n        rgb[2] += C;\n        rgb[0] += X;\n        break;\n\n      case 5:\n        X = C * (6 - h6);\n        rgb[2] += X;\n        rgb[0] += C;\n        break;\n    }\n\n    for (var i = 0; i != 3; ++i) {\n      rgb[i] = Math.round(rgb[i] * 255);\n    }\n\n    return rgb;\n  }\n  /* 18.8.3 bgColor tint algorithm */\n\n\n  function rgb_tint(hex, tint) {\n    if (tint == 0) return hex;\n    var hsl = rgb2HSL(hex2RGB(hex));\n    if (tint < 0) hsl[2] = hsl[2] * (1 + tint);else hsl[2] = 1 - (1 - hsl[2]) * (1 - tint);\n    var rev = rgb2Hex(hsl2RGB(hsl));\n    return rev;\n  }\n  /* 18.3.1.13 width calculations */\n\n\n  var DEF_MDW = 7,\n      MAX_MDW = 15,\n      MIN_MDW = 1,\n      MDW = DEF_MDW;\n\n  function width2px(width) {\n    return (width + (128 / MDW | 0) / 256) * MDW | 0;\n  }\n\n  function px2char(px) {\n    return ((px - 5) / MDW * 100 + 0.5 | 0) / 100;\n  }\n\n  function char2width(chr) {\n    return ((chr * MDW + 5) / MDW * 256 | 0) / 256;\n  }\n\n  function cycle_width(collw) {\n    return char2width(px2char(width2px(collw)));\n  }\n\n  function find_mdw(collw, coll) {\n    if (cycle_width(collw) != collw) {\n      for (MDW = DEF_MDW; MDW > MIN_MDW; --MDW) {\n        if (cycle_width(collw) === collw) break;\n      }\n\n      if (MDW === MIN_MDW) for (MDW = DEF_MDW + 1; MDW < MAX_MDW; ++MDW) {\n        if (cycle_width(collw) === collw) break;\n      }\n      if (MDW === MAX_MDW) MDW = DEF_MDW;\n    }\n  }\n  /* [MS-EXSPXML3] 2.4.54 ST_enmPattern */\n\n\n  var XLMLPatternTypeMap = {\n    \"None\": \"none\",\n    \"Solid\": \"solid\",\n    \"Gray50\": \"mediumGray\",\n    \"Gray75\": \"darkGray\",\n    \"Gray25\": \"lightGray\",\n    \"HorzStripe\": \"darkHorizontal\",\n    \"VertStripe\": \"darkVertical\",\n    \"ReverseDiagStripe\": \"darkDown\",\n    \"DiagStripe\": \"darkUp\",\n    \"DiagCross\": \"darkGrid\",\n    \"ThickDiagCross\": \"darkTrellis\",\n    \"ThinHorzStripe\": \"lightHorizontal\",\n    \"ThinVertStripe\": \"lightVertical\",\n    \"ThinReverseDiagStripe\": \"lightDown\",\n    \"ThinHorzCross\": \"lightGrid\"\n  };\n  var styles = {}; // shared styles\n\n  var themes = {}; // shared themes\n\n  /* 18.8.21 fills CT_Fills */\n\n  function parse_fills(t, opts) {\n    styles.Fills = [];\n    var fill = {};\n    t[0].match(tagregex).forEach(function (x) {\n      var y = parsexmltag(x);\n\n      switch (y[0]) {\n        case '<fills':\n        case '<fills>':\n        case '</fills>':\n          break;\n\n        /* 18.8.20 fill CT_Fill */\n\n        case '<fill>':\n          break;\n\n        case '</fill>':\n          styles.Fills.push(fill);\n          fill = {};\n          break;\n\n        /* 18.8.32 patternFill CT_PatternFill */\n\n        case '<patternFill':\n          if (y.patternType) fill.patternType = y.patternType;\n          break;\n\n        case '<patternFill/>':\n        case '</patternFill>':\n          break;\n\n        /* 18.8.3 bgColor CT_Color */\n\n        case '<bgColor':\n          if (!fill.bgColor) fill.bgColor = {};\n          if (y.indexed) fill.bgColor.indexed = parseInt(y.indexed, 10);\n          if (y.theme) fill.bgColor.theme = parseInt(y.theme, 10);\n          if (y.tint) fill.bgColor.tint = parseFloat(y.tint);\n\n          if (y.theme && themes.themeElements && themes.themeElements.clrScheme) {\n            fill.bgColor.rgb = rgb_tint(themes.themeElements.clrScheme[fill.bgColor.theme].rgb, fill.bgColor.tint || 0);\n            if (opts.WTF) fill.bgColor.raw_rgb = rgb_tint(themes.themeElements.clrScheme[fill.bgColor.theme].rgb, 0);\n          }\n          /* Excel uses ARGB strings */\n\n\n          if (y.rgb) fill.bgColor.rgb = y.rgb; //.substring(y.rgb.length - 6);\n\n          break;\n\n        case '<bgColor/>':\n        case '</bgColor>':\n          break;\n\n        /* 18.8.19 fgColor CT_Color */\n\n        case '<fgColor':\n          if (!fill.fgColor) fill.fgColor = {};\n          if (y.theme) fill.fgColor.theme = parseInt(y.theme, 10);\n          if (y.tint) fill.fgColor.tint = parseFloat(y.tint);\n\n          if (y.theme && themes.themeElements && themes.themeElements.clrScheme) {\n            fill.fgColor.rgb = rgb_tint(themes.themeElements.clrScheme[fill.fgColor.theme].rgb, fill.fgColor.tint || 0);\n            if (opts.WTF) fill.fgColor.raw_rgb = rgb_tint(themes.themeElements.clrScheme[fill.fgColor.theme].rgb, 0);\n          }\n          /* Excel uses ARGB strings */\n\n\n          if (y.rgb) fill.fgColor.rgb = y.rgb; //.substring(y.rgb.length - 6);\n\n          break;\n\n        case '<fgColor/>':\n        case '</fgColor>':\n          break;\n\n        default:\n          if (opts.WTF) throw 'unrecognized ' + y[0] + ' in fills';\n      }\n    });\n  }\n\n  function parse_fonts(t, opts) {\n    styles.Fonts = [];\n    var font = {};\n    t[0].match(tagregex).forEach(function (x) {\n      var y = parsexmltag(x);\n\n      switch (y[0]) {\n        case '<fonts':\n        case '<fonts>':\n        case '</fonts>':\n          break;\n\n        case '<font':\n          break;\n\n        case '</font>':\n          styles.Fonts.push(font);\n          ;\n          font = {};\n          break;\n\n        case '<name':\n          if (y.val) font.name = y.val;\n          break;\n\n        case '<name/>':\n        case '</name>':\n          break;\n\n        case '<b/>':\n          font.bold = true;\n          break;\n\n        case '<u/>':\n          font.underline = true;\n          break;\n\n        case '<i/>':\n          font.italic = true;\n          break;\n\n        case '<strike/>':\n          font.strike = true;\n          break;\n\n        case '<outline/>':\n          font.outline = true;\n          break;\n\n        case '<shadow/>':\n          font.shadow = true;\n          break;\n\n        case '<sz':\n          if (y.val) font.sz = y.val;\n          break;\n\n        case '<sz/>':\n        case '</sz>':\n          break;\n\n        case '<vertAlign':\n          if (y.val) font.vertAlign = y.val;\n          break;\n\n        case '<vertAlign/>':\n        case '</vertAlign>':\n          break;\n\n        case '<color':\n          if (!font.color) font.color = {};\n          if (y.theme) font.color.theme = y.theme;\n          if (y.tint) font.color.tint = y.tint;\n\n          if (y.theme && themes.themeElements && themes.themeElements.clrScheme) {\n            font.color.rgb = rgb_tint(themes.themeElements.clrScheme[font.color.theme].rgb, font.color.tint || 0);\n          }\n\n          if (y.rgb) font.color.rgb = y.rgb;\n          break;\n\n        case '<color/>':\n        case '</color>':\n          break;\n      }\n    });\n  }\n\n  function parse_borders(t, opts) {\n    styles.Borders = [];\n    var border = {},\n        sub_border = {};\n    t[0].match(tagregex).forEach(function (x) {\n      var y = parsexmltag(x);\n\n      switch (y[0]) {\n        case '<borders':\n        case '<borders>':\n        case '</borders>':\n          break;\n\n        case '<border':\n        case '<border>':\n          border = {};\n\n          if (y.diagonalUp) {\n            border.diagonalUp = y.diagonalUp;\n          }\n\n          if (y.diagonalDown) {\n            border.diagonalDown = y.diagonalDown;\n          }\n\n          styles.Borders.push(border);\n          break;\n          break;\n\n        case '</border>':\n          break;\n\n        case '<left':\n          sub_border = border.left = {};\n\n          if (y.style) {\n            sub_border.style = y.style;\n          }\n\n          break;\n\n        case '<right':\n          sub_border = border.right = {};\n\n          if (y.style) {\n            sub_border.style = y.style;\n          }\n\n          break;\n\n        case '<top':\n          sub_border = border.top = {};\n\n          if (y.style) {\n            sub_border.style = y.style;\n          }\n\n          break;\n\n        case '<bottom':\n          sub_border = border.bottom = {};\n\n          if (y.style) {\n            sub_border.style = y.style;\n          }\n\n          break;\n\n        case '<diagonal':\n          sub_border = border.diagonal = {};\n\n          if (y.style) {\n            sub_border.style = y.style;\n          }\n\n          break;\n\n        case '<color':\n          sub_border.color = {};\n          if (y.theme) sub_border.color.theme = y.theme;\n\n          if (y.theme && themes.themeElements && themes.themeElements.clrScheme) {\n            sub_border.color.rgb = rgb_tint(themes.themeElements.clrScheme[sub_border.color.theme].rgb, sub_border.color.tint || 0);\n          }\n\n          if (y.tint) sub_border.color.tint = y.tint;\n          if (y.rgb) sub_border.color.rgb = y.rgb;\n          if (y.auto) sub_border.color.auto = y.auto;\n          break;\n\n        case '<name/>':\n        case '</name>':\n          break;\n\n        default:\n          break;\n      }\n    });\n  }\n  /* 18.8.31 numFmts CT_NumFmts */\n\n\n  function parse_numFmts(t, opts) {\n    styles.NumberFmt = [];\n    var k = keys(SSF._table);\n\n    for (var i = 0; i < k.length; ++i) {\n      styles.NumberFmt[k[i]] = SSF._table[k[i]];\n    }\n\n    var m = t[0].match(tagregex);\n\n    for (i = 0; i < m.length; ++i) {\n      var y = parsexmltag(m[i]);\n\n      switch (y[0]) {\n        case '<numFmts':\n        case '</numFmts>':\n        case '<numFmts/>':\n        case '<numFmts>':\n          break;\n\n        case '<numFmt':\n          {\n            var f = unescapexml(utf8read(y.formatCode)),\n                j = parseInt(y.numFmtId, 10);\n            styles.NumberFmt[j] = f;\n            if (j > 0) SSF.load(f, j);\n          }\n          break;\n\n        default:\n          if (opts.WTF) throw 'unrecognized ' + y[0] + ' in numFmts';\n      }\n    }\n  }\n\n  function write_numFmts(NF, opts) {\n    var o = [\"<numFmts>\"];\n    [[5, 8], [23, 26], [41, 44], [63, 66], [164, 392]].forEach(function (r) {\n      for (var i = r[0]; i <= r[1]; ++i) {\n        if (NF[i] !== undefined) o[o.length] = writextag('numFmt', null, {\n          numFmtId: i,\n          formatCode: escapexml(NF[i])\n        });\n      }\n    });\n    if (o.length === 1) return \"\";\n    o[o.length] = \"</numFmts>\";\n    o[0] = writextag('numFmts', null, {\n      count: o.length - 2\n    }).replace(\"/>\", \">\");\n    return o.join(\"\");\n  }\n  /* 18.8.10 cellXfs CT_CellXfs */\n\n\n  function parse_cellXfs(t, opts) {\n    styles.CellXf = [];\n    var xf;\n    t[0].match(tagregex).forEach(function (x) {\n      var y = parsexmltag(x);\n\n      switch (y[0]) {\n        case '<cellXfs':\n        case '<cellXfs>':\n        case '<cellXfs/>':\n        case '</cellXfs>':\n          break;\n\n        /* 18.8.45 xf CT_Xf */\n\n        case '<xf':\n          xf = y;\n          delete xf[0];\n          delete y[0];\n          if (xf.numFmtId) xf.numFmtId = parseInt(xf.numFmtId, 10);\n          if (xf.fillId) xf.fillId = parseInt(xf.fillId, 10);\n          styles.CellXf.push(xf);\n          break;\n\n        case '</xf>':\n          break;\n\n        /* 18.8.1 alignment CT_CellAlignment */\n\n        case '<alignment':\n        case '<alignment/>':\n          var alignment = {};\n\n          if (y.vertical) {\n            alignment.vertical = y.vertical;\n          }\n\n          if (y.horizontal) {\n            alignment.horizontal = y.horizontal;\n          }\n\n          if (y.textRotation != undefined) {\n            alignment.textRotation = y.textRotation;\n          }\n\n          if (y.indent) {\n            alignment.indent = y.indent;\n          }\n\n          if (y.wrapText) {\n            alignment.wrapText = y.wrapText;\n          }\n\n          xf.alignment = alignment;\n          break;\n\n        /* 18.8.33 protection CT_CellProtection */\n\n        case '<protection':\n        case '</protection>':\n        case '<protection/>':\n          break;\n\n        case '<extLst':\n        case '</extLst>':\n          break;\n\n        case '<ext':\n          break;\n\n        default:\n          if (opts.WTF) throw 'unrecognized ' + y[0] + ' in cellXfs';\n      }\n    });\n  }\n\n  function write_cellXfs(cellXfs) {\n    var o = [];\n    o[o.length] = writextag('cellXfs', null);\n    cellXfs.forEach(function (c) {\n      o[o.length] = writextag('xf', null, c);\n    });\n    o[o.length] = \"</cellXfs>\";\n    if (o.length === 2) return \"\";\n    o[0] = writextag('cellXfs', null, {\n      count: o.length - 2\n    }).replace(\"/>\", \">\");\n    return o.join(\"\");\n  }\n  /* 18.8 Styles CT_Stylesheet*/\n\n\n  var parse_sty_xml = function make_pstyx() {\n    var numFmtRegex = /<numFmts([^>]*)>.*<\\/numFmts>/;\n    var cellXfRegex = /<cellXfs([^>]*)>.*<\\/cellXfs>/;\n    var fillsRegex = /<fills([^>]*)>.*<\\/fills>/;\n    var bordersRegex = /<borders([^>]*)>.*<\\/borders>/;\n    return function parse_sty_xml(data, opts) {\n      /* 18.8.39 styleSheet CT_Stylesheet */\n      var t;\n      /* numFmts CT_NumFmts ? */\n\n      if (t = data.match(numFmtRegex)) parse_numFmts(t, opts);\n      /* fonts CT_Fonts ? */\n\n      if (t = data.match(/<fonts([^>]*)>.*<\\/fonts>/)) parse_fonts(t, opts);\n      /* fills CT_Fills */\n\n      if (t = data.match(fillsRegex)) parse_fills(t, opts);\n      /* borders CT_Borders ? */\n\n      if (t = data.match(bordersRegex)) parse_borders(t, opts);\n      /* cellStyleXfs CT_CellStyleXfs ? */\n\n      /* cellXfs CT_CellXfs ? */\n\n      if (t = data.match(cellXfRegex)) parse_cellXfs(t, opts);\n      /* dxfs CT_Dxfs ? */\n\n      /* tableStyles CT_TableStyles ? */\n\n      /* colors CT_Colors ? */\n\n      /* extLst CT_ExtensionList ? */\n\n      return styles;\n    };\n  }();\n\n  var STYLES_XML_ROOT = writextag('styleSheet', null, {\n    'xmlns': XMLNS.main[0],\n    'xmlns:vt': XMLNS.vt\n  });\n  RELS.STY = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles\";\n\n  function write_sty_xml(wb, opts) {\n    if (typeof style_builder != 'undefined' && typeof 'require' != 'undefined') {\n      return style_builder.toXml();\n    }\n\n    var o = [XML_HEADER, STYLES_XML_ROOT],\n        w;\n    if ((w = write_numFmts(wb.SSF)) != null) o[o.length] = w;\n    o[o.length] = '<fonts count=\"1\"><font><sz val=\"12\"/><color theme=\"1\"/><name val=\"Calibri\"/><family val=\"2\"/><scheme val=\"minor\"/></font></fonts>';\n    o[o.length] = '<fills count=\"2\"><fill><patternFill patternType=\"none\"/></fill><fill><patternFill patternType=\"gray125\"/></fill></fills>';\n    o[o.length] = '<borders count=\"1\"><border><left/><right/><top/><bottom/><diagonal/></border></borders>';\n    o[o.length] = '<cellStyleXfs count=\"1\"><xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\"/></cellStyleXfs>';\n    if (w = write_cellXfs(opts.cellXfs)) o[o.length] = w;\n    o[o.length] = '<cellStyles count=\"1\"><cellStyle name=\"Normal\" xfId=\"0\" builtinId=\"0\"/></cellStyles>';\n    o[o.length] = '<dxfs count=\"0\"/>';\n    o[o.length] = '<tableStyles count=\"0\" defaultTableStyle=\"TableStyleMedium9\" defaultPivotStyle=\"PivotStyleMedium4\"/>';\n\n    if (o.length > 2) {\n      o[o.length] = '</styleSheet>';\n      o[1] = o[1].replace(\"/>\", \">\");\n    }\n\n    return o.join(\"\");\n  }\n  /* [MS-XLSB] 2.4.651 BrtFmt */\n\n\n  function parse_BrtFmt(data, length) {\n    var ifmt = data.read_shift(2);\n    var stFmtCode = parse_XLWideString(data, length - 2);\n    return [ifmt, stFmtCode];\n  }\n  /* [MS-XLSB] 2.4.653 BrtFont TODO */\n\n\n  function parse_BrtFont(data, length) {\n    var out = {\n      flags: {}\n    };\n    out.dyHeight = data.read_shift(2);\n    out.grbit = parse_FontFlags(data, 2);\n    out.bls = data.read_shift(2);\n    out.sss = data.read_shift(2);\n    out.uls = data.read_shift(1);\n    out.bFamily = data.read_shift(1);\n    out.bCharSet = data.read_shift(1);\n    data.l++;\n    out.brtColor = parse_BrtColor(data, 8);\n    out.bFontScheme = data.read_shift(1);\n    out.name = parse_XLWideString(data, length - 21);\n    out.flags.Bold = out.bls === 0x02BC;\n    out.flags.Italic = out.grbit.fItalic;\n    out.flags.Strikeout = out.grbit.fStrikeout;\n    out.flags.Outline = out.grbit.fOutline;\n    out.flags.Shadow = out.grbit.fShadow;\n    out.flags.Condense = out.grbit.fCondense;\n    out.flags.Extend = out.grbit.fExtend;\n    out.flags.Sub = out.sss & 0x2;\n    out.flags.Sup = out.sss & 0x1;\n    return out;\n  }\n  /* [MS-XLSB] 2.4.816 BrtXF */\n\n\n  function parse_BrtXF(data, length) {\n    var ixfeParent = data.read_shift(2);\n    var ifmt = data.read_shift(2);\n    parsenoop(data, length - 4);\n    return {\n      ixfe: ixfeParent,\n      ifmt: ifmt\n    };\n  }\n  /* [MS-XLSB] 2.1.7.50 Styles */\n\n\n  function parse_sty_bin(data, opts) {\n    styles.NumberFmt = [];\n\n    for (var y in SSF._table) {\n      styles.NumberFmt[y] = SSF._table[y];\n    }\n\n    styles.CellXf = [];\n    var state = \"\";\n    /* TODO: this should be a stack */\n\n    var pass = false;\n    recordhopper(data, function hopper_sty(val, R, RT) {\n      switch (R.n) {\n        case 'BrtFmt':\n          styles.NumberFmt[val[0]] = val[1];\n          SSF.load(val[1], val[0]);\n          break;\n\n        case 'BrtFont':\n          break;\n\n        /* TODO */\n\n        case 'BrtKnownFonts':\n          break;\n\n        /* TODO */\n\n        case 'BrtFill':\n          break;\n\n        /* TODO */\n\n        case 'BrtBorder':\n          break;\n\n        /* TODO */\n\n        case 'BrtXF':\n          if (state === \"CELLXFS\") {\n            styles.CellXf.push(val);\n          }\n\n          break;\n\n        /* TODO */\n\n        case 'BrtStyle':\n          break;\n\n        /* TODO */\n\n        case 'BrtDXF':\n          break;\n\n        /* TODO */\n\n        case 'BrtMRUColor':\n          break;\n\n        /* TODO */\n\n        case 'BrtIndexedColor':\n          break;\n\n        /* TODO */\n\n        case 'BrtBeginStyleSheet':\n          break;\n\n        case 'BrtEndStyleSheet':\n          break;\n\n        case 'BrtBeginTableStyle':\n          break;\n\n        case 'BrtTableStyleElement':\n          break;\n\n        case 'BrtEndTableStyle':\n          break;\n\n        case 'BrtBeginFmts':\n          state = \"FMTS\";\n          break;\n\n        case 'BrtEndFmts':\n          state = \"\";\n          break;\n\n        case 'BrtBeginFonts':\n          state = \"FONTS\";\n          break;\n\n        case 'BrtEndFonts':\n          state = \"\";\n          break;\n\n        case 'BrtACBegin':\n          state = \"ACFONTS\";\n          break;\n\n        case 'BrtACEnd':\n          state = \"\";\n          break;\n\n        case 'BrtBeginFills':\n          state = \"FILLS\";\n          break;\n\n        case 'BrtEndFills':\n          state = \"\";\n          break;\n\n        case 'BrtBeginBorders':\n          state = \"BORDERS\";\n          break;\n\n        case 'BrtEndBorders':\n          state = \"\";\n          break;\n\n        case 'BrtBeginCellStyleXFs':\n          state = \"CELLSTYLEXFS\";\n          break;\n\n        case 'BrtEndCellStyleXFs':\n          state = \"\";\n          break;\n\n        case 'BrtBeginCellXFs':\n          state = \"CELLXFS\";\n          break;\n\n        case 'BrtEndCellXFs':\n          state = \"\";\n          break;\n\n        case 'BrtBeginStyles':\n          state = \"STYLES\";\n          break;\n\n        case 'BrtEndStyles':\n          state = \"\";\n          break;\n\n        case 'BrtBeginDXFs':\n          state = \"DXFS\";\n          break;\n\n        case 'BrtEndDXFs':\n          state = \"\";\n          break;\n\n        case 'BrtBeginTableStyles':\n          state = \"TABLESTYLES\";\n          break;\n\n        case 'BrtEndTableStyles':\n          state = \"\";\n          break;\n\n        case 'BrtBeginColorPalette':\n          state = \"COLORPALETTE\";\n          break;\n\n        case 'BrtEndColorPalette':\n          state = \"\";\n          break;\n\n        case 'BrtBeginIndexedColors':\n          state = \"INDEXEDCOLORS\";\n          break;\n\n        case 'BrtEndIndexedColors':\n          state = \"\";\n          break;\n\n        case 'BrtBeginMRUColors':\n          state = \"MRUCOLORS\";\n          break;\n\n        case 'BrtEndMRUColors':\n          state = \"\";\n          break;\n\n        case 'BrtFRTBegin':\n          pass = true;\n          break;\n\n        case 'BrtFRTEnd':\n          pass = false;\n          break;\n\n        case 'BrtBeginStyleSheetExt14':\n          break;\n\n        case 'BrtBeginSlicerStyles':\n          break;\n\n        case 'BrtEndSlicerStyles':\n          break;\n\n        case 'BrtBeginTimelineStylesheetExt15':\n          break;\n\n        case 'BrtEndTimelineStylesheetExt15':\n          break;\n\n        case 'BrtBeginTimelineStyles':\n          break;\n\n        case 'BrtEndTimelineStyles':\n          break;\n\n        case 'BrtEndStyleSheetExt14':\n          break;\n\n        default:\n          if (!pass || opts.WTF) throw new Error(\"Unexpected record \" + RT + \" \" + R.n);\n      }\n    });\n    return styles;\n  }\n  /* [MS-XLSB] 2.1.7.50 Styles */\n\n\n  function write_sty_bin(data, opts) {\n    var ba = buf_array();\n    write_record(ba, \"BrtBeginStyleSheet\");\n    /* [FMTS] */\n\n    /* [FONTS] */\n\n    /* [FILLS] */\n\n    /* [BORDERS] */\n\n    /* CELLSTYLEXFS */\n\n    /* CELLXFS*/\n\n    /* STYLES */\n\n    /* DXFS */\n\n    /* TABLESTYLES */\n\n    /* [COLORPALETTE] */\n\n    /* FRTSTYLESHEET*/\n\n    write_record(ba, \"BrtEndStyleSheet\");\n    return ba.end();\n  }\n\n  RELS.THEME = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme\";\n  /* 20.1.6.2 clrScheme CT_ColorScheme */\n\n  function parse_clrScheme(t, opts) {\n    themes.themeElements.clrScheme = [];\n    var color = {};\n    t[0].match(tagregex).forEach(function (x) {\n      var y = parsexmltag(x);\n\n      switch (y[0]) {\n        case '<a:clrScheme':\n        case '</a:clrScheme>':\n          break;\n\n        /* 20.1.2.3.32 srgbClr CT_SRgbColor */\n\n        case '<a:srgbClr':\n          color.rgb = y.val;\n          break;\n\n        /* 20.1.2.3.33 sysClr CT_SystemColor */\n\n        case '<a:sysClr':\n          color.rgb = y.lastClr;\n          break;\n\n        /* 20.1.4.1.9 dk1 (Dark 1) */\n\n        case '<a:dk1>':\n        case '</a:dk1>':\n        /* 20.1.4.1.10 dk2 (Dark 2) */\n\n        case '<a:dk2>':\n        case '</a:dk2>':\n        /* 20.1.4.1.22 lt1 (Light 1) */\n\n        case '<a:lt1>':\n        case '</a:lt1>':\n        /* 20.1.4.1.23 lt2 (Light 2) */\n\n        case '<a:lt2>':\n        case '</a:lt2>':\n        /* 20.1.4.1.1 accent1 (Accent 1) */\n\n        case '<a:accent1>':\n        case '</a:accent1>':\n        /* 20.1.4.1.2 accent2 (Accent 2) */\n\n        case '<a:accent2>':\n        case '</a:accent2>':\n        /* 20.1.4.1.3 accent3 (Accent 3) */\n\n        case '<a:accent3>':\n        case '</a:accent3>':\n        /* 20.1.4.1.4 accent4 (Accent 4) */\n\n        case '<a:accent4>':\n        case '</a:accent4>':\n        /* 20.1.4.1.5 accent5 (Accent 5) */\n\n        case '<a:accent5>':\n        case '</a:accent5>':\n        /* 20.1.4.1.6 accent6 (Accent 6) */\n\n        case '<a:accent6>':\n        case '</a:accent6>':\n        /* 20.1.4.1.19 hlink (Hyperlink) */\n\n        case '<a:hlink>':\n        case '</a:hlink>':\n        /* 20.1.4.1.15 folHlink (Followed Hyperlink) */\n\n        case '<a:folHlink>':\n        case '</a:folHlink>':\n          if (y[0][1] === '/') {\n            themes.themeElements.clrScheme.push(color);\n            color = {};\n          } else {\n            color.name = y[0].substring(3, y[0].length - 1);\n          }\n\n          break;\n\n        default:\n          if (opts.WTF) throw 'unrecognized ' + y[0] + ' in clrScheme';\n      }\n    });\n  }\n  /* 20.1.4.1.18 fontScheme CT_FontScheme */\n\n\n  function parse_fontScheme(t, opts) {}\n  /* 20.1.4.1.15 fmtScheme CT_StyleMatrix */\n\n\n  function parse_fmtScheme(t, opts) {}\n\n  var clrsregex = /<a:clrScheme([^>]*)>[^\\u2603]*<\\/a:clrScheme>/;\n  var fntsregex = /<a:fontScheme([^>]*)>[^\\u2603]*<\\/a:fontScheme>/;\n  var fmtsregex = /<a:fmtScheme([^>]*)>[^\\u2603]*<\\/a:fmtScheme>/;\n  /* 20.1.6.10 themeElements CT_BaseStyles */\n\n  function parse_themeElements(data, opts) {\n    themes.themeElements = {};\n    var t;\n    [\n    /* clrScheme CT_ColorScheme */\n    ['clrScheme', clrsregex, parse_clrScheme],\n    /* fontScheme CT_FontScheme */\n    ['fontScheme', fntsregex, parse_fontScheme],\n    /* fmtScheme CT_StyleMatrix */\n    ['fmtScheme', fmtsregex, parse_fmtScheme]].forEach(function (m) {\n      if (!(t = data.match(m[1]))) throw m[0] + ' not found in themeElements';\n      m[2](t, opts);\n    });\n  }\n\n  var themeltregex = /<a:themeElements([^>]*)>[^\\u2603]*<\\/a:themeElements>/;\n  /* 14.2.7 Theme Part */\n\n  function parse_theme_xml(data, opts) {\n    /* 20.1.6.9 theme CT_OfficeStyleSheet */\n    if (!data || data.length === 0) return themes;\n    var t;\n    /* themeElements CT_BaseStyles */\n\n    if (!(t = data.match(themeltregex))) throw 'themeElements not found in theme';\n    parse_themeElements(t[0], opts);\n    return themes;\n  } //function write_theme() { return '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\n<a:theme xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" name=\"Office Theme\"><a:themeElements><a:clrScheme name=\"Office\"><a:dk1><a:sysClr val=\"windowText\" lastClr=\"000000\"/></a:dk1><a:lt1><a:sysClr val=\"window\" lastClr=\"FFFFFF\"/></a:lt1><a:dk2><a:srgbClr val=\"1F497D\"/></a:dk2><a:lt2><a:srgbClr val=\"EEECE1\"/></a:lt2><a:accent1><a:srgbClr val=\"4F81BD\"/></a:accent1><a:accent2><a:srgbClr val=\"C0504D\"/></a:accent2><a:accent3><a:srgbClr val=\"9BBB59\"/></a:accent3><a:accent4><a:srgbClr val=\"8064A2\"/></a:accent4><a:accent5><a:srgbClr val=\"4BACC6\"/></a:accent5><a:accent6><a:srgbClr val=\"F79646\"/></a:accent6><a:hlink><a:srgbClr val=\"0000FF\"/></a:hlink><a:folHlink><a:srgbClr val=\"800080\"/></a:folHlink></a:clrScheme><a:fontScheme name=\"Office\"><a:majorFont><a:latin typeface=\"Cambria\"/><a:ea typeface=\"\"/><a:cs typeface=\"\"/><a:font script=\"Jpan\" typeface=\"ＭＳ Ｐゴシック\"/><a:font script=\"Hang\" typeface=\"맑은 고딕\"/><a:font script=\"Hans\" typeface=\"宋体\"/><a:font script=\"Hant\" typeface=\"新細明體\"/><a:font script=\"Arab\" typeface=\"Times New Roman\"/><a:font script=\"Hebr\" typeface=\"Times New Roman\"/><a:font script=\"Thai\" typeface=\"Tahoma\"/><a:font script=\"Ethi\" typeface=\"Nyala\"/><a:font script=\"Beng\" typeface=\"Vrinda\"/><a:font script=\"Gujr\" typeface=\"Shruti\"/><a:font script=\"Khmr\" typeface=\"MoolBoran\"/><a:font script=\"Knda\" typeface=\"Tunga\"/><a:font script=\"Guru\" typeface=\"Raavi\"/><a:font script=\"Cans\" typeface=\"Euphemia\"/><a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/><a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/><a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/><a:font script=\"Thaa\" typeface=\"MV Boli\"/><a:font script=\"Deva\" typeface=\"Mangal\"/><a:font script=\"Telu\" typeface=\"Gautami\"/><a:font script=\"Taml\" typeface=\"Latha\"/><a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/><a:font script=\"Orya\" typeface=\"Kalinga\"/><a:font script=\"Mlym\" typeface=\"Kartika\"/><a:font script=\"Laoo\" typeface=\"DokChampa\"/><a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/><a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/><a:font script=\"Viet\" typeface=\"Times New Roman\"/><a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/><a:font script=\"Geor\" typeface=\"Sylfaen\"/></a:majorFont><a:minorFont><a:latin typeface=\"Calibri\"/><a:ea typeface=\"\"/><a:cs typeface=\"\"/><a:font script=\"Jpan\" typeface=\"ＭＳ Ｐゴシック\"/><a:font script=\"Hang\" typeface=\"맑은 고딕\"/><a:font script=\"Hans\" typeface=\"宋体\"/><a:font script=\"Hant\" typeface=\"新細明體\"/><a:font script=\"Arab\" typeface=\"Arial\"/><a:font script=\"Hebr\" typeface=\"Arial\"/><a:font script=\"Thai\" typeface=\"Tahoma\"/><a:font script=\"Ethi\" typeface=\"Nyala\"/><a:font script=\"Beng\" typeface=\"Vrinda\"/><a:font script=\"Gujr\" typeface=\"Shruti\"/><a:font script=\"Khmr\" typeface=\"DaunPenh\"/><a:font script=\"Knda\" typeface=\"Tunga\"/><a:font script=\"Guru\" typeface=\"Raavi\"/><a:font script=\"Cans\" typeface=\"Euphemia\"/><a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/><a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/><a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/><a:font script=\"Thaa\" typeface=\"MV Boli\"/><a:font script=\"Deva\" typeface=\"Mangal\"/><a:font script=\"Telu\" typeface=\"Gautami\"/><a:font script=\"Taml\" typeface=\"Latha\"/><a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/><a:font script=\"Orya\" typeface=\"Kalinga\"/><a:font script=\"Mlym\" typeface=\"Kartika\"/><a:font script=\"Laoo\" typeface=\"DokChampa\"/><a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/><a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/><a:font script=\"Viet\" typeface=\"Arial\"/><a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/><a:font script=\"Geor\" typeface=\"Sylfaen\"/></a:minorFont></a:fontScheme><a:fmtScheme name=\"Office\"><a:fillStyleLst><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"50000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"35000\"><a:schemeClr val=\"phClr\"><a:tint val=\"37000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:tint val=\"15000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs></a:gsLst><a:lin ang=\"16200000\" scaled=\"1\"/></a:gradFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"100000\"/><a:shade val=\"100000\"/><a:satMod val=\"130000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:tint val=\"50000\"/><a:shade val=\"100000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs></a:gsLst><a:lin ang=\"16200000\" scaled=\"0\"/></a:gradFill></a:fillStyleLst><a:lnStyleLst><a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"><a:shade val=\"95000\"/><a:satMod val=\"105000\"/></a:schemeClr></a:solidFill><a:prstDash val=\"solid\"/></a:ln><a:ln w=\"25400\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln><a:ln w=\"38100\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln></a:lnStyleLst><a:effectStyleLst><a:effectStyle><a:effectLst><a:outerShdw blurRad=\"40000\" dist=\"20000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"38000\"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad=\"40000\" dist=\"23000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad=\"40000\" dist=\"23000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw></a:effectLst><a:scene3d><a:camera prst=\"orthographicFront\"><a:rot lat=\"0\" lon=\"0\" rev=\"0\"/></a:camera><a:lightRig rig=\"threePt\" dir=\"t\"><a:rot lat=\"0\" lon=\"0\" rev=\"1200000\"/></a:lightRig></a:scene3d><a:sp3d><a:bevelT w=\"63500\" h=\"25400\"/></a:sp3d></a:effectStyle></a:effectStyleLst><a:bgFillStyleLst><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"40000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs><a:gs pos=\"40000\"><a:schemeClr val=\"phClr\"><a:tint val=\"45000\"/><a:shade val=\"99000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"20000\"/><a:satMod val=\"255000\"/></a:schemeClr></a:gs></a:gsLst><a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"-80000\" r=\"50000\" b=\"180000\"/></a:path></a:gradFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"80000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"30000\"/><a:satMod val=\"200000\"/></a:schemeClr></a:gs></a:gsLst><a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"50000\" r=\"50000\" b=\"50000\"/></a:path></a:gradFill></a:bgFillStyleLst></a:fmtScheme></a:themeElements><a:objectDefaults><a:spDef><a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx=\"1\"><a:schemeClr val=\"accent1\"/></a:lnRef><a:fillRef idx=\"3\"><a:schemeClr val=\"accent1\"/></a:fillRef><a:effectRef idx=\"2\"><a:schemeClr val=\"accent1\"/></a:effectRef><a:fontRef idx=\"minor\"><a:schemeClr val=\"lt1\"/></a:fontRef></a:style></a:spDef><a:lnDef><a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx=\"2\"><a:schemeClr val=\"accent1\"/></a:lnRef><a:fillRef idx=\"0\"><a:schemeClr val=\"accent1\"/></a:fillRef><a:effectRef idx=\"1\"><a:schemeClr val=\"accent1\"/></a:effectRef><a:fontRef idx=\"minor\"><a:schemeClr val=\"tx1\"/></a:fontRef></a:style></a:lnDef></a:objectDefaults><a:extraClrSchemeLst/></a:theme>'; }\n\n\n  function write_theme(opts) {\n    if (opts.themeXml) {\n      return opts.themeXml;\n    }\n\n    return '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\n<a:theme xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" name=\"Office Theme\"><a:themeElements><a:clrScheme name=\"Office\"><a:dk1><a:sysClr val=\"windowText\" lastClr=\"000000\"/></a:dk1><a:lt1><a:sysClr val=\"window\" lastClr=\"FFFFFF\"/></a:lt1><a:dk2><a:srgbClr val=\"1F497D\"/></a:dk2><a:lt2><a:srgbClr val=\"EEECE1\"/></a:lt2><a:accent1><a:srgbClr val=\"4F81BD\"/></a:accent1><a:accent2><a:srgbClr val=\"C0504D\"/></a:accent2><a:accent3><a:srgbClr val=\"9BBB59\"/></a:accent3><a:accent4><a:srgbClr val=\"8064A2\"/></a:accent4><a:accent5><a:srgbClr val=\"4BACC6\"/></a:accent5><a:accent6><a:srgbClr val=\"F79646\"/></a:accent6><a:hlink><a:srgbClr val=\"0000FF\"/></a:hlink><a:folHlink><a:srgbClr val=\"800080\"/></a:folHlink></a:clrScheme><a:fontScheme name=\"Office\"><a:majorFont><a:latin typeface=\"Cambria\"/><a:ea typeface=\"\"/><a:cs typeface=\"\"/><a:font script=\"Jpan\" typeface=\"ＭＳ Ｐゴシック\"/><a:font script=\"Hang\" typeface=\"맑은 고딕\"/><a:font script=\"Hans\" typeface=\"宋体\"/><a:font script=\"Hant\" typeface=\"新細明體\"/><a:font script=\"Arab\" typeface=\"Times New Roman\"/><a:font script=\"Hebr\" typeface=\"Times New Roman\"/><a:font script=\"Thai\" typeface=\"Tahoma\"/><a:font script=\"Ethi\" typeface=\"Nyala\"/><a:font script=\"Beng\" typeface=\"Vrinda\"/><a:font script=\"Gujr\" typeface=\"Shruti\"/><a:font script=\"Khmr\" typeface=\"MoolBoran\"/><a:font script=\"Knda\" typeface=\"Tunga\"/><a:font script=\"Guru\" typeface=\"Raavi\"/><a:font script=\"Cans\" typeface=\"Euphemia\"/><a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/><a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/><a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/><a:font script=\"Thaa\" typeface=\"MV Boli\"/><a:font script=\"Deva\" typeface=\"Mangal\"/><a:font script=\"Telu\" typeface=\"Gautami\"/><a:font script=\"Taml\" typeface=\"Latha\"/><a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/><a:font script=\"Orya\" typeface=\"Kalinga\"/><a:font script=\"Mlym\" typeface=\"Kartika\"/><a:font script=\"Laoo\" typeface=\"DokChampa\"/><a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/><a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/><a:font script=\"Viet\" typeface=\"Times New Roman\"/><a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/><a:font script=\"Geor\" typeface=\"Sylfaen\"/></a:majorFont><a:minorFont><a:latin typeface=\"Calibri\"/><a:ea typeface=\"\"/><a:cs typeface=\"\"/><a:font script=\"Jpan\" typeface=\"ＭＳ Ｐゴシック\"/><a:font script=\"Hang\" typeface=\"맑은 고딕\"/><a:font script=\"Hans\" typeface=\"宋体\"/><a:font script=\"Hant\" typeface=\"新細明體\"/><a:font script=\"Arab\" typeface=\"Arial\"/><a:font script=\"Hebr\" typeface=\"Arial\"/><a:font script=\"Thai\" typeface=\"Tahoma\"/><a:font script=\"Ethi\" typeface=\"Nyala\"/><a:font script=\"Beng\" typeface=\"Vrinda\"/><a:font script=\"Gujr\" typeface=\"Shruti\"/><a:font script=\"Khmr\" typeface=\"DaunPenh\"/><a:font script=\"Knda\" typeface=\"Tunga\"/><a:font script=\"Guru\" typeface=\"Raavi\"/><a:font script=\"Cans\" typeface=\"Euphemia\"/><a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/><a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/><a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/><a:font script=\"Thaa\" typeface=\"MV Boli\"/><a:font script=\"Deva\" typeface=\"Mangal\"/><a:font script=\"Telu\" typeface=\"Gautami\"/><a:font script=\"Taml\" typeface=\"Latha\"/><a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/><a:font script=\"Orya\" typeface=\"Kalinga\"/><a:font script=\"Mlym\" typeface=\"Kartika\"/><a:font script=\"Laoo\" typeface=\"DokChampa\"/><a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/><a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/><a:font script=\"Viet\" typeface=\"Arial\"/><a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/><a:font script=\"Geor\" typeface=\"Sylfaen\"/></a:minorFont></a:fontScheme><a:fmtScheme name=\"Office\"><a:fillStyleLst><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"50000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"35000\"><a:schemeClr val=\"phClr\"><a:tint val=\"37000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:tint val=\"15000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs></a:gsLst><a:lin ang=\"16200000\" scaled=\"1\"/></a:gradFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"100000\"/><a:shade val=\"100000\"/><a:satMod val=\"130000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:tint val=\"50000\"/><a:shade val=\"100000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs></a:gsLst><a:lin ang=\"16200000\" scaled=\"0\"/></a:gradFill></a:fillStyleLst><a:lnStyleLst><a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"><a:shade val=\"95000\"/><a:satMod val=\"105000\"/></a:schemeClr></a:solidFill><a:prstDash val=\"solid\"/></a:ln><a:ln w=\"25400\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln><a:ln w=\"38100\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln></a:lnStyleLst><a:effectStyleLst><a:effectStyle><a:effectLst><a:outerShdw blurRad=\"40000\" dist=\"20000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"38000\"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad=\"40000\" dist=\"23000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad=\"40000\" dist=\"23000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw></a:effectLst><a:scene3d><a:camera prst=\"orthographicFront\"><a:rot lat=\"0\" lon=\"0\" rev=\"0\"/></a:camera><a:lightRig rig=\"threePt\" dir=\"t\"><a:rot lat=\"0\" lon=\"0\" rev=\"1200000\"/></a:lightRig></a:scene3d><a:sp3d><a:bevelT w=\"63500\" h=\"25400\"/></a:sp3d></a:effectStyle></a:effectStyleLst><a:bgFillStyleLst><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"40000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs><a:gs pos=\"40000\"><a:schemeClr val=\"phClr\"><a:tint val=\"45000\"/><a:shade val=\"99000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"20000\"/><a:satMod val=\"255000\"/></a:schemeClr></a:gs></a:gsLst><a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"-80000\" r=\"50000\" b=\"180000\"/></a:path></a:gradFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"80000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"30000\"/><a:satMod val=\"200000\"/></a:schemeClr></a:gs></a:gsLst><a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"50000\" r=\"50000\" b=\"50000\"/></a:path></a:gradFill></a:bgFillStyleLst></a:fmtScheme></a:themeElements><a:objectDefaults><a:spDef><a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx=\"1\"><a:schemeClr val=\"accent1\"/></a:lnRef><a:fillRef idx=\"3\"><a:schemeClr val=\"accent1\"/></a:fillRef><a:effectRef idx=\"2\"><a:schemeClr val=\"accent1\"/></a:effectRef><a:fontRef idx=\"minor\"><a:schemeClr val=\"lt1\"/></a:fontRef></a:style></a:spDef><a:lnDef><a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx=\"2\"><a:schemeClr val=\"accent1\"/></a:lnRef><a:fillRef idx=\"0\"><a:schemeClr val=\"accent1\"/></a:fillRef><a:effectRef idx=\"1\"><a:schemeClr val=\"accent1\"/></a:effectRef><a:fontRef idx=\"minor\"><a:schemeClr val=\"tx1\"/></a:fontRef></a:style></a:lnDef></a:objectDefaults><a:extraClrSchemeLst/></a:theme>';\n  }\n  /* [MS-XLS] 2.4.326 TODO: payload is a zip file */\n\n\n  function parse_Theme(blob, length) {\n    var dwThemeVersion = blob.read_shift(4);\n    if (dwThemeVersion === 124226) return;\n    blob.l += length - 4;\n  }\n  /* 2.5.49 */\n\n\n  function parse_ColorTheme(blob, length) {\n    return blob.read_shift(4);\n  }\n  /* 2.5.155 */\n\n\n  function parse_FullColorExt(blob, length) {\n    var o = {};\n    o.xclrType = blob.read_shift(2);\n    o.nTintShade = blob.read_shift(2);\n\n    switch (o.xclrType) {\n      case 0:\n        blob.l += 4;\n        break;\n\n      case 1:\n        o.xclrValue = parse_IcvXF(blob, 4);\n        break;\n\n      case 2:\n        o.xclrValue = parse_LongRGBA(blob, 4);\n        break;\n\n      case 3:\n        o.xclrValue = parse_ColorTheme(blob, 4);\n        break;\n\n      case 4:\n        blob.l += 4;\n        break;\n    }\n\n    blob.l += 8;\n    return o;\n  }\n  /* 2.5.164 TODO: read 7 bits*/\n\n\n  function parse_IcvXF(blob, length) {\n    return parsenoop(blob, length);\n  }\n  /* 2.5.280 */\n\n\n  function parse_XFExtGradient(blob, length) {\n    return parsenoop(blob, length);\n  }\n  /* 2.5.108 */\n\n\n  function parse_ExtProp(blob, length) {\n    var extType = blob.read_shift(2);\n    var cb = blob.read_shift(2);\n    var o = [extType];\n\n    switch (extType) {\n      case 0x04:\n      case 0x05:\n      case 0x07:\n      case 0x08:\n      case 0x09:\n      case 0x0A:\n      case 0x0B:\n      case 0x0D:\n        o[1] = parse_FullColorExt(blob, cb);\n        break;\n\n      case 0x06:\n        o[1] = parse_XFExtGradient(blob, cb);\n        break;\n\n      case 0x0E:\n      case 0x0F:\n        o[1] = blob.read_shift(cb === 5 ? 1 : 2);\n        break;\n\n      default:\n        throw new Error(\"Unrecognized ExtProp type: \" + extType + \" \" + cb);\n    }\n\n    return o;\n  }\n  /* 2.4.355 */\n\n\n  function parse_XFExt(blob, length) {\n    var end = blob.l + length;\n    blob.l += 2;\n    var ixfe = blob.read_shift(2);\n    blob.l += 2;\n    var cexts = blob.read_shift(2);\n    var ext = [];\n\n    while (cexts-- > 0) {\n      ext.push(parse_ExtProp(blob, end - blob.l));\n    }\n\n    return {\n      ixfe: ixfe,\n      ext: ext\n    };\n  }\n  /* xf is an XF, see parse_XFExt for xfext */\n\n\n  function update_xfext(xf, xfext) {\n    xfext.forEach(function (xfe) {\n      switch (xfe[0]) {\n        /* 2.5.108 extPropData */\n        case 0x04:\n          break;\n\n        /* foreground color */\n\n        case 0x05:\n          break;\n\n        /* background color */\n\n        case 0x07:\n        case 0x08:\n        case 0x09:\n        case 0x0a:\n          break;\n\n        case 0x0d:\n          break;\n\n        /* text color */\n\n        case 0x0e:\n          break;\n\n        /* font scheme */\n\n        default:\n          throw \"bafuq\" + xfe[0].toString(16);\n      }\n    });\n  }\n  /* 18.6 Calculation Chain */\n\n\n  function parse_cc_xml(data, opts) {\n    var d = [];\n    var l = 0,\n        i = 1;\n    (data.match(tagregex) || []).forEach(function (x) {\n      var y = parsexmltag(x);\n\n      switch (y[0]) {\n        case '<?xml':\n          break;\n\n        /* 18.6.2  calcChain CT_CalcChain 1 */\n\n        case '<calcChain':\n        case '<calcChain>':\n        case '</calcChain>':\n          break;\n\n        /* 18.6.1  c CT_CalcCell 1 */\n\n        case '<c':\n          delete y[0];\n          if (y.i) i = y.i;else y.i = i;\n          d.push(y);\n          break;\n      }\n    });\n    return d;\n  }\n\n  function write_cc_xml(data, opts) {}\n  /* [MS-XLSB] 2.6.4.1 */\n\n\n  function parse_BrtCalcChainItem$(data, length) {\n    var out = {};\n    out.i = data.read_shift(4);\n    var cell = {};\n    cell.r = data.read_shift(4);\n    cell.c = data.read_shift(4);\n    out.r = encode_cell(cell);\n    var flags = data.read_shift(1);\n    if (flags & 0x2) out.l = '1';\n    if (flags & 0x8) out.a = '1';\n    return out;\n  }\n  /* 18.6 Calculation Chain */\n\n\n  function parse_cc_bin(data, opts) {\n    var out = [];\n    var pass = false;\n    recordhopper(data, function hopper_cc(val, R, RT) {\n      switch (R.n) {\n        case 'BrtCalcChainItem$':\n          out.push(val);\n          break;\n\n        case 'BrtBeginCalcChain$':\n          break;\n\n        case 'BrtEndCalcChain$':\n          break;\n\n        default:\n          if (!pass || opts.WTF) throw new Error(\"Unexpected record \" + RT + \" \" + R.n);\n      }\n    });\n    return out;\n  }\n\n  function write_cc_bin(data, opts) {}\n\n  function parse_comments(zip, dirComments, sheets, sheetRels, opts) {\n    for (var i = 0; i != dirComments.length; ++i) {\n      var canonicalpath = dirComments[i];\n      var comments = parse_cmnt(getzipdata(zip, canonicalpath.replace(/^\\//, ''), true), canonicalpath, opts);\n      if (!comments || !comments.length) continue; // find the sheets targeted by these comments\n\n      var sheetNames = keys(sheets);\n\n      for (var j = 0; j != sheetNames.length; ++j) {\n        var sheetName = sheetNames[j];\n        var rels = sheetRels[sheetName];\n\n        if (rels) {\n          var rel = rels[canonicalpath];\n          if (rel) insertCommentsIntoSheet(sheetName, sheets[sheetName], comments);\n        }\n      }\n    }\n  }\n\n  function insertCommentsIntoSheet(sheetName, sheet, comments) {\n    comments.forEach(function (comment) {\n      var cell = sheet[comment.ref];\n\n      if (!cell) {\n        cell = {};\n        sheet[comment.ref] = cell;\n        var range = safe_decode_range(sheet[\"!ref\"] || \"BDWGO1000001:A1\");\n        var thisCell = decode_cell(comment.ref);\n        if (range.s.r > thisCell.r) range.s.r = thisCell.r;\n        if (range.e.r < thisCell.r) range.e.r = thisCell.r;\n        if (range.s.c > thisCell.c) range.s.c = thisCell.c;\n        if (range.e.c < thisCell.c) range.e.c = thisCell.c;\n        var encoded = encode_range(range);\n        if (encoded !== sheet[\"!ref\"]) sheet[\"!ref\"] = encoded;\n      }\n\n      if (!cell.c) cell.c = [];\n      var o = {\n        a: comment.author,\n        t: comment.t,\n        r: comment.r\n      };\n      if (comment.h) o.h = comment.h;\n      cell.c.push(o);\n    });\n  }\n  /* 18.7.3 CT_Comment */\n\n\n  function parse_comments_xml(data, opts) {\n    if (data.match(/<(?:\\w+:)?comments *\\/>/)) return [];\n    var authors = [];\n    var commentList = [];\n    data.match(/<(?:\\w+:)?authors>([^\\u2603]*)<\\/(?:\\w+:)?authors>/)[1].split(/<\\/\\w*:?author>/).forEach(function (x) {\n      if (x === \"\" || x.trim() === \"\") return;\n      authors.push(x.match(/<(?:\\w+:)?author[^>]*>(.*)/)[1]);\n    });\n    (data.match(/<(?:\\w+:)?commentList>([^\\u2603]*)<\\/(?:\\w+:)?commentList>/) || [\"\", \"\"])[1].split(/<\\/\\w*:?comment>/).forEach(function (x, index) {\n      if (x === \"\" || x.trim() === \"\") return;\n      var y = parsexmltag(x.match(/<(?:\\w+:)?comment[^>]*>/)[0]);\n      var comment = {\n        author: y.authorId && authors[y.authorId] ? authors[y.authorId] : undefined,\n        ref: y.ref,\n        guid: y.guid\n      };\n      var cell = decode_cell(y.ref);\n      if (opts.sheetRows && opts.sheetRows <= cell.r) return;\n      var textMatch = x.match(/<text>([^\\u2603]*)<\\/text>/);\n      if (!textMatch || !textMatch[1]) return; // a comment may contain an empty text tag.\n\n      var rt = parse_si(textMatch[1]);\n      comment.r = rt.r;\n      comment.t = rt.t;\n      if (opts.cellHTML) comment.h = rt.h;\n      commentList.push(comment);\n    });\n    return commentList;\n  }\n\n  function write_comments_xml(data, opts) {}\n  /* [MS-XLSB] 2.4.28 BrtBeginComment */\n\n\n  function parse_BrtBeginComment(data, length) {\n    var out = {};\n    out.iauthor = data.read_shift(4);\n    var rfx = parse_UncheckedRfX(data, 16);\n    out.rfx = rfx.s;\n    out.ref = encode_cell(rfx.s);\n    data.l += 16;\n    /*var guid = parse_GUID(data); */\n\n    return out;\n  }\n  /* [MS-XLSB] 2.4.324 BrtCommentAuthor */\n\n\n  var parse_BrtCommentAuthor = parse_XLWideString;\n  /* [MS-XLSB] 2.4.325 BrtCommentText */\n\n  var parse_BrtCommentText = parse_RichStr;\n  /* [MS-XLSB] 2.1.7.8 Comments */\n\n  function parse_comments_bin(data, opts) {\n    var out = [];\n    var authors = [];\n    var c = {};\n    var pass = false;\n    recordhopper(data, function hopper_cmnt(val, R, RT) {\n      switch (R.n) {\n        case 'BrtCommentAuthor':\n          authors.push(val);\n          break;\n\n        case 'BrtBeginComment':\n          c = val;\n          break;\n\n        case 'BrtCommentText':\n          c.t = val.t;\n          c.h = val.h;\n          c.r = val.r;\n          break;\n\n        case 'BrtEndComment':\n          c.author = authors[c.iauthor];\n          delete c.iauthor;\n          if (opts.sheetRows && opts.sheetRows <= c.rfx.r) break;\n          delete c.rfx;\n          out.push(c);\n          break;\n\n        case 'BrtBeginComments':\n          break;\n\n        case 'BrtEndComments':\n          break;\n\n        case 'BrtBeginCommentAuthors':\n          break;\n\n        case 'BrtEndCommentAuthors':\n          break;\n\n        case 'BrtBeginCommentList':\n          break;\n\n        case 'BrtEndCommentList':\n          break;\n\n        default:\n          if (!pass || opts.WTF) throw new Error(\"Unexpected record \" + RT + \" \" + R.n);\n      }\n    });\n    return out;\n  }\n\n  function write_comments_bin(data, opts) {}\n  /* TODO: it will be useful to parse the function str */\n\n\n  var rc_to_a1 = function () {\n    var rcregex = /(^|[^A-Za-z])R(\\[?)(-?\\d+|)\\]?C(\\[?)(-?\\d+|)\\]?/g;\n    var rcbase;\n\n    function rcfunc($$, $1, $2, $3, $4, $5) {\n      var R = $3.length > 0 ? parseInt($3, 10) | 0 : 0,\n          C = $5.length > 0 ? parseInt($5, 10) | 0 : 0;\n      if (C < 0 && $4.length === 0) C = 0;\n      if ($4.length > 0) C += rcbase.c;\n      if ($2.length > 0) R += rcbase.r;\n      return $1 + encode_col(C) + encode_row(R);\n    }\n\n    return function rc_to_a1(fstr, base) {\n      rcbase = base;\n      return fstr.replace(rcregex, rcfunc);\n    };\n  }();\n  /* --- formula references point to MS-XLS --- */\n\n  /* Small helpers */\n\n\n  function parseread(l) {\n    return function (blob, length) {\n      blob.l += l;\n      return;\n    };\n  }\n\n  function parseread1(blob, length) {\n    blob.l += 1;\n    return;\n  }\n  /* Rgce Helpers */\n\n  /* 2.5.51 */\n\n\n  function parse_ColRelU(blob, length) {\n    var c = blob.read_shift(2);\n    return [c & 0x3FFF, c >> 14 & 1, c >> 15 & 1];\n  }\n  /* 2.5.198.105 */\n\n\n  function parse_RgceArea(blob, length) {\n    var r = blob.read_shift(2),\n        R = blob.read_shift(2);\n    var c = parse_ColRelU(blob, 2);\n    var C = parse_ColRelU(blob, 2);\n    return {\n      s: {\n        r: r,\n        c: c[0],\n        cRel: c[1],\n        rRel: c[2]\n      },\n      e: {\n        r: R,\n        c: C[0],\n        cRel: C[1],\n        rRel: C[2]\n      }\n    };\n  }\n  /* 2.5.198.105 TODO */\n\n\n  function parse_RgceAreaRel(blob, length) {\n    var r = blob.read_shift(2),\n        R = blob.read_shift(2);\n    var c = parse_ColRelU(blob, 2);\n    var C = parse_ColRelU(blob, 2);\n    return {\n      s: {\n        r: r,\n        c: c[0],\n        cRel: c[1],\n        rRel: c[2]\n      },\n      e: {\n        r: R,\n        c: C[0],\n        cRel: C[1],\n        rRel: C[2]\n      }\n    };\n  }\n  /* 2.5.198.109 */\n\n\n  function parse_RgceLoc(blob, length) {\n    var r = blob.read_shift(2);\n    var c = parse_ColRelU(blob, 2);\n    return {\n      r: r,\n      c: c[0],\n      cRel: c[1],\n      rRel: c[2]\n    };\n  }\n  /* 2.5.198.111 */\n\n\n  function parse_RgceLocRel(blob, length) {\n    var r = blob.read_shift(2);\n    var cl = blob.read_shift(2);\n    var cRel = (cl & 0x8000) >> 15,\n        rRel = (cl & 0x4000) >> 14;\n    cl &= 0x3FFF;\n    if (cRel !== 0) while (cl >= 0x100) {\n      cl -= 0x100;\n    }\n    return {\n      r: r,\n      c: cl,\n      cRel: cRel,\n      rRel: rRel\n    };\n  }\n  /* Ptg Tokens */\n\n  /* 2.5.198.27 */\n\n\n  function parse_PtgArea(blob, length) {\n    var type = (blob[blob.l++] & 0x60) >> 5;\n    var area = parse_RgceArea(blob, 8);\n    return [type, area];\n  }\n  /* 2.5.198.28 */\n\n\n  function parse_PtgArea3d(blob, length) {\n    var type = (blob[blob.l++] & 0x60) >> 5;\n    var ixti = blob.read_shift(2);\n    var area = parse_RgceArea(blob, 8);\n    return [type, ixti, area];\n  }\n  /* 2.5.198.29 */\n\n\n  function parse_PtgAreaErr(blob, length) {\n    var type = (blob[blob.l++] & 0x60) >> 5;\n    blob.l += 8;\n    return [type];\n  }\n  /* 2.5.198.30 */\n\n\n  function parse_PtgAreaErr3d(blob, length) {\n    var type = (blob[blob.l++] & 0x60) >> 5;\n    var ixti = blob.read_shift(2);\n    blob.l += 8;\n    return [type, ixti];\n  }\n  /* 2.5.198.31 */\n\n\n  function parse_PtgAreaN(blob, length) {\n    var type = (blob[blob.l++] & 0x60) >> 5;\n    var area = parse_RgceAreaRel(blob, 8);\n    return [type, area];\n  }\n  /* 2.5.198.32 -- ignore this and look in PtgExtraArray for shape + values */\n\n\n  function parse_PtgArray(blob, length) {\n    var type = (blob[blob.l++] & 0x60) >> 5;\n    blob.l += 7;\n    return [type];\n  }\n  /* 2.5.198.33 */\n\n\n  function parse_PtgAttrBaxcel(blob, length) {\n    var bitSemi = blob[blob.l + 1] & 0x01;\n    /* 1 = volatile */\n\n    var bitBaxcel = 1;\n    blob.l += 4;\n    return [bitSemi, bitBaxcel];\n  }\n  /* 2.5.198.34 */\n\n\n  function parse_PtgAttrChoose(blob, length) {\n    blob.l += 2;\n    var offset = blob.read_shift(2);\n    var o = [];\n    /* offset is 1 less than the number of elements */\n\n    for (var i = 0; i <= offset; ++i) {\n      o.push(blob.read_shift(2));\n    }\n\n    return o;\n  }\n  /* 2.5.198.35 */\n\n\n  function parse_PtgAttrGoto(blob, length) {\n    var bitGoto = blob[blob.l + 1] & 0xFF ? 1 : 0;\n    blob.l += 2;\n    return [bitGoto, blob.read_shift(2)];\n  }\n  /* 2.5.198.36 */\n\n\n  function parse_PtgAttrIf(blob, length) {\n    var bitIf = blob[blob.l + 1] & 0xFF ? 1 : 0;\n    blob.l += 2;\n    return [bitIf, blob.read_shift(2)];\n  }\n  /* 2.5.198.37 */\n\n\n  function parse_PtgAttrSemi(blob, length) {\n    var bitSemi = blob[blob.l + 1] & 0xFF ? 1 : 0;\n    blob.l += 4;\n    return [bitSemi];\n  }\n  /* 2.5.198.40 (used by PtgAttrSpace and PtgAttrSpaceSemi) */\n\n\n  function parse_PtgAttrSpaceType(blob, length) {\n    var type = blob.read_shift(1),\n        cch = blob.read_shift(1);\n    return [type, cch];\n  }\n  /* 2.5.198.38 */\n\n\n  function parse_PtgAttrSpace(blob, length) {\n    blob.read_shift(2);\n    return parse_PtgAttrSpaceType(blob, 2);\n  }\n  /* 2.5.198.39 */\n\n\n  function parse_PtgAttrSpaceSemi(blob, length) {\n    blob.read_shift(2);\n    return parse_PtgAttrSpaceType(blob, 2);\n  }\n  /* 2.5.198.84 TODO */\n\n\n  function parse_PtgRef(blob, length) {\n    var ptg = blob[blob.l] & 0x1F;\n    var type = (blob[blob.l] & 0x60) >> 5;\n    blob.l += 1;\n    var loc = parse_RgceLoc(blob, 4);\n    return [type, loc];\n  }\n  /* 2.5.198.88 TODO */\n\n\n  function parse_PtgRefN(blob, length) {\n    var ptg = blob[blob.l] & 0x1F;\n    var type = (blob[blob.l] & 0x60) >> 5;\n    blob.l += 1;\n    var loc = parse_RgceLocRel(blob, 4);\n    return [type, loc];\n  }\n  /* 2.5.198.85 TODO */\n\n\n  function parse_PtgRef3d(blob, length) {\n    var ptg = blob[blob.l] & 0x1F;\n    var type = (blob[blob.l] & 0x60) >> 5;\n    blob.l += 1;\n    var ixti = blob.read_shift(2); // XtiIndex\n\n    var loc = parse_RgceLoc(blob, 4);\n    return [type, ixti, loc];\n  }\n  /* 2.5.198.62 TODO */\n\n\n  function parse_PtgFunc(blob, length) {\n    var ptg = blob[blob.l] & 0x1F;\n    var type = (blob[blob.l] & 0x60) >> 5;\n    blob.l += 1;\n    var iftab = blob.read_shift(2);\n    return [FtabArgc[iftab], Ftab[iftab]];\n  }\n  /* 2.5.198.63 TODO */\n\n\n  function parse_PtgFuncVar(blob, length) {\n    blob.l++;\n    var cparams = blob.read_shift(1),\n        tab = parsetab(blob);\n    return [cparams, (tab[0] === 0 ? Ftab : Cetab)[tab[1]]];\n  }\n\n  function parsetab(blob, length) {\n    return [blob[blob.l + 1] >> 7, blob.read_shift(2) & 0x7FFF];\n  }\n  /* 2.5.198.41 */\n\n\n  var parse_PtgAttrSum = parseread(4);\n  /* 2.5.198.43 */\n\n  var parse_PtgConcat = parseread1;\n  /* 2.5.198.58 */\n\n  function parse_PtgExp(blob, length) {\n    blob.l++;\n    var row = blob.read_shift(2);\n    var col = blob.read_shift(2);\n    return [row, col];\n  }\n  /* 2.5.198.57 */\n\n\n  function parse_PtgErr(blob, length) {\n    blob.l++;\n    return BErr[blob.read_shift(1)];\n  }\n  /* 2.5.198.66 TODO */\n\n\n  function parse_PtgInt(blob, length) {\n    blob.l++;\n    return blob.read_shift(2);\n  }\n  /* 2.5.198.42 */\n\n\n  function parse_PtgBool(blob, length) {\n    blob.l++;\n    return blob.read_shift(1) !== 0;\n  }\n  /* 2.5.198.79 */\n\n\n  function parse_PtgNum(blob, length) {\n    blob.l++;\n    return parse_Xnum(blob, 8);\n  }\n  /* 2.5.198.89 */\n\n\n  function parse_PtgStr(blob, length) {\n    blob.l++;\n    return parse_ShortXLUnicodeString(blob);\n  }\n  /* 2.5.192.112 + 2.5.192.11{3,4,5,6,7} */\n\n\n  function parse_SerAr(blob) {\n    var val = [];\n\n    switch (val[0] = blob.read_shift(1)) {\n      /* 2.5.192.113 */\n      case 0x04:\n        /* SerBool -- boolean */\n        val[1] = parsebool(blob, 1) ? 'TRUE' : 'FALSE';\n        blob.l += 7;\n        break;\n\n      /* 2.5.192.114 */\n\n      case 0x10:\n        /* SerErr -- error */\n        val[1] = BErr[blob[blob.l]];\n        blob.l += 8;\n        break;\n\n      /* 2.5.192.115 */\n\n      case 0x00:\n        /* SerNil -- honestly, I'm not sure how to reproduce this */\n        blob.l += 8;\n        break;\n\n      /* 2.5.192.116 */\n\n      case 0x01:\n        /* SerNum -- Xnum */\n        val[1] = parse_Xnum(blob, 8);\n        break;\n\n      /* 2.5.192.117 */\n\n      case 0x02:\n        /* SerStr -- XLUnicodeString (<256 chars) */\n        val[1] = parse_XLUnicodeString(blob);\n        break;\n      // default: throw \"Bad SerAr: \" + val[0]; /* Unreachable */\n    }\n\n    return val;\n  }\n  /* 2.5.198.61 */\n\n\n  function parse_PtgExtraMem(blob, cce) {\n    var count = blob.read_shift(2);\n    var out = [];\n\n    for (var i = 0; i != count; ++i) {\n      out.push(parse_Ref8U(blob, 8));\n    }\n\n    return out;\n  }\n  /* 2.5.198.59 */\n\n\n  function parse_PtgExtraArray(blob) {\n    var cols = 1 + blob.read_shift(1); //DColByteU\n\n    var rows = 1 + blob.read_shift(2); //DRw\n\n    for (var i = 0, o = []; i != rows && (o[i] = []); ++i) {\n      for (var j = 0; j != cols; ++j) {\n        o[i][j] = parse_SerAr(blob);\n      }\n    }\n\n    return o;\n  }\n  /* 2.5.198.76 */\n\n\n  function parse_PtgName(blob, length) {\n    var type = blob.read_shift(1) >>> 5 & 0x03;\n    var nameindex = blob.read_shift(4);\n    return [type, 0, nameindex];\n  }\n  /* 2.5.198.77 */\n\n\n  function parse_PtgNameX(blob, length) {\n    var type = blob.read_shift(1) >>> 5 & 0x03;\n    var ixti = blob.read_shift(2); // XtiIndex\n\n    var nameindex = blob.read_shift(4);\n    return [type, ixti, nameindex];\n  }\n  /* 2.5.198.70 */\n\n\n  function parse_PtgMemArea(blob, length) {\n    var type = blob.read_shift(1) >>> 5 & 0x03;\n    blob.l += 4;\n    var cce = blob.read_shift(2);\n    return [type, cce];\n  }\n  /* 2.5.198.72 */\n\n\n  function parse_PtgMemFunc(blob, length) {\n    var type = blob.read_shift(1) >>> 5 & 0x03;\n    var cce = blob.read_shift(2);\n    return [type, cce];\n  }\n  /* 2.5.198.86 */\n\n\n  function parse_PtgRefErr(blob, length) {\n    var type = blob.read_shift(1) >>> 5 & 0x03;\n    blob.l += 4;\n    return [type];\n  }\n  /* 2.5.198.26 */\n\n\n  var parse_PtgAdd = parseread1;\n  /* 2.5.198.45 */\n\n  var parse_PtgDiv = parseread1;\n  /* 2.5.198.56 */\n\n  var parse_PtgEq = parseread1;\n  /* 2.5.198.64 */\n\n  var parse_PtgGe = parseread1;\n  /* 2.5.198.65 */\n\n  var parse_PtgGt = parseread1;\n  /* 2.5.198.67 */\n\n  var parse_PtgIsect = parseread1;\n  /* 2.5.198.68 */\n\n  var parse_PtgLe = parseread1;\n  /* 2.5.198.69 */\n\n  var parse_PtgLt = parseread1;\n  /* 2.5.198.74 */\n\n  var parse_PtgMissArg = parseread1;\n  /* 2.5.198.75 */\n\n  var parse_PtgMul = parseread1;\n  /* 2.5.198.78 */\n\n  var parse_PtgNe = parseread1;\n  /* 2.5.198.80 */\n\n  var parse_PtgParen = parseread1;\n  /* 2.5.198.81 */\n\n  var parse_PtgPercent = parseread1;\n  /* 2.5.198.82 */\n\n  var parse_PtgPower = parseread1;\n  /* 2.5.198.83 */\n\n  var parse_PtgRange = parseread1;\n  /* 2.5.198.90 */\n\n  var parse_PtgSub = parseread1;\n  /* 2.5.198.93 */\n\n  var parse_PtgUminus = parseread1;\n  /* 2.5.198.94 */\n\n  var parse_PtgUnion = parseread1;\n  /* 2.5.198.95 */\n\n  var parse_PtgUplus = parseread1;\n  /* 2.5.198.71 */\n\n  var parse_PtgMemErr = parsenoop;\n  /* 2.5.198.73 */\n\n  var parse_PtgMemNoMem = parsenoop;\n  /* 2.5.198.87 */\n\n  var parse_PtgRefErr3d = parsenoop;\n  /* 2.5.198.92 */\n\n  var parse_PtgTbl = parsenoop;\n  /* 2.5.198.25 */\n\n  var PtgTypes = {\n    0x01: {\n      n: 'PtgExp',\n      f: parse_PtgExp\n    },\n    0x02: {\n      n: 'PtgTbl',\n      f: parse_PtgTbl\n    },\n    0x03: {\n      n: 'PtgAdd',\n      f: parse_PtgAdd\n    },\n    0x04: {\n      n: 'PtgSub',\n      f: parse_PtgSub\n    },\n    0x05: {\n      n: 'PtgMul',\n      f: parse_PtgMul\n    },\n    0x06: {\n      n: 'PtgDiv',\n      f: parse_PtgDiv\n    },\n    0x07: {\n      n: 'PtgPower',\n      f: parse_PtgPower\n    },\n    0x08: {\n      n: 'PtgConcat',\n      f: parse_PtgConcat\n    },\n    0x09: {\n      n: 'PtgLt',\n      f: parse_PtgLt\n    },\n    0x0A: {\n      n: 'PtgLe',\n      f: parse_PtgLe\n    },\n    0x0B: {\n      n: 'PtgEq',\n      f: parse_PtgEq\n    },\n    0x0C: {\n      n: 'PtgGe',\n      f: parse_PtgGe\n    },\n    0x0D: {\n      n: 'PtgGt',\n      f: parse_PtgGt\n    },\n    0x0E: {\n      n: 'PtgNe',\n      f: parse_PtgNe\n    },\n    0x0F: {\n      n: 'PtgIsect',\n      f: parse_PtgIsect\n    },\n    0x10: {\n      n: 'PtgUnion',\n      f: parse_PtgUnion\n    },\n    0x11: {\n      n: 'PtgRange',\n      f: parse_PtgRange\n    },\n    0x12: {\n      n: 'PtgUplus',\n      f: parse_PtgUplus\n    },\n    0x13: {\n      n: 'PtgUminus',\n      f: parse_PtgUminus\n    },\n    0x14: {\n      n: 'PtgPercent',\n      f: parse_PtgPercent\n    },\n    0x15: {\n      n: 'PtgParen',\n      f: parse_PtgParen\n    },\n    0x16: {\n      n: 'PtgMissArg',\n      f: parse_PtgMissArg\n    },\n    0x17: {\n      n: 'PtgStr',\n      f: parse_PtgStr\n    },\n    0x1C: {\n      n: 'PtgErr',\n      f: parse_PtgErr\n    },\n    0x1D: {\n      n: 'PtgBool',\n      f: parse_PtgBool\n    },\n    0x1E: {\n      n: 'PtgInt',\n      f: parse_PtgInt\n    },\n    0x1F: {\n      n: 'PtgNum',\n      f: parse_PtgNum\n    },\n    0x20: {\n      n: 'PtgArray',\n      f: parse_PtgArray\n    },\n    0x21: {\n      n: 'PtgFunc',\n      f: parse_PtgFunc\n    },\n    0x22: {\n      n: 'PtgFuncVar',\n      f: parse_PtgFuncVar\n    },\n    0x23: {\n      n: 'PtgName',\n      f: parse_PtgName\n    },\n    0x24: {\n      n: 'PtgRef',\n      f: parse_PtgRef\n    },\n    0x25: {\n      n: 'PtgArea',\n      f: parse_PtgArea\n    },\n    0x26: {\n      n: 'PtgMemArea',\n      f: parse_PtgMemArea\n    },\n    0x27: {\n      n: 'PtgMemErr',\n      f: parse_PtgMemErr\n    },\n    0x28: {\n      n: 'PtgMemNoMem',\n      f: parse_PtgMemNoMem\n    },\n    0x29: {\n      n: 'PtgMemFunc',\n      f: parse_PtgMemFunc\n    },\n    0x2A: {\n      n: 'PtgRefErr',\n      f: parse_PtgRefErr\n    },\n    0x2B: {\n      n: 'PtgAreaErr',\n      f: parse_PtgAreaErr\n    },\n    0x2C: {\n      n: 'PtgRefN',\n      f: parse_PtgRefN\n    },\n    0x2D: {\n      n: 'PtgAreaN',\n      f: parse_PtgAreaN\n    },\n    0x39: {\n      n: 'PtgNameX',\n      f: parse_PtgNameX\n    },\n    0x3A: {\n      n: 'PtgRef3d',\n      f: parse_PtgRef3d\n    },\n    0x3B: {\n      n: 'PtgArea3d',\n      f: parse_PtgArea3d\n    },\n    0x3C: {\n      n: 'PtgRefErr3d',\n      f: parse_PtgRefErr3d\n    },\n    0x3D: {\n      n: 'PtgAreaErr3d',\n      f: parse_PtgAreaErr3d\n    },\n    0xFF: {}\n  };\n  /* These are duplicated in the PtgTypes table */\n\n  var PtgDupes = {\n    0x40: 0x20,\n    0x60: 0x20,\n    0x41: 0x21,\n    0x61: 0x21,\n    0x42: 0x22,\n    0x62: 0x22,\n    0x43: 0x23,\n    0x63: 0x23,\n    0x44: 0x24,\n    0x64: 0x24,\n    0x45: 0x25,\n    0x65: 0x25,\n    0x46: 0x26,\n    0x66: 0x26,\n    0x47: 0x27,\n    0x67: 0x27,\n    0x48: 0x28,\n    0x68: 0x28,\n    0x49: 0x29,\n    0x69: 0x29,\n    0x4A: 0x2A,\n    0x6A: 0x2A,\n    0x4B: 0x2B,\n    0x6B: 0x2B,\n    0x4C: 0x2C,\n    0x6C: 0x2C,\n    0x4D: 0x2D,\n    0x6D: 0x2D,\n    0x59: 0x39,\n    0x79: 0x39,\n    0x5A: 0x3A,\n    0x7A: 0x3A,\n    0x5B: 0x3B,\n    0x7B: 0x3B,\n    0x5C: 0x3C,\n    0x7C: 0x3C,\n    0x5D: 0x3D,\n    0x7D: 0x3D\n  };\n\n  (function () {\n    for (var y in PtgDupes) {\n      PtgTypes[y] = PtgTypes[PtgDupes[y]];\n    }\n  })();\n\n  var Ptg18 = {};\n  var Ptg19 = {\n    0x01: {\n      n: 'PtgAttrSemi',\n      f: parse_PtgAttrSemi\n    },\n    0x02: {\n      n: 'PtgAttrIf',\n      f: parse_PtgAttrIf\n    },\n    0x04: {\n      n: 'PtgAttrChoose',\n      f: parse_PtgAttrChoose\n    },\n    0x08: {\n      n: 'PtgAttrGoto',\n      f: parse_PtgAttrGoto\n    },\n    0x10: {\n      n: 'PtgAttrSum',\n      f: parse_PtgAttrSum\n    },\n    0x20: {\n      n: 'PtgAttrBaxcel',\n      f: parse_PtgAttrBaxcel\n    },\n    0x40: {\n      n: 'PtgAttrSpace',\n      f: parse_PtgAttrSpace\n    },\n    0x41: {\n      n: 'PtgAttrSpaceSemi',\n      f: parse_PtgAttrSpaceSemi\n    },\n    0xFF: {}\n  };\n  /* 2.4.127 TODO */\n\n  function parse_Formula(blob, length, opts) {\n    var cell = parse_XLSCell(blob, 6);\n    var val = parse_FormulaValue(blob, 8);\n    var flags = blob.read_shift(1);\n    blob.read_shift(1);\n    var chn = blob.read_shift(4);\n    var cbf = \"\";\n    if (opts.biff === 5) blob.l += length - 20;else cbf = parse_XLSCellParsedFormula(blob, length - 20, opts);\n    return {\n      cell: cell,\n      val: val[0],\n      formula: cbf,\n      shared: flags >> 3 & 1,\n      tt: val[1]\n    };\n  }\n  /* 2.5.133 TODO: how to emit empty strings? */\n\n\n  function parse_FormulaValue(blob) {\n    var b;\n    if (__readUInt16LE(blob, blob.l + 6) !== 0xFFFF) return [parse_Xnum(blob), 'n'];\n\n    switch (blob[blob.l]) {\n      case 0x00:\n        blob.l += 8;\n        return [\"String\", 's'];\n\n      case 0x01:\n        b = blob[blob.l + 2] === 0x1;\n        blob.l += 8;\n        return [b, 'b'];\n\n      case 0x02:\n        b = blob[blob.l + 2];\n        blob.l += 8;\n        return [b, 'e'];\n\n      case 0x03:\n        blob.l += 8;\n        return [\"\", 's'];\n    }\n  }\n  /* 2.5.198.103 */\n\n\n  function parse_RgbExtra(blob, length, rgce, opts) {\n    if (opts.biff < 8) return parsenoop(blob, length);\n    var target = blob.l + length;\n    var o = [];\n\n    for (var i = 0; i !== rgce.length; ++i) {\n      switch (rgce[i][0]) {\n        case 'PtgArray':\n          /* PtgArray -> PtgExtraArray */\n          rgce[i][1] = parse_PtgExtraArray(blob);\n          o.push(rgce[i][1]);\n          break;\n\n        case 'PtgMemArea':\n          /* PtgMemArea -> PtgExtraMem */\n          rgce[i][2] = parse_PtgExtraMem(blob, rgce[i][1]);\n          o.push(rgce[i][2]);\n          break;\n\n        default:\n          break;\n      }\n    }\n\n    length = target - blob.l;\n    if (length !== 0) o.push(parsenoop(blob, length));\n    return o;\n  }\n  /* 2.5.198.21 */\n\n\n  function parse_NameParsedFormula(blob, length, opts, cce) {\n    var target = blob.l + length;\n    var rgce = parse_Rgce(blob, cce);\n    var rgcb;\n    if (target !== blob.l) rgcb = parse_RgbExtra(blob, target - blob.l, rgce, opts);\n    return [rgce, rgcb];\n  }\n  /* 2.5.198.3 TODO */\n\n\n  function parse_XLSCellParsedFormula(blob, length, opts) {\n    var target = blob.l + length;\n    var rgcb,\n        cce = blob.read_shift(2); // length of rgce\n\n    if (cce == 0xFFFF) return [[], parsenoop(blob, length - 2)];\n    var rgce = parse_Rgce(blob, cce);\n    if (length !== cce + 2) rgcb = parse_RgbExtra(blob, length - cce - 2, rgce, opts);\n    return [rgce, rgcb];\n  }\n  /* 2.5.198.118 TODO */\n\n\n  function parse_SharedParsedFormula(blob, length, opts) {\n    var target = blob.l + length;\n    var rgcb,\n        cce = blob.read_shift(2); // length of rgce\n\n    var rgce = parse_Rgce(blob, cce);\n    if (cce == 0xFFFF) return [[], parsenoop(blob, length - 2)];\n    if (length !== cce + 2) rgcb = parse_RgbExtra(blob, target - cce - 2, rgce, opts);\n    return [rgce, rgcb];\n  }\n  /* 2.5.198.1 TODO */\n\n\n  function parse_ArrayParsedFormula(blob, length, opts, ref) {\n    var target = blob.l + length;\n    var rgcb,\n        cce = blob.read_shift(2); // length of rgce\n\n    if (cce == 0xFFFF) return [[], parsenoop(blob, length - 2)];\n    var rgce = parse_Rgce(blob, cce);\n    if (length !== cce + 2) rgcb = parse_RgbExtra(blob, target - cce - 2, rgce, opts);\n    return [rgce, rgcb];\n  }\n  /* 2.5.198.104 */\n\n\n  function parse_Rgce(blob, length) {\n    var target = blob.l + length;\n    var R,\n        id,\n        ptgs = [];\n\n    while (target != blob.l) {\n      length = target - blob.l;\n      id = blob[blob.l];\n      R = PtgTypes[id]; //console.log(\"ptg\", id, R)\n\n      if (id === 0x18 || id === 0x19) {\n        id = blob[blob.l + 1];\n        R = (id === 0x18 ? Ptg18 : Ptg19)[id];\n      }\n\n      if (!R || !R.f) {\n        ptgs.push(parsenoop(blob, length));\n      } else {\n        ptgs.push([R.n, R.f(blob, length)]);\n      }\n    }\n\n    return ptgs;\n  }\n\n  function mapper(x) {\n    return x.map(function f2(y) {\n      return y[1];\n    }).join(\",\");\n  }\n  /* 2.2.2 + Magic TODO */\n\n\n  function stringify_formula(formula, range, cell, supbooks, opts) {\n    if (opts !== undefined && opts.biff === 5) return \"BIFF5??\";\n\n    var _range = range !== undefined ? range : {\n      s: {\n        c: 0,\n        r: 0\n      }\n    };\n\n    var stack = [],\n        e1,\n        e2,\n        type,\n        c,\n        ixti,\n        nameidx,\n        r;\n    if (!formula[0] || !formula[0][0]) return \"\"; //console.log(\"--\",cell,formula[0])\n\n    for (var ff = 0, fflen = formula[0].length; ff < fflen; ++ff) {\n      var f = formula[0][ff]; //console.log(\"++\",f, stack)\n\n      switch (f[0]) {\n        /* 2.2.2.1 Unary Operator Tokens */\n\n        /* 2.5.198.93 */\n        case 'PtgUminus':\n          stack.push(\"-\" + stack.pop());\n          break;\n\n        /* 2.5.198.95 */\n\n        case 'PtgUplus':\n          stack.push(\"+\" + stack.pop());\n          break;\n\n        /* 2.5.198.81 */\n\n        case 'PtgPercent':\n          stack.push(stack.pop() + \"%\");\n          break;\n\n        /* 2.2.2.1 Binary Value Operator Token */\n\n        /* 2.5.198.26 */\n\n        case 'PtgAdd':\n          e1 = stack.pop();\n          e2 = stack.pop();\n          stack.push(e2 + \"+\" + e1);\n          break;\n\n        /* 2.5.198.90 */\n\n        case 'PtgSub':\n          e1 = stack.pop();\n          e2 = stack.pop();\n          stack.push(e2 + \"-\" + e1);\n          break;\n\n        /* 2.5.198.75 */\n\n        case 'PtgMul':\n          e1 = stack.pop();\n          e2 = stack.pop();\n          stack.push(e2 + \"*\" + e1);\n          break;\n\n        /* 2.5.198.45 */\n\n        case 'PtgDiv':\n          e1 = stack.pop();\n          e2 = stack.pop();\n          stack.push(e2 + \"/\" + e1);\n          break;\n\n        /* 2.5.198.82 */\n\n        case 'PtgPower':\n          e1 = stack.pop();\n          e2 = stack.pop();\n          stack.push(e2 + \"^\" + e1);\n          break;\n\n        /* 2.5.198.43 */\n\n        case 'PtgConcat':\n          e1 = stack.pop();\n          e2 = stack.pop();\n          stack.push(e2 + \"&\" + e1);\n          break;\n\n        /* 2.5.198.69 */\n\n        case 'PtgLt':\n          e1 = stack.pop();\n          e2 = stack.pop();\n          stack.push(e2 + \"<\" + e1);\n          break;\n\n        /* 2.5.198.68 */\n\n        case 'PtgLe':\n          e1 = stack.pop();\n          e2 = stack.pop();\n          stack.push(e2 + \"<=\" + e1);\n          break;\n\n        /* 2.5.198.56 */\n\n        case 'PtgEq':\n          e1 = stack.pop();\n          e2 = stack.pop();\n          stack.push(e2 + \"=\" + e1);\n          break;\n\n        /* 2.5.198.64 */\n\n        case 'PtgGe':\n          e1 = stack.pop();\n          e2 = stack.pop();\n          stack.push(e2 + \">=\" + e1);\n          break;\n\n        /* 2.5.198.65 */\n\n        case 'PtgGt':\n          e1 = stack.pop();\n          e2 = stack.pop();\n          stack.push(e2 + \">\" + e1);\n          break;\n\n        /* 2.5.198.78 */\n\n        case 'PtgNe':\n          e1 = stack.pop();\n          e2 = stack.pop();\n          stack.push(e2 + \"<>\" + e1);\n          break;\n\n        /* 2.2.2.1 Binary Reference Operator Token */\n\n        /* 2.5.198.67 */\n\n        case 'PtgIsect':\n          e1 = stack.pop();\n          e2 = stack.pop();\n          stack.push(e2 + \" \" + e1);\n          break;\n\n        case 'PtgUnion':\n          e1 = stack.pop();\n          e2 = stack.pop();\n          stack.push(e2 + \",\" + e1);\n          break;\n\n        case 'PtgRange':\n          break;\n\n        /* 2.2.2.3 Control Tokens \"can be ignored\" */\n\n        /* 2.5.198.34 */\n\n        case 'PtgAttrChoose':\n          break;\n\n        /* 2.5.198.35 */\n\n        case 'PtgAttrGoto':\n          break;\n\n        /* 2.5.198.36 */\n\n        case 'PtgAttrIf':\n          break;\n\n        /* 2.5.198.84 */\n\n        case 'PtgRef':\n          type = f[1][0];\n          c = shift_cell_xls(decode_cell(encode_cell(f[1][1])), _range);\n          stack.push(encode_cell(c));\n          break;\n\n        /* 2.5.198.88 */\n\n        case 'PtgRefN':\n          type = f[1][0];\n          c = shift_cell_xls(decode_cell(encode_cell(f[1][1])), cell);\n          stack.push(encode_cell(c));\n          break;\n\n        case 'PtgRef3d':\n          // TODO: lots of stuff\n          type = f[1][0];\n          ixti = f[1][1];\n          c = shift_cell_xls(f[1][2], _range);\n          stack.push(supbooks[1][ixti + 1] + \"!\" + encode_cell(c));\n          break;\n\n        /* Function Call */\n\n        /* 2.5.198.62 */\n\n        case 'PtgFunc':\n        /* 2.5.198.63 */\n\n        case 'PtgFuncVar':\n          /* f[1] = [argc, func] */\n          var argc = f[1][0],\n              func = f[1][1];\n          if (!argc) argc = 0;\n          var args = stack.slice(-argc);\n          stack.length -= argc;\n          if (func === 'User') func = args.shift();\n          stack.push(func + \"(\" + args.join(\",\") + \")\");\n          break;\n\n        /* 2.5.198.42 */\n\n        case 'PtgBool':\n          stack.push(f[1] ? \"TRUE\" : \"FALSE\");\n          break;\n\n        /* 2.5.198.66 */\n\n        case 'PtgInt':\n          stack.push(f[1]);\n          break;\n\n        /* 2.5.198.79 TODO: precision? */\n\n        case 'PtgNum':\n          stack.push(String(f[1]));\n          break;\n\n        /* 2.5.198.89 */\n\n        case 'PtgStr':\n          stack.push('\"' + f[1] + '\"');\n          break;\n\n        /* 2.5.198.57 */\n\n        case 'PtgErr':\n          stack.push(f[1]);\n          break;\n\n        /* 2.5.198.27 TODO: fixed points */\n\n        case 'PtgArea':\n          type = f[1][0];\n          r = shift_range_xls(f[1][1], _range);\n          stack.push(encode_range(r));\n          break;\n\n        /* 2.5.198.28 */\n\n        case 'PtgArea3d':\n          // TODO: lots of stuff\n          type = f[1][0];\n          ixti = f[1][1];\n          r = f[1][2];\n          stack.push(supbooks[1][ixti + 1] + \"!\" + encode_range(r));\n          break;\n\n        /* 2.5.198.41 */\n\n        case 'PtgAttrSum':\n          stack.push(\"SUM(\" + stack.pop() + \")\");\n          break;\n\n        /* Expression Prefixes */\n\n        /* 2.5.198.37 */\n\n        case 'PtgAttrSemi':\n          break;\n\n        /* 2.5.97.60 TODO: do something different for revisions */\n\n        case 'PtgName':\n          /* f[1] = type, 0, nameindex */\n          nameidx = f[1][2];\n          var lbl = supbooks[0][nameidx];\n          var name = lbl.Name;\n          if (name in XLSXFutureFunctions) name = XLSXFutureFunctions[name];\n          stack.push(name);\n          break;\n\n        /* 2.5.97.61 TODO: do something different for revisions */\n\n        case 'PtgNameX':\n          /* f[1] = type, ixti, nameindex */\n          var bookidx = f[1][1];\n          nameidx = f[1][2];\n          var externbook;\n          /* TODO: Properly handle missing values */\n\n          if (supbooks[bookidx + 1]) externbook = supbooks[bookidx + 1][nameidx];else if (supbooks[bookidx - 1]) externbook = supbooks[bookidx - 1][nameidx];\n          if (!externbook) externbook = {\n            body: \"??NAMEX??\"\n          };\n          stack.push(externbook.body);\n          break;\n\n        /* 2.2.2.4 Display Tokens */\n\n        /* 2.5.198.80 */\n\n        case 'PtgParen':\n          stack.push('(' + stack.pop() + ')');\n          break;\n\n        /* 2.5.198.86 */\n\n        case 'PtgRefErr':\n          stack.push('#REF!');\n          break;\n\n        /* */\n\n        /* 2.5.198.58 TODO */\n\n        case 'PtgExp':\n          c = {\n            c: f[1][1],\n            r: f[1][0]\n          };\n          var q = {\n            c: cell.c,\n            r: cell.r\n          };\n\n          if (supbooks.sharedf[encode_cell(c)]) {\n            var parsedf = supbooks.sharedf[encode_cell(c)];\n            stack.push(stringify_formula(parsedf, _range, q, supbooks, opts));\n          } else {\n            var fnd = false;\n\n            for (e1 = 0; e1 != supbooks.arrayf.length; ++e1) {\n              /* TODO: should be something like range_has */\n              e2 = supbooks.arrayf[e1];\n              if (c.c < e2[0].s.c || c.c > e2[0].e.c) continue;\n              if (c.r < e2[0].s.r || c.r > e2[0].e.r) continue;\n              stack.push(stringify_formula(e2[1], _range, q, supbooks, opts));\n            }\n\n            if (!fnd) stack.push(f[1]);\n          }\n\n          break;\n\n        /* 2.5.198.32 TODO */\n\n        case 'PtgArray':\n          stack.push(\"{\" + f[1].map(mapper).join(\";\") + \"}\");\n          break;\n\n        /* 2.2.2.5 Mem Tokens */\n\n        /* 2.5.198.70 TODO: confirm this is a non-display */\n\n        case 'PtgMemArea':\n          //stack.push(\"(\" + f[2].map(encode_range).join(\",\") + \")\");\n          break;\n\n        /* 2.5.198.38 TODO */\n\n        case 'PtgAttrSpace':\n          break;\n\n        /* 2.5.198.92 TODO */\n\n        case 'PtgTbl':\n          break;\n\n        /* 2.5.198.71 */\n\n        case 'PtgMemErr':\n          break;\n\n        /* 2.5.198.74 */\n\n        case 'PtgMissArg':\n          stack.push(\"\");\n          break;\n\n        /* 2.5.198.29 TODO */\n\n        case 'PtgAreaErr':\n          break;\n\n        /* 2.5.198.31 TODO */\n\n        case 'PtgAreaN':\n          stack.push(\"\");\n          break;\n\n        /* 2.5.198.87 TODO */\n\n        case 'PtgRefErr3d':\n          break;\n\n        /* 2.5.198.72 TODO */\n\n        case 'PtgMemFunc':\n          break;\n\n        default:\n          throw 'Unrecognized Formula Token: ' + f;\n      } //console.log(\"::\",f, stack)\n\n    } //console.log(\"--\",stack);\n\n\n    return stack[0];\n  }\n  /* [MS-XLSB] 2.5.97.4 CellParsedFormula TODO: use similar logic to js-xls */\n\n\n  function parse_XLSBCellParsedFormula(data, length) {\n    var cce = data.read_shift(4);\n    return parsenoop(data, length - 4);\n  }\n  /* [MS-XLS] 2.5.198.44 */\n\n\n  var PtgDataType = {\n    0x1: \"REFERENCE\",\n    // reference to range\n    0x2: \"VALUE\",\n    // single value\n    0x3: \"ARRAY\" // array of values\n\n  };\n  /* [MS-XLS] 2.5.198.4 */\n\n  var Cetab = {\n    0x0000: 'BEEP',\n    0x0001: 'OPEN',\n    0x0002: 'OPEN.LINKS',\n    0x0003: 'CLOSE.ALL',\n    0x0004: 'SAVE',\n    0x0005: 'SAVE.AS',\n    0x0006: 'FILE.DELETE',\n    0x0007: 'PAGE.SETUP',\n    0x0008: 'PRINT',\n    0x0009: 'PRINTER.SETUP',\n    0x000A: 'QUIT',\n    0x000B: 'NEW.WINDOW',\n    0x000C: 'ARRANGE.ALL',\n    0x000D: 'WINDOW.SIZE',\n    0x000E: 'WINDOW.MOVE',\n    0x000F: 'FULL',\n    0x0010: 'CLOSE',\n    0x0011: 'RUN',\n    0x0016: 'SET.PRINT.AREA',\n    0x0017: 'SET.PRINT.TITLES',\n    0x0018: 'SET.PAGE.BREAK',\n    0x0019: 'REMOVE.PAGE.BREAK',\n    0x001A: 'FONT',\n    0x001B: 'DISPLAY',\n    0x001C: 'PROTECT.DOCUMENT',\n    0x001D: 'PRECISION',\n    0x001E: 'A1.R1C1',\n    0x001F: 'CALCULATE.NOW',\n    0x0020: 'CALCULATION',\n    0x0022: 'DATA.FIND',\n    0x0023: 'EXTRACT',\n    0x0024: 'DATA.DELETE',\n    0x0025: 'SET.DATABASE',\n    0x0026: 'SET.CRITERIA',\n    0x0027: 'SORT',\n    0x0028: 'DATA.SERIES',\n    0x0029: 'TABLE',\n    0x002A: 'FORMAT.NUMBER',\n    0x002B: 'ALIGNMENT',\n    0x002C: 'STYLE',\n    0x002D: 'BORDER',\n    0x002E: 'CELL.PROTECTION',\n    0x002F: 'COLUMN.WIDTH',\n    0x0030: 'UNDO',\n    0x0031: 'CUT',\n    0x0032: 'COPY',\n    0x0033: 'PASTE',\n    0x0034: 'CLEAR',\n    0x0035: 'PASTE.SPECIAL',\n    0x0036: 'EDIT.DELETE',\n    0x0037: 'INSERT',\n    0x0038: 'FILL.RIGHT',\n    0x0039: 'FILL.DOWN',\n    0x003D: 'DEFINE.NAME',\n    0x003E: 'CREATE.NAMES',\n    0x003F: 'FORMULA.GOTO',\n    0x0040: 'FORMULA.FIND',\n    0x0041: 'SELECT.LAST.CELL',\n    0x0042: 'SHOW.ACTIVE.CELL',\n    0x0043: 'GALLERY.AREA',\n    0x0044: 'GALLERY.BAR',\n    0x0045: 'GALLERY.COLUMN',\n    0x0046: 'GALLERY.LINE',\n    0x0047: 'GALLERY.PIE',\n    0x0048: 'GALLERY.SCATTER',\n    0x0049: 'COMBINATION',\n    0x004A: 'PREFERRED',\n    0x004B: 'ADD.OVERLAY',\n    0x004C: 'GRIDLINES',\n    0x004D: 'SET.PREFERRED',\n    0x004E: 'AXES',\n    0x004F: 'LEGEND',\n    0x0050: 'ATTACH.TEXT',\n    0x0051: 'ADD.ARROW',\n    0x0052: 'SELECT.CHART',\n    0x0053: 'SELECT.PLOT.AREA',\n    0x0054: 'PATTERNS',\n    0x0055: 'MAIN.CHART',\n    0x0056: 'OVERLAY',\n    0x0057: 'SCALE',\n    0x0058: 'FORMAT.LEGEND',\n    0x0059: 'FORMAT.TEXT',\n    0x005A: 'EDIT.REPEAT',\n    0x005B: 'PARSE',\n    0x005C: 'JUSTIFY',\n    0x005D: 'HIDE',\n    0x005E: 'UNHIDE',\n    0x005F: 'WORKSPACE',\n    0x0060: 'FORMULA',\n    0x0061: 'FORMULA.FILL',\n    0x0062: 'FORMULA.ARRAY',\n    0x0063: 'DATA.FIND.NEXT',\n    0x0064: 'DATA.FIND.PREV',\n    0x0065: 'FORMULA.FIND.NEXT',\n    0x0066: 'FORMULA.FIND.PREV',\n    0x0067: 'ACTIVATE',\n    0x0068: 'ACTIVATE.NEXT',\n    0x0069: 'ACTIVATE.PREV',\n    0x006A: 'UNLOCKED.NEXT',\n    0x006B: 'UNLOCKED.PREV',\n    0x006C: 'COPY.PICTURE',\n    0x006D: 'SELECT',\n    0x006E: 'DELETE.NAME',\n    0x006F: 'DELETE.FORMAT',\n    0x0070: 'VLINE',\n    0x0071: 'HLINE',\n    0x0072: 'VPAGE',\n    0x0073: 'HPAGE',\n    0x0074: 'VSCROLL',\n    0x0075: 'HSCROLL',\n    0x0076: 'ALERT',\n    0x0077: 'NEW',\n    0x0078: 'CANCEL.COPY',\n    0x0079: 'SHOW.CLIPBOARD',\n    0x007A: 'MESSAGE',\n    0x007C: 'PASTE.LINK',\n    0x007D: 'APP.ACTIVATE',\n    0x007E: 'DELETE.ARROW',\n    0x007F: 'ROW.HEIGHT',\n    0x0080: 'FORMAT.MOVE',\n    0x0081: 'FORMAT.SIZE',\n    0x0082: 'FORMULA.REPLACE',\n    0x0083: 'SEND.KEYS',\n    0x0084: 'SELECT.SPECIAL',\n    0x0085: 'APPLY.NAMES',\n    0x0086: 'REPLACE.FONT',\n    0x0087: 'FREEZE.PANES',\n    0x0088: 'SHOW.INFO',\n    0x0089: 'SPLIT',\n    0x008A: 'ON.WINDOW',\n    0x008B: 'ON.DATA',\n    0x008C: 'DISABLE.INPUT',\n    0x008E: 'OUTLINE',\n    0x008F: 'LIST.NAMES',\n    0x0090: 'FILE.CLOSE',\n    0x0091: 'SAVE.WORKBOOK',\n    0x0092: 'DATA.FORM',\n    0x0093: 'COPY.CHART',\n    0x0094: 'ON.TIME',\n    0x0095: 'WAIT',\n    0x0096: 'FORMAT.FONT',\n    0x0097: 'FILL.UP',\n    0x0098: 'FILL.LEFT',\n    0x0099: 'DELETE.OVERLAY',\n    0x009B: 'SHORT.MENUS',\n    0x009F: 'SET.UPDATE.STATUS',\n    0x00A1: 'COLOR.PALETTE',\n    0x00A2: 'DELETE.STYLE',\n    0x00A3: 'WINDOW.RESTORE',\n    0x00A4: 'WINDOW.MAXIMIZE',\n    0x00A6: 'CHANGE.LINK',\n    0x00A7: 'CALCULATE.DOCUMENT',\n    0x00A8: 'ON.KEY',\n    0x00A9: 'APP.RESTORE',\n    0x00AA: 'APP.MOVE',\n    0x00AB: 'APP.SIZE',\n    0x00AC: 'APP.MINIMIZE',\n    0x00AD: 'APP.MAXIMIZE',\n    0x00AE: 'BRING.TO.FRONT',\n    0x00AF: 'SEND.TO.BACK',\n    0x00B9: 'MAIN.CHART.TYPE',\n    0x00BA: 'OVERLAY.CHART.TYPE',\n    0x00BB: 'SELECT.END',\n    0x00BC: 'OPEN.MAIL',\n    0x00BD: 'SEND.MAIL',\n    0x00BE: 'STANDARD.FONT',\n    0x00BF: 'CONSOLIDATE',\n    0x00C0: 'SORT.SPECIAL',\n    0x00C1: 'GALLERY.3D.AREA',\n    0x00C2: 'GALLERY.3D.COLUMN',\n    0x00C3: 'GALLERY.3D.LINE',\n    0x00C4: 'GALLERY.3D.PIE',\n    0x00C5: 'VIEW.3D',\n    0x00C6: 'GOAL.SEEK',\n    0x00C7: 'WORKGROUP',\n    0x00C8: 'FILL.GROUP',\n    0x00C9: 'UPDATE.LINK',\n    0x00CA: 'PROMOTE',\n    0x00CB: 'DEMOTE',\n    0x00CC: 'SHOW.DETAIL',\n    0x00CE: 'UNGROUP',\n    0x00CF: 'OBJECT.PROPERTIES',\n    0x00D0: 'SAVE.NEW.OBJECT',\n    0x00D1: 'SHARE',\n    0x00D2: 'SHARE.NAME',\n    0x00D3: 'DUPLICATE',\n    0x00D4: 'APPLY.STYLE',\n    0x00D5: 'ASSIGN.TO.OBJECT',\n    0x00D6: 'OBJECT.PROTECTION',\n    0x00D7: 'HIDE.OBJECT',\n    0x00D8: 'SET.EXTRACT',\n    0x00D9: 'CREATE.PUBLISHER',\n    0x00DA: 'SUBSCRIBE.TO',\n    0x00DB: 'ATTRIBUTES',\n    0x00DC: 'SHOW.TOOLBAR',\n    0x00DE: 'PRINT.PREVIEW',\n    0x00DF: 'EDIT.COLOR',\n    0x00E0: 'SHOW.LEVELS',\n    0x00E1: 'FORMAT.MAIN',\n    0x00E2: 'FORMAT.OVERLAY',\n    0x00E3: 'ON.RECALC',\n    0x00E4: 'EDIT.SERIES',\n    0x00E5: 'DEFINE.STYLE',\n    0x00F0: 'LINE.PRINT',\n    0x00F3: 'ENTER.DATA',\n    0x00F9: 'GALLERY.RADAR',\n    0x00FA: 'MERGE.STYLES',\n    0x00FB: 'EDITION.OPTIONS',\n    0x00FC: 'PASTE.PICTURE',\n    0x00FD: 'PASTE.PICTURE.LINK',\n    0x00FE: 'SPELLING',\n    0x0100: 'ZOOM',\n    0x0103: 'INSERT.OBJECT',\n    0x0104: 'WINDOW.MINIMIZE',\n    0x0109: 'SOUND.NOTE',\n    0x010A: 'SOUND.PLAY',\n    0x010B: 'FORMAT.SHAPE',\n    0x010C: 'EXTEND.POLYGON',\n    0x010D: 'FORMAT.AUTO',\n    0x0110: 'GALLERY.3D.BAR',\n    0x0111: 'GALLERY.3D.SURFACE',\n    0x0112: 'FILL.AUTO',\n    0x0114: 'CUSTOMIZE.TOOLBAR',\n    0x0115: 'ADD.TOOL',\n    0x0116: 'EDIT.OBJECT',\n    0x0117: 'ON.DOUBLECLICK',\n    0x0118: 'ON.ENTRY',\n    0x0119: 'WORKBOOK.ADD',\n    0x011A: 'WORKBOOK.MOVE',\n    0x011B: 'WORKBOOK.COPY',\n    0x011C: 'WORKBOOK.OPTIONS',\n    0x011D: 'SAVE.WORKSPACE',\n    0x0120: 'CHART.WIZARD',\n    0x0121: 'DELETE.TOOL',\n    0x0122: 'MOVE.TOOL',\n    0x0123: 'WORKBOOK.SELECT',\n    0x0124: 'WORKBOOK.ACTIVATE',\n    0x0125: 'ASSIGN.TO.TOOL',\n    0x0127: 'COPY.TOOL',\n    0x0128: 'RESET.TOOL',\n    0x0129: 'CONSTRAIN.NUMERIC',\n    0x012A: 'PASTE.TOOL',\n    0x012E: 'WORKBOOK.NEW',\n    0x0131: 'SCENARIO.CELLS',\n    0x0132: 'SCENARIO.DELETE',\n    0x0133: 'SCENARIO.ADD',\n    0x0134: 'SCENARIO.EDIT',\n    0x0135: 'SCENARIO.SHOW',\n    0x0136: 'SCENARIO.SHOW.NEXT',\n    0x0137: 'SCENARIO.SUMMARY',\n    0x0138: 'PIVOT.TABLE.WIZARD',\n    0x0139: 'PIVOT.FIELD.PROPERTIES',\n    0x013A: 'PIVOT.FIELD',\n    0x013B: 'PIVOT.ITEM',\n    0x013C: 'PIVOT.ADD.FIELDS',\n    0x013E: 'OPTIONS.CALCULATION',\n    0x013F: 'OPTIONS.EDIT',\n    0x0140: 'OPTIONS.VIEW',\n    0x0141: 'ADDIN.MANAGER',\n    0x0142: 'MENU.EDITOR',\n    0x0143: 'ATTACH.TOOLBARS',\n    0x0144: 'VBAActivate',\n    0x0145: 'OPTIONS.CHART',\n    0x0148: 'VBA.INSERT.FILE',\n    0x014A: 'VBA.PROCEDURE.DEFINITION',\n    0x0150: 'ROUTING.SLIP',\n    0x0152: 'ROUTE.DOCUMENT',\n    0x0153: 'MAIL.LOGON',\n    0x0156: 'INSERT.PICTURE',\n    0x0157: 'EDIT.TOOL',\n    0x0158: 'GALLERY.DOUGHNUT',\n    0x015E: 'CHART.TREND',\n    0x0160: 'PIVOT.ITEM.PROPERTIES',\n    0x0162: 'WORKBOOK.INSERT',\n    0x0163: 'OPTIONS.TRANSITION',\n    0x0164: 'OPTIONS.GENERAL',\n    0x0172: 'FILTER.ADVANCED',\n    0x0175: 'MAIL.ADD.MAILER',\n    0x0176: 'MAIL.DELETE.MAILER',\n    0x0177: 'MAIL.REPLY',\n    0x0178: 'MAIL.REPLY.ALL',\n    0x0179: 'MAIL.FORWARD',\n    0x017A: 'MAIL.NEXT.LETTER',\n    0x017B: 'DATA.LABEL',\n    0x017C: 'INSERT.TITLE',\n    0x017D: 'FONT.PROPERTIES',\n    0x017E: 'MACRO.OPTIONS',\n    0x017F: 'WORKBOOK.HIDE',\n    0x0180: 'WORKBOOK.UNHIDE',\n    0x0181: 'WORKBOOK.DELETE',\n    0x0182: 'WORKBOOK.NAME',\n    0x0184: 'GALLERY.CUSTOM',\n    0x0186: 'ADD.CHART.AUTOFORMAT',\n    0x0187: 'DELETE.CHART.AUTOFORMAT',\n    0x0188: 'CHART.ADD.DATA',\n    0x0189: 'AUTO.OUTLINE',\n    0x018A: 'TAB.ORDER',\n    0x018B: 'SHOW.DIALOG',\n    0x018C: 'SELECT.ALL',\n    0x018D: 'UNGROUP.SHEETS',\n    0x018E: 'SUBTOTAL.CREATE',\n    0x018F: 'SUBTOTAL.REMOVE',\n    0x0190: 'RENAME.OBJECT',\n    0x019C: 'WORKBOOK.SCROLL',\n    0x019D: 'WORKBOOK.NEXT',\n    0x019E: 'WORKBOOK.PREV',\n    0x019F: 'WORKBOOK.TAB.SPLIT',\n    0x01A0: 'FULL.SCREEN',\n    0x01A1: 'WORKBOOK.PROTECT',\n    0x01A4: 'SCROLLBAR.PROPERTIES',\n    0x01A5: 'PIVOT.SHOW.PAGES',\n    0x01A6: 'TEXT.TO.COLUMNS',\n    0x01A7: 'FORMAT.CHARTTYPE',\n    0x01A8: 'LINK.FORMAT',\n    0x01A9: 'TRACER.DISPLAY',\n    0x01AE: 'TRACER.NAVIGATE',\n    0x01AF: 'TRACER.CLEAR',\n    0x01B0: 'TRACER.ERROR',\n    0x01B1: 'PIVOT.FIELD.GROUP',\n    0x01B2: 'PIVOT.FIELD.UNGROUP',\n    0x01B3: 'CHECKBOX.PROPERTIES',\n    0x01B4: 'LABEL.PROPERTIES',\n    0x01B5: 'LISTBOX.PROPERTIES',\n    0x01B6: 'EDITBOX.PROPERTIES',\n    0x01B7: 'PIVOT.REFRESH',\n    0x01B8: 'LINK.COMBO',\n    0x01B9: 'OPEN.TEXT',\n    0x01BA: 'HIDE.DIALOG',\n    0x01BB: 'SET.DIALOG.FOCUS',\n    0x01BC: 'ENABLE.OBJECT',\n    0x01BD: 'PUSHBUTTON.PROPERTIES',\n    0x01BE: 'SET.DIALOG.DEFAULT',\n    0x01BF: 'FILTER',\n    0x01C0: 'FILTER.SHOW.ALL',\n    0x01C1: 'CLEAR.OUTLINE',\n    0x01C2: 'FUNCTION.WIZARD',\n    0x01C3: 'ADD.LIST.ITEM',\n    0x01C4: 'SET.LIST.ITEM',\n    0x01C5: 'REMOVE.LIST.ITEM',\n    0x01C6: 'SELECT.LIST.ITEM',\n    0x01C7: 'SET.CONTROL.VALUE',\n    0x01C8: 'SAVE.COPY.AS',\n    0x01CA: 'OPTIONS.LISTS.ADD',\n    0x01CB: 'OPTIONS.LISTS.DELETE',\n    0x01CC: 'SERIES.AXES',\n    0x01CD: 'SERIES.X',\n    0x01CE: 'SERIES.Y',\n    0x01CF: 'ERRORBAR.X',\n    0x01D0: 'ERRORBAR.Y',\n    0x01D1: 'FORMAT.CHART',\n    0x01D2: 'SERIES.ORDER',\n    0x01D3: 'MAIL.LOGOFF',\n    0x01D4: 'CLEAR.ROUTING.SLIP',\n    0x01D5: 'APP.ACTIVATE.MICROSOFT',\n    0x01D6: 'MAIL.EDIT.MAILER',\n    0x01D7: 'ON.SHEET',\n    0x01D8: 'STANDARD.WIDTH',\n    0x01D9: 'SCENARIO.MERGE',\n    0x01DA: 'SUMMARY.INFO',\n    0x01DB: 'FIND.FILE',\n    0x01DC: 'ACTIVE.CELL.FONT',\n    0x01DD: 'ENABLE.TIPWIZARD',\n    0x01DE: 'VBA.MAKE.ADDIN',\n    0x01E0: 'INSERTDATATABLE',\n    0x01E1: 'WORKGROUP.OPTIONS',\n    0x01E2: 'MAIL.SEND.MAILER',\n    0x01E5: 'AUTOCORRECT',\n    0x01E9: 'POST.DOCUMENT',\n    0x01EB: 'PICKLIST',\n    0x01ED: 'VIEW.SHOW',\n    0x01EE: 'VIEW.DEFINE',\n    0x01EF: 'VIEW.DELETE',\n    0x01FD: 'SHEET.BACKGROUND',\n    0x01FE: 'INSERT.MAP.OBJECT',\n    0x01FF: 'OPTIONS.MENONO',\n    0x0205: 'MSOCHECKS',\n    0x0206: 'NORMAL',\n    0x0207: 'LAYOUT',\n    0x0208: 'RM.PRINT.AREA',\n    0x0209: 'CLEAR.PRINT.AREA',\n    0x020A: 'ADD.PRINT.AREA',\n    0x020B: 'MOVE.BRK',\n    0x0221: 'HIDECURR.NOTE',\n    0x0222: 'HIDEALL.NOTES',\n    0x0223: 'DELETE.NOTE',\n    0x0224: 'TRAVERSE.NOTES',\n    0x0225: 'ACTIVATE.NOTES',\n    0x026C: 'PROTECT.REVISIONS',\n    0x026D: 'UNPROTECT.REVISIONS',\n    0x0287: 'OPTIONS.ME',\n    0x028D: 'WEB.PUBLISH',\n    0x029B: 'NEWWEBQUERY',\n    0x02A1: 'PIVOT.TABLE.CHART',\n    0x02F1: 'OPTIONS.SAVE',\n    0x02F3: 'OPTIONS.SPELL',\n    0x0328: 'HIDEALL.INKANNOTS'\n  };\n  /* [MS-XLS] 2.5.198.17 */\n\n  var Ftab = {\n    0x0000: 'COUNT',\n    0x0001: 'IF',\n    0x0002: 'ISNA',\n    0x0003: 'ISERROR',\n    0x0004: 'SUM',\n    0x0005: 'AVERAGE',\n    0x0006: 'MIN',\n    0x0007: 'MAX',\n    0x0008: 'ROW',\n    0x0009: 'COLUMN',\n    0x000A: 'NA',\n    0x000B: 'NPV',\n    0x000C: 'STDEV',\n    0x000D: 'DOLLAR',\n    0x000E: 'FIXED',\n    0x000F: 'SIN',\n    0x0010: 'COS',\n    0x0011: 'TAN',\n    0x0012: 'ATAN',\n    0x0013: 'PI',\n    0x0014: 'SQRT',\n    0x0015: 'EXP',\n    0x0016: 'LN',\n    0x0017: 'LOG10',\n    0x0018: 'ABS',\n    0x0019: 'INT',\n    0x001A: 'SIGN',\n    0x001B: 'ROUND',\n    0x001C: 'LOOKUP',\n    0x001D: 'INDEX',\n    0x001E: 'REPT',\n    0x001F: 'MID',\n    0x0020: 'LEN',\n    0x0021: 'VALUE',\n    0x0022: 'TRUE',\n    0x0023: 'FALSE',\n    0x0024: 'AND',\n    0x0025: 'OR',\n    0x0026: 'NOT',\n    0x0027: 'MOD',\n    0x0028: 'DCOUNT',\n    0x0029: 'DSUM',\n    0x002A: 'DAVERAGE',\n    0x002B: 'DMIN',\n    0x002C: 'DMAX',\n    0x002D: 'DSTDEV',\n    0x002E: 'VAR',\n    0x002F: 'DVAR',\n    0x0030: 'TEXT',\n    0x0031: 'LINEST',\n    0x0032: 'TREND',\n    0x0033: 'LOGEST',\n    0x0034: 'GROWTH',\n    0x0035: 'GOTO',\n    0x0036: 'HALT',\n    0x0037: 'RETURN',\n    0x0038: 'PV',\n    0x0039: 'FV',\n    0x003A: 'NPER',\n    0x003B: 'PMT',\n    0x003C: 'RATE',\n    0x003D: 'MIRR',\n    0x003E: 'IRR',\n    0x003F: 'RAND',\n    0x0040: 'MATCH',\n    0x0041: 'DATE',\n    0x0042: 'TIME',\n    0x0043: 'DAY',\n    0x0044: 'MONTH',\n    0x0045: 'YEAR',\n    0x0046: 'WEEKDAY',\n    0x0047: 'HOUR',\n    0x0048: 'MINUTE',\n    0x0049: 'SECOND',\n    0x004A: 'NOW',\n    0x004B: 'AREAS',\n    0x004C: 'ROWS',\n    0x004D: 'COLUMNS',\n    0x004E: 'OFFSET',\n    0x004F: 'ABSREF',\n    0x0050: 'RELREF',\n    0x0051: 'ARGUMENT',\n    0x0052: 'SEARCH',\n    0x0053: 'TRANSPOSE',\n    0x0054: 'ERROR',\n    0x0055: 'STEP',\n    0x0056: 'TYPE',\n    0x0057: 'ECHO',\n    0x0058: 'SET.NAME',\n    0x0059: 'CALLER',\n    0x005A: 'DEREF',\n    0x005B: 'WINDOWS',\n    0x005C: 'SERIES',\n    0x005D: 'DOCUMENTS',\n    0x005E: 'ACTIVE.CELL',\n    0x005F: 'SELECTION',\n    0x0060: 'RESULT',\n    0x0061: 'ATAN2',\n    0x0062: 'ASIN',\n    0x0063: 'ACOS',\n    0x0064: 'CHOOSE',\n    0x0065: 'HLOOKUP',\n    0x0066: 'VLOOKUP',\n    0x0067: 'LINKS',\n    0x0068: 'INPUT',\n    0x0069: 'ISREF',\n    0x006A: 'GET.FORMULA',\n    0x006B: 'GET.NAME',\n    0x006C: 'SET.VALUE',\n    0x006D: 'LOG',\n    0x006E: 'EXEC',\n    0x006F: 'CHAR',\n    0x0070: 'LOWER',\n    0x0071: 'UPPER',\n    0x0072: 'PROPER',\n    0x0073: 'LEFT',\n    0x0074: 'RIGHT',\n    0x0075: 'EXACT',\n    0x0076: 'TRIM',\n    0x0077: 'REPLACE',\n    0x0078: 'SUBSTITUTE',\n    0x0079: 'CODE',\n    0x007A: 'NAMES',\n    0x007B: 'DIRECTORY',\n    0x007C: 'FIND',\n    0x007D: 'CELL',\n    0x007E: 'ISERR',\n    0x007F: 'ISTEXT',\n    0x0080: 'ISNUMBER',\n    0x0081: 'ISBLANK',\n    0x0082: 'T',\n    0x0083: 'N',\n    0x0084: 'FOPEN',\n    0x0085: 'FCLOSE',\n    0x0086: 'FSIZE',\n    0x0087: 'FREADLN',\n    0x0088: 'FREAD',\n    0x0089: 'FWRITELN',\n    0x008A: 'FWRITE',\n    0x008B: 'FPOS',\n    0x008C: 'DATEVALUE',\n    0x008D: 'TIMEVALUE',\n    0x008E: 'SLN',\n    0x008F: 'SYD',\n    0x0090: 'DDB',\n    0x0091: 'GET.DEF',\n    0x0092: 'REFTEXT',\n    0x0093: 'TEXTREF',\n    0x0094: 'INDIRECT',\n    0x0095: 'REGISTER',\n    0x0096: 'CALL',\n    0x0097: 'ADD.BAR',\n    0x0098: 'ADD.MENU',\n    0x0099: 'ADD.COMMAND',\n    0x009A: 'ENABLE.COMMAND',\n    0x009B: 'CHECK.COMMAND',\n    0x009C: 'RENAME.COMMAND',\n    0x009D: 'SHOW.BAR',\n    0x009E: 'DELETE.MENU',\n    0x009F: 'DELETE.COMMAND',\n    0x00A0: 'GET.CHART.ITEM',\n    0x00A1: 'DIALOG.BOX',\n    0x00A2: 'CLEAN',\n    0x00A3: 'MDETERM',\n    0x00A4: 'MINVERSE',\n    0x00A5: 'MMULT',\n    0x00A6: 'FILES',\n    0x00A7: 'IPMT',\n    0x00A8: 'PPMT',\n    0x00A9: 'COUNTA',\n    0x00AA: 'CANCEL.KEY',\n    0x00AB: 'FOR',\n    0x00AC: 'WHILE',\n    0x00AD: 'BREAK',\n    0x00AE: 'NEXT',\n    0x00AF: 'INITIATE',\n    0x00B0: 'REQUEST',\n    0x00B1: 'POKE',\n    0x00B2: 'EXECUTE',\n    0x00B3: 'TERMINATE',\n    0x00B4: 'RESTART',\n    0x00B5: 'HELP',\n    0x00B6: 'GET.BAR',\n    0x00B7: 'PRODUCT',\n    0x00B8: 'FACT',\n    0x00B9: 'GET.CELL',\n    0x00BA: 'GET.WORKSPACE',\n    0x00BB: 'GET.WINDOW',\n    0x00BC: 'GET.DOCUMENT',\n    0x00BD: 'DPRODUCT',\n    0x00BE: 'ISNONTEXT',\n    0x00BF: 'GET.NOTE',\n    0x00C0: 'NOTE',\n    0x00C1: 'STDEVP',\n    0x00C2: 'VARP',\n    0x00C3: 'DSTDEVP',\n    0x00C4: 'DVARP',\n    0x00C5: 'TRUNC',\n    0x00C6: 'ISLOGICAL',\n    0x00C7: 'DCOUNTA',\n    0x00C8: 'DELETE.BAR',\n    0x00C9: 'UNREGISTER',\n    0x00CC: 'USDOLLAR',\n    0x00CD: 'FINDB',\n    0x00CE: 'SEARCHB',\n    0x00CF: 'REPLACEB',\n    0x00D0: 'LEFTB',\n    0x00D1: 'RIGHTB',\n    0x00D2: 'MIDB',\n    0x00D3: 'LENB',\n    0x00D4: 'ROUNDUP',\n    0x00D5: 'ROUNDDOWN',\n    0x00D6: 'ASC',\n    0x00D7: 'DBCS',\n    0x00D8: 'RANK',\n    0x00DB: 'ADDRESS',\n    0x00DC: 'DAYS360',\n    0x00DD: 'TODAY',\n    0x00DE: 'VDB',\n    0x00DF: 'ELSE',\n    0x00E0: 'ELSE.IF',\n    0x00E1: 'END.IF',\n    0x00E2: 'FOR.CELL',\n    0x00E3: 'MEDIAN',\n    0x00E4: 'SUMPRODUCT',\n    0x00E5: 'SINH',\n    0x00E6: 'COSH',\n    0x00E7: 'TANH',\n    0x00E8: 'ASINH',\n    0x00E9: 'ACOSH',\n    0x00EA: 'ATANH',\n    0x00EB: 'DGET',\n    0x00EC: 'CREATE.OBJECT',\n    0x00ED: 'VOLATILE',\n    0x00EE: 'LAST.ERROR',\n    0x00EF: 'CUSTOM.UNDO',\n    0x00F0: 'CUSTOM.REPEAT',\n    0x00F1: 'FORMULA.CONVERT',\n    0x00F2: 'GET.LINK.INFO',\n    0x00F3: 'TEXT.BOX',\n    0x00F4: 'INFO',\n    0x00F5: 'GROUP',\n    0x00F6: 'GET.OBJECT',\n    0x00F7: 'DB',\n    0x00F8: 'PAUSE',\n    0x00FB: 'RESUME',\n    0x00FC: 'FREQUENCY',\n    0x00FD: 'ADD.TOOLBAR',\n    0x00FE: 'DELETE.TOOLBAR',\n    0x00FF: 'User',\n    0x0100: 'RESET.TOOLBAR',\n    0x0101: 'EVALUATE',\n    0x0102: 'GET.TOOLBAR',\n    0x0103: 'GET.TOOL',\n    0x0104: 'SPELLING.CHECK',\n    0x0105: 'ERROR.TYPE',\n    0x0106: 'APP.TITLE',\n    0x0107: 'WINDOW.TITLE',\n    0x0108: 'SAVE.TOOLBAR',\n    0x0109: 'ENABLE.TOOL',\n    0x010A: 'PRESS.TOOL',\n    0x010B: 'REGISTER.ID',\n    0x010C: 'GET.WORKBOOK',\n    0x010D: 'AVEDEV',\n    0x010E: 'BETADIST',\n    0x010F: 'GAMMALN',\n    0x0110: 'BETAINV',\n    0x0111: 'BINOMDIST',\n    0x0112: 'CHIDIST',\n    0x0113: 'CHIINV',\n    0x0114: 'COMBIN',\n    0x0115: 'CONFIDENCE',\n    0x0116: 'CRITBINOM',\n    0x0117: 'EVEN',\n    0x0118: 'EXPONDIST',\n    0x0119: 'FDIST',\n    0x011A: 'FINV',\n    0x011B: 'FISHER',\n    0x011C: 'FISHERINV',\n    0x011D: 'FLOOR',\n    0x011E: 'GAMMADIST',\n    0x011F: 'GAMMAINV',\n    0x0120: 'CEILING',\n    0x0121: 'HYPGEOMDIST',\n    0x0122: 'LOGNORMDIST',\n    0x0123: 'LOGINV',\n    0x0124: 'NEGBINOMDIST',\n    0x0125: 'NORMDIST',\n    0x0126: 'NORMSDIST',\n    0x0127: 'NORMINV',\n    0x0128: 'NORMSINV',\n    0x0129: 'STANDARDIZE',\n    0x012A: 'ODD',\n    0x012B: 'PERMUT',\n    0x012C: 'POISSON',\n    0x012D: 'TDIST',\n    0x012E: 'WEIBULL',\n    0x012F: 'SUMXMY2',\n    0x0130: 'SUMX2MY2',\n    0x0131: 'SUMX2PY2',\n    0x0132: 'CHITEST',\n    0x0133: 'CORREL',\n    0x0134: 'COVAR',\n    0x0135: 'FORECAST',\n    0x0136: 'FTEST',\n    0x0137: 'INTERCEPT',\n    0x0138: 'PEARSON',\n    0x0139: 'RSQ',\n    0x013A: 'STEYX',\n    0x013B: 'SLOPE',\n    0x013C: 'TTEST',\n    0x013D: 'PROB',\n    0x013E: 'DEVSQ',\n    0x013F: 'GEOMEAN',\n    0x0140: 'HARMEAN',\n    0x0141: 'SUMSQ',\n    0x0142: 'KURT',\n    0x0143: 'SKEW',\n    0x0144: 'ZTEST',\n    0x0145: 'LARGE',\n    0x0146: 'SMALL',\n    0x0147: 'QUARTILE',\n    0x0148: 'PERCENTILE',\n    0x0149: 'PERCENTRANK',\n    0x014A: 'MODE',\n    0x014B: 'TRIMMEAN',\n    0x014C: 'TINV',\n    0x014E: 'MOVIE.COMMAND',\n    0x014F: 'GET.MOVIE',\n    0x0150: 'CONCATENATE',\n    0x0151: 'POWER',\n    0x0152: 'PIVOT.ADD.DATA',\n    0x0153: 'GET.PIVOT.TABLE',\n    0x0154: 'GET.PIVOT.FIELD',\n    0x0155: 'GET.PIVOT.ITEM',\n    0x0156: 'RADIANS',\n    0x0157: 'DEGREES',\n    0x0158: 'SUBTOTAL',\n    0x0159: 'SUMIF',\n    0x015A: 'COUNTIF',\n    0x015B: 'COUNTBLANK',\n    0x015C: 'SCENARIO.GET',\n    0x015D: 'OPTIONS.LISTS.GET',\n    0x015E: 'ISPMT',\n    0x015F: 'DATEDIF',\n    0x0160: 'DATESTRING',\n    0x0161: 'NUMBERSTRING',\n    0x0162: 'ROMAN',\n    0x0163: 'OPEN.DIALOG',\n    0x0164: 'SAVE.DIALOG',\n    0x0165: 'VIEW.GET',\n    0x0166: 'GETPIVOTDATA',\n    0x0167: 'HYPERLINK',\n    0x0168: 'PHONETIC',\n    0x0169: 'AVERAGEA',\n    0x016A: 'MAXA',\n    0x016B: 'MINA',\n    0x016C: 'STDEVPA',\n    0x016D: 'VARPA',\n    0x016E: 'STDEVA',\n    0x016F: 'VARA',\n    0x0170: 'BAHTTEXT',\n    0x0171: 'THAIDAYOFWEEK',\n    0x0172: 'THAIDIGIT',\n    0x0173: 'THAIMONTHOFYEAR',\n    0x0174: 'THAINUMSOUND',\n    0x0175: 'THAINUMSTRING',\n    0x0176: 'THAISTRINGLENGTH',\n    0x0177: 'ISTHAIDIGIT',\n    0x0178: 'ROUNDBAHTDOWN',\n    0x0179: 'ROUNDBAHTUP',\n    0x017A: 'THAIYEAR',\n    0x017B: 'RTD'\n  };\n  var FtabArgc = {\n    0x0002: 1,\n\n    /* ISNA */\n    0x0003: 1,\n\n    /* ISERROR */\n    0x000F: 1,\n\n    /* SIN */\n    0x0010: 1,\n\n    /* COS */\n    0x0011: 1,\n\n    /* TAN */\n    0x0012: 1,\n\n    /* ATAN */\n    0x0014: 1,\n\n    /* SQRT */\n    0x0015: 1,\n\n    /* EXP */\n    0x0016: 1,\n\n    /* LN */\n    0x0017: 1,\n\n    /* LOG10 */\n    0x0018: 1,\n\n    /* ABS */\n    0x0019: 1,\n\n    /* INT */\n    0x001A: 1,\n\n    /* SIGN */\n    0x001B: 2,\n\n    /* ROUND */\n    0x001E: 2,\n\n    /* REPT */\n    0x001F: 3,\n\n    /* MID */\n    0x0020: 1,\n\n    /* LEN */\n    0x0021: 1,\n\n    /* VALUE */\n    0x0026: 1,\n\n    /* NOT */\n    0x0027: 2,\n\n    /* MOD */\n    0x0028: 3,\n\n    /* DCOUNT */\n    0x0029: 3,\n\n    /* DSUM */\n    0x002A: 3,\n\n    /* DAVERAGE */\n    0x002B: 3,\n\n    /* DMIN */\n    0x002C: 3,\n\n    /* DMAX */\n    0x002D: 3,\n\n    /* DSTDEV */\n    0x002F: 3,\n\n    /* DVAR */\n    0x0030: 2,\n\n    /* TEXT */\n    0x0035: 1,\n\n    /* GOTO */\n    0x003D: 3,\n\n    /* MIRR */\n    0x0041: 3,\n\n    /* DATE */\n    0x0042: 3,\n\n    /* TIME */\n    0x0043: 1,\n\n    /* DAY */\n    0x0044: 1,\n\n    /* MONTH */\n    0x0045: 1,\n\n    /* YEAR */\n    0x0047: 1,\n\n    /* HOUR */\n    0x0048: 1,\n\n    /* MINUTE */\n    0x0049: 1,\n\n    /* SECOND */\n    0x004B: 1,\n\n    /* AREAS */\n    0x004C: 1,\n\n    /* ROWS */\n    0x004D: 1,\n\n    /* COLUMNS */\n    0x004F: 2,\n\n    /* ABSREF */\n    0x0050: 2,\n\n    /* RELREF */\n    0x0053: 1,\n\n    /* TRANSPOSE */\n    0x0056: 1,\n\n    /* TYPE */\n    0x005A: 1,\n\n    /* DEREF */\n    0x0061: 2,\n\n    /* ATAN2 */\n    0x0062: 1,\n\n    /* ASIN */\n    0x0063: 1,\n\n    /* ACOS */\n    0x0069: 1,\n\n    /* ISREF */\n    0x006F: 1,\n\n    /* CHAR */\n    0x0070: 1,\n\n    /* LOWER */\n    0x0071: 1,\n\n    /* UPPER */\n    0x0072: 1,\n\n    /* PROPER */\n    0x0075: 2,\n\n    /* EXACT */\n    0x0076: 1,\n\n    /* TRIM */\n    0x0077: 4,\n\n    /* REPLACE */\n    0x0079: 1,\n\n    /* CODE */\n    0x007E: 1,\n\n    /* ISERR */\n    0x007F: 1,\n\n    /* ISTEXT */\n    0x0080: 1,\n\n    /* ISNUMBER */\n    0x0081: 1,\n\n    /* ISBLANK */\n    0x0082: 1,\n\n    /* T */\n    0x0083: 1,\n\n    /* N */\n    0x0085: 1,\n\n    /* FCLOSE */\n    0x0086: 1,\n\n    /* FSIZE */\n    0x0087: 1,\n\n    /* FREADLN */\n    0x0088: 2,\n\n    /* FREAD */\n    0x0089: 2,\n\n    /* FWRITELN */\n    0x008A: 2,\n\n    /* FWRITE */\n    0x008C: 1,\n\n    /* DATEVALUE */\n    0x008D: 1,\n\n    /* TIMEVALUE */\n    0x008E: 3,\n\n    /* SLN */\n    0x008F: 4,\n\n    /* SYD */\n    0x00A2: 1,\n\n    /* CLEAN */\n    0x00A3: 1,\n\n    /* MDETERM */\n    0x00A4: 1,\n\n    /* MINVERSE */\n    0x00A5: 2,\n\n    /* MMULT */\n    0x00AC: 1,\n\n    /* WHILE */\n    0x00AF: 2,\n\n    /* INITIATE */\n    0x00B0: 2,\n\n    /* REQUEST */\n    0x00B1: 3,\n\n    /* POKE */\n    0x00B2: 2,\n\n    /* EXECUTE */\n    0x00B3: 1,\n\n    /* TERMINATE */\n    0x00B8: 1,\n\n    /* FACT */\n    0x00BD: 3,\n\n    /* DPRODUCT */\n    0x00BE: 1,\n\n    /* ISNONTEXT */\n    0x00C3: 3,\n\n    /* DSTDEVP */\n    0x00C4: 3,\n\n    /* DVARP */\n    0x00C6: 1,\n\n    /* ISLOGICAL */\n    0x00C7: 3,\n\n    /* DCOUNTA */\n    0x00C9: 1,\n\n    /* UNREGISTER */\n    0x00CF: 4,\n\n    /* REPLACEB */\n    0x00D2: 3,\n\n    /* MIDB */\n    0x00D3: 1,\n\n    /* LENB */\n    0x00D4: 2,\n\n    /* ROUNDUP */\n    0x00D5: 2,\n\n    /* ROUNDDOWN */\n    0x00D6: 1,\n\n    /* ASC */\n    0x00D7: 1,\n\n    /* DBCS */\n    0x00E5: 1,\n\n    /* SINH */\n    0x00E6: 1,\n\n    /* COSH */\n    0x00E7: 1,\n\n    /* TANH */\n    0x00E8: 1,\n\n    /* ASINH */\n    0x00E9: 1,\n\n    /* ACOSH */\n    0x00EA: 1,\n\n    /* ATANH */\n    0x00EB: 3,\n\n    /* DGET */\n    0x00F4: 1,\n\n    /* INFO */\n    0x00FC: 2,\n\n    /* FREQUENCY */\n    0x0101: 1,\n\n    /* EVALUATE */\n    0x0105: 1,\n\n    /* ERROR.TYPE */\n    0x010F: 1,\n\n    /* GAMMALN */\n    0x0111: 4,\n\n    /* BINOMDIST */\n    0x0112: 2,\n\n    /* CHIDIST */\n    0x0113: 2,\n\n    /* CHIINV */\n    0x0114: 2,\n\n    /* COMBIN */\n    0x0115: 3,\n\n    /* CONFIDENCE */\n    0x0116: 3,\n\n    /* CRITBINOM */\n    0x0117: 1,\n\n    /* EVEN */\n    0x0118: 3,\n\n    /* EXPONDIST */\n    0x0119: 3,\n\n    /* FDIST */\n    0x011A: 3,\n\n    /* FINV */\n    0x011B: 1,\n\n    /* FISHER */\n    0x011C: 1,\n\n    /* FISHERINV */\n    0x011D: 2,\n\n    /* FLOOR */\n    0x011E: 4,\n\n    /* GAMMADIST */\n    0x011F: 3,\n\n    /* GAMMAINV */\n    0x0120: 2,\n\n    /* CEILING */\n    0x0121: 4,\n\n    /* HYPGEOMDIST */\n    0x0122: 3,\n\n    /* LOGNORMDIST */\n    0x0123: 3,\n\n    /* LOGINV */\n    0x0124: 3,\n\n    /* NEGBINOMDIST */\n    0x0125: 4,\n\n    /* NORMDIST */\n    0x0126: 1,\n\n    /* NORMSDIST */\n    0x0127: 3,\n\n    /* NORMINV */\n    0x0128: 1,\n\n    /* NORMSINV */\n    0x0129: 3,\n\n    /* STANDARDIZE */\n    0x012A: 1,\n\n    /* ODD */\n    0x012B: 2,\n\n    /* PERMUT */\n    0x012C: 3,\n\n    /* POISSON */\n    0x012D: 3,\n\n    /* TDIST */\n    0x012E: 4,\n\n    /* WEIBULL */\n    0x012F: 2,\n\n    /* SUMXMY2 */\n    0x0130: 2,\n\n    /* SUMX2MY2 */\n    0x0131: 2,\n\n    /* SUMX2PY2 */\n    0x0132: 2,\n\n    /* CHITEST */\n    0x0133: 2,\n\n    /* CORREL */\n    0x0134: 2,\n\n    /* COVAR */\n    0x0135: 3,\n\n    /* FORECAST */\n    0x0136: 2,\n\n    /* FTEST */\n    0x0137: 2,\n\n    /* INTERCEPT */\n    0x0138: 2,\n\n    /* PEARSON */\n    0x0139: 2,\n\n    /* RSQ */\n    0x013A: 2,\n\n    /* STEYX */\n    0x013B: 2,\n\n    /* SLOPE */\n    0x013C: 4,\n\n    /* TTEST */\n    0x0145: 2,\n\n    /* LARGE */\n    0x0146: 2,\n\n    /* SMALL */\n    0x0147: 2,\n\n    /* QUARTILE */\n    0x0148: 2,\n\n    /* PERCENTILE */\n    0x014B: 2,\n\n    /* TRIMMEAN */\n    0x014C: 2,\n\n    /* TINV */\n    0x0151: 2,\n\n    /* POWER */\n    0x0156: 1,\n\n    /* RADIANS */\n    0x0157: 1,\n\n    /* DEGREES */\n    0x015A: 2,\n\n    /* COUNTIF */\n    0x015B: 1,\n\n    /* COUNTBLANK */\n    0x015E: 4,\n\n    /* ISPMT */\n    0x015F: 3,\n\n    /* DATEDIF */\n    0x0160: 1,\n\n    /* DATESTRING */\n    0x0161: 2,\n\n    /* NUMBERSTRING */\n    0x0168: 1,\n\n    /* PHONETIC */\n    0x0170: 1,\n\n    /* BAHTTEXT */\n    0x0171: 1,\n\n    /* THAIDAYOFWEEK */\n    0x0172: 1,\n\n    /* THAIDIGIT */\n    0x0173: 1,\n\n    /* THAIMONTHOFYEAR */\n    0x0174: 1,\n\n    /* THAINUMSOUND */\n    0x0175: 1,\n\n    /* THAINUMSTRING */\n    0x0176: 1,\n\n    /* THAISTRINGLENGTH */\n    0x0177: 1,\n\n    /* ISTHAIDIGIT */\n    0x0178: 1,\n\n    /* ROUNDBAHTDOWN */\n    0x0179: 1,\n\n    /* ROUNDBAHTUP */\n    0x017A: 1,\n\n    /* THAIYEAR */\n    0xFFFF: 0\n  };\n  /* [MS-XLSX] 2.2.3 Functions */\n\n  var XLSXFutureFunctions = {\n    \"_xlfn.ACOT\": \"ACOT\",\n    \"_xlfn.ACOTH\": \"ACOTH\",\n    \"_xlfn.AGGREGATE\": \"AGGREGATE\",\n    \"_xlfn.ARABIC\": \"ARABIC\",\n    \"_xlfn.AVERAGEIF\": \"AVERAGEIF\",\n    \"_xlfn.AVERAGEIFS\": \"AVERAGEIFS\",\n    \"_xlfn.BASE\": \"BASE\",\n    \"_xlfn.BETA.DIST\": \"BETA.DIST\",\n    \"_xlfn.BETA.INV\": \"BETA.INV\",\n    \"_xlfn.BINOM.DIST\": \"BINOM.DIST\",\n    \"_xlfn.BINOM.DIST.RANGE\": \"BINOM.DIST.RANGE\",\n    \"_xlfn.BINOM.INV\": \"BINOM.INV\",\n    \"_xlfn.BITAND\": \"BITAND\",\n    \"_xlfn.BITLSHIFT\": \"BITLSHIFT\",\n    \"_xlfn.BITOR\": \"BITOR\",\n    \"_xlfn.BITRSHIFT\": \"BITRSHIFT\",\n    \"_xlfn.BITXOR\": \"BITXOR\",\n    \"_xlfn.CEILING.MATH\": \"CEILING.MATH\",\n    \"_xlfn.CEILING.PRECISE\": \"CEILING.PRECISE\",\n    \"_xlfn.CHISQ.DIST\": \"CHISQ.DIST\",\n    \"_xlfn.CHISQ.DIST.RT\": \"CHISQ.DIST.RT\",\n    \"_xlfn.CHISQ.INV\": \"CHISQ.INV\",\n    \"_xlfn.CHISQ.INV.RT\": \"CHISQ.INV.RT\",\n    \"_xlfn.CHISQ.TEST\": \"CHISQ.TEST\",\n    \"_xlfn.COMBINA\": \"COMBINA\",\n    \"_xlfn.CONFIDENCE.NORM\": \"CONFIDENCE.NORM\",\n    \"_xlfn.CONFIDENCE.T\": \"CONFIDENCE.T\",\n    \"_xlfn.COT\": \"COT\",\n    \"_xlfn.COTH\": \"COTH\",\n    \"_xlfn.COUNTIFS\": \"COUNTIFS\",\n    \"_xlfn.COVARIANCE.P\": \"COVARIANCE.P\",\n    \"_xlfn.COVARIANCE.S\": \"COVARIANCE.S\",\n    \"_xlfn.CSC\": \"CSC\",\n    \"_xlfn.CSCH\": \"CSCH\",\n    \"_xlfn.DAYS\": \"DAYS\",\n    \"_xlfn.DECIMAL\": \"DECIMAL\",\n    \"_xlfn.ECMA.CEILING\": \"ECMA.CEILING\",\n    \"_xlfn.ERF.PRECISE\": \"ERF.PRECISE\",\n    \"_xlfn.ERFC.PRECISE\": \"ERFC.PRECISE\",\n    \"_xlfn.EXPON.DIST\": \"EXPON.DIST\",\n    \"_xlfn.F.DIST\": \"F.DIST\",\n    \"_xlfn.F.DIST.RT\": \"F.DIST.RT\",\n    \"_xlfn.F.INV\": \"F.INV\",\n    \"_xlfn.F.INV.RT\": \"F.INV.RT\",\n    \"_xlfn.F.TEST\": \"F.TEST\",\n    \"_xlfn.FILTERXML\": \"FILTERXML\",\n    \"_xlfn.FLOOR.MATH\": \"FLOOR.MATH\",\n    \"_xlfn.FLOOR.PRECISE\": \"FLOOR.PRECISE\",\n    \"_xlfn.FORMULATEXT\": \"FORMULATEXT\",\n    \"_xlfn.GAMMA\": \"GAMMA\",\n    \"_xlfn.GAMMA.DIST\": \"GAMMA.DIST\",\n    \"_xlfn.GAMMA.INV\": \"GAMMA.INV\",\n    \"_xlfn.GAMMALN.PRECISE\": \"GAMMALN.PRECISE\",\n    \"_xlfn.GAUSS\": \"GAUSS\",\n    \"_xlfn.HYPGEOM.DIST\": \"HYPGEOM.DIST\",\n    \"_xlfn.IFNA\": \"IFNA\",\n    \"_xlfn.IFERROR\": \"IFERROR\",\n    \"_xlfn.IMCOSH\": \"IMCOSH\",\n    \"_xlfn.IMCOT\": \"IMCOT\",\n    \"_xlfn.IMCSC\": \"IMCSC\",\n    \"_xlfn.IMCSCH\": \"IMCSCH\",\n    \"_xlfn.IMSEC\": \"IMSEC\",\n    \"_xlfn.IMSECH\": \"IMSECH\",\n    \"_xlfn.IMSINH\": \"IMSINH\",\n    \"_xlfn.IMTAN\": \"IMTAN\",\n    \"_xlfn.ISFORMULA\": \"ISFORMULA\",\n    \"_xlfn.ISO.CEILING\": \"ISO.CEILING\",\n    \"_xlfn.ISOWEEKNUM\": \"ISOWEEKNUM\",\n    \"_xlfn.LOGNORM.DIST\": \"LOGNORM.DIST\",\n    \"_xlfn.LOGNORM.INV\": \"LOGNORM.INV\",\n    \"_xlfn.MODE.MULT\": \"MODE.MULT\",\n    \"_xlfn.MODE.SNGL\": \"MODE.SNGL\",\n    \"_xlfn.MUNIT\": \"MUNIT\",\n    \"_xlfn.NEGBINOM.DIST\": \"NEGBINOM.DIST\",\n    \"_xlfn.NETWORKDAYS.INTL\": \"NETWORKDAYS.INTL\",\n    \"_xlfn.NIGBINOM\": \"NIGBINOM\",\n    \"_xlfn.NORM.DIST\": \"NORM.DIST\",\n    \"_xlfn.NORM.INV\": \"NORM.INV\",\n    \"_xlfn.NORM.S.DIST\": \"NORM.S.DIST\",\n    \"_xlfn.NORM.S.INV\": \"NORM.S.INV\",\n    \"_xlfn.NUMBERVALUE\": \"NUMBERVALUE\",\n    \"_xlfn.PDURATION\": \"PDURATION\",\n    \"_xlfn.PERCENTILE.EXC\": \"PERCENTILE.EXC\",\n    \"_xlfn.PERCENTILE.INC\": \"PERCENTILE.INC\",\n    \"_xlfn.PERCENTRANK.EXC\": \"PERCENTRANK.EXC\",\n    \"_xlfn.PERCENTRANK.INC\": \"PERCENTRANK.INC\",\n    \"_xlfn.PERMUTATIONA\": \"PERMUTATIONA\",\n    \"_xlfn.PHI\": \"PHI\",\n    \"_xlfn.POISSON.DIST\": \"POISSON.DIST\",\n    \"_xlfn.QUARTILE.EXC\": \"QUARTILE.EXC\",\n    \"_xlfn.QUARTILE.INC\": \"QUARTILE.INC\",\n    \"_xlfn.QUERYSTRING\": \"QUERYSTRING\",\n    \"_xlfn.RANK.AVG\": \"RANK.AVG\",\n    \"_xlfn.RANK.EQ\": \"RANK.EQ\",\n    \"_xlfn.RRI\": \"RRI\",\n    \"_xlfn.SEC\": \"SEC\",\n    \"_xlfn.SECH\": \"SECH\",\n    \"_xlfn.SHEET\": \"SHEET\",\n    \"_xlfn.SHEETS\": \"SHEETS\",\n    \"_xlfn.SKEW.P\": \"SKEW.P\",\n    \"_xlfn.STDEV.P\": \"STDEV.P\",\n    \"_xlfn.STDEV.S\": \"STDEV.S\",\n    \"_xlfn.SUMIFS\": \"SUMIFS\",\n    \"_xlfn.T.DIST\": \"T.DIST\",\n    \"_xlfn.T.DIST.2T\": \"T.DIST.2T\",\n    \"_xlfn.T.DIST.RT\": \"T.DIST.RT\",\n    \"_xlfn.T.INV\": \"T.INV\",\n    \"_xlfn.T.INV.2T\": \"T.INV.2T\",\n    \"_xlfn.T.TEST\": \"T.TEST\",\n    \"_xlfn.UNICHAR\": \"UNICHAR\",\n    \"_xlfn.UNICODE\": \"UNICODE\",\n    \"_xlfn.VAR.P\": \"VAR.P\",\n    \"_xlfn.VAR.S\": \"VAR.S\",\n    \"_xlfn.WEBSERVICE\": \"WEBSERVICE\",\n    \"_xlfn.WEIBULL.DIST\": \"WEIBULL.DIST\",\n    \"_xlfn.WORKDAY.INTL\": \"WORKDAY.INTL\",\n    \"_xlfn.XOR\": \"XOR\",\n    \"_xlfn.Z.TEST\": \"Z.TEST\"\n  };\n  var strs = {}; // shared strings\n\n  var _ssfopts = {}; // spreadsheet formatting options\n\n  RELS.WS = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet\";\n\n  function get_sst_id(sst, str) {\n    for (var i = 0, len = sst.length; i < len; ++i) {\n      if (sst[i].t === str) {\n        sst.Count++;\n        return i;\n      }\n    }\n\n    sst[len] = {\n      t: str\n    };\n    sst.Count++;\n    sst.Unique++;\n    return len;\n  }\n\n  function get_cell_style(styles, cell, opts) {\n    if (typeof style_builder != 'undefined') {\n      if (/^\\d+$/.exec(cell.s)) {\n        return cell.s;\n      } // if its already an integer index, let it be\n\n\n      if (cell.s && cell.s == +cell.s) {\n        return cell.s;\n      } // if its already an integer index, let it be\n\n\n      var s = cell.s || {};\n      if (cell.z) s.numFmt = cell.z;\n      return style_builder.addStyle(s);\n    } else {\n      var z = opts.revssf[cell.z != null ? cell.z : \"General\"];\n\n      for (var i = 0, len = styles.length; i != len; ++i) {\n        if (styles[i].numFmtId === z) return i;\n      }\n\n      styles[len] = {\n        numFmtId: z,\n        fontId: 0,\n        fillId: 0,\n        borderId: 0,\n        xfId: 0,\n        applyNumberFormat: 1\n      };\n      return len;\n    }\n  }\n\n  function get_cell_style_csf(cellXf) {\n    if (cellXf) {\n      var s = {};\n\n      if (typeof cellXf.numFmtId != undefined) {\n        s.numFmt = SSF._table[cellXf.numFmtId];\n      }\n\n      if (cellXf.fillId) {\n        s.fill = styles.Fills[cellXf.fillId];\n      }\n\n      if (cellXf.fontId) {\n        s.font = styles.Fonts[cellXf.fontId];\n      }\n\n      if (cellXf.borderId) {\n        s.border = styles.Borders[cellXf.borderId];\n      }\n\n      if (cellXf.applyAlignment == 1) {\n        s.alignment = cellXf.alignment;\n      }\n\n      return JSON.parse(JSON.stringify(s));\n    }\n\n    return null;\n  }\n\n  function safe_format(p, fmtid, fillid, opts) {\n    try {\n      if (p.t === 'e') p.w = p.w || BErr[p.v];else if (fmtid === 0) {\n        if (p.t === 'n') {\n          if ((p.v | 0) === p.v) p.w = SSF._general_int(p.v, _ssfopts);else p.w = SSF._general_num(p.v, _ssfopts);\n        } else if (p.t === 'd') {\n          var dd = datenum(p.v);\n          if ((dd | 0) === dd) p.w = SSF._general_int(dd, _ssfopts);else p.w = SSF._general_num(dd, _ssfopts);\n        } else if (p.v === undefined) return \"\";else p.w = SSF._general(p.v, _ssfopts);\n      } else if (p.t === 'd') p.w = SSF.format(fmtid, datenum(p.v), _ssfopts);else p.w = SSF.format(fmtid, p.v, _ssfopts);\n      if (opts.cellNF) p.z = SSF._table[fmtid];\n    } catch (e) {\n      if (opts.WTF) throw e;\n    }\n  }\n\n  function parse_ws_xml_dim(ws, s) {\n    var d = safe_decode_range(s);\n    if (d.s.r <= d.e.r && d.s.c <= d.e.c && d.s.r >= 0 && d.s.c >= 0) ws[\"!ref\"] = encode_range(d);\n  }\n\n  var mergecregex = /<mergeCell ref=\"[A-Z0-9:]+\"\\s*\\/>/g;\n  var sheetdataregex = /<(?:\\w+:)?sheetData>([^\\u2603]*)<\\/(?:\\w+:)?sheetData>/;\n  var hlinkregex = /<hyperlink[^>]*\\/>/g;\n  var dimregex = /\"(\\w*:\\w*)\"/;\n  var colregex = /<col[^>]*\\/>/g;\n  /* 18.3 Worksheets */\n\n  function parse_ws_xml(data, opts, rels) {\n    if (!data) return data;\n    /* 18.3.1.99 worksheet CT_Worksheet */\n\n    var s = {};\n    /* 18.3.1.35 dimension CT_SheetDimension ? */\n\n    var ridx = data.indexOf(\"<dimension\");\n\n    if (ridx > 0) {\n      var ref = data.substr(ridx, 50).match(dimregex);\n      if (ref != null) parse_ws_xml_dim(s, ref[1]);\n    }\n    /* 18.3.1.55 mergeCells CT_MergeCells */\n\n\n    var mergecells = [];\n\n    if (data.indexOf(\"</mergeCells>\") !== -1) {\n      var merges = data.match(mergecregex);\n\n      for (ridx = 0; ridx != merges.length; ++ridx) {\n        mergecells[ridx] = safe_decode_range(merges[ridx].substr(merges[ridx].indexOf(\"\\\"\") + 1));\n      }\n    }\n    /* 18.3.1.17 cols CT_Cols */\n\n\n    var columns = [];\n\n    if (opts.cellStyles && data.indexOf(\"</cols>\") !== -1) {\n      /* 18.3.1.13 col CT_Col */\n      var cols = data.match(colregex);\n      parse_ws_xml_cols(columns, cols);\n    }\n\n    var refguess = {\n      s: {\n        r: 1000000,\n        c: 1000000\n      },\n      e: {\n        r: 0,\n        c: 0\n      }\n    };\n    /* 18.3.1.80 sheetData CT_SheetData ? */\n\n    var mtch = data.match(sheetdataregex);\n    if (mtch) parse_ws_xml_data(mtch[1], s, opts, refguess);\n    /* 18.3.1.48 hyperlinks CT_Hyperlinks */\n\n    if (data.indexOf(\"</hyperlinks>\") !== -1) parse_ws_xml_hlinks(s, data.match(hlinkregex), rels);\n    if (!s[\"!ref\"] && refguess.e.c >= refguess.s.c && refguess.e.r >= refguess.s.r) s[\"!ref\"] = encode_range(refguess);\n\n    if (opts.sheetRows > 0 && s[\"!ref\"]) {\n      var tmpref = safe_decode_range(s[\"!ref\"]);\n\n      if (opts.sheetRows < +tmpref.e.r) {\n        tmpref.e.r = opts.sheetRows - 1;\n        if (tmpref.e.r > refguess.e.r) tmpref.e.r = refguess.e.r;\n        if (tmpref.e.r < tmpref.s.r) tmpref.s.r = tmpref.e.r;\n        if (tmpref.e.c > refguess.e.c) tmpref.e.c = refguess.e.c;\n        if (tmpref.e.c < tmpref.s.c) tmpref.s.c = tmpref.e.c;\n        s[\"!fullref\"] = s[\"!ref\"];\n        s[\"!ref\"] = encode_range(tmpref);\n      }\n    }\n\n    if (mergecells.length > 0) s[\"!merges\"] = mergecells;\n    if (columns.length > 0) s[\"!cols\"] = columns;\n    return s;\n  }\n\n  function write_ws_xml_merges(merges) {\n    if (merges.length == 0) return \"\";\n    var o = '<mergeCells count=\"' + merges.length + '\">';\n\n    for (var i = 0; i != merges.length; ++i) {\n      o += '<mergeCell ref=\"' + encode_range(merges[i]) + '\"/>';\n    }\n\n    return o + '</mergeCells>';\n  }\n\n  function write_ws_xml_pagesetup(setup) {\n    var pageSetup = writextag('pageSetup', null, {\n      scale: setup.scale || '100',\n      orientation: setup.orientation || 'portrait',\n      horizontalDpi: setup.horizontalDpi || '4294967292',\n      verticalDpi: setup.verticalDpi || '4294967292'\n    });\n    return pageSetup;\n  }\n\n  function parse_ws_xml_hlinks(s, data, rels) {\n    for (var i = 0; i != data.length; ++i) {\n      var val = parsexmltag(data[i], true);\n      if (!val.ref) return;\n      var rel = rels ? rels['!id'][val.id] : null;\n\n      if (rel) {\n        val.Target = rel.Target;\n        if (val.location) val.Target += \"#\" + val.location;\n        val.Rel = rel;\n      } else {\n        val.Target = val.location;\n        rel = {\n          Target: val.location,\n          TargetMode: 'Internal'\n        };\n        val.Rel = rel;\n      }\n\n      var rng = safe_decode_range(val.ref);\n\n      for (var R = rng.s.r; R <= rng.e.r; ++R) {\n        for (var C = rng.s.c; C <= rng.e.c; ++C) {\n          var addr = encode_cell({\n            c: C,\n            r: R\n          });\n          if (!s[addr]) s[addr] = {\n            t: \"stub\",\n            v: undefined\n          };\n          s[addr].l = val;\n        }\n      }\n    }\n  }\n\n  function parse_ws_xml_cols(columns, cols) {\n    var seencol = false;\n\n    for (var coli = 0; coli != cols.length; ++coli) {\n      var coll = parsexmltag(cols[coli], true);\n      var colm = parseInt(coll.min, 10) - 1,\n          colM = parseInt(coll.max, 10) - 1;\n      delete coll.min;\n      delete coll.max;\n\n      if (!seencol && coll.width) {\n        seencol = true;\n        find_mdw(+coll.width, coll);\n      }\n\n      if (coll.width) {\n        coll.wpx = width2px(+coll.width);\n        coll.wch = px2char(coll.wpx);\n        coll.MDW = MDW;\n      }\n\n      while (colm <= colM) {\n        columns[colm++] = coll;\n      }\n    }\n  }\n\n  function write_ws_xml_cols(ws, cols) {\n    var o = [\"<cols>\"],\n        col,\n        width;\n\n    for (var i = 0; i != cols.length; ++i) {\n      if (!(col = cols[i])) continue;\n      var p = {\n        min: i + 1,\n        max: i + 1\n      };\n      /* wch (chars), wpx (pixels) */\n\n      width = -1;\n      if (col.wpx) width = px2char(col.wpx);else if (col.wch) width = col.wch;\n\n      if (width > -1) {\n        p.width = char2width(width);\n        p.customWidth = 1;\n      }\n\n      o[o.length] = writextag('col', null, p);\n    }\n\n    o[o.length] = \"</cols>\";\n    return o.join(\"\");\n  }\n\n  function write_ws_xml_cell(cell, ref, ws, opts, idx, wb) {\n    if (cell.v === undefined && cell.s === undefined) return \"\";\n    var vv = \"\";\n    var oldt = cell.t,\n        oldv = cell.v;\n\n    switch (cell.t) {\n      case 'b':\n        vv = cell.v ? \"1\" : \"0\";\n        break;\n\n      case 'n':\n        vv = '' + cell.v;\n        break;\n\n      case 'e':\n        vv = BErr[cell.v];\n        break;\n\n      case 'd':\n        if (opts.cellDates) vv = new Date(cell.v).toISOString();else {\n          cell.t = 'n';\n          vv = '' + (cell.v = datenum(cell.v));\n          if (typeof cell.z === 'undefined') cell.z = SSF._table[14];\n        }\n        break;\n\n      default:\n        vv = cell.v;\n        break;\n    }\n\n    var v = writetag('v', escapexml(vv)),\n        o = {\n      r: ref\n    };\n    /* TODO: cell style */\n\n    var os = get_cell_style(opts.cellXfs, cell, opts);\n    if (os !== 0) o.s = os;\n\n    switch (cell.t) {\n      case 'n':\n        break;\n\n      case 'd':\n        o.t = \"d\";\n        break;\n\n      case 'b':\n        o.t = \"b\";\n        break;\n\n      case 'e':\n        o.t = \"e\";\n        break;\n\n      default:\n        if (opts.bookSST) {\n          v = writetag('v', '' + get_sst_id(opts.Strings, cell.v));\n          o.t = \"s\";\n          break;\n        }\n\n        o.t = \"str\";\n        break;\n    }\n\n    if (cell.t != oldt) {\n      cell.t = oldt;\n      cell.v = oldv;\n    }\n\n    return writextag('c', v, o);\n  }\n\n  var parse_ws_xml_data = function parse_ws_xml_data_factory() {\n    var cellregex = /<(?:\\w+:)?c[ >]/,\n        rowregex = /<\\/(?:\\w+:)?row>/;\n    var rregex = /r=[\"']([^\"']*)[\"']/,\n        isregex = /<is>([\\S\\s]*?)<\\/is>/;\n    var match_v = matchtag(\"v\"),\n        match_f = matchtag(\"f\");\n    return function parse_ws_xml_data(sdata, s, opts, guess) {\n      var ri = 0,\n          x = \"\",\n          cells = [],\n          cref = [],\n          idx = 0,\n          i = 0,\n          cc = 0,\n          d = \"\",\n          p;\n      var tag,\n          tagr = 0,\n          tagc = 0;\n      var sstr;\n      var fmtid = 0,\n          fillid = 0,\n          do_format = Array.isArray(styles.CellXf),\n          cf;\n\n      for (var marr = sdata.split(rowregex), mt = 0, marrlen = marr.length; mt != marrlen; ++mt) {\n        x = marr[mt].trim();\n        var xlen = x.length;\n        if (xlen === 0) continue;\n        /* 18.3.1.73 row CT_Row */\n\n        for (ri = 0; ri < xlen; ++ri) {\n          if (x.charCodeAt(ri) === 62) break;\n        }\n\n        ++ri;\n        tag = parsexmltag(x.substr(0, ri), true);\n        /* SpreadSheetGear uses implicit r/c */\n\n        tagr = typeof tag.r !== 'undefined' ? parseInt(tag.r, 10) : tagr + 1;\n        tagc = -1;\n        if (opts.sheetRows && opts.sheetRows < tagr) continue;\n        if (guess.s.r > tagr - 1) guess.s.r = tagr - 1;\n        if (guess.e.r < tagr - 1) guess.e.r = tagr - 1;\n        /* 18.3.1.4 c CT_Cell */\n\n        cells = x.substr(ri).split(cellregex);\n\n        for (ri = typeof tag.r === 'undefined' ? 0 : 1; ri != cells.length; ++ri) {\n          x = cells[ri].trim();\n          if (x.length === 0) continue;\n          cref = x.match(rregex);\n          idx = ri;\n          i = 0;\n          cc = 0;\n          x = \"<c \" + (x.substr(0, 1) == \"<\" ? \">\" : \"\") + x;\n\n          if (cref !== null && cref.length === 2) {\n            idx = 0;\n            d = cref[1];\n\n            for (i = 0; i != d.length; ++i) {\n              if ((cc = d.charCodeAt(i) - 64) < 1 || cc > 26) break;\n              idx = 26 * idx + cc;\n            }\n\n            --idx;\n            tagc = idx;\n          } else ++tagc;\n\n          for (i = 0; i != x.length; ++i) {\n            if (x.charCodeAt(i) === 62) break;\n          }\n\n          ++i;\n          tag = parsexmltag(x.substr(0, i), true);\n          if (!tag.r) tag.r = utils.encode_cell({\n            r: tagr - 1,\n            c: tagc\n          });\n          d = x.substr(i);\n          p = {\n            t: \"\"\n          };\n          if ((cref = d.match(match_v)) !== null && cref[1] !== '') p.v = unescapexml(cref[1]);\n          if (opts.cellFormula && (cref = d.match(match_f)) !== null) p.f = unescapexml(cref[1]);\n          /* SCHEMA IS ACTUALLY INCORRECT HERE.  IF A CELL HAS NO T, EMIT \"\" */\n\n          if (tag.t === undefined && tag.s === undefined && p.v === undefined) {\n            if (!opts.sheetStubs) continue;\n            p.t = \"stub\";\n          } else p.t = tag.t || \"n\";\n\n          if (guess.s.c > idx) guess.s.c = idx;\n          if (guess.e.c < idx) guess.e.c = idx;\n          /* 18.18.11 t ST_CellType */\n\n          switch (p.t) {\n            case 'n':\n              p.v = parseFloat(p.v);\n              if (isNaN(p.v)) p.v = \"\"; // we don't want NaN if p.v is null\n\n              break;\n\n            case 's':\n              // if (!p.hasOwnProperty('v')) continue;\n              sstr = strs[parseInt(p.v, 10)];\n              p.v = sstr.t;\n              p.r = sstr.r;\n              if (opts.cellHTML) p.h = sstr.h;\n              break;\n\n            case 'str':\n              p.t = \"s\";\n              p.v = p.v != null ? utf8read(p.v) : '';\n              if (opts.cellHTML) p.h = p.v;\n              break;\n\n            case 'inlineStr':\n              cref = d.match(isregex);\n              p.t = 's';\n\n              if (cref !== null) {\n                sstr = parse_si(cref[1]);\n                p.v = sstr.t;\n              } else p.v = \"\";\n\n              break;\n            // inline string\n\n            case 'b':\n              p.v = parsexmlbool(p.v);\n              break;\n\n            case 'd':\n              if (!opts.cellDates) {\n                p.v = datenum(p.v);\n                p.t = 'n';\n              }\n\n              break;\n\n            /* error string in .v, number in .v */\n\n            case 'e':\n              p.w = p.v;\n              p.v = RBErr[p.v];\n              break;\n          }\n          /* formatting */\n\n\n          fmtid = fillid = 0;\n\n          if (do_format && tag.s !== undefined) {\n            cf = styles.CellXf[tag.s];\n\n            if (opts.cellStyles) {\n              p.s = get_cell_style_csf(cf);\n            }\n\n            if (cf != null) {\n              if (cf.numFmtId != null) fmtid = cf.numFmtId;\n              if (opts.cellStyles && cf.fillId != null) fillid = cf.fillId;\n            }\n          }\n\n          safe_format(p, fmtid, fillid, opts);\n          s[tag.r] = p;\n        }\n      }\n    };\n  }();\n\n  function write_ws_xml_data(ws, opts, idx, wb) {\n    var o = [],\n        r = [],\n        range = safe_decode_range(ws['!ref']),\n        cell,\n        ref,\n        rr = \"\",\n        cols = [],\n        R,\n        C;\n\n    for (C = range.s.c; C <= range.e.c; ++C) {\n      cols[C] = encode_col(C);\n    }\n\n    for (R = range.s.r; R <= range.e.r; ++R) {\n      r = [];\n      rr = encode_row(R);\n\n      for (C = range.s.c; C <= range.e.c; ++C) {\n        ref = cols[C] + rr;\n        if (ws[ref] === undefined) continue;\n        if ((cell = write_ws_xml_cell(ws[ref], ref, ws, opts, idx, wb)) != null) r.push(cell);\n      }\n\n      if (r.length > 0) o[o.length] = writextag('row', r.join(\"\"), {\n        r: rr\n      });\n    }\n\n    return o.join(\"\");\n  }\n\n  var WS_XML_ROOT = writextag('worksheet', null, {\n    'xmlns': XMLNS.main[0],\n    'xmlns:r': XMLNS.r\n  });\n\n  function write_ws_xml(idx, opts, wb) {\n    var o = [XML_HEADER, WS_XML_ROOT];\n    var s = wb.SheetNames[idx],\n        sidx = 0,\n        rdata = \"\";\n    var ws = wb.Sheets[s];\n    if (ws === undefined) ws = {};\n    var ref = ws['!ref'];\n    if (ref === undefined) ref = 'A1';\n    o[o.length] = writextag('dimension', null, {\n      'ref': ref\n    });\n    var kids = [];\n\n    if (ws['!freeze']) {\n      var pane = '';\n      pane = writextag('pane', null, ws['!freeze']);\n      kids.push(pane);\n      var selection = writextag('selection', null, {\n        pane: \"topLeft\"\n      });\n      kids.push(selection);\n      var selection = writextag('selection', null, {\n        pane: \"bottomLeft\"\n      });\n      kids.push(selection);\n      var selection = writextag('selection', null, {\n        pane: \"bottomRight\",\n        activeCell: ws['!freeze'],\n        sqref: ws['!freeze']\n      });\n      kids.push(selection);\n    } //<selection pane=\"bottomRight\" activeCell=\"A4\" sqref=\"A4\"/>\n\n\n    var sheetView = writextag('sheetView', kids.join('') || undefined, {\n      showGridLines: opts.showGridLines == false ? '0' : '1',\n      tabSelected: opts.tabSelected === undefined ? '0' : opts.tabSelected,\n      // see issue #26, need to set WorkbookViews if this is set\n      workbookViewId: opts.workbookViewId === undefined ? '0' : opts.workbookViewId\n    });\n    o[o.length] = writextag('sheetViews', sheetView);\n    if (ws['!cols'] !== undefined && ws['!cols'].length > 0) o[o.length] = write_ws_xml_cols(ws, ws['!cols']);\n    o[sidx = o.length] = '<sheetData/>';\n\n    if (ws['!ref'] !== undefined) {\n      rdata = write_ws_xml_data(ws, opts, idx, wb);\n      if (rdata.length > 0) o[o.length] = rdata;\n    }\n\n    if (o.length > sidx + 1) {\n      o[o.length] = '</sheetData>';\n      o[sidx] = o[sidx].replace(\"/>\", \">\");\n    }\n\n    if (ws['!merges'] !== undefined && ws['!merges'].length > 0) o[o.length] = write_ws_xml_merges(ws['!merges']);\n    if (ws['!pageSetup'] !== undefined) o[o.length] = write_ws_xml_pagesetup(ws['!pageSetup']);\n    if (ws['!rowBreaks'] !== undefined) o[o.length] = write_ws_xml_row_breaks(ws['!rowBreaks']);\n    if (ws['!colBreaks'] !== undefined) o[o.length] = write_ws_xml_col_breaks(ws['!colBreaks']);\n\n    if (o.length > 2) {\n      o[o.length] = '</worksheet>';\n      o[1] = o[1].replace(\"/>\", \">\");\n    }\n\n    return o.join(\"\");\n  }\n\n  function write_ws_xml_row_breaks(breaks) {\n    var brk = [];\n\n    for (var i = 0; i < breaks.length; i++) {\n      var thisBreak = '' + breaks[i];\n      var nextBreak = '' + (breaks[i + 1] || '16383');\n      brk.push(writextag('brk', null, {\n        id: thisBreak,\n        max: nextBreak,\n        man: '1'\n      }));\n    }\n\n    return writextag('rowBreaks', brk.join(' '), {\n      count: brk.length,\n      manualBreakCount: brk.length\n    });\n  }\n\n  function write_ws_xml_col_breaks(breaks) {\n    var brk = [];\n\n    for (var i = 0; i < breaks.length; i++) {\n      var thisBreak = '' + breaks[i];\n      var nextBreak = '' + (breaks[i + 1] || '1048575');\n      brk.push(writextag('brk', null, {\n        id: thisBreak,\n        max: nextBreak,\n        man: '1'\n      }));\n    }\n\n    return writextag('colBreaks', brk.join(' '), {\n      count: brk.length,\n      manualBreakCount: brk.length\n    });\n  }\n  /* [MS-XLSB] 2.4.718 BrtRowHdr */\n\n\n  function parse_BrtRowHdr(data, length) {\n    var z = [];\n    z.r = data.read_shift(4);\n    data.l += length - 4;\n    return z;\n  }\n  /* [MS-XLSB] 2.4.812 BrtWsDim */\n\n\n  var parse_BrtWsDim = parse_UncheckedRfX;\n  var write_BrtWsDim = write_UncheckedRfX;\n  /* [MS-XLSB] 2.4.815 BrtWsProp */\n\n  function parse_BrtWsProp(data, length) {\n    var z = {};\n    /* TODO: pull flags */\n\n    data.l += 19;\n    z.name = parse_XLSBCodeName(data, length - 19);\n    return z;\n  }\n  /* [MS-XLSB] 2.4.303 BrtCellBlank */\n\n\n  function parse_BrtCellBlank(data, length) {\n    var cell = parse_XLSBCell(data);\n    return [cell];\n  }\n\n  function write_BrtCellBlank(cell, val, o) {\n    if (o == null) o = new_buf(8);\n    return write_XLSBCell(val, o);\n  }\n  /* [MS-XLSB] 2.4.304 BrtCellBool */\n\n\n  function parse_BrtCellBool(data, length) {\n    var cell = parse_XLSBCell(data);\n    var fBool = data.read_shift(1);\n    return [cell, fBool, 'b'];\n  }\n  /* [MS-XLSB] 2.4.305 BrtCellError */\n\n\n  function parse_BrtCellError(data, length) {\n    var cell = parse_XLSBCell(data);\n    var fBool = data.read_shift(1);\n    return [cell, fBool, 'e'];\n  }\n  /* [MS-XLSB] 2.4.308 BrtCellIsst */\n\n\n  function parse_BrtCellIsst(data, length) {\n    var cell = parse_XLSBCell(data);\n    var isst = data.read_shift(4);\n    return [cell, isst, 's'];\n  }\n  /* [MS-XLSB] 2.4.310 BrtCellReal */\n\n\n  function parse_BrtCellReal(data, length) {\n    var cell = parse_XLSBCell(data);\n    var value = parse_Xnum(data);\n    return [cell, value, 'n'];\n  }\n  /* [MS-XLSB] 2.4.311 BrtCellRk */\n\n\n  function parse_BrtCellRk(data, length) {\n    var cell = parse_XLSBCell(data);\n    var value = parse_RkNumber(data);\n    return [cell, value, 'n'];\n  }\n  /* [MS-XLSB] 2.4.314 BrtCellSt */\n\n\n  function parse_BrtCellSt(data, length) {\n    var cell = parse_XLSBCell(data);\n    var value = parse_XLWideString(data);\n    return [cell, value, 'str'];\n  }\n  /* [MS-XLSB] 2.4.647 BrtFmlaBool */\n\n\n  function parse_BrtFmlaBool(data, length, opts) {\n    var cell = parse_XLSBCell(data);\n    var value = data.read_shift(1);\n    var o = [cell, value, 'b'];\n\n    if (opts.cellFormula) {\n      var formula = parse_XLSBCellParsedFormula(data, length - 9);\n      o[3] = \"\";\n      /* TODO */\n    } else data.l += length - 9;\n\n    return o;\n  }\n  /* [MS-XLSB] 2.4.648 BrtFmlaError */\n\n\n  function parse_BrtFmlaError(data, length, opts) {\n    var cell = parse_XLSBCell(data);\n    var value = data.read_shift(1);\n    var o = [cell, value, 'e'];\n\n    if (opts.cellFormula) {\n      var formula = parse_XLSBCellParsedFormula(data, length - 9);\n      o[3] = \"\";\n      /* TODO */\n    } else data.l += length - 9;\n\n    return o;\n  }\n  /* [MS-XLSB] 2.4.649 BrtFmlaNum */\n\n\n  function parse_BrtFmlaNum(data, length, opts) {\n    var cell = parse_XLSBCell(data);\n    var value = parse_Xnum(data);\n    var o = [cell, value, 'n'];\n\n    if (opts.cellFormula) {\n      var formula = parse_XLSBCellParsedFormula(data, length - 16);\n      o[3] = \"\";\n      /* TODO */\n    } else data.l += length - 16;\n\n    return o;\n  }\n  /* [MS-XLSB] 2.4.650 BrtFmlaString */\n\n\n  function parse_BrtFmlaString(data, length, opts) {\n    var start = data.l;\n    var cell = parse_XLSBCell(data);\n    var value = parse_XLWideString(data);\n    var o = [cell, value, 'str'];\n\n    if (opts.cellFormula) {\n      var formula = parse_XLSBCellParsedFormula(data, start + length - data.l);\n    } else data.l = start + length;\n\n    return o;\n  }\n  /* [MS-XLSB] 2.4.676 BrtMergeCell */\n\n\n  var parse_BrtMergeCell = parse_UncheckedRfX;\n  /* [MS-XLSB] 2.4.656 BrtHLink */\n\n  function parse_BrtHLink(data, length, opts) {\n    var end = data.l + length;\n    var rfx = parse_UncheckedRfX(data, 16);\n    var relId = parse_XLNullableWideString(data);\n    var loc = parse_XLWideString(data);\n    var tooltip = parse_XLWideString(data);\n    var display = parse_XLWideString(data);\n    data.l = end;\n    return {\n      rfx: rfx,\n      relId: relId,\n      loc: loc,\n      tooltip: tooltip,\n      display: display\n    };\n  }\n  /* [MS-XLSB] 2.1.7.61 Worksheet */\n\n\n  function parse_ws_bin(data, opts, rels) {\n    if (!data) return data;\n    if (!rels) rels = {\n      '!id': {}\n    };\n    var s = {};\n    var ref;\n    var refguess = {\n      s: {\n        r: 1000000,\n        c: 1000000\n      },\n      e: {\n        r: 0,\n        c: 0\n      }\n    };\n    var pass = false,\n        end = false;\n    var row, p, cf, R, C, addr, sstr, rr;\n    var mergecells = [];\n    recordhopper(data, function ws_parse(val, R) {\n      if (end) return;\n\n      switch (R.n) {\n        case 'BrtWsDim':\n          ref = val;\n          break;\n\n        case 'BrtRowHdr':\n          row = val;\n          if (opts.sheetRows && opts.sheetRows <= row.r) end = true;\n          rr = encode_row(row.r);\n          break;\n\n        case 'BrtFmlaBool':\n        case 'BrtFmlaError':\n        case 'BrtFmlaNum':\n        case 'BrtFmlaString':\n        case 'BrtCellBool':\n        case 'BrtCellError':\n        case 'BrtCellIsst':\n        case 'BrtCellReal':\n        case 'BrtCellRk':\n        case 'BrtCellSt':\n          p = {\n            t: val[2]\n          };\n\n          switch (val[2]) {\n            case 'n':\n              p.v = val[1];\n              break;\n\n            case 's':\n              sstr = strs[val[1]];\n              p.v = sstr.t;\n              p.r = sstr.r;\n              break;\n\n            case 'b':\n              p.v = val[1] ? true : false;\n              break;\n\n            case 'e':\n              p.v = val[1];\n              p.w = BErr[p.v];\n              break;\n\n            case 'str':\n              p.t = 's';\n              p.v = utf8read(val[1]);\n              break;\n          }\n\n          if (opts.cellFormula && val.length > 3) p.f = val[3];\n          if (cf = styles.CellXf[val[0].iStyleRef]) safe_format(p, cf.ifmt, null, opts);\n          s[encode_col(C = val[0].c) + rr] = p;\n          if (refguess.s.r > row.r) refguess.s.r = row.r;\n          if (refguess.s.c > C) refguess.s.c = C;\n          if (refguess.e.r < row.r) refguess.e.r = row.r;\n          if (refguess.e.c < C) refguess.e.c = C;\n          break;\n\n        case 'BrtCellBlank':\n          if (!opts.sheetStubs) break;\n          p = {\n            t: 's',\n            v: undefined\n          };\n          s[encode_col(C = val[0].c) + rr] = p;\n          if (refguess.s.r > row.r) refguess.s.r = row.r;\n          if (refguess.s.c > C) refguess.s.c = C;\n          if (refguess.e.r < row.r) refguess.e.r = row.r;\n          if (refguess.e.c < C) refguess.e.c = C;\n          break;\n\n        /* Merge Cells */\n\n        case 'BrtBeginMergeCells':\n          break;\n\n        case 'BrtEndMergeCells':\n          break;\n\n        case 'BrtMergeCell':\n          mergecells.push(val);\n          break;\n\n        case 'BrtHLink':\n          var rel = rels['!id'][val.relId];\n\n          if (rel) {\n            val.Target = rel.Target;\n            if (val.loc) val.Target += \"#\" + val.loc;\n            val.Rel = rel;\n          }\n\n          for (R = val.rfx.s.r; R <= val.rfx.e.r; ++R) {\n            for (C = val.rfx.s.c; C <= val.rfx.e.c; ++C) {\n              addr = encode_cell({\n                c: C,\n                r: R\n              });\n              if (!s[addr]) s[addr] = {\n                t: 's',\n                v: undefined\n              };\n              s[addr].l = val;\n            }\n          }\n\n          break;\n\n        case 'BrtArrFmla':\n          break;\n        // TODO\n\n        case 'BrtShrFmla':\n          break;\n        // TODO\n\n        case 'BrtBeginSheet':\n          break;\n\n        case 'BrtWsProp':\n          break;\n        // TODO\n\n        case 'BrtSheetCalcProp':\n          break;\n        // TODO\n\n        case 'BrtBeginWsViews':\n          break;\n        // TODO\n\n        case 'BrtBeginWsView':\n          break;\n        // TODO\n\n        case 'BrtPane':\n          break;\n        // TODO\n\n        case 'BrtSel':\n          break;\n        // TODO\n\n        case 'BrtEndWsView':\n          break;\n        // TODO\n\n        case 'BrtEndWsViews':\n          break;\n        // TODO\n\n        case 'BrtACBegin':\n          break;\n        // TODO\n\n        case 'BrtRwDescent':\n          break;\n        // TODO\n\n        case 'BrtACEnd':\n          break;\n        // TODO\n\n        case 'BrtWsFmtInfoEx14':\n          break;\n        // TODO\n\n        case 'BrtWsFmtInfo':\n          break;\n        // TODO\n\n        case 'BrtBeginColInfos':\n          break;\n        // TODO\n\n        case 'BrtColInfo':\n          break;\n        // TODO\n\n        case 'BrtEndColInfos':\n          break;\n        // TODO\n\n        case 'BrtBeginSheetData':\n          break;\n        // TODO\n\n        case 'BrtEndSheetData':\n          break;\n        // TODO\n\n        case 'BrtSheetProtection':\n          break;\n        // TODO\n\n        case 'BrtPrintOptions':\n          break;\n        // TODO\n\n        case 'BrtMargins':\n          break;\n        // TODO\n\n        case 'BrtPageSetup':\n          break;\n        // TODO\n\n        case 'BrtFRTBegin':\n          pass = true;\n          break;\n\n        case 'BrtFRTEnd':\n          pass = false;\n          break;\n\n        case 'BrtEndSheet':\n          break;\n        // TODO\n\n        case 'BrtDrawing':\n          break;\n        // TODO\n\n        case 'BrtLegacyDrawing':\n          break;\n        // TODO\n\n        case 'BrtLegacyDrawingHF':\n          break;\n        // TODO\n\n        case 'BrtPhoneticInfo':\n          break;\n        // TODO\n\n        case 'BrtBeginHeaderFooter':\n          break;\n        // TODO\n\n        case 'BrtEndHeaderFooter':\n          break;\n        // TODO\n\n        case 'BrtBrk':\n          break;\n        // TODO\n\n        case 'BrtBeginRwBrk':\n          break;\n        // TODO\n\n        case 'BrtEndRwBrk':\n          break;\n        // TODO\n\n        case 'BrtBeginColBrk':\n          break;\n        // TODO\n\n        case 'BrtEndColBrk':\n          break;\n        // TODO\n\n        case 'BrtBeginUserShViews':\n          break;\n        // TODO\n\n        case 'BrtBeginUserShView':\n          break;\n        // TODO\n\n        case 'BrtEndUserShView':\n          break;\n        // TODO\n\n        case 'BrtEndUserShViews':\n          break;\n        // TODO\n\n        case 'BrtBkHim':\n          break;\n        // TODO\n\n        case 'BrtBeginOleObjects':\n          break;\n        // TODO\n\n        case 'BrtOleObject':\n          break;\n        // TODO\n\n        case 'BrtEndOleObjects':\n          break;\n        // TODO\n\n        case 'BrtBeginListParts':\n          break;\n        // TODO\n\n        case 'BrtListPart':\n          break;\n        // TODO\n\n        case 'BrtEndListParts':\n          break;\n        // TODO\n\n        case 'BrtBeginSortState':\n          break;\n        // TODO\n\n        case 'BrtBeginSortCond':\n          break;\n        // TODO\n\n        case 'BrtEndSortCond':\n          break;\n        // TODO\n\n        case 'BrtEndSortState':\n          break;\n        // TODO\n\n        case 'BrtBeginConditionalFormatting':\n          break;\n        // TODO\n\n        case 'BrtEndConditionalFormatting':\n          break;\n        // TODO\n\n        case 'BrtBeginCFRule':\n          break;\n        // TODO\n\n        case 'BrtEndCFRule':\n          break;\n        // TODO\n\n        case 'BrtBeginDVals':\n          break;\n        // TODO\n\n        case 'BrtDVal':\n          break;\n        // TODO\n\n        case 'BrtEndDVals':\n          break;\n        // TODO\n\n        case 'BrtRangeProtection':\n          break;\n        // TODO\n\n        case 'BrtBeginDCon':\n          break;\n        // TODO\n\n        case 'BrtEndDCon':\n          break;\n        // TODO\n\n        case 'BrtBeginDRefs':\n          break;\n\n        case 'BrtDRef':\n          break;\n\n        case 'BrtEndDRefs':\n          break;\n\n        /* ActiveX */\n\n        case 'BrtBeginActiveXControls':\n          break;\n\n        case 'BrtActiveX':\n          break;\n\n        case 'BrtEndActiveXControls':\n          break;\n\n        /* AutoFilter */\n\n        case 'BrtBeginAFilter':\n          break;\n\n        case 'BrtEndAFilter':\n          break;\n\n        case 'BrtBeginFilterColumn':\n          break;\n\n        case 'BrtBeginFilters':\n          break;\n\n        case 'BrtFilter':\n          break;\n\n        case 'BrtEndFilters':\n          break;\n\n        case 'BrtEndFilterColumn':\n          break;\n\n        case 'BrtDynamicFilter':\n          break;\n\n        case 'BrtTop10Filter':\n          break;\n\n        case 'BrtBeginCustomFilters':\n          break;\n\n        case 'BrtCustomFilter':\n          break;\n\n        case 'BrtEndCustomFilters':\n          break;\n\n        /* Smart Tags */\n\n        case 'BrtBeginSmartTags':\n          break;\n\n        case 'BrtBeginCellSmartTags':\n          break;\n\n        case 'BrtBeginCellSmartTag':\n          break;\n\n        case 'BrtCellSmartTagProperty':\n          break;\n\n        case 'BrtEndCellSmartTag':\n          break;\n\n        case 'BrtEndCellSmartTags':\n          break;\n\n        case 'BrtEndSmartTags':\n          break;\n\n        /* Cell Watch */\n\n        case 'BrtBeginCellWatches':\n          break;\n\n        case 'BrtCellWatch':\n          break;\n\n        case 'BrtEndCellWatches':\n          break;\n\n        /* Table */\n\n        case 'BrtTable':\n          break;\n\n        /* Ignore Cell Errors */\n\n        case 'BrtBeginCellIgnoreECs':\n          break;\n\n        case 'BrtCellIgnoreEC':\n          break;\n\n        case 'BrtEndCellIgnoreECs':\n          break;\n\n        default:\n          if (!pass || opts.WTF) throw new Error(\"Unexpected record \" + R.n);\n      }\n    }, opts);\n    if (!s[\"!ref\"] && (refguess.s.r < 1000000 || ref.e.r > 0 || ref.e.c > 0 || ref.s.r > 0 || ref.s.c > 0)) s[\"!ref\"] = encode_range(ref);\n\n    if (opts.sheetRows && s[\"!ref\"]) {\n      var tmpref = safe_decode_range(s[\"!ref\"]);\n\n      if (opts.sheetRows < +tmpref.e.r) {\n        tmpref.e.r = opts.sheetRows - 1;\n        if (tmpref.e.r > refguess.e.r) tmpref.e.r = refguess.e.r;\n        if (tmpref.e.r < tmpref.s.r) tmpref.s.r = tmpref.e.r;\n        if (tmpref.e.c > refguess.e.c) tmpref.e.c = refguess.e.c;\n        if (tmpref.e.c < tmpref.s.c) tmpref.s.c = tmpref.e.c;\n        s[\"!fullref\"] = s[\"!ref\"];\n        s[\"!ref\"] = encode_range(tmpref);\n      }\n    }\n\n    if (mergecells.length > 0) s[\"!merges\"] = mergecells;\n    return s;\n  }\n  /* TODO: something useful -- this is a stub */\n\n\n  function write_ws_bin_cell(ba, cell, R, C, opts) {\n    if (cell.v === undefined) return \"\";\n    var vv = \"\";\n\n    switch (cell.t) {\n      case 'b':\n        vv = cell.v ? \"1\" : \"0\";\n        break;\n\n      case 'n':\n      case 'e':\n        vv = '' + cell.v;\n        break;\n\n      default:\n        vv = cell.v;\n        break;\n    }\n\n    var o = {\n      r: R,\n      c: C\n    };\n    /* TODO: cell style */\n\n    o.s = get_cell_style(opts.cellXfs, cell, opts);\n\n    switch (cell.t) {\n      case 's':\n      case 'str':\n        if (opts.bookSST) {\n          vv = get_sst_id(opts.Strings, cell.v);\n          o.t = \"s\";\n          break;\n        }\n\n        o.t = \"str\";\n        break;\n\n      case 'n':\n        break;\n\n      case 'b':\n        o.t = \"b\";\n        break;\n\n      case 'e':\n        o.t = \"e\";\n        break;\n    }\n\n    write_record(ba, \"BrtCellBlank\", write_BrtCellBlank(cell, o));\n  }\n\n  function write_CELLTABLE(ba, ws, idx, opts, wb) {\n    var range = safe_decode_range(ws['!ref'] || \"A1\"),\n        ref,\n        rr = \"\",\n        cols = [];\n    write_record(ba, 'BrtBeginSheetData');\n\n    for (var R = range.s.r; R <= range.e.r; ++R) {\n      rr = encode_row(R);\n      /* [ACCELLTABLE] */\n\n      /* BrtRowHdr */\n\n      for (var C = range.s.c; C <= range.e.c; ++C) {\n        /* *16384CELL */\n        if (R === range.s.r) cols[C] = encode_col(C);\n        ref = cols[C] + rr;\n        if (!ws[ref]) continue;\n        /* write cell */\n\n        write_ws_bin_cell(ba, ws[ref], R, C, opts);\n      }\n    }\n\n    write_record(ba, 'BrtEndSheetData');\n  }\n\n  function write_ws_bin(idx, opts, wb) {\n    var ba = buf_array();\n    var s = wb.SheetNames[idx],\n        ws = wb.Sheets[s] || {};\n    var r = safe_decode_range(ws['!ref'] || \"A1\");\n    write_record(ba, \"BrtBeginSheet\");\n    /* [BrtWsProp] */\n\n    write_record(ba, \"BrtWsDim\", write_BrtWsDim(r));\n    /* [WSVIEWS2] */\n\n    /* [WSFMTINFO] */\n\n    /* *COLINFOS */\n\n    write_CELLTABLE(ba, ws, idx, opts, wb);\n    /* [BrtSheetCalcProp] */\n\n    /* [[BrtSheetProtectionIso] BrtSheetProtection] */\n\n    /* *([BrtRangeProtectionIso] BrtRangeProtection) */\n\n    /* [SCENMAN] */\n\n    /* [AUTOFILTER] */\n\n    /* [SORTSTATE] */\n\n    /* [DCON] */\n\n    /* [USERSHVIEWS] */\n\n    /* [MERGECELLS] */\n\n    /* [BrtPhoneticInfo] */\n\n    /* *CONDITIONALFORMATTING */\n\n    /* [DVALS] */\n\n    /* *BrtHLink */\n\n    /* [BrtPrintOptions] */\n\n    /* [BrtMargins] */\n\n    /* [BrtPageSetup] */\n\n    /* [HEADERFOOTER] */\n\n    /* [RWBRK] */\n\n    /* [COLBRK] */\n\n    /* *BrtBigName */\n\n    /* [CELLWATCHES] */\n\n    /* [IGNOREECS] */\n\n    /* [SMARTTAGS] */\n\n    /* [BrtDrawing] */\n\n    /* [BrtLegacyDrawing] */\n\n    /* [BrtLegacyDrawingHF] */\n\n    /* [BrtBkHim] */\n\n    /* [OLEOBJECTS] */\n\n    /* [ACTIVEXCONTROLS] */\n\n    /* [WEBPUBITEMS] */\n\n    /* [LISTPARTS] */\n\n    /* FRTWORKSHEET */\n\n    write_record(ba, \"BrtEndSheet\");\n    return ba.end();\n  }\n  /* 18.2.28 (CT_WorkbookProtection) Defaults */\n\n\n  var WBPropsDef = [['allowRefreshQuery', '0'], ['autoCompressPictures', '1'], ['backupFile', '0'], ['checkCompatibility', '0'], ['codeName', ''], ['date1904', '0'], ['dateCompatibility', '1'], //['defaultThemeVersion', '0'],\n  ['filterPrivacy', '0'], ['hidePivotFieldList', '0'], ['promptedSolutions', '0'], ['publishItems', '0'], ['refreshAllConnections', false], ['saveExternalLinkValues', '1'], ['showBorderUnselectedTables', '1'], ['showInkAnnotation', '1'], ['showObjects', 'all'], ['showPivotChartFilter', '0'] //['updateLinks', 'userSet']\n  ];\n  /* 18.2.30 (CT_BookView) Defaults */\n\n  var WBViewDef = [['activeTab', '0'], ['autoFilterDateGrouping', '1'], ['firstSheet', '0'], ['minimized', '0'], ['showHorizontalScroll', '1'], ['showSheetTabs', '1'], ['showVerticalScroll', '1'], ['tabRatio', '600'], ['visibility', 'visible'] //window{Height,Width}, {x,y}Window\n  ];\n  /* 18.2.19 (CT_Sheet) Defaults */\n\n  var SheetDef = [['state', 'visible']];\n  /* 18.2.2  (CT_CalcPr) Defaults */\n\n  var CalcPrDef = [['calcCompleted', 'true'], ['calcMode', 'auto'], ['calcOnSave', 'true'], ['concurrentCalc', 'true'], ['fullCalcOnLoad', 'false'], ['fullPrecision', 'true'], ['iterate', 'false'], ['iterateCount', '100'], ['iterateDelta', '0.001'], ['refMode', 'A1']];\n  /* 18.2.3 (CT_CustomWorkbookView) Defaults */\n\n  var CustomWBViewDef = [['autoUpdate', 'false'], ['changesSavedWin', 'false'], ['includeHiddenRowCol', 'true'], ['includePrintSettings', 'true'], ['maximized', 'false'], ['minimized', 'false'], ['onlySync', 'false'], ['personalView', 'false'], ['showComments', 'commIndicator'], ['showFormulaBar', 'true'], ['showHorizontalScroll', 'true'], ['showObjects', 'all'], ['showSheetTabs', 'true'], ['showStatusbar', 'true'], ['showVerticalScroll', 'true'], ['tabRatio', '600'], ['xWindow', '0'], ['yWindow', '0']];\n\n  function push_defaults_array(target, defaults) {\n    for (var j = 0; j != target.length; ++j) {\n      var w = target[j];\n\n      for (var i = 0; i != defaults.length; ++i) {\n        var z = defaults[i];\n        if (w[z[0]] == null) w[z[0]] = z[1];\n      }\n    }\n  }\n\n  function push_defaults(target, defaults) {\n    for (var i = 0; i != defaults.length; ++i) {\n      var z = defaults[i];\n      if (target[z[0]] == null) target[z[0]] = z[1];\n    }\n  }\n\n  function parse_wb_defaults(wb) {\n    push_defaults(wb.WBProps, WBPropsDef);\n    push_defaults(wb.CalcPr, CalcPrDef);\n    push_defaults_array(wb.WBView, WBViewDef);\n    push_defaults_array(wb.Sheets, SheetDef);\n    _ssfopts.date1904 = parsexmlbool(wb.WBProps.date1904, 'date1904');\n  }\n  /* 18.2 Workbook */\n\n\n  var wbnsregex = /<\\w+:workbook/;\n\n  function parse_wb_xml(data, opts) {\n    var wb = {\n      AppVersion: {},\n      WBProps: {},\n      WBView: [],\n      Sheets: [],\n      CalcPr: {},\n      xmlns: \"\"\n    };\n    var pass = false,\n        xmlns = \"xmlns\";\n    data.match(tagregex).forEach(function xml_wb(x) {\n      var y = parsexmltag(x);\n\n      switch (strip_ns(y[0])) {\n        case '<?xml':\n          break;\n\n        /* 18.2.27 workbook CT_Workbook 1 */\n\n        case '<workbook':\n          if (x.match(wbnsregex)) xmlns = \"xmlns\" + x.match(/<(\\w+):/)[1];\n          wb.xmlns = y[xmlns];\n          break;\n\n        case '</workbook>':\n          break;\n\n        /* 18.2.13 fileVersion CT_FileVersion ? */\n\n        case '<fileVersion':\n          delete y[0];\n          wb.AppVersion = y;\n          break;\n\n        case '<fileVersion/>':\n          break;\n\n        /* 18.2.12 fileSharing CT_FileSharing ? */\n\n        case '<fileSharing':\n        case '<fileSharing/>':\n          break;\n\n        /* 18.2.28 workbookPr CT_WorkbookPr ? */\n\n        case '<workbookPr':\n          delete y[0];\n          wb.WBProps = y;\n          break;\n\n        case '<workbookPr/>':\n          delete y[0];\n          wb.WBProps = y;\n          break;\n\n        /* 18.2.29 workbookProtection CT_WorkbookProtection ? */\n\n        case '<workbookProtection':\n          break;\n\n        case '<workbookProtection/>':\n          break;\n\n        /* 18.2.1  bookViews CT_BookViews ? */\n\n        case '<bookViews>':\n        case '</bookViews>':\n          break;\n\n        /* 18.2.30   workbookView CT_BookView + */\n\n        case '<workbookView':\n          delete y[0];\n          wb.WBView.push(y);\n          break;\n\n        /* 18.2.20 sheets CT_Sheets 1 */\n\n        case '<sheets>':\n        case '</sheets>':\n          break;\n        // aggregate sheet\n\n        /* 18.2.19   sheet CT_Sheet + */\n\n        case '<sheet':\n          delete y[0];\n          y.name = utf8read(y.name);\n          wb.Sheets.push(y);\n          break;\n\n        /* 18.2.15 functionGroups CT_FunctionGroups ? */\n\n        case '<functionGroups':\n        case '<functionGroups/>':\n          break;\n\n        /* 18.2.14   functionGroup CT_FunctionGroup + */\n\n        case '<functionGroup':\n          break;\n\n        /* 18.2.9  externalReferences CT_ExternalReferences ? */\n\n        case '<externalReferences':\n        case '</externalReferences>':\n        case '<externalReferences>':\n          break;\n\n        /* 18.2.8    externalReference CT_ExternalReference + */\n\n        case '<externalReference':\n          break;\n\n        /* 18.2.6  definedNames CT_DefinedNames ? */\n\n        case '<definedNames/>':\n          break;\n\n        case '<definedNames>':\n        case '<definedNames':\n          pass = true;\n          break;\n\n        case '</definedNames>':\n          pass = false;\n          break;\n\n        /* 18.2.5    definedName CT_DefinedName + */\n\n        case '<definedName':\n        case '<definedName/>':\n        case '</definedName>':\n          break;\n\n        /* 18.2.2  calcPr CT_CalcPr ? */\n\n        case '<calcPr':\n          delete y[0];\n          wb.CalcPr = y;\n          break;\n\n        case '<calcPr/>':\n          delete y[0];\n          wb.CalcPr = y;\n          break;\n\n        /* 18.2.16 oleSize CT_OleSize ? (ref required) */\n\n        case '<oleSize':\n          break;\n\n        /* 18.2.4  customWorkbookViews CT_CustomWorkbookViews ? */\n\n        case '<customWorkbookViews>':\n        case '</customWorkbookViews>':\n        case '<customWorkbookViews':\n          break;\n\n        /* 18.2.3    customWorkbookView CT_CustomWorkbookView + */\n\n        case '<customWorkbookView':\n        case '</customWorkbookView>':\n          break;\n\n        /* 18.2.18 pivotCaches CT_PivotCaches ? */\n\n        case '<pivotCaches>':\n        case '</pivotCaches>':\n        case '<pivotCaches':\n          break;\n\n        /* 18.2.17 pivotCache CT_PivotCache ? */\n\n        case '<pivotCache':\n          break;\n\n        /* 18.2.21 smartTagPr CT_SmartTagPr ? */\n\n        case '<smartTagPr':\n        case '<smartTagPr/>':\n          break;\n\n        /* 18.2.23 smartTagTypes CT_SmartTagTypes ? */\n\n        case '<smartTagTypes':\n        case '<smartTagTypes>':\n        case '</smartTagTypes>':\n          break;\n\n        /* 18.2.22   smartTagType CT_SmartTagType ? */\n\n        case '<smartTagType':\n          break;\n\n        /* 18.2.24 webPublishing CT_WebPublishing ? */\n\n        case '<webPublishing':\n        case '<webPublishing/>':\n          break;\n\n        /* 18.2.11 fileRecoveryPr CT_FileRecoveryPr ? */\n\n        case '<fileRecoveryPr':\n        case '<fileRecoveryPr/>':\n          break;\n\n        /* 18.2.26 webPublishObjects CT_WebPublishObjects ? */\n\n        case '<webPublishObjects>':\n        case '<webPublishObjects':\n        case '</webPublishObjects>':\n          break;\n\n        /* 18.2.25 webPublishObject CT_WebPublishObject ? */\n\n        case '<webPublishObject':\n          break;\n\n        /* 18.2.10 extLst CT_ExtensionList ? */\n\n        case '<extLst>':\n        case '</extLst>':\n        case '<extLst/>':\n          break;\n\n        /* 18.2.7    ext CT_Extension + */\n\n        case '<ext':\n          pass = true;\n          break;\n        //TODO: check with versions of excel\n\n        case '</ext>':\n          pass = false;\n          break;\n\n        /* Others */\n\n        case '<ArchID':\n          break;\n\n        case '<AlternateContent':\n          pass = true;\n          break;\n\n        case '</AlternateContent>':\n          pass = false;\n          break;\n\n        default:\n          if (!pass && opts.WTF) throw 'unrecognized ' + y[0] + ' in workbook';\n      }\n    });\n    if (XMLNS.main.indexOf(wb.xmlns) === -1) throw new Error(\"Unknown Namespace: \" + wb.xmlns);\n    parse_wb_defaults(wb);\n    return wb;\n  }\n\n  var WB_XML_ROOT = writextag('workbook', null, {\n    'xmlns': XMLNS.main[0],\n    //'xmlns:mx': XMLNS.mx,\n    //'xmlns:s': XMLNS.main[0],\n    'xmlns:r': XMLNS.r\n  });\n\n  function safe1904(wb) {\n    /* TODO: store date1904 somewhere else */\n    try {\n      return parsexmlbool(wb.Workbook.WBProps.date1904) ? \"true\" : \"false\";\n    } catch (e) {\n      return \"false\";\n    }\n  }\n\n  function write_wb_xml(wb, opts) {\n    var o = [XML_HEADER];\n    o[o.length] = WB_XML_ROOT;\n    o[o.length] = writextag('workbookPr', null, {\n      date1904: safe1904(wb)\n    });\n    o[o.length] = \"<sheets>\";\n\n    for (var i = 0; i != wb.SheetNames.length; ++i) {\n      o[o.length] = writextag('sheet', null, {\n        name: wb.SheetNames[i].substr(0, 31),\n        sheetId: \"\" + (i + 1),\n        \"r:id\": \"rId\" + (i + 1)\n      });\n    }\n\n    o[o.length] = \"</sheets>\";\n    var hasPrintHeaders = false;\n\n    for (var i = 0; i != wb.SheetNames.length; ++i) {\n      var sheetName = wb.SheetNames[i];\n      var sheet = wb.Sheets[sheetName];\n\n      if (sheet['!printHeader']) {\n        if (sheet['!printHeader'].length !== 2) {\n          throw \"!printHeaders must be an array of length 2: \" + sheet['!printHeader'];\n        }\n\n        hasPrintHeaders = true;\n      }\n    }\n\n    if (hasPrintHeaders) {\n      o[o.length] = '<definedNames>';\n\n      for (var i = 0; i != wb.SheetNames.length; ++i) {\n        var sheetName = wb.SheetNames[i];\n        var sheet = wb.Sheets[sheetName];\n\n        if (sheet['!printHeader'] || sheet['!printColumns']) {\n          var printHeader = sheet['!printHeader'];\n          var printColumns = sheet['!printColumns']; //Sheet1!$A:$C,Sheet1!$1:$1\n\n          var range = \"\";\n          if (printColumns) range += \"'\" + sheetName + \"'!\" + (\"$\" + printColumns[0] + \":$\" + printColumns[1]);\n          if (printColumns && printHeader) range += \",\";\n          if (printHeader) range += \"'\" + sheetName + \"'!\" + (\"$\" + printHeader[0] + \":$\" + printHeader[1]);\n          console.log(\"-----------------------------\");\n          console.log(range);\n          o[o.length] = writextag('definedName', range, {\n            \"name\": \"_xlnm.Print_Titles\",\n            localSheetId: '' + i\n          });\n        }\n      }\n\n      o[o.length] = '</definedNames>';\n    }\n\n    if (o.length > 2) {\n      o[o.length] = '</workbook>';\n      o[1] = o[1].replace(\"/>\", \">\");\n    }\n\n    return o.join(\"\");\n  }\n  /* [MS-XLSB] 2.4.301 BrtBundleSh */\n\n\n  function parse_BrtBundleSh(data, length) {\n    var z = {};\n    z.hsState = data.read_shift(4); //ST_SheetState\n\n    z.iTabID = data.read_shift(4);\n    z.strRelID = parse_RelID(data, length - 8);\n    z.name = parse_XLWideString(data);\n    return z;\n  }\n\n  function write_BrtBundleSh(data, o) {\n    if (!o) o = new_buf(127);\n    o.write_shift(4, data.hsState);\n    o.write_shift(4, data.iTabID);\n    write_RelID(data.strRelID, o);\n    write_XLWideString(data.name.substr(0, 31), o);\n    return o;\n  }\n  /* [MS-XLSB] 2.4.807 BrtWbProp */\n\n\n  function parse_BrtWbProp(data, length) {\n    data.read_shift(4);\n    var dwThemeVersion = data.read_shift(4);\n    var strName = length > 8 ? parse_XLWideString(data) : \"\";\n    return [dwThemeVersion, strName];\n  }\n\n  function write_BrtWbProp(data, o) {\n    if (!o) o = new_buf(8);\n    o.write_shift(4, 0);\n    o.write_shift(4, 0);\n    return o;\n  }\n\n  function parse_BrtFRTArchID$(data, length) {\n    var o = {};\n    data.read_shift(4);\n    o.ArchID = data.read_shift(4);\n    data.l += length - 8;\n    return o;\n  }\n  /* [MS-XLSB] 2.1.7.60 Workbook */\n\n\n  function parse_wb_bin(data, opts) {\n    var wb = {\n      AppVersion: {},\n      WBProps: {},\n      WBView: [],\n      Sheets: [],\n      CalcPr: {},\n      xmlns: \"\"\n    };\n    var pass = false,\n        z;\n    recordhopper(data, function hopper_wb(val, R) {\n      switch (R.n) {\n        case 'BrtBundleSh':\n          wb.Sheets.push(val);\n          break;\n\n        case 'BrtBeginBook':\n          break;\n\n        case 'BrtFileVersion':\n          break;\n\n        case 'BrtWbProp':\n          break;\n\n        case 'BrtACBegin':\n          break;\n\n        case 'BrtAbsPath15':\n          break;\n\n        case 'BrtACEnd':\n          break;\n\n        case 'BrtWbFactoid':\n          break;\n\n        /*case 'BrtBookProtectionIso': break;*/\n\n        case 'BrtBookProtection':\n          break;\n\n        case 'BrtBeginBookViews':\n          break;\n\n        case 'BrtBookView':\n          break;\n\n        case 'BrtEndBookViews':\n          break;\n\n        case 'BrtBeginBundleShs':\n          break;\n\n        case 'BrtEndBundleShs':\n          break;\n\n        case 'BrtBeginFnGroup':\n          break;\n\n        case 'BrtEndFnGroup':\n          break;\n\n        case 'BrtBeginExternals':\n          break;\n\n        case 'BrtSupSelf':\n          break;\n\n        case 'BrtSupBookSrc':\n          break;\n\n        case 'BrtExternSheet':\n          break;\n\n        case 'BrtEndExternals':\n          break;\n\n        case 'BrtName':\n          break;\n\n        case 'BrtCalcProp':\n          break;\n\n        case 'BrtUserBookView':\n          break;\n\n        case 'BrtBeginPivotCacheIDs':\n          break;\n\n        case 'BrtBeginPivotCacheID':\n          break;\n\n        case 'BrtEndPivotCacheID':\n          break;\n\n        case 'BrtEndPivotCacheIDs':\n          break;\n\n        case 'BrtWebOpt':\n          break;\n\n        case 'BrtFileRecover':\n          break;\n\n        case 'BrtFileSharing':\n          break;\n\n        /*case 'BrtBeginWebPubItems': break;\r\n        case 'BrtBeginWebPubItem': break;\r\n        case 'BrtEndWebPubItem': break;\r\n        case 'BrtEndWebPubItems': break;*/\n\n        /* Smart Tags */\n\n        case 'BrtBeginSmartTagTypes':\n          break;\n\n        case 'BrtSmartTagType':\n          break;\n\n        case 'BrtEndSmartTagTypes':\n          break;\n\n        case 'BrtFRTBegin':\n          pass = true;\n          break;\n\n        case 'BrtFRTArchID$':\n          break;\n\n        case 'BrtWorkBookPr15':\n          break;\n\n        case 'BrtFRTEnd':\n          pass = false;\n          break;\n\n        case 'BrtEndBook':\n          break;\n\n        default:\n          if (!pass || opts.WTF) throw new Error(\"Unexpected record \" + R.n);\n      }\n    });\n    parse_wb_defaults(wb);\n    return wb;\n  }\n  /* [MS-XLSB] 2.1.7.60 Workbook */\n\n\n  function write_BUNDLESHS(ba, wb, opts) {\n    write_record(ba, \"BrtBeginBundleShs\");\n\n    for (var idx = 0; idx != wb.SheetNames.length; ++idx) {\n      var d = {\n        hsState: 0,\n        iTabID: idx + 1,\n        strRelID: 'rId' + (idx + 1),\n        name: wb.SheetNames[idx]\n      };\n      write_record(ba, \"BrtBundleSh\", write_BrtBundleSh(d));\n    }\n\n    write_record(ba, \"BrtEndBundleShs\");\n  }\n  /* [MS-XLSB] 2.4.643 BrtFileVersion */\n\n\n  function write_BrtFileVersion(data, o) {\n    if (!o) o = new_buf(127);\n\n    for (var i = 0; i != 4; ++i) {\n      o.write_shift(4, 0);\n    }\n\n    write_XLWideString(\"SheetJS\", o);\n    write_XLWideString(XLSX.version, o);\n    write_XLWideString(XLSX.version, o);\n    write_XLWideString(\"7262\", o);\n    o.length = o.l;\n    return o;\n  }\n  /* [MS-XLSB] 2.1.7.60 Workbook */\n\n\n  function write_BOOKVIEWS(ba, wb, opts) {\n    write_record(ba, \"BrtBeginBookViews\");\n    /* 1*(BrtBookView *FRT) */\n\n    write_record(ba, \"BrtEndBookViews\");\n  }\n  /* [MS-XLSB] 2.4.302 BrtCalcProp */\n\n\n  function write_BrtCalcProp(data, o) {\n    if (!o) o = new_buf(26);\n    o.write_shift(4, 0);\n    /* force recalc */\n\n    o.write_shift(4, 1);\n    o.write_shift(4, 0);\n    write_Xnum(0, o);\n    o.write_shift(-4, 1023);\n    o.write_shift(1, 0x33);\n    o.write_shift(1, 0x00);\n    return o;\n  }\n\n  function write_BrtFileRecover(data, o) {\n    if (!o) o = new_buf(1);\n    o.write_shift(1, 0);\n    return o;\n  }\n  /* [MS-XLSB] 2.1.7.60 Workbook */\n\n\n  function write_wb_bin(wb, opts) {\n    var ba = buf_array();\n    write_record(ba, \"BrtBeginBook\");\n    write_record(ba, \"BrtFileVersion\", write_BrtFileVersion());\n    /* [[BrtFileSharingIso] BrtFileSharing] */\n\n    write_record(ba, \"BrtWbProp\", write_BrtWbProp());\n    /* [ACABSPATH] */\n\n    /* [[BrtBookProtectionIso] BrtBookProtection] */\n\n    write_BOOKVIEWS(ba, wb, opts);\n    write_BUNDLESHS(ba, wb, opts);\n    /* [FNGROUP] */\n\n    /* [EXTERNALS] */\n\n    /* *BrtName */\n\n    write_record(ba, \"BrtCalcProp\", write_BrtCalcProp());\n    /* [BrtOleSize] */\n\n    /* *(BrtUserBookView *FRT) */\n\n    /* [PIVOTCACHEIDS] */\n\n    /* [BrtWbFactoid] */\n\n    /* [SMARTTAGTYPES] */\n\n    /* [BrtWebOpt] */\n\n    write_record(ba, \"BrtFileRecover\", write_BrtFileRecover());\n    /* [WEBPUBITEMS] */\n\n    /* [CRERRS] */\n\n    /* FRTWORKBOOK */\n\n    write_record(ba, \"BrtEndBook\");\n    return ba.end();\n  }\n\n  function parse_wb(data, name, opts) {\n    return (name.substr(-4) === \".bin\" ? parse_wb_bin : parse_wb_xml)(data, opts);\n  }\n\n  function parse_ws(data, name, opts, rels) {\n    return (name.substr(-4) === \".bin\" ? parse_ws_bin : parse_ws_xml)(data, opts, rels);\n  }\n\n  function parse_sty(data, name, opts) {\n    return (name.substr(-4) === \".bin\" ? parse_sty_bin : parse_sty_xml)(data, opts);\n  }\n\n  function parse_theme(data, name, opts) {\n    return parse_theme_xml(data, opts);\n  }\n\n  function parse_sst(data, name, opts) {\n    return (name.substr(-4) === \".bin\" ? parse_sst_bin : parse_sst_xml)(data, opts);\n  }\n\n  function parse_cmnt(data, name, opts) {\n    return (name.substr(-4) === \".bin\" ? parse_comments_bin : parse_comments_xml)(data, opts);\n  }\n\n  function parse_cc(data, name, opts) {\n    return (name.substr(-4) === \".bin\" ? parse_cc_bin : parse_cc_xml)(data, opts);\n  }\n\n  function write_wb(wb, name, opts) {\n    return (name.substr(-4) === \".bin\" ? write_wb_bin : write_wb_xml)(wb, opts);\n  }\n\n  function write_ws(data, name, opts, wb) {\n    return (name.substr(-4) === \".bin\" ? write_ws_bin : write_ws_xml)(data, opts, wb);\n  }\n\n  function write_sty(data, name, opts) {\n    return (name.substr(-4) === \".bin\" ? write_sty_bin : write_sty_xml)(data, opts);\n  }\n\n  function write_sst(data, name, opts) {\n    return (name.substr(-4) === \".bin\" ? write_sst_bin : write_sst_xml)(data, opts);\n  }\n  /*\r\n  function write_cmnt(data, name, opts) {\r\n  \treturn (name.substr(-4)===\".bin\" ? write_comments_bin : write_comments_xml)(data, opts);\r\n  }\r\n  \r\n  function write_cc(data, name, opts) {\r\n  \treturn (name.substr(-4)===\".bin\" ? write_cc_bin : write_cc_xml)(data, opts);\r\n  }\r\n  */\n\n\n  var attregexg2 = /([\\w:]+)=((?:\")([^\"]*)(?:\")|(?:')([^']*)(?:'))/g;\n  var attregex2 = /([\\w:]+)=((?:\")(?:[^\"]*)(?:\")|(?:')(?:[^']*)(?:'))/;\n\n  var _chr = function _chr(c) {\n    return String.fromCharCode(c);\n  };\n\n  function xlml_parsexmltag(tag, skip_root) {\n    var words = tag.split(/\\s+/);\n    var z = [];\n    if (!skip_root) z[0] = words[0];\n    if (words.length === 1) return z;\n    var m = tag.match(attregexg2),\n        y,\n        j,\n        w,\n        i;\n    if (m) for (i = 0; i != m.length; ++i) {\n      y = m[i].match(attregex2);\n      if ((j = y[1].indexOf(\":\")) === -1) z[y[1]] = y[2].substr(1, y[2].length - 2);else {\n        if (y[1].substr(0, 6) === \"xmlns:\") w = \"xmlns\" + y[1].substr(6);else w = y[1].substr(j + 1);\n        z[w] = y[2].substr(1, y[2].length - 2);\n      }\n    }\n    return z;\n  }\n\n  function xlml_parsexmltagobj(tag) {\n    var words = tag.split(/\\s+/);\n    var z = {};\n    if (words.length === 1) return z;\n    var m = tag.match(attregexg2),\n        y,\n        j,\n        w,\n        i;\n    if (m) for (i = 0; i != m.length; ++i) {\n      y = m[i].match(attregex2);\n      if ((j = y[1].indexOf(\":\")) === -1) z[y[1]] = y[2].substr(1, y[2].length - 2);else {\n        if (y[1].substr(0, 6) === \"xmlns:\") w = \"xmlns\" + y[1].substr(6);else w = y[1].substr(j + 1);\n        z[w] = y[2].substr(1, y[2].length - 2);\n      }\n    }\n    return z;\n  } // ----\n\n\n  function xlml_format(format, value) {\n    var fmt = XLMLFormatMap[format] || unescapexml(format);\n    if (fmt === \"General\") return SSF._general(value);\n    return SSF.format(fmt, value);\n  }\n\n  function xlml_set_custprop(Custprops, Rn, cp, val) {\n    switch ((cp[0].match(/dt:dt=\"([\\w.]+)\"/) || [\"\", \"\"])[1]) {\n      case \"boolean\":\n        val = parsexmlbool(val);\n        break;\n\n      case \"i2\":\n      case \"int\":\n        val = parseInt(val, 10);\n        break;\n\n      case \"r4\":\n      case \"float\":\n        val = parseFloat(val);\n        break;\n\n      case \"date\":\n      case \"dateTime.tz\":\n        val = new Date(val);\n        break;\n\n      case \"i8\":\n      case \"string\":\n      case \"fixed\":\n      case \"uuid\":\n      case \"bin.base64\":\n        break;\n\n      default:\n        throw \"bad custprop:\" + cp[0];\n    }\n\n    Custprops[unescapexml(Rn[3])] = val;\n  }\n\n  function safe_format_xlml(cell, nf, o) {\n    try {\n      if (cell.t === 'e') {\n        cell.w = cell.w || BErr[cell.v];\n      } else if (nf === \"General\") {\n        if (cell.t === 'n') {\n          if ((cell.v | 0) === cell.v) cell.w = SSF._general_int(cell.v);else cell.w = SSF._general_num(cell.v);\n        } else cell.w = SSF._general(cell.v);\n      } else cell.w = xlml_format(nf || \"General\", cell.v);\n\n      if (o.cellNF) cell.z = XLMLFormatMap[nf] || nf || \"General\";\n    } catch (e) {\n      if (o.WTF) throw e;\n    }\n  }\n\n  function process_style_xlml(styles, stag, opts) {\n    if (opts.cellStyles) {\n      if (stag.Interior) {\n        var I = stag.Interior;\n        if (I.Pattern) I.patternType = XLMLPatternTypeMap[I.Pattern] || I.Pattern;\n      }\n    }\n\n    styles[stag.ID] = stag;\n  }\n  /* TODO: there must exist some form of OSP-blessed spec */\n\n\n  function parse_xlml_data(xml, ss, data, cell, base, styles, csty, row, o) {\n    var nf = \"General\",\n        sid = cell.StyleID,\n        S = {};\n    o = o || {};\n    var interiors = [];\n    if (sid === undefined && row) sid = row.StyleID;\n    if (sid === undefined && csty) sid = csty.StyleID;\n\n    while (styles[sid] !== undefined) {\n      if (styles[sid].nf) nf = styles[sid].nf;\n      if (styles[sid].Interior) interiors.push(styles[sid].Interior);\n      if (!styles[sid].Parent) break;\n      sid = styles[sid].Parent;\n    }\n\n    switch (data.Type) {\n      case 'Boolean':\n        cell.t = 'b';\n        cell.v = parsexmlbool(xml);\n        break;\n\n      case 'String':\n        cell.t = 's';\n        cell.r = xlml_fixstr(unescapexml(xml));\n        cell.v = xml.indexOf(\"<\") > -1 ? ss : cell.r;\n        break;\n\n      case 'DateTime':\n        cell.v = (Date.parse(xml) - new Date(Date.UTC(1899, 11, 30))) / (24 * 60 * 60 * 1000);\n        if (cell.v !== cell.v) cell.v = unescapexml(xml);else if (cell.v >= 1 && cell.v < 60) cell.v = cell.v - 1;\n        if (!nf || nf == \"General\") nf = \"yyyy-mm-dd\";\n\n      /* falls through */\n\n      case 'Number':\n        if (cell.v === undefined) cell.v = +xml;\n        if (!cell.t) cell.t = 'n';\n        break;\n\n      case 'Error':\n        cell.t = 'e';\n        cell.v = RBErr[xml];\n        cell.w = xml;\n        break;\n\n      default:\n        cell.t = 's';\n        cell.v = xlml_fixstr(ss);\n        break;\n    }\n\n    safe_format_xlml(cell, nf, o);\n\n    if (o.cellFormula != null && cell.Formula) {\n      cell.f = rc_to_a1(unescapexml(cell.Formula), base);\n      cell.Formula = undefined;\n    }\n\n    if (o.cellStyles) {\n      interiors.forEach(function (x) {\n        if (!S.patternType && x.patternType) S.patternType = x.patternType;\n      });\n      cell.s = S;\n    }\n\n    cell.ixfe = cell.StyleID !== undefined ? cell.StyleID : 'Default';\n  }\n\n  function xlml_clean_comment(comment) {\n    comment.t = comment.v;\n    comment.v = comment.w = comment.ixfe = undefined;\n  }\n\n  function xlml_normalize(d) {\n    if (has_buf && Buffer.isBuffer(d)) return d.toString('utf8');\n    if (typeof d === 'string') return d;\n    throw \"badf\";\n  }\n  /* TODO: Everything */\n\n\n  var xlmlregex = /<(\\/?)([a-z0-9]*:|)(\\w+)[^>]*>/mg;\n\n  function parse_xlml_xml(d, opts) {\n    var str = xlml_normalize(d);\n    var Rn;\n    var state = [],\n        tmp;\n    var sheets = {},\n        sheetnames = [],\n        cursheet = {},\n        sheetname = \"\";\n    var table = {},\n        cell = {},\n        row = {},\n        dtag,\n        didx;\n    var c = 0,\n        r = 0;\n    var refguess = {\n      s: {\n        r: 1000000,\n        c: 1000000\n      },\n      e: {\n        r: 0,\n        c: 0\n      }\n    };\n    var styles = {},\n        stag = {};\n    var ss = \"\",\n        fidx = 0;\n    var mergecells = [];\n    var Props = {},\n        Custprops = {},\n        pidx = 0,\n        cp = {};\n    var comments = [],\n        comment = {};\n    var cstys = [],\n        csty;\n    xlmlregex.lastIndex = 0;\n\n    while (Rn = xlmlregex.exec(str)) {\n      switch (Rn[3]) {\n        case 'Data':\n          if (state[state.length - 1][1]) break;\n          if (Rn[1] === '/') parse_xlml_data(str.slice(didx, Rn.index), ss, dtag, state[state.length - 1][0] == \"Comment\" ? comment : cell, {\n            c: c,\n            r: r\n          }, styles, cstys[c], row, opts);else {\n            ss = \"\";\n            dtag = xlml_parsexmltag(Rn[0]);\n            didx = Rn.index + Rn[0].length;\n          }\n          break;\n\n        case 'Cell':\n          if (Rn[1] === '/') {\n            if (comments.length > 0) cell.c = comments;\n            if ((!opts.sheetRows || opts.sheetRows > r) && cell.v !== undefined) cursheet[encode_col(c) + encode_row(r)] = cell;\n\n            if (cell.HRef) {\n              cell.l = {\n                Target: cell.HRef,\n                tooltip: cell.HRefScreenTip\n              };\n              cell.HRef = cell.HRefScreenTip = undefined;\n            }\n\n            if (cell.MergeAcross || cell.MergeDown) {\n              var cc = c + (parseInt(cell.MergeAcross, 10) | 0);\n              var rr = r + (parseInt(cell.MergeDown, 10) | 0);\n              mergecells.push({\n                s: {\n                  c: c,\n                  r: r\n                },\n                e: {\n                  c: cc,\n                  r: rr\n                }\n              });\n            }\n\n            ++c;\n            if (cell.MergeAcross) c += +cell.MergeAcross;\n          } else {\n            cell = xlml_parsexmltagobj(Rn[0]);\n            if (cell.Index) c = +cell.Index - 1;\n            if (c < refguess.s.c) refguess.s.c = c;\n            if (c > refguess.e.c) refguess.e.c = c;\n            if (Rn[0].substr(-2) === \"/>\") ++c;\n            comments = [];\n          }\n\n          break;\n\n        case 'Row':\n          if (Rn[1] === '/' || Rn[0].substr(-2) === \"/>\") {\n            if (r < refguess.s.r) refguess.s.r = r;\n            if (r > refguess.e.r) refguess.e.r = r;\n\n            if (Rn[0].substr(-2) === \"/>\") {\n              row = xlml_parsexmltag(Rn[0]);\n              if (row.Index) r = +row.Index - 1;\n            }\n\n            c = 0;\n            ++r;\n          } else {\n            row = xlml_parsexmltag(Rn[0]);\n            if (row.Index) r = +row.Index - 1;\n          }\n\n          break;\n\n        case 'Worksheet':\n          /* TODO: read range from FullRows/FullColumns */\n          if (Rn[1] === '/') {\n            if ((tmp = state.pop())[0] !== Rn[3]) throw \"Bad state: \" + tmp;\n            sheetnames.push(sheetname);\n            if (refguess.s.r <= refguess.e.r && refguess.s.c <= refguess.e.c) cursheet[\"!ref\"] = encode_range(refguess);\n            if (mergecells.length) cursheet[\"!merges\"] = mergecells;\n            sheets[sheetname] = cursheet;\n          } else {\n            refguess = {\n              s: {\n                r: 1000000,\n                c: 1000000\n              },\n              e: {\n                r: 0,\n                c: 0\n              }\n            };\n            r = c = 0;\n            state.push([Rn[3], false]);\n            tmp = xlml_parsexmltag(Rn[0]);\n            sheetname = tmp.Name;\n            cursheet = {};\n            mergecells = [];\n          }\n\n          break;\n\n        case 'Table':\n          if (Rn[1] === '/') {\n            if ((tmp = state.pop())[0] !== Rn[3]) throw \"Bad state: \" + tmp;\n          } else if (Rn[0].slice(-2) == \"/>\") break;else {\n            table = xlml_parsexmltag(Rn[0]);\n            state.push([Rn[3], false]);\n            cstys = [];\n          }\n\n          break;\n\n        case 'Style':\n          if (Rn[1] === '/') process_style_xlml(styles, stag, opts);else stag = xlml_parsexmltag(Rn[0]);\n          break;\n\n        case 'NumberFormat':\n          stag.nf = xlml_parsexmltag(Rn[0]).Format || \"General\";\n          break;\n\n        case 'Column':\n          if (state[state.length - 1][0] !== 'Table') break;\n          csty = xlml_parsexmltag(Rn[0]);\n          cstys[csty.Index - 1 || cstys.length] = csty;\n\n          for (var i = 0; i < +csty.Span; ++i) {\n            cstys[cstys.length] = csty;\n          }\n\n          break;\n\n        case 'NamedRange':\n          break;\n\n        case 'NamedCell':\n          break;\n\n        case 'B':\n          break;\n\n        case 'I':\n          break;\n\n        case 'U':\n          break;\n\n        case 'S':\n          break;\n\n        case 'Sub':\n          break;\n\n        case 'Sup':\n          break;\n\n        case 'Span':\n          break;\n\n        case 'Border':\n          break;\n\n        case 'Alignment':\n          break;\n\n        case 'Borders':\n          break;\n\n        case 'Font':\n          if (Rn[0].substr(-2) === \"/>\") break;else if (Rn[1] === \"/\") ss += str.slice(fidx, Rn.index);else fidx = Rn.index + Rn[0].length;\n          break;\n\n        case 'Interior':\n          if (!opts.cellStyles) break;\n          stag.Interior = xlml_parsexmltag(Rn[0]);\n          break;\n\n        case 'Protection':\n          break;\n\n        case 'Author':\n        case 'Title':\n        case 'Description':\n        case 'Created':\n        case 'Keywords':\n        case 'Subject':\n        case 'Category':\n        case 'Company':\n        case 'LastAuthor':\n        case 'LastSaved':\n        case 'LastPrinted':\n        case 'Version':\n        case 'Revision':\n        case 'TotalTime':\n        case 'HyperlinkBase':\n        case 'Manager':\n          if (Rn[0].substr(-2) === \"/>\") break;else if (Rn[1] === \"/\") xlml_set_prop(Props, Rn[3], str.slice(pidx, Rn.index));else pidx = Rn.index + Rn[0].length;\n          break;\n\n        case 'Paragraphs':\n          break;\n\n        case 'Styles':\n        case 'Workbook':\n          if (Rn[1] === '/') {\n            if ((tmp = state.pop())[0] !== Rn[3]) throw \"Bad state: \" + tmp;\n          } else state.push([Rn[3], false]);\n\n          break;\n\n        case 'Comment':\n          if (Rn[1] === '/') {\n            if ((tmp = state.pop())[0] !== Rn[3]) throw \"Bad state: \" + tmp;\n            xlml_clean_comment(comment);\n            comments.push(comment);\n          } else {\n            state.push([Rn[3], false]);\n            tmp = xlml_parsexmltag(Rn[0]);\n            comment = {\n              a: tmp.Author\n            };\n          }\n\n          break;\n\n        case 'Name':\n          break;\n\n        case 'ComponentOptions':\n        case 'DocumentProperties':\n        case 'CustomDocumentProperties':\n        case 'OfficeDocumentSettings':\n        case 'PivotTable':\n        case 'PivotCache':\n        case 'Names':\n        case 'MapInfo':\n        case 'PageBreaks':\n        case 'QueryTable':\n        case 'DataValidation':\n        case 'AutoFilter':\n        case 'Sorting':\n        case 'Schema':\n        case 'data':\n        case 'ConditionalFormatting':\n        case 'SmartTagType':\n        case 'SmartTags':\n        case 'ExcelWorkbook':\n        case 'WorkbookOptions':\n        case 'WorksheetOptions':\n          if (Rn[1] === '/') {\n            if ((tmp = state.pop())[0] !== Rn[3]) throw \"Bad state: \" + tmp;\n          } else if (Rn[0].charAt(Rn[0].length - 2) !== '/') state.push([Rn[3], true]);\n\n          break;\n\n        default:\n          var seen = true;\n\n          switch (state[state.length - 1][0]) {\n            /* OfficeDocumentSettings */\n            case 'OfficeDocumentSettings':\n              switch (Rn[3]) {\n                case 'AllowPNG':\n                  break;\n\n                case 'RemovePersonalInformation':\n                  break;\n\n                case 'DownloadComponents':\n                  break;\n\n                case 'LocationOfComponents':\n                  break;\n\n                case 'Colors':\n                  break;\n\n                case 'Color':\n                  break;\n\n                case 'Index':\n                  break;\n\n                case 'RGB':\n                  break;\n\n                case 'PixelsPerInch':\n                  break;\n\n                case 'TargetScreenSize':\n                  break;\n\n                case 'ReadOnlyRecommended':\n                  break;\n\n                default:\n                  seen = false;\n              }\n\n              break;\n\n            /* ComponentOptions */\n\n            case 'ComponentOptions':\n              switch (Rn[3]) {\n                case 'Toolbar':\n                  break;\n\n                case 'HideOfficeLogo':\n                  break;\n\n                case 'SpreadsheetAutoFit':\n                  break;\n\n                case 'Label':\n                  break;\n\n                case 'Caption':\n                  break;\n\n                case 'MaxHeight':\n                  break;\n\n                case 'MaxWidth':\n                  break;\n\n                case 'NextSheetNumber':\n                  break;\n\n                default:\n                  seen = false;\n              }\n\n              break;\n\n            /* ExcelWorkbook */\n\n            case 'ExcelWorkbook':\n              switch (Rn[3]) {\n                case 'WindowHeight':\n                  break;\n\n                case 'WindowWidth':\n                  break;\n\n                case 'WindowTopX':\n                  break;\n\n                case 'WindowTopY':\n                  break;\n\n                case 'TabRatio':\n                  break;\n\n                case 'ProtectStructure':\n                  break;\n\n                case 'ProtectWindows':\n                  break;\n\n                case 'ActiveSheet':\n                  break;\n\n                case 'DisplayInkNotes':\n                  break;\n\n                case 'FirstVisibleSheet':\n                  break;\n\n                case 'SupBook':\n                  break;\n\n                case 'SheetName':\n                  break;\n\n                case 'SheetIndex':\n                  break;\n\n                case 'SheetIndexFirst':\n                  break;\n\n                case 'SheetIndexLast':\n                  break;\n\n                case 'Dll':\n                  break;\n\n                case 'AcceptLabelsInFormulas':\n                  break;\n\n                case 'DoNotSaveLinkValues':\n                  break;\n\n                case 'Date1904':\n                  break;\n\n                case 'Iteration':\n                  break;\n\n                case 'MaxIterations':\n                  break;\n\n                case 'MaxChange':\n                  break;\n\n                case 'Path':\n                  break;\n\n                case 'Xct':\n                  break;\n\n                case 'Count':\n                  break;\n\n                case 'SelectedSheets':\n                  break;\n\n                case 'Calculation':\n                  break;\n\n                case 'Uncalced':\n                  break;\n\n                case 'StartupPrompt':\n                  break;\n\n                case 'Crn':\n                  break;\n\n                case 'ExternName':\n                  break;\n\n                case 'Formula':\n                  break;\n\n                case 'ColFirst':\n                  break;\n\n                case 'ColLast':\n                  break;\n\n                case 'WantAdvise':\n                  break;\n\n                case 'Boolean':\n                  break;\n\n                case 'Error':\n                  break;\n\n                case 'Text':\n                  break;\n\n                case 'OLE':\n                  break;\n\n                case 'NoAutoRecover':\n                  break;\n\n                case 'PublishObjects':\n                  break;\n\n                case 'DoNotCalculateBeforeSave':\n                  break;\n\n                case 'Number':\n                  break;\n\n                case 'RefModeR1C1':\n                  break;\n\n                case 'EmbedSaveSmartTags':\n                  break;\n\n                default:\n                  seen = false;\n              }\n\n              break;\n\n            /* WorkbookOptions */\n\n            case 'WorkbookOptions':\n              switch (Rn[3]) {\n                case 'OWCVersion':\n                  break;\n\n                case 'Height':\n                  break;\n\n                case 'Width':\n                  break;\n\n                default:\n                  seen = false;\n              }\n\n              break;\n\n            /* WorksheetOptions */\n\n            case 'WorksheetOptions':\n              switch (Rn[3]) {\n                case 'Unsynced':\n                  break;\n\n                case 'Visible':\n                  break;\n\n                case 'Print':\n                  break;\n\n                case 'Panes':\n                  break;\n\n                case 'Scale':\n                  break;\n\n                case 'Pane':\n                  break;\n\n                case 'Number':\n                  break;\n\n                case 'Layout':\n                  break;\n\n                case 'Header':\n                  break;\n\n                case 'Footer':\n                  break;\n\n                case 'PageSetup':\n                  break;\n\n                case 'PageMargins':\n                  break;\n\n                case 'Selected':\n                  break;\n\n                case 'ProtectObjects':\n                  break;\n\n                case 'EnableSelection':\n                  break;\n\n                case 'ProtectScenarios':\n                  break;\n\n                case 'ValidPrinterInfo':\n                  break;\n\n                case 'HorizontalResolution':\n                  break;\n\n                case 'VerticalResolution':\n                  break;\n\n                case 'NumberofCopies':\n                  break;\n\n                case 'ActiveRow':\n                  break;\n\n                case 'ActiveCol':\n                  break;\n\n                case 'ActivePane':\n                  break;\n\n                case 'TopRowVisible':\n                  break;\n\n                case 'TopRowBottomPane':\n                  break;\n\n                case 'LeftColumnVisible':\n                  break;\n\n                case 'LeftColumnRightPane':\n                  break;\n\n                case 'FitToPage':\n                  break;\n\n                case 'RangeSelection':\n                  break;\n\n                case 'PaperSizeIndex':\n                  break;\n\n                case 'PageLayoutZoom':\n                  break;\n\n                case 'PageBreakZoom':\n                  break;\n\n                case 'FilterOn':\n                  break;\n\n                case 'DoNotDisplayGridlines':\n                  break;\n\n                case 'SplitHorizontal':\n                  break;\n\n                case 'SplitVertical':\n                  break;\n\n                case 'FreezePanes':\n                  break;\n\n                case 'FrozenNoSplit':\n                  break;\n\n                case 'FitWidth':\n                  break;\n\n                case 'FitHeight':\n                  break;\n\n                case 'CommentsLayout':\n                  break;\n\n                case 'Zoom':\n                  break;\n\n                case 'LeftToRight':\n                  break;\n\n                case 'Gridlines':\n                  break;\n\n                case 'AllowSort':\n                  break;\n\n                case 'AllowFilter':\n                  break;\n\n                case 'AllowInsertRows':\n                  break;\n\n                case 'AllowDeleteRows':\n                  break;\n\n                case 'AllowInsertCols':\n                  break;\n\n                case 'AllowDeleteCols':\n                  break;\n\n                case 'AllowInsertHyperlinks':\n                  break;\n\n                case 'AllowFormatCells':\n                  break;\n\n                case 'AllowSizeCols':\n                  break;\n\n                case 'AllowSizeRows':\n                  break;\n\n                case 'NoSummaryRowsBelowDetail':\n                  break;\n\n                case 'TabColorIndex':\n                  break;\n\n                case 'DoNotDisplayHeadings':\n                  break;\n\n                case 'ShowPageLayoutZoom':\n                  break;\n\n                case 'NoSummaryColumnsRightDetail':\n                  break;\n\n                case 'BlackAndWhite':\n                  break;\n\n                case 'DoNotDisplayZeros':\n                  break;\n\n                case 'DisplayPageBreak':\n                  break;\n\n                case 'RowColHeadings':\n                  break;\n\n                case 'DoNotDisplayOutline':\n                  break;\n\n                case 'NoOrientation':\n                  break;\n\n                case 'AllowUsePivotTables':\n                  break;\n\n                case 'ZeroHeight':\n                  break;\n\n                case 'ViewableRange':\n                  break;\n\n                case 'Selection':\n                  break;\n\n                case 'ProtectContents':\n                  break;\n\n                default:\n                  seen = false;\n              }\n\n              break;\n\n            /* PivotTable */\n\n            case 'PivotTable':\n            case 'PivotCache':\n              switch (Rn[3]) {\n                case 'ImmediateItemsOnDrop':\n                  break;\n\n                case 'ShowPageMultipleItemLabel':\n                  break;\n\n                case 'CompactRowIndent':\n                  break;\n\n                case 'Location':\n                  break;\n\n                case 'PivotField':\n                  break;\n\n                case 'Orientation':\n                  break;\n\n                case 'LayoutForm':\n                  break;\n\n                case 'LayoutSubtotalLocation':\n                  break;\n\n                case 'LayoutCompactRow':\n                  break;\n\n                case 'Position':\n                  break;\n\n                case 'PivotItem':\n                  break;\n\n                case 'DataType':\n                  break;\n\n                case 'DataField':\n                  break;\n\n                case 'SourceName':\n                  break;\n\n                case 'ParentField':\n                  break;\n\n                case 'PTLineItems':\n                  break;\n\n                case 'PTLineItem':\n                  break;\n\n                case 'CountOfSameItems':\n                  break;\n\n                case 'Item':\n                  break;\n\n                case 'ItemType':\n                  break;\n\n                case 'PTSource':\n                  break;\n\n                case 'CacheIndex':\n                  break;\n\n                case 'ConsolidationReference':\n                  break;\n\n                case 'FileName':\n                  break;\n\n                case 'Reference':\n                  break;\n\n                case 'NoColumnGrand':\n                  break;\n\n                case 'NoRowGrand':\n                  break;\n\n                case 'BlankLineAfterItems':\n                  break;\n\n                case 'Hidden':\n                  break;\n\n                case 'Subtotal':\n                  break;\n\n                case 'BaseField':\n                  break;\n\n                case 'MapChildItems':\n                  break;\n\n                case 'Function':\n                  break;\n\n                case 'RefreshOnFileOpen':\n                  break;\n\n                case 'PrintSetTitles':\n                  break;\n\n                case 'MergeLabels':\n                  break;\n\n                case 'DefaultVersion':\n                  break;\n\n                case 'RefreshName':\n                  break;\n\n                case 'RefreshDate':\n                  break;\n\n                case 'RefreshDateCopy':\n                  break;\n\n                case 'VersionLastRefresh':\n                  break;\n\n                case 'VersionLastUpdate':\n                  break;\n\n                case 'VersionUpdateableMin':\n                  break;\n\n                case 'VersionRefreshableMin':\n                  break;\n\n                case 'Calculation':\n                  break;\n\n                default:\n                  seen = false;\n              }\n\n              break;\n\n            /* PageBreaks */\n\n            case 'PageBreaks':\n              switch (Rn[3]) {\n                case 'ColBreaks':\n                  break;\n\n                case 'ColBreak':\n                  break;\n\n                case 'RowBreaks':\n                  break;\n\n                case 'RowBreak':\n                  break;\n\n                case 'ColStart':\n                  break;\n\n                case 'ColEnd':\n                  break;\n\n                case 'RowEnd':\n                  break;\n\n                default:\n                  seen = false;\n              }\n\n              break;\n\n            /* AutoFilter */\n\n            case 'AutoFilter':\n              switch (Rn[3]) {\n                case 'AutoFilterColumn':\n                  break;\n\n                case 'AutoFilterCondition':\n                  break;\n\n                case 'AutoFilterAnd':\n                  break;\n\n                case 'AutoFilterOr':\n                  break;\n\n                default:\n                  seen = false;\n              }\n\n              break;\n\n            /* QueryTable */\n\n            case 'QueryTable':\n              switch (Rn[3]) {\n                case 'Id':\n                  break;\n\n                case 'AutoFormatFont':\n                  break;\n\n                case 'AutoFormatPattern':\n                  break;\n\n                case 'QuerySource':\n                  break;\n\n                case 'QueryType':\n                  break;\n\n                case 'EnableRedirections':\n                  break;\n\n                case 'RefreshedInXl9':\n                  break;\n\n                case 'URLString':\n                  break;\n\n                case 'HTMLTables':\n                  break;\n\n                case 'Connection':\n                  break;\n\n                case 'CommandText':\n                  break;\n\n                case 'RefreshInfo':\n                  break;\n\n                case 'NoTitles':\n                  break;\n\n                case 'NextId':\n                  break;\n\n                case 'ColumnInfo':\n                  break;\n\n                case 'OverwriteCells':\n                  break;\n\n                case 'DoNotPromptForFile':\n                  break;\n\n                case 'TextWizardSettings':\n                  break;\n\n                case 'Source':\n                  break;\n\n                case 'Number':\n                  break;\n\n                case 'Decimal':\n                  break;\n\n                case 'ThousandSeparator':\n                  break;\n\n                case 'TrailingMinusNumbers':\n                  break;\n\n                case 'FormatSettings':\n                  break;\n\n                case 'FieldType':\n                  break;\n\n                case 'Delimiters':\n                  break;\n\n                case 'Tab':\n                  break;\n\n                case 'Comma':\n                  break;\n\n                case 'AutoFormatName':\n                  break;\n\n                case 'VersionLastEdit':\n                  break;\n\n                case 'VersionLastRefresh':\n                  break;\n\n                default:\n                  seen = false;\n              }\n\n              break;\n\n            /* Sorting */\n\n            case 'Sorting':\n            /* ConditionalFormatting */\n\n            case 'ConditionalFormatting':\n            /* DataValidation */\n\n            case 'DataValidation':\n              switch (Rn[3]) {\n                case 'Range':\n                  break;\n\n                case 'Type':\n                  break;\n\n                case 'Min':\n                  break;\n\n                case 'Max':\n                  break;\n\n                case 'Sort':\n                  break;\n\n                case 'Descending':\n                  break;\n\n                case 'Order':\n                  break;\n\n                case 'CaseSensitive':\n                  break;\n\n                case 'Value':\n                  break;\n\n                case 'ErrorStyle':\n                  break;\n\n                case 'ErrorMessage':\n                  break;\n\n                case 'ErrorTitle':\n                  break;\n\n                case 'CellRangeList':\n                  break;\n\n                case 'InputMessage':\n                  break;\n\n                case 'InputTitle':\n                  break;\n\n                case 'ComboHide':\n                  break;\n\n                case 'InputHide':\n                  break;\n\n                case 'Condition':\n                  break;\n\n                case 'Qualifier':\n                  break;\n\n                case 'UseBlank':\n                  break;\n\n                case 'Value1':\n                  break;\n\n                case 'Value2':\n                  break;\n\n                case 'Format':\n                  break;\n\n                default:\n                  seen = false;\n              }\n\n              break;\n\n            /* MapInfo (schema) */\n\n            case 'MapInfo':\n            case 'Schema':\n            case 'data':\n              switch (Rn[3]) {\n                case 'Map':\n                  break;\n\n                case 'Entry':\n                  break;\n\n                case 'Range':\n                  break;\n\n                case 'XPath':\n                  break;\n\n                case 'Field':\n                  break;\n\n                case 'XSDType':\n                  break;\n\n                case 'FilterOn':\n                  break;\n\n                case 'Aggregate':\n                  break;\n\n                case 'ElementType':\n                  break;\n\n                case 'AttributeType':\n                  break;\n\n                /* These are from xsd (XML Schema Definition) */\n\n                case 'schema':\n                case 'element':\n                case 'complexType':\n                case 'datatype':\n                case 'all':\n                case 'attribute':\n                case 'extends':\n                  break;\n\n                case 'row':\n                  break;\n\n                default:\n                  seen = false;\n              }\n\n              break;\n\n            /* SmartTags (can be anything) */\n\n            case 'SmartTags':\n              break;\n\n            default:\n              seen = false;\n              break;\n          }\n\n          if (seen) break;\n          /* CustomDocumentProperties */\n\n          if (!state[state.length - 1][1]) throw 'Unrecognized tag: ' + Rn[3] + \"|\" + state.join(\"|\");\n\n          if (state[state.length - 1][0] === 'CustomDocumentProperties') {\n            if (Rn[0].substr(-2) === \"/>\") break;else if (Rn[1] === \"/\") xlml_set_custprop(Custprops, Rn, cp, str.slice(pidx, Rn.index));else {\n              cp = Rn;\n              pidx = Rn.index + Rn[0].length;\n            }\n            break;\n          }\n\n          if (opts.WTF) throw 'Unrecognized tag: ' + Rn[3] + \"|\" + state.join(\"|\");\n      }\n    }\n\n    var out = {};\n    if (!opts.bookSheets && !opts.bookProps) out.Sheets = sheets;\n    out.SheetNames = sheetnames;\n    out.SSF = SSF.get_table();\n    out.Props = Props;\n    out.Custprops = Custprops;\n    return out;\n  }\n\n  function parse_xlml(data, opts) {\n    fix_read_opts(opts = opts || {});\n\n    switch (opts.type || \"base64\") {\n      case \"base64\":\n        return parse_xlml_xml(Base64.decode(data), opts);\n\n      case \"binary\":\n      case \"buffer\":\n      case \"file\":\n        return parse_xlml_xml(data, opts);\n\n      case \"array\":\n        return parse_xlml_xml(data.map(_chr).join(\"\"), opts);\n    }\n  }\n\n  function write_xlml(wb, opts) {}\n  /* [MS-OLEDS] 2.3.8 CompObjStream */\n\n\n  function parse_compobj(obj) {\n    var v = {};\n    var o = obj.content;\n    /* [MS-OLEDS] 2.3.7 CompObjHeader -- All fields MUST be ignored */\n\n    var l = 28,\n        m;\n    m = __lpstr(o, l);\n    l += 4 + __readUInt32LE(o, l);\n    v.UserType = m;\n    /* [MS-OLEDS] 2.3.1 ClipboardFormatOrAnsiString */\n\n    m = __readUInt32LE(o, l);\n    l += 4;\n\n    switch (m) {\n      case 0x00000000:\n        break;\n\n      case 0xffffffff:\n      case 0xfffffffe:\n        l += 4;\n        break;\n\n      default:\n        if (m > 0x190) throw new Error(\"Unsupported Clipboard: \" + m.toString(16));\n        l += m;\n    }\n\n    m = __lpstr(o, l);\n    l += m.length === 0 ? 0 : 5 + m.length;\n    v.Reserved1 = m;\n    if ((m = __readUInt32LE(o, l)) !== 0x71b2e9f4) return v;\n    throw \"Unsupported Unicode Extension\";\n  }\n  /* 2.4.58 Continue logic */\n\n\n  function slurp(R, blob, length, opts) {\n    var l = length;\n    var bufs = [];\n    var d = blob.slice(blob.l, blob.l + l);\n    if (opts && opts.enc && opts.enc.insitu_decrypt) switch (R.n) {\n      case 'BOF':\n      case 'FilePass':\n      case 'FileLock':\n      case 'InterfaceHdr':\n      case 'RRDInfo':\n      case 'RRDHead':\n      case 'UsrExcl':\n        break;\n\n      default:\n        if (d.length === 0) break;\n        opts.enc.insitu_decrypt(d);\n    }\n    bufs.push(d);\n    blob.l += l;\n\n    var next = XLSRecordEnum[__readUInt16LE(blob, blob.l)];\n\n    while (next != null && next.n === 'Continue') {\n      l = __readUInt16LE(blob, blob.l + 2);\n      bufs.push(blob.slice(blob.l + 4, blob.l + 4 + l));\n      blob.l += 4 + l;\n      next = XLSRecordEnum[__readUInt16LE(blob, blob.l)];\n    }\n\n    var b = bconcat(bufs);\n    prep_blob(b, 0);\n    var ll = 0;\n    b.lens = [];\n\n    for (var j = 0; j < bufs.length; ++j) {\n      b.lens.push(ll);\n      ll += bufs[j].length;\n    }\n\n    return R.f(b, b.length, opts);\n  }\n\n  function safe_format_xf(p, opts, date1904) {\n    if (!p.XF) return;\n\n    try {\n      var fmtid = p.XF.ifmt || 0;\n\n      if (p.t === 'e') {\n        p.w = p.w || BErr[p.v];\n      } else if (fmtid === 0) {\n        if (p.t === 'n') {\n          if ((p.v | 0) === p.v) p.w = SSF._general_int(p.v);else p.w = SSF._general_num(p.v);\n        } else p.w = SSF._general(p.v);\n      } else p.w = SSF.format(fmtid, p.v, {\n        date1904: date1904 || false\n      });\n\n      if (opts.cellNF) p.z = SSF._table[fmtid];\n    } catch (e) {\n      if (opts.WTF) throw e;\n    }\n  }\n\n  function make_cell(val, ixfe, t) {\n    return {\n      v: val,\n      ixfe: ixfe,\n      t: t\n    };\n  } // 2.3.2\n\n\n  function parse_workbook(blob, options) {\n    var wb = {\n      opts: {}\n    };\n    var Sheets = {};\n    var out = {};\n    var Directory = {};\n    var found_sheet = false;\n    var range = {};\n    var last_formula = null;\n    var sst = [];\n    var cur_sheet = \"\";\n    var Preamble = {};\n    var lastcell, last_cell, cc, cmnt, rng, rngC, rngR;\n    var shared_formulae = {};\n    var array_formulae = [];\n    /* TODO: something more clever */\n\n    var temp_val;\n    var country;\n    var cell_valid = true;\n    var XFs = [];\n    /* XF records */\n\n    var palette = [];\n\n    var get_rgb = function getrgb(icv) {\n      if (icv < 8) return XLSIcv[icv];\n      if (icv < 64) return palette[icv - 8] || XLSIcv[icv];\n      return XLSIcv[icv];\n    };\n\n    var process_cell_style = function pcs(cell, line) {\n      var xfd = line.XF.data;\n      if (!xfd || !xfd.patternType) return;\n      line.s = {};\n      line.s.patternType = xfd.patternType;\n      var t;\n\n      if (t = rgb2Hex(get_rgb(xfd.icvFore))) {\n        line.s.fgColor = {\n          rgb: t\n        };\n      }\n\n      if (t = rgb2Hex(get_rgb(xfd.icvBack))) {\n        line.s.bgColor = {\n          rgb: t\n        };\n      }\n    };\n\n    var addcell = function addcell(cell, line, options) {\n      if (!cell_valid) return;\n      if (options.cellStyles && line.XF && line.XF.data) process_cell_style(cell, line);\n      lastcell = cell;\n      last_cell = encode_cell(cell);\n\n      if (range.s) {\n        if (cell.r < range.s.r) range.s.r = cell.r;\n        if (cell.c < range.s.c) range.s.c = cell.c;\n      }\n\n      if (range.e) {\n        if (cell.r + 1 > range.e.r) range.e.r = cell.r + 1;\n        if (cell.c + 1 > range.e.c) range.e.c = cell.c + 1;\n      }\n\n      if (options.sheetRows && lastcell.r >= options.sheetRows) cell_valid = false;else out[last_cell] = line;\n    };\n\n    var opts = {\n      enc: false,\n      // encrypted\n      sbcch: 0,\n      // cch in the preceding SupBook\n      snames: [],\n      // sheetnames\n      sharedf: shared_formulae,\n      // shared formulae by address\n      arrayf: array_formulae,\n      // array formulae array\n      rrtabid: [],\n      // RRTabId\n      lastuser: \"\",\n      // Last User from WriteAccess\n      biff: 8,\n      // BIFF version\n      codepage: 0,\n      // CP from CodePage record\n      winlocked: 0,\n      // fLockWn from WinProtect\n      wtf: false\n    };\n    if (options.password) opts.password = options.password;\n    var mergecells = [];\n    var objects = [];\n    var supbooks = [[]]; // 1-indexed, will hold extern names\n\n    var sbc = 0,\n        sbci = 0,\n        sbcli = 0;\n    supbooks.SheetNames = opts.snames;\n    supbooks.sharedf = opts.sharedf;\n    supbooks.arrayf = opts.arrayf;\n    var last_Rn = '';\n    var file_depth = 0;\n    /* TODO: make a real stack */\n\n    /* explicit override for some broken writers */\n\n    opts.codepage = 1200;\n    set_cp(1200);\n\n    while (blob.l < blob.length - 1) {\n      var s = blob.l;\n      var RecordType = blob.read_shift(2);\n      if (RecordType === 0 && last_Rn === 'EOF') break;\n      var length = blob.l === blob.length ? 0 : blob.read_shift(2),\n          y;\n      var R = XLSRecordEnum[RecordType];\n\n      if (R && R.f) {\n        if (options.bookSheets) {\n          if (last_Rn === 'BoundSheet8' && R.n !== 'BoundSheet8') break;\n        }\n\n        last_Rn = R.n;\n\n        if (R.r === 2 || R.r == 12) {\n          var rt = blob.read_shift(2);\n          length -= 2;\n          if (!opts.enc && rt !== RecordType) throw \"rt mismatch\";\n\n          if (R.r == 12) {\n            blob.l += 10;\n            length -= 10;\n          } // skip FRT\n\n        } //console.error(R,blob.l,length,blob.length);\n\n\n        var val;\n        if (R.n === 'EOF') val = R.f(blob, length, opts);else val = slurp(R, blob, length, opts);\n        var Rn = R.n;\n        /* BIFF5 overrides */\n\n        if (opts.biff === 5 || opts.biff === 2) switch (Rn) {\n          case 'Lbl':\n            Rn = 'Label';\n            break;\n        }\n        /* nested switch statements to workaround V8 128 limit */\n\n        switch (Rn) {\n          /* Workbook Options */\n          case 'Date1904':\n            wb.opts.Date1904 = val;\n            break;\n\n          case 'WriteProtect':\n            wb.opts.WriteProtect = true;\n            break;\n\n          case 'FilePass':\n            if (!opts.enc) blob.l = 0;\n            opts.enc = val;\n            if (opts.WTF) console.error(val);\n            if (!options.password) throw new Error(\"File is password-protected\");\n            if (val.Type !== 0) throw new Error(\"Encryption scheme unsupported\");\n            if (!val.valid) throw new Error(\"Password is incorrect\");\n            break;\n\n          case 'WriteAccess':\n            opts.lastuser = val;\n            break;\n\n          case 'FileSharing':\n            break;\n          //TODO\n\n          case 'CodePage':\n            /* overrides based on test cases */\n            if (val === 0x5212) val = 1200;else if (val === 0x8001) val = 1252;\n            opts.codepage = val;\n            set_cp(val);\n            break;\n\n          case 'RRTabId':\n            opts.rrtabid = val;\n            break;\n\n          case 'WinProtect':\n            opts.winlocked = val;\n            break;\n\n          case 'Template':\n            break;\n          // TODO\n\n          case 'RefreshAll':\n            wb.opts.RefreshAll = val;\n            break;\n\n          case 'BookBool':\n            break;\n          // TODO\n\n          case 'UsesELFs':\n            /* if(val) console.error(\"Unsupported ELFs\"); */\n            break;\n\n          case 'MTRSettings':\n            {\n              if (val[0] && val[1]) throw \"Unsupported threads: \" + val;\n            }\n            break;\n          // TODO: actually support threads\n\n          case 'CalcCount':\n            wb.opts.CalcCount = val;\n            break;\n\n          case 'CalcDelta':\n            wb.opts.CalcDelta = val;\n            break;\n\n          case 'CalcIter':\n            wb.opts.CalcIter = val;\n            break;\n\n          case 'CalcMode':\n            wb.opts.CalcMode = val;\n            break;\n\n          case 'CalcPrecision':\n            wb.opts.CalcPrecision = val;\n            break;\n\n          case 'CalcSaveRecalc':\n            wb.opts.CalcSaveRecalc = val;\n            break;\n\n          case 'CalcRefMode':\n            opts.CalcRefMode = val;\n            break;\n          // TODO: implement R1C1\n\n          case 'Uncalced':\n            break;\n\n          case 'ForceFullCalculation':\n            wb.opts.FullCalc = val;\n            break;\n\n          case 'WsBool':\n            break;\n          // TODO\n\n          case 'XF':\n            XFs.push(val);\n            break;\n\n          case 'ExtSST':\n            break;\n          // TODO\n\n          case 'BookExt':\n            break;\n          // TODO\n\n          case 'RichTextStream':\n            break;\n\n          case 'BkHim':\n            break;\n\n          case 'SupBook':\n            supbooks[++sbc] = [val];\n            sbci = 0;\n            break;\n\n          case 'ExternName':\n            supbooks[sbc][++sbci] = val;\n            break;\n\n          case 'Index':\n            break;\n          // TODO\n\n          case 'Lbl':\n            supbooks[0][++sbcli] = val;\n            break;\n\n          case 'ExternSheet':\n            supbooks[sbc] = supbooks[sbc].concat(val);\n            sbci += val.length;\n            break;\n\n          case 'Protect':\n            out[\"!protect\"] = val;\n            break;\n\n          /* for sheet or book */\n\n          case 'Password':\n            if (val !== 0 && opts.WTF) console.error(\"Password verifier: \" + val);\n            break;\n\n          case 'Prot4Rev':\n          case 'Prot4RevPass':\n            break;\n\n          /*TODO: Revision Control*/\n\n          case 'BoundSheet8':\n            {\n              Directory[val.pos] = val;\n              opts.snames.push(val.name);\n            }\n            break;\n\n          case 'EOF':\n            {\n              if (--file_depth) break;\n\n              if (range.e) {\n                out[\"!range\"] = range;\n\n                if (range.e.r > 0 && range.e.c > 0) {\n                  range.e.r--;\n                  range.e.c--;\n                  out[\"!ref\"] = encode_range(range);\n                  range.e.r++;\n                  range.e.c++;\n                }\n\n                if (mergecells.length > 0) out[\"!merges\"] = mergecells;\n                if (objects.length > 0) out[\"!objects\"] = objects;\n              }\n\n              if (cur_sheet === \"\") Preamble = out;else Sheets[cur_sheet] = out;\n              out = {};\n            }\n            break;\n\n          case 'BOF':\n            {\n              if (opts.biff !== 8) ;else if (val.BIFFVer === 0x0500) opts.biff = 5;else if (val.BIFFVer === 0x0002) opts.biff = 2;else if (val.BIFFVer === 0x0007) opts.biff = 2;\n              if (file_depth++) break;\n              cell_valid = true;\n              out = {};\n\n              if (opts.biff === 2) {\n                if (cur_sheet === \"\") cur_sheet = \"Sheet1\";\n                range = {\n                  s: {\n                    r: 0,\n                    c: 0\n                  },\n                  e: {\n                    r: 0,\n                    c: 0\n                  }\n                };\n              } else cur_sheet = (Directory[s] || {\n                name: \"\"\n              }).name;\n\n              mergecells = [];\n              objects = [];\n            }\n            break;\n\n          case 'Number':\n          case 'BIFF2NUM':\n            {\n              temp_val = {\n                ixfe: val.ixfe,\n                XF: XFs[val.ixfe],\n                v: val.val,\n                t: 'n'\n              };\n              if (temp_val.XF) safe_format_xf(temp_val, options, wb.opts.Date1904);\n              addcell({\n                c: val.c,\n                r: val.r\n              }, temp_val, options);\n            }\n            break;\n\n          case 'BoolErr':\n            {\n              temp_val = {\n                ixfe: val.ixfe,\n                XF: XFs[val.ixfe],\n                v: val.val,\n                t: val.t\n              };\n              if (temp_val.XF) safe_format_xf(temp_val, options, wb.opts.Date1904);\n              addcell({\n                c: val.c,\n                r: val.r\n              }, temp_val, options);\n            }\n            break;\n\n          case 'RK':\n            {\n              temp_val = {\n                ixfe: val.ixfe,\n                XF: XFs[val.ixfe],\n                v: val.rknum,\n                t: 'n'\n              };\n              if (temp_val.XF) safe_format_xf(temp_val, options, wb.opts.Date1904);\n              addcell({\n                c: val.c,\n                r: val.r\n              }, temp_val, options);\n            }\n            break;\n\n          case 'MulRk':\n            {\n              for (var j = val.c; j <= val.C; ++j) {\n                var ixfe = val.rkrec[j - val.c][0];\n                temp_val = {\n                  ixfe: ixfe,\n                  XF: XFs[ixfe],\n                  v: val.rkrec[j - val.c][1],\n                  t: 'n'\n                };\n                if (temp_val.XF) safe_format_xf(temp_val, options, wb.opts.Date1904);\n                addcell({\n                  c: j,\n                  r: val.r\n                }, temp_val, options);\n              }\n            }\n            break;\n\n          case 'Formula':\n            {\n              switch (val.val) {\n                case 'String':\n                  last_formula = val;\n                  break;\n\n                case 'Array Formula':\n                  throw \"Array Formula unsupported\";\n\n                default:\n                  temp_val = {\n                    v: val.val,\n                    ixfe: val.cell.ixfe,\n                    t: val.tt\n                  };\n                  temp_val.XF = XFs[temp_val.ixfe];\n                  if (options.cellFormula) temp_val.f = \"=\" + stringify_formula(val.formula, range, val.cell, supbooks, opts);\n                  if (temp_val.XF) safe_format_xf(temp_val, options, wb.opts.Date1904);\n                  addcell(val.cell, temp_val, options);\n                  last_formula = val;\n              }\n            }\n            break;\n\n          case 'String':\n            {\n              if (last_formula) {\n                last_formula.val = val;\n                temp_val = {\n                  v: last_formula.val,\n                  ixfe: last_formula.cell.ixfe,\n                  t: 's'\n                };\n                temp_val.XF = XFs[temp_val.ixfe];\n                if (options.cellFormula) temp_val.f = \"=\" + stringify_formula(last_formula.formula, range, last_formula.cell, supbooks, opts);\n                if (temp_val.XF) safe_format_xf(temp_val, options, wb.opts.Date1904);\n                addcell(last_formula.cell, temp_val, options);\n                last_formula = null;\n              }\n            }\n            break;\n\n          case 'Array':\n            {\n              array_formulae.push(val);\n            }\n            break;\n\n          case 'ShrFmla':\n            {\n              if (!cell_valid) break; //if(options.cellFormula) out[last_cell].f = stringify_formula(val[0], range, lastcell, supbooks, opts);\n\n              /* TODO: capture range */\n\n              shared_formulae[encode_cell(last_formula.cell)] = val[0];\n            }\n            break;\n\n          case 'LabelSst':\n            //temp_val={v:sst[val.isst].t, ixfe:val.ixfe, t:'s'};\n            temp_val = make_cell(sst[val.isst].t, val.ixfe, 's');\n            temp_val.XF = XFs[temp_val.ixfe];\n            if (temp_val.XF) safe_format_xf(temp_val, options, wb.opts.Date1904);\n            addcell({\n              c: val.c,\n              r: val.r\n            }, temp_val, options);\n            break;\n\n          case 'Label':\n          case 'BIFF2STR':\n            /* Some writers erroneously write Label */\n            temp_val = make_cell(val.val, val.ixfe, 's');\n            temp_val.XF = XFs[temp_val.ixfe];\n            if (temp_val.XF) safe_format_xf(temp_val, options, wb.opts.Date1904);\n            addcell({\n              c: val.c,\n              r: val.r\n            }, temp_val, options);\n            break;\n\n          case 'Dimensions':\n            {\n              if (file_depth === 1) range = val;\n              /* TODO: stack */\n            }\n            break;\n\n          case 'SST':\n            {\n              sst = val;\n            }\n            break;\n\n          case 'Format':\n            {\n              /* val = [id, fmt] */\n              SSF.load(val[1], val[0]);\n            }\n            break;\n\n          case 'MergeCells':\n            mergecells = mergecells.concat(val);\n            break;\n\n          case 'Obj':\n            objects[val.cmo[0]] = opts.lastobj = val;\n            break;\n\n          case 'TxO':\n            opts.lastobj.TxO = val;\n            break;\n\n          case 'HLink':\n            {\n              for (rngR = val[0].s.r; rngR <= val[0].e.r; ++rngR) {\n                for (rngC = val[0].s.c; rngC <= val[0].e.c; ++rngC) {\n                  if (out[encode_cell({\n                    c: rngC,\n                    r: rngR\n                  })]) out[encode_cell({\n                    c: rngC,\n                    r: rngR\n                  })].l = val[1];\n                }\n              }\n            }\n            break;\n\n          case 'HLinkTooltip':\n            {\n              for (rngR = val[0].s.r; rngR <= val[0].e.r; ++rngR) {\n                for (rngC = val[0].s.c; rngC <= val[0].e.c; ++rngC) {\n                  if (out[encode_cell({\n                    c: rngC,\n                    r: rngR\n                  })]) out[encode_cell({\n                    c: rngC,\n                    r: rngR\n                  })].l.tooltip = val[1];\n                }\n              }\n            }\n            break;\n\n          /* Comments */\n\n          case 'Note':\n            {\n              if (opts.biff <= 5 && opts.biff >= 2) break;\n              /* TODO: BIFF5 */\n\n              cc = out[encode_cell(val[0])];\n              var noteobj = objects[val[2]];\n              if (!cc) break;\n              if (!cc.c) cc.c = [];\n              cmnt = {\n                a: val[1],\n                t: noteobj.TxO.t\n              };\n              cc.c.push(cmnt);\n            }\n            break;\n\n          default:\n            switch (R.n) {\n              /* nested */\n              case 'ClrtClient':\n                break;\n\n              case 'XFExt':\n                update_xfext(XFs[val.ixfe], val.ext);\n                break;\n\n              case 'NameCmt':\n                break;\n\n              case 'Header':\n                break;\n              // TODO\n\n              case 'Footer':\n                break;\n              // TODO\n\n              case 'HCenter':\n                break;\n              // TODO\n\n              case 'VCenter':\n                break;\n              // TODO\n\n              case 'Pls':\n                break;\n              // TODO\n\n              case 'Setup':\n                break;\n              // TODO\n\n              case 'DefColWidth':\n                break;\n              // TODO\n\n              case 'GCW':\n                break;\n\n              case 'LHRecord':\n                break;\n\n              case 'ColInfo':\n                break;\n              // TODO\n\n              case 'Row':\n                break;\n              // TODO\n\n              case 'DBCell':\n                break;\n              // TODO\n\n              case 'MulBlank':\n                break;\n              // TODO\n\n              case 'EntExU2':\n                break;\n              // TODO\n\n              case 'SxView':\n                break;\n              // TODO\n\n              case 'Sxvd':\n                break;\n              // TODO\n\n              case 'SXVI':\n                break;\n              // TODO\n\n              case 'SXVDEx':\n                break;\n              // TODO\n\n              case 'SxIvd':\n                break;\n              // TODO\n\n              case 'SXDI':\n                break;\n              // TODO\n\n              case 'SXLI':\n                break;\n              // TODO\n\n              case 'SXEx':\n                break;\n              // TODO\n\n              case 'QsiSXTag':\n                break;\n              // TODO\n\n              case 'Selection':\n                break;\n\n              case 'Feat':\n                break;\n\n              case 'FeatHdr':\n              case 'FeatHdr11':\n                break;\n\n              case 'Feature11':\n              case 'Feature12':\n              case 'List12':\n                break;\n\n              case 'Blank':\n                break;\n\n              case 'Country':\n                country = val;\n                break;\n\n              case 'RecalcId':\n                break;\n\n              case 'DefaultRowHeight':\n              case 'DxGCol':\n                break;\n              // TODO: htmlify\n\n              case 'Fbi':\n              case 'Fbi2':\n              case 'GelFrame':\n                break;\n\n              case 'Font':\n                break;\n              // TODO\n\n              case 'XFCRC':\n                break;\n              // TODO\n\n              case 'Style':\n                break;\n              // TODO\n\n              case 'StyleExt':\n                break;\n              // TODO\n\n              case 'Palette':\n                palette = val;\n                break;\n              // TODO\n\n              case 'Theme':\n                break;\n              // TODO\n\n              /* Protection */\n\n              case 'ScenarioProtect':\n                break;\n\n              case 'ObjProtect':\n                break;\n\n              /* Conditional Formatting */\n\n              case 'CondFmt12':\n                break;\n\n              /* Table */\n\n              case 'Table':\n                break;\n              // TODO\n\n              case 'TableStyles':\n                break;\n              // TODO\n\n              case 'TableStyle':\n                break;\n              // TODO\n\n              case 'TableStyleElement':\n                break;\n              // TODO\n\n              /* PivotTable */\n\n              case 'SXStreamID':\n                break;\n              // TODO\n\n              case 'SXVS':\n                break;\n              // TODO\n\n              case 'DConRef':\n                break;\n              // TODO\n\n              case 'SXAddl':\n                break;\n              // TODO\n\n              case 'DConBin':\n                break;\n              // TODO\n\n              case 'DConName':\n                break;\n              // TODO\n\n              case 'SXPI':\n                break;\n              // TODO\n\n              case 'SxFormat':\n                break;\n              // TODO\n\n              case 'SxSelect':\n                break;\n              // TODO\n\n              case 'SxRule':\n                break;\n              // TODO\n\n              case 'SxFilt':\n                break;\n              // TODO\n\n              case 'SxItm':\n                break;\n              // TODO\n\n              case 'SxDXF':\n                break;\n              // TODO\n\n              /* Scenario Manager */\n\n              case 'ScenMan':\n                break;\n\n              /* Data Consolidation */\n\n              case 'DCon':\n                break;\n\n              /* Watched Cell */\n\n              case 'CellWatch':\n                break;\n\n              /* Print Settings */\n\n              case 'PrintRowCol':\n                break;\n\n              case 'PrintGrid':\n                break;\n\n              case 'PrintSize':\n                break;\n\n              case 'XCT':\n                break;\n\n              case 'CRN':\n                break;\n\n              case 'Scl':\n                {//console.log(\"Zoom Level:\", val[0]/val[1],val);\n                }\n                break;\n\n              case 'SheetExt':\n                {}\n                break;\n\n              case 'SheetExtOptional':\n                {}\n                break;\n\n              /* VBA */\n\n              case 'ObNoMacros':\n                {}\n                break;\n\n              case 'ObProj':\n                {}\n                break;\n\n              case 'CodeName':\n                {}\n                break;\n\n              case 'GUIDTypeLib':\n                {}\n                break;\n\n              case 'WOpt':\n                break;\n              // TODO: WTF?\n\n              case 'PhoneticInfo':\n                break;\n\n              case 'OleObjectSize':\n                break;\n\n              /* Differential Formatting */\n\n              case 'DXF':\n              case 'DXFN':\n              case 'DXFN12':\n              case 'DXFN12List':\n              case 'DXFN12NoCB':\n                break;\n\n              /* Data Validation */\n\n              case 'Dv':\n              case 'DVal':\n                break;\n\n              /* Data Series */\n\n              case 'BRAI':\n              case 'Series':\n              case 'SeriesText':\n                break;\n\n              /* Data Connection */\n\n              case 'DConn':\n                break;\n\n              case 'DbOrParamQry':\n                break;\n\n              case 'DBQueryExt':\n                break;\n\n              /* Formatting */\n\n              case 'IFmtRecord':\n                break;\n\n              case 'CondFmt':\n              case 'CF':\n              case 'CF12':\n              case 'CFEx':\n                break;\n\n              /* Explicitly Ignored */\n\n              case 'Excel9File':\n                break;\n\n              case 'Units':\n                break;\n\n              case 'InterfaceHdr':\n              case 'Mms':\n              case 'InterfaceEnd':\n              case 'DSF':\n              case 'BuiltInFnGroupCount':\n              /* View Stuff */\n\n              case 'Window1':\n              case 'Window2':\n              case 'HideObj':\n              case 'GridSet':\n              case 'Guts':\n              case 'UserBView':\n              case 'UserSViewBegin':\n              case 'UserSViewEnd':\n              case 'Pane':\n                break;\n\n              default:\n                switch (R.n) {\n                  /* nested */\n\n                  /* Chart */\n                  case 'Dat':\n                  case 'Begin':\n                  case 'End':\n                  case 'StartBlock':\n                  case 'EndBlock':\n                  case 'Frame':\n                  case 'Area':\n                  case 'Axis':\n                  case 'AxisLine':\n                  case 'Tick':\n                    break;\n\n                  case 'AxesUsed':\n                  case 'CrtLayout12':\n                  case 'CrtLayout12A':\n                  case 'CrtLink':\n                  case 'CrtLine':\n                  case 'CrtMlFrt':\n                  case 'CrtMlFrtContinue':\n                    break;\n\n                  case 'LineFormat':\n                  case 'AreaFormat':\n                  case 'Chart':\n                  case 'Chart3d':\n                  case 'Chart3DBarShape':\n                  case 'ChartFormat':\n                  case 'ChartFrtInfo':\n                    break;\n\n                  case 'PlotArea':\n                  case 'PlotGrowth':\n                    break;\n\n                  case 'SeriesList':\n                  case 'SerParent':\n                  case 'SerAuxTrend':\n                    break;\n\n                  case 'DataFormat':\n                  case 'SerToCrt':\n                  case 'FontX':\n                    break;\n\n                  case 'CatSerRange':\n                  case 'AxcExt':\n                  case 'SerFmt':\n                    break;\n\n                  case 'ShtProps':\n                    break;\n\n                  case 'DefaultText':\n                  case 'Text':\n                  case 'CatLab':\n                    break;\n\n                  case 'DataLabExtContents':\n                    break;\n\n                  case 'Legend':\n                  case 'LegendException':\n                    break;\n\n                  case 'Pie':\n                  case 'Scatter':\n                    break;\n\n                  case 'PieFormat':\n                  case 'MarkerFormat':\n                    break;\n\n                  case 'StartObject':\n                  case 'EndObject':\n                    break;\n\n                  case 'AlRuns':\n                  case 'ObjectLink':\n                    break;\n\n                  case 'SIIndex':\n                    break;\n\n                  case 'AttachedLabel':\n                  case 'YMult':\n                    break;\n\n                  /* Chart Group */\n\n                  case 'Line':\n                  case 'Bar':\n                    break;\n\n                  case 'Surf':\n                    break;\n\n                  /* Axis Group */\n\n                  case 'AxisParent':\n                    break;\n\n                  case 'Pos':\n                    break;\n\n                  case 'ValueRange':\n                    break;\n\n                  /* Pivot Chart */\n\n                  case 'SXViewEx9':\n                    break;\n                  // TODO\n\n                  case 'SXViewLink':\n                    break;\n\n                  case 'PivotChartBits':\n                    break;\n\n                  case 'SBaseRef':\n                    break;\n\n                  case 'TextPropsStream':\n                    break;\n\n                  /* Chart Misc */\n\n                  case 'LnExt':\n                    break;\n\n                  case 'MkrExt':\n                    break;\n\n                  case 'CrtCoopt':\n                    break;\n\n                  /* Query Table */\n\n                  case 'Qsi':\n                  case 'Qsif':\n                  case 'Qsir':\n                  case 'QsiSXTag':\n                    break;\n\n                  case 'TxtQry':\n                    break;\n\n                  /* Filter */\n\n                  case 'FilterMode':\n                    break;\n\n                  case 'AutoFilter':\n                  case 'AutoFilterInfo':\n                    break;\n\n                  case 'AutoFilter12':\n                    break;\n\n                  case 'DropDownObjIds':\n                    break;\n\n                  case 'Sort':\n                    break;\n\n                  case 'SortData':\n                    break;\n\n                  /* Drawing */\n\n                  case 'ShapePropsStream':\n                    break;\n\n                  case 'MsoDrawing':\n                  case 'MsoDrawingGroup':\n                  case 'MsoDrawingSelection':\n                    break;\n\n                  case 'ImData':\n                    break;\n\n                  /* Pub Stuff */\n\n                  case 'WebPub':\n                  case 'AutoWebPub':\n                  /* Print Stuff */\n\n                  case 'RightMargin':\n                  case 'LeftMargin':\n                  case 'TopMargin':\n                  case 'BottomMargin':\n                  case 'HeaderFooter':\n                  case 'HFPicture':\n                  case 'PLV':\n                  case 'HorizontalPageBreaks':\n                  case 'VerticalPageBreaks':\n                  /* Behavioral */\n\n                  case 'Backup':\n                  case 'CompressPictures':\n                  case 'Compat12':\n                    break;\n\n                  /* Should not Happen */\n\n                  case 'Continue':\n                  case 'ContinueFrt12':\n                    break;\n\n                  /* Future Records */\n\n                  case 'FrtFontList':\n                  case 'FrtWrapper':\n                    break;\n\n                  /* BIFF5 records */\n\n                  case 'ExternCount':\n                    break;\n\n                  case 'RString':\n                    break;\n\n                  case 'TabIdConf':\n                  case 'Radar':\n                  case 'RadarArea':\n                  case 'DropBar':\n                  case 'Intl':\n                  case 'CoordList':\n                  case 'SerAuxErrBar':\n                    break;\n\n                  default:\n                    switch (R.n) {\n                      /* nested */\n\n                      /* Miscellaneous */\n                      case 'SCENARIO':\n                      case 'DConBin':\n                      case 'PicF':\n                      case 'DataLabExt':\n                      case 'Lel':\n                      case 'BopPop':\n                      case 'BopPopCustom':\n                      case 'RealTimeData':\n                      case 'Name':\n                        break;\n\n                      default:\n                        if (options.WTF) throw 'Unrecognized Record ' + R.n;\n                    }\n\n                }\n\n            }\n\n        }\n      } else blob.l += length;\n    }\n\n    var sheetnamesraw = opts.biff === 2 ? ['Sheet1'] : Object.keys(Directory).sort(function (a, b) {\n      return Number(a) - Number(b);\n    }).map(function (x) {\n      return Directory[x].name;\n    });\n    var sheetnames = sheetnamesraw.slice();\n    wb.Directory = sheetnamesraw;\n    wb.SheetNames = sheetnamesraw;\n    if (!options.bookSheets) wb.Sheets = Sheets;\n    wb.Preamble = Preamble;\n    wb.Strings = sst;\n    wb.SSF = SSF.get_table();\n    if (opts.enc) wb.Encryption = opts.enc;\n    wb.Metadata = {};\n    if (country !== undefined) wb.Metadata.Country = country;\n    return wb;\n  }\n\n  function parse_xlscfb(cfb, options) {\n    if (!options) options = {};\n    fix_read_opts(options);\n    reset_cp();\n    var CompObj, Summary, Workbook;\n\n    if (cfb.find) {\n      CompObj = cfb.find('!CompObj');\n      Summary = cfb.find('!SummaryInformation');\n      Workbook = cfb.find('/Workbook');\n    } else {\n      prep_blob(cfb, 0);\n      Workbook = {\n        content: cfb\n      };\n    }\n\n    if (!Workbook) Workbook = cfb.find('/Book');\n    var CompObjP, SummaryP, WorkbookP;\n    if (CompObj) CompObjP = parse_compobj(CompObj);\n    if (options.bookProps && !options.bookSheets) WorkbookP = {};else {\n      if (Workbook) WorkbookP = parse_workbook(Workbook.content, options, !!Workbook.find);else throw new Error(\"Cannot find Workbook stream\");\n    }\n    if (cfb.find) parse_props(cfb);\n    var props = {};\n\n    for (var y in cfb.Summary) {\n      props[y] = cfb.Summary[y];\n    }\n\n    for (y in cfb.DocSummary) {\n      props[y] = cfb.DocSummary[y];\n    }\n\n    WorkbookP.Props = WorkbookP.Custprops = props;\n    /* TODO: split up properties */\n\n    if (options.bookFiles) WorkbookP.cfb = cfb;\n    WorkbookP.CompObjP = CompObjP;\n    return WorkbookP;\n  }\n  /* TODO: WTF */\n\n\n  function parse_props(cfb) {\n    /* [MS-OSHARED] 2.3.3.2.2 Document Summary Information Property Set */\n    var DSI = cfb.find('!DocumentSummaryInformation');\n    if (DSI) try {\n      cfb.DocSummary = parse_PropertySetStream(DSI, DocSummaryPIDDSI);\n    } catch (e) {}\n    /* [MS-OSHARED] 2.3.3.2.1 Summary Information Property Set*/\n\n    var SI = cfb.find('!SummaryInformation');\n    if (SI) try {\n      cfb.Summary = parse_PropertySetStream(SI, SummaryPIDSI);\n    } catch (e) {}\n  }\n  /* [MS-XLSB] 2.3 Record Enumeration */\n\n\n  var XLSBRecordEnum = {\n    0x0000: {\n      n: \"BrtRowHdr\",\n      f: parse_BrtRowHdr\n    },\n    0x0001: {\n      n: \"BrtCellBlank\",\n      f: parse_BrtCellBlank\n    },\n    0x0002: {\n      n: \"BrtCellRk\",\n      f: parse_BrtCellRk\n    },\n    0x0003: {\n      n: \"BrtCellError\",\n      f: parse_BrtCellError\n    },\n    0x0004: {\n      n: \"BrtCellBool\",\n      f: parse_BrtCellBool\n    },\n    0x0005: {\n      n: \"BrtCellReal\",\n      f: parse_BrtCellReal\n    },\n    0x0006: {\n      n: \"BrtCellSt\",\n      f: parse_BrtCellSt\n    },\n    0x0007: {\n      n: \"BrtCellIsst\",\n      f: parse_BrtCellIsst\n    },\n    0x0008: {\n      n: \"BrtFmlaString\",\n      f: parse_BrtFmlaString\n    },\n    0x0009: {\n      n: \"BrtFmlaNum\",\n      f: parse_BrtFmlaNum\n    },\n    0x000A: {\n      n: \"BrtFmlaBool\",\n      f: parse_BrtFmlaBool\n    },\n    0x000B: {\n      n: \"BrtFmlaError\",\n      f: parse_BrtFmlaError\n    },\n    0x0010: {\n      n: \"BrtFRTArchID$\",\n      f: parse_BrtFRTArchID$\n    },\n    0x0013: {\n      n: \"BrtSSTItem\",\n      f: parse_RichStr\n    },\n    0x0014: {\n      n: \"BrtPCDIMissing\",\n      f: parsenoop\n    },\n    0x0015: {\n      n: \"BrtPCDINumber\",\n      f: parsenoop\n    },\n    0x0016: {\n      n: \"BrtPCDIBoolean\",\n      f: parsenoop\n    },\n    0x0017: {\n      n: \"BrtPCDIError\",\n      f: parsenoop\n    },\n    0x0018: {\n      n: \"BrtPCDIString\",\n      f: parsenoop\n    },\n    0x0019: {\n      n: \"BrtPCDIDatetime\",\n      f: parsenoop\n    },\n    0x001A: {\n      n: \"BrtPCDIIndex\",\n      f: parsenoop\n    },\n    0x001B: {\n      n: \"BrtPCDIAMissing\",\n      f: parsenoop\n    },\n    0x001C: {\n      n: \"BrtPCDIANumber\",\n      f: parsenoop\n    },\n    0x001D: {\n      n: \"BrtPCDIABoolean\",\n      f: parsenoop\n    },\n    0x001E: {\n      n: \"BrtPCDIAError\",\n      f: parsenoop\n    },\n    0x001F: {\n      n: \"BrtPCDIAString\",\n      f: parsenoop\n    },\n    0x0020: {\n      n: \"BrtPCDIADatetime\",\n      f: parsenoop\n    },\n    0x0021: {\n      n: \"BrtPCRRecord\",\n      f: parsenoop\n    },\n    0x0022: {\n      n: \"BrtPCRRecordDt\",\n      f: parsenoop\n    },\n    0x0023: {\n      n: \"BrtFRTBegin\",\n      f: parsenoop\n    },\n    0x0024: {\n      n: \"BrtFRTEnd\",\n      f: parsenoop\n    },\n    0x0025: {\n      n: \"BrtACBegin\",\n      f: parsenoop\n    },\n    0x0026: {\n      n: \"BrtACEnd\",\n      f: parsenoop\n    },\n    0x0027: {\n      n: \"BrtName\",\n      f: parsenoop\n    },\n    0x0028: {\n      n: \"BrtIndexRowBlock\",\n      f: parsenoop\n    },\n    0x002A: {\n      n: \"BrtIndexBlock\",\n      f: parsenoop\n    },\n    0x002B: {\n      n: \"BrtFont\",\n      f: parse_BrtFont\n    },\n    0x002C: {\n      n: \"BrtFmt\",\n      f: parse_BrtFmt\n    },\n    0x002D: {\n      n: \"BrtFill\",\n      f: parsenoop\n    },\n    0x002E: {\n      n: \"BrtBorder\",\n      f: parsenoop\n    },\n    0x002F: {\n      n: \"BrtXF\",\n      f: parse_BrtXF\n    },\n    0x0030: {\n      n: \"BrtStyle\",\n      f: parsenoop\n    },\n    0x0031: {\n      n: \"BrtCellMeta\",\n      f: parsenoop\n    },\n    0x0032: {\n      n: \"BrtValueMeta\",\n      f: parsenoop\n    },\n    0x0033: {\n      n: \"BrtMdb\",\n      f: parsenoop\n    },\n    0x0034: {\n      n: \"BrtBeginFmd\",\n      f: parsenoop\n    },\n    0x0035: {\n      n: \"BrtEndFmd\",\n      f: parsenoop\n    },\n    0x0036: {\n      n: \"BrtBeginMdx\",\n      f: parsenoop\n    },\n    0x0037: {\n      n: \"BrtEndMdx\",\n      f: parsenoop\n    },\n    0x0038: {\n      n: \"BrtBeginMdxTuple\",\n      f: parsenoop\n    },\n    0x0039: {\n      n: \"BrtEndMdxTuple\",\n      f: parsenoop\n    },\n    0x003A: {\n      n: \"BrtMdxMbrIstr\",\n      f: parsenoop\n    },\n    0x003B: {\n      n: \"BrtStr\",\n      f: parsenoop\n    },\n    0x003C: {\n      n: \"BrtColInfo\",\n      f: parsenoop\n    },\n    0x003E: {\n      n: \"BrtCellRString\",\n      f: parsenoop\n    },\n    0x003F: {\n      n: \"BrtCalcChainItem$\",\n      f: parse_BrtCalcChainItem$\n    },\n    0x0040: {\n      n: \"BrtDVal\",\n      f: parsenoop\n    },\n    0x0041: {\n      n: \"BrtSxvcellNum\",\n      f: parsenoop\n    },\n    0x0042: {\n      n: \"BrtSxvcellStr\",\n      f: parsenoop\n    },\n    0x0043: {\n      n: \"BrtSxvcellBool\",\n      f: parsenoop\n    },\n    0x0044: {\n      n: \"BrtSxvcellErr\",\n      f: parsenoop\n    },\n    0x0045: {\n      n: \"BrtSxvcellDate\",\n      f: parsenoop\n    },\n    0x0046: {\n      n: \"BrtSxvcellNil\",\n      f: parsenoop\n    },\n    0x0080: {\n      n: \"BrtFileVersion\",\n      f: parsenoop\n    },\n    0x0081: {\n      n: \"BrtBeginSheet\",\n      f: parsenoop\n    },\n    0x0082: {\n      n: \"BrtEndSheet\",\n      f: parsenoop\n    },\n    0x0083: {\n      n: \"BrtBeginBook\",\n      f: parsenoop,\n      p: 0\n    },\n    0x0084: {\n      n: \"BrtEndBook\",\n      f: parsenoop\n    },\n    0x0085: {\n      n: \"BrtBeginWsViews\",\n      f: parsenoop\n    },\n    0x0086: {\n      n: \"BrtEndWsViews\",\n      f: parsenoop\n    },\n    0x0087: {\n      n: \"BrtBeginBookViews\",\n      f: parsenoop\n    },\n    0x0088: {\n      n: \"BrtEndBookViews\",\n      f: parsenoop\n    },\n    0x0089: {\n      n: \"BrtBeginWsView\",\n      f: parsenoop\n    },\n    0x008A: {\n      n: \"BrtEndWsView\",\n      f: parsenoop\n    },\n    0x008B: {\n      n: \"BrtBeginCsViews\",\n      f: parsenoop\n    },\n    0x008C: {\n      n: \"BrtEndCsViews\",\n      f: parsenoop\n    },\n    0x008D: {\n      n: \"BrtBeginCsView\",\n      f: parsenoop\n    },\n    0x008E: {\n      n: \"BrtEndCsView\",\n      f: parsenoop\n    },\n    0x008F: {\n      n: \"BrtBeginBundleShs\",\n      f: parsenoop\n    },\n    0x0090: {\n      n: \"BrtEndBundleShs\",\n      f: parsenoop\n    },\n    0x0091: {\n      n: \"BrtBeginSheetData\",\n      f: parsenoop\n    },\n    0x0092: {\n      n: \"BrtEndSheetData\",\n      f: parsenoop\n    },\n    0x0093: {\n      n: \"BrtWsProp\",\n      f: parse_BrtWsProp\n    },\n    0x0094: {\n      n: \"BrtWsDim\",\n      f: parse_BrtWsDim,\n      p: 16\n    },\n    0x0097: {\n      n: \"BrtPane\",\n      f: parsenoop\n    },\n    0x0098: {\n      n: \"BrtSel\",\n      f: parsenoop\n    },\n    0x0099: {\n      n: \"BrtWbProp\",\n      f: parse_BrtWbProp\n    },\n    0x009A: {\n      n: \"BrtWbFactoid\",\n      f: parsenoop\n    },\n    0x009B: {\n      n: \"BrtFileRecover\",\n      f: parsenoop\n    },\n    0x009C: {\n      n: \"BrtBundleSh\",\n      f: parse_BrtBundleSh\n    },\n    0x009D: {\n      n: \"BrtCalcProp\",\n      f: parsenoop\n    },\n    0x009E: {\n      n: \"BrtBookView\",\n      f: parsenoop\n    },\n    0x009F: {\n      n: \"BrtBeginSst\",\n      f: parse_BrtBeginSst\n    },\n    0x00A0: {\n      n: \"BrtEndSst\",\n      f: parsenoop\n    },\n    0x00A1: {\n      n: \"BrtBeginAFilter\",\n      f: parsenoop\n    },\n    0x00A2: {\n      n: \"BrtEndAFilter\",\n      f: parsenoop\n    },\n    0x00A3: {\n      n: \"BrtBeginFilterColumn\",\n      f: parsenoop\n    },\n    0x00A4: {\n      n: \"BrtEndFilterColumn\",\n      f: parsenoop\n    },\n    0x00A5: {\n      n: \"BrtBeginFilters\",\n      f: parsenoop\n    },\n    0x00A6: {\n      n: \"BrtEndFilters\",\n      f: parsenoop\n    },\n    0x00A7: {\n      n: \"BrtFilter\",\n      f: parsenoop\n    },\n    0x00A8: {\n      n: \"BrtColorFilter\",\n      f: parsenoop\n    },\n    0x00A9: {\n      n: \"BrtIconFilter\",\n      f: parsenoop\n    },\n    0x00AA: {\n      n: \"BrtTop10Filter\",\n      f: parsenoop\n    },\n    0x00AB: {\n      n: \"BrtDynamicFilter\",\n      f: parsenoop\n    },\n    0x00AC: {\n      n: \"BrtBeginCustomFilters\",\n      f: parsenoop\n    },\n    0x00AD: {\n      n: \"BrtEndCustomFilters\",\n      f: parsenoop\n    },\n    0x00AE: {\n      n: \"BrtCustomFilter\",\n      f: parsenoop\n    },\n    0x00AF: {\n      n: \"BrtAFilterDateGroupItem\",\n      f: parsenoop\n    },\n    0x00B0: {\n      n: \"BrtMergeCell\",\n      f: parse_BrtMergeCell\n    },\n    0x00B1: {\n      n: \"BrtBeginMergeCells\",\n      f: parsenoop\n    },\n    0x00B2: {\n      n: \"BrtEndMergeCells\",\n      f: parsenoop\n    },\n    0x00B3: {\n      n: \"BrtBeginPivotCacheDef\",\n      f: parsenoop\n    },\n    0x00B4: {\n      n: \"BrtEndPivotCacheDef\",\n      f: parsenoop\n    },\n    0x00B5: {\n      n: \"BrtBeginPCDFields\",\n      f: parsenoop\n    },\n    0x00B6: {\n      n: \"BrtEndPCDFields\",\n      f: parsenoop\n    },\n    0x00B7: {\n      n: \"BrtBeginPCDField\",\n      f: parsenoop\n    },\n    0x00B8: {\n      n: \"BrtEndPCDField\",\n      f: parsenoop\n    },\n    0x00B9: {\n      n: \"BrtBeginPCDSource\",\n      f: parsenoop\n    },\n    0x00BA: {\n      n: \"BrtEndPCDSource\",\n      f: parsenoop\n    },\n    0x00BB: {\n      n: \"BrtBeginPCDSRange\",\n      f: parsenoop\n    },\n    0x00BC: {\n      n: \"BrtEndPCDSRange\",\n      f: parsenoop\n    },\n    0x00BD: {\n      n: \"BrtBeginPCDFAtbl\",\n      f: parsenoop\n    },\n    0x00BE: {\n      n: \"BrtEndPCDFAtbl\",\n      f: parsenoop\n    },\n    0x00BF: {\n      n: \"BrtBeginPCDIRun\",\n      f: parsenoop\n    },\n    0x00C0: {\n      n: \"BrtEndPCDIRun\",\n      f: parsenoop\n    },\n    0x00C1: {\n      n: \"BrtBeginPivotCacheRecords\",\n      f: parsenoop\n    },\n    0x00C2: {\n      n: \"BrtEndPivotCacheRecords\",\n      f: parsenoop\n    },\n    0x00C3: {\n      n: \"BrtBeginPCDHierarchies\",\n      f: parsenoop\n    },\n    0x00C4: {\n      n: \"BrtEndPCDHierarchies\",\n      f: parsenoop\n    },\n    0x00C5: {\n      n: \"BrtBeginPCDHierarchy\",\n      f: parsenoop\n    },\n    0x00C6: {\n      n: \"BrtEndPCDHierarchy\",\n      f: parsenoop\n    },\n    0x00C7: {\n      n: \"BrtBeginPCDHFieldsUsage\",\n      f: parsenoop\n    },\n    0x00C8: {\n      n: \"BrtEndPCDHFieldsUsage\",\n      f: parsenoop\n    },\n    0x00C9: {\n      n: \"BrtBeginExtConnection\",\n      f: parsenoop\n    },\n    0x00CA: {\n      n: \"BrtEndExtConnection\",\n      f: parsenoop\n    },\n    0x00CB: {\n      n: \"BrtBeginECDbProps\",\n      f: parsenoop\n    },\n    0x00CC: {\n      n: \"BrtEndECDbProps\",\n      f: parsenoop\n    },\n    0x00CD: {\n      n: \"BrtBeginECOlapProps\",\n      f: parsenoop\n    },\n    0x00CE: {\n      n: \"BrtEndECOlapProps\",\n      f: parsenoop\n    },\n    0x00CF: {\n      n: \"BrtBeginPCDSConsol\",\n      f: parsenoop\n    },\n    0x00D0: {\n      n: \"BrtEndPCDSConsol\",\n      f: parsenoop\n    },\n    0x00D1: {\n      n: \"BrtBeginPCDSCPages\",\n      f: parsenoop\n    },\n    0x00D2: {\n      n: \"BrtEndPCDSCPages\",\n      f: parsenoop\n    },\n    0x00D3: {\n      n: \"BrtBeginPCDSCPage\",\n      f: parsenoop\n    },\n    0x00D4: {\n      n: \"BrtEndPCDSCPage\",\n      f: parsenoop\n    },\n    0x00D5: {\n      n: \"BrtBeginPCDSCPItem\",\n      f: parsenoop\n    },\n    0x00D6: {\n      n: \"BrtEndPCDSCPItem\",\n      f: parsenoop\n    },\n    0x00D7: {\n      n: \"BrtBeginPCDSCSets\",\n      f: parsenoop\n    },\n    0x00D8: {\n      n: \"BrtEndPCDSCSets\",\n      f: parsenoop\n    },\n    0x00D9: {\n      n: \"BrtBeginPCDSCSet\",\n      f: parsenoop\n    },\n    0x00DA: {\n      n: \"BrtEndPCDSCSet\",\n      f: parsenoop\n    },\n    0x00DB: {\n      n: \"BrtBeginPCDFGroup\",\n      f: parsenoop\n    },\n    0x00DC: {\n      n: \"BrtEndPCDFGroup\",\n      f: parsenoop\n    },\n    0x00DD: {\n      n: \"BrtBeginPCDFGItems\",\n      f: parsenoop\n    },\n    0x00DE: {\n      n: \"BrtEndPCDFGItems\",\n      f: parsenoop\n    },\n    0x00DF: {\n      n: \"BrtBeginPCDFGRange\",\n      f: parsenoop\n    },\n    0x00E0: {\n      n: \"BrtEndPCDFGRange\",\n      f: parsenoop\n    },\n    0x00E1: {\n      n: \"BrtBeginPCDFGDiscrete\",\n      f: parsenoop\n    },\n    0x00E2: {\n      n: \"BrtEndPCDFGDiscrete\",\n      f: parsenoop\n    },\n    0x00E3: {\n      n: \"BrtBeginPCDSDTupleCache\",\n      f: parsenoop\n    },\n    0x00E4: {\n      n: \"BrtEndPCDSDTupleCache\",\n      f: parsenoop\n    },\n    0x00E5: {\n      n: \"BrtBeginPCDSDTCEntries\",\n      f: parsenoop\n    },\n    0x00E6: {\n      n: \"BrtEndPCDSDTCEntries\",\n      f: parsenoop\n    },\n    0x00E7: {\n      n: \"BrtBeginPCDSDTCEMembers\",\n      f: parsenoop\n    },\n    0x00E8: {\n      n: \"BrtEndPCDSDTCEMembers\",\n      f: parsenoop\n    },\n    0x00E9: {\n      n: \"BrtBeginPCDSDTCEMember\",\n      f: parsenoop\n    },\n    0x00EA: {\n      n: \"BrtEndPCDSDTCEMember\",\n      f: parsenoop\n    },\n    0x00EB: {\n      n: \"BrtBeginPCDSDTCQueries\",\n      f: parsenoop\n    },\n    0x00EC: {\n      n: \"BrtEndPCDSDTCQueries\",\n      f: parsenoop\n    },\n    0x00ED: {\n      n: \"BrtBeginPCDSDTCQuery\",\n      f: parsenoop\n    },\n    0x00EE: {\n      n: \"BrtEndPCDSDTCQuery\",\n      f: parsenoop\n    },\n    0x00EF: {\n      n: \"BrtBeginPCDSDTCSets\",\n      f: parsenoop\n    },\n    0x00F0: {\n      n: \"BrtEndPCDSDTCSets\",\n      f: parsenoop\n    },\n    0x00F1: {\n      n: \"BrtBeginPCDSDTCSet\",\n      f: parsenoop\n    },\n    0x00F2: {\n      n: \"BrtEndPCDSDTCSet\",\n      f: parsenoop\n    },\n    0x00F3: {\n      n: \"BrtBeginPCDCalcItems\",\n      f: parsenoop\n    },\n    0x00F4: {\n      n: \"BrtEndPCDCalcItems\",\n      f: parsenoop\n    },\n    0x00F5: {\n      n: \"BrtBeginPCDCalcItem\",\n      f: parsenoop\n    },\n    0x00F6: {\n      n: \"BrtEndPCDCalcItem\",\n      f: parsenoop\n    },\n    0x00F7: {\n      n: \"BrtBeginPRule\",\n      f: parsenoop\n    },\n    0x00F8: {\n      n: \"BrtEndPRule\",\n      f: parsenoop\n    },\n    0x00F9: {\n      n: \"BrtBeginPRFilters\",\n      f: parsenoop\n    },\n    0x00FA: {\n      n: \"BrtEndPRFilters\",\n      f: parsenoop\n    },\n    0x00FB: {\n      n: \"BrtBeginPRFilter\",\n      f: parsenoop\n    },\n    0x00FC: {\n      n: \"BrtEndPRFilter\",\n      f: parsenoop\n    },\n    0x00FD: {\n      n: \"BrtBeginPNames\",\n      f: parsenoop\n    },\n    0x00FE: {\n      n: \"BrtEndPNames\",\n      f: parsenoop\n    },\n    0x00FF: {\n      n: \"BrtBeginPName\",\n      f: parsenoop\n    },\n    0x0100: {\n      n: \"BrtEndPName\",\n      f: parsenoop\n    },\n    0x0101: {\n      n: \"BrtBeginPNPairs\",\n      f: parsenoop\n    },\n    0x0102: {\n      n: \"BrtEndPNPairs\",\n      f: parsenoop\n    },\n    0x0103: {\n      n: \"BrtBeginPNPair\",\n      f: parsenoop\n    },\n    0x0104: {\n      n: \"BrtEndPNPair\",\n      f: parsenoop\n    },\n    0x0105: {\n      n: \"BrtBeginECWebProps\",\n      f: parsenoop\n    },\n    0x0106: {\n      n: \"BrtEndECWebProps\",\n      f: parsenoop\n    },\n    0x0107: {\n      n: \"BrtBeginEcWpTables\",\n      f: parsenoop\n    },\n    0x0108: {\n      n: \"BrtEndECWPTables\",\n      f: parsenoop\n    },\n    0x0109: {\n      n: \"BrtBeginECParams\",\n      f: parsenoop\n    },\n    0x010A: {\n      n: \"BrtEndECParams\",\n      f: parsenoop\n    },\n    0x010B: {\n      n: \"BrtBeginECParam\",\n      f: parsenoop\n    },\n    0x010C: {\n      n: \"BrtEndECParam\",\n      f: parsenoop\n    },\n    0x010D: {\n      n: \"BrtBeginPCDKPIs\",\n      f: parsenoop\n    },\n    0x010E: {\n      n: \"BrtEndPCDKPIs\",\n      f: parsenoop\n    },\n    0x010F: {\n      n: \"BrtBeginPCDKPI\",\n      f: parsenoop\n    },\n    0x0110: {\n      n: \"BrtEndPCDKPI\",\n      f: parsenoop\n    },\n    0x0111: {\n      n: \"BrtBeginDims\",\n      f: parsenoop\n    },\n    0x0112: {\n      n: \"BrtEndDims\",\n      f: parsenoop\n    },\n    0x0113: {\n      n: \"BrtBeginDim\",\n      f: parsenoop\n    },\n    0x0114: {\n      n: \"BrtEndDim\",\n      f: parsenoop\n    },\n    0x0115: {\n      n: \"BrtIndexPartEnd\",\n      f: parsenoop\n    },\n    0x0116: {\n      n: \"BrtBeginStyleSheet\",\n      f: parsenoop\n    },\n    0x0117: {\n      n: \"BrtEndStyleSheet\",\n      f: parsenoop\n    },\n    0x0118: {\n      n: \"BrtBeginSXView\",\n      f: parsenoop\n    },\n    0x0119: {\n      n: \"BrtEndSXVI\",\n      f: parsenoop\n    },\n    0x011A: {\n      n: \"BrtBeginSXVI\",\n      f: parsenoop\n    },\n    0x011B: {\n      n: \"BrtBeginSXVIs\",\n      f: parsenoop\n    },\n    0x011C: {\n      n: \"BrtEndSXVIs\",\n      f: parsenoop\n    },\n    0x011D: {\n      n: \"BrtBeginSXVD\",\n      f: parsenoop\n    },\n    0x011E: {\n      n: \"BrtEndSXVD\",\n      f: parsenoop\n    },\n    0x011F: {\n      n: \"BrtBeginSXVDs\",\n      f: parsenoop\n    },\n    0x0120: {\n      n: \"BrtEndSXVDs\",\n      f: parsenoop\n    },\n    0x0121: {\n      n: \"BrtBeginSXPI\",\n      f: parsenoop\n    },\n    0x0122: {\n      n: \"BrtEndSXPI\",\n      f: parsenoop\n    },\n    0x0123: {\n      n: \"BrtBeginSXPIs\",\n      f: parsenoop\n    },\n    0x0124: {\n      n: \"BrtEndSXPIs\",\n      f: parsenoop\n    },\n    0x0125: {\n      n: \"BrtBeginSXDI\",\n      f: parsenoop\n    },\n    0x0126: {\n      n: \"BrtEndSXDI\",\n      f: parsenoop\n    },\n    0x0127: {\n      n: \"BrtBeginSXDIs\",\n      f: parsenoop\n    },\n    0x0128: {\n      n: \"BrtEndSXDIs\",\n      f: parsenoop\n    },\n    0x0129: {\n      n: \"BrtBeginSXLI\",\n      f: parsenoop\n    },\n    0x012A: {\n      n: \"BrtEndSXLI\",\n      f: parsenoop\n    },\n    0x012B: {\n      n: \"BrtBeginSXLIRws\",\n      f: parsenoop\n    },\n    0x012C: {\n      n: \"BrtEndSXLIRws\",\n      f: parsenoop\n    },\n    0x012D: {\n      n: \"BrtBeginSXLICols\",\n      f: parsenoop\n    },\n    0x012E: {\n      n: \"BrtEndSXLICols\",\n      f: parsenoop\n    },\n    0x012F: {\n      n: \"BrtBeginSXFormat\",\n      f: parsenoop\n    },\n    0x0130: {\n      n: \"BrtEndSXFormat\",\n      f: parsenoop\n    },\n    0x0131: {\n      n: \"BrtBeginSXFormats\",\n      f: parsenoop\n    },\n    0x0132: {\n      n: \"BrtEndSxFormats\",\n      f: parsenoop\n    },\n    0x0133: {\n      n: \"BrtBeginSxSelect\",\n      f: parsenoop\n    },\n    0x0134: {\n      n: \"BrtEndSxSelect\",\n      f: parsenoop\n    },\n    0x0135: {\n      n: \"BrtBeginISXVDRws\",\n      f: parsenoop\n    },\n    0x0136: {\n      n: \"BrtEndISXVDRws\",\n      f: parsenoop\n    },\n    0x0137: {\n      n: \"BrtBeginISXVDCols\",\n      f: parsenoop\n    },\n    0x0138: {\n      n: \"BrtEndISXVDCols\",\n      f: parsenoop\n    },\n    0x0139: {\n      n: \"BrtEndSXLocation\",\n      f: parsenoop\n    },\n    0x013A: {\n      n: \"BrtBeginSXLocation\",\n      f: parsenoop\n    },\n    0x013B: {\n      n: \"BrtEndSXView\",\n      f: parsenoop\n    },\n    0x013C: {\n      n: \"BrtBeginSXTHs\",\n      f: parsenoop\n    },\n    0x013D: {\n      n: \"BrtEndSXTHs\",\n      f: parsenoop\n    },\n    0x013E: {\n      n: \"BrtBeginSXTH\",\n      f: parsenoop\n    },\n    0x013F: {\n      n: \"BrtEndSXTH\",\n      f: parsenoop\n    },\n    0x0140: {\n      n: \"BrtBeginISXTHRws\",\n      f: parsenoop\n    },\n    0x0141: {\n      n: \"BrtEndISXTHRws\",\n      f: parsenoop\n    },\n    0x0142: {\n      n: \"BrtBeginISXTHCols\",\n      f: parsenoop\n    },\n    0x0143: {\n      n: \"BrtEndISXTHCols\",\n      f: parsenoop\n    },\n    0x0144: {\n      n: \"BrtBeginSXTDMPS\",\n      f: parsenoop\n    },\n    0x0145: {\n      n: \"BrtEndSXTDMPs\",\n      f: parsenoop\n    },\n    0x0146: {\n      n: \"BrtBeginSXTDMP\",\n      f: parsenoop\n    },\n    0x0147: {\n      n: \"BrtEndSXTDMP\",\n      f: parsenoop\n    },\n    0x0148: {\n      n: \"BrtBeginSXTHItems\",\n      f: parsenoop\n    },\n    0x0149: {\n      n: \"BrtEndSXTHItems\",\n      f: parsenoop\n    },\n    0x014A: {\n      n: \"BrtBeginSXTHItem\",\n      f: parsenoop\n    },\n    0x014B: {\n      n: \"BrtEndSXTHItem\",\n      f: parsenoop\n    },\n    0x014C: {\n      n: \"BrtBeginMetadata\",\n      f: parsenoop\n    },\n    0x014D: {\n      n: \"BrtEndMetadata\",\n      f: parsenoop\n    },\n    0x014E: {\n      n: \"BrtBeginEsmdtinfo\",\n      f: parsenoop\n    },\n    0x014F: {\n      n: \"BrtMdtinfo\",\n      f: parsenoop\n    },\n    0x0150: {\n      n: \"BrtEndEsmdtinfo\",\n      f: parsenoop\n    },\n    0x0151: {\n      n: \"BrtBeginEsmdb\",\n      f: parsenoop\n    },\n    0x0152: {\n      n: \"BrtEndEsmdb\",\n      f: parsenoop\n    },\n    0x0153: {\n      n: \"BrtBeginEsfmd\",\n      f: parsenoop\n    },\n    0x0154: {\n      n: \"BrtEndEsfmd\",\n      f: parsenoop\n    },\n    0x0155: {\n      n: \"BrtBeginSingleCells\",\n      f: parsenoop\n    },\n    0x0156: {\n      n: \"BrtEndSingleCells\",\n      f: parsenoop\n    },\n    0x0157: {\n      n: \"BrtBeginList\",\n      f: parsenoop\n    },\n    0x0158: {\n      n: \"BrtEndList\",\n      f: parsenoop\n    },\n    0x0159: {\n      n: \"BrtBeginListCols\",\n      f: parsenoop\n    },\n    0x015A: {\n      n: \"BrtEndListCols\",\n      f: parsenoop\n    },\n    0x015B: {\n      n: \"BrtBeginListCol\",\n      f: parsenoop\n    },\n    0x015C: {\n      n: \"BrtEndListCol\",\n      f: parsenoop\n    },\n    0x015D: {\n      n: \"BrtBeginListXmlCPr\",\n      f: parsenoop\n    },\n    0x015E: {\n      n: \"BrtEndListXmlCPr\",\n      f: parsenoop\n    },\n    0x015F: {\n      n: \"BrtListCCFmla\",\n      f: parsenoop\n    },\n    0x0160: {\n      n: \"BrtListTrFmla\",\n      f: parsenoop\n    },\n    0x0161: {\n      n: \"BrtBeginExternals\",\n      f: parsenoop\n    },\n    0x0162: {\n      n: \"BrtEndExternals\",\n      f: parsenoop\n    },\n    0x0163: {\n      n: \"BrtSupBookSrc\",\n      f: parsenoop\n    },\n    0x0165: {\n      n: \"BrtSupSelf\",\n      f: parsenoop\n    },\n    0x0166: {\n      n: \"BrtSupSame\",\n      f: parsenoop\n    },\n    0x0167: {\n      n: \"BrtSupTabs\",\n      f: parsenoop\n    },\n    0x0168: {\n      n: \"BrtBeginSupBook\",\n      f: parsenoop\n    },\n    0x0169: {\n      n: \"BrtPlaceholderName\",\n      f: parsenoop\n    },\n    0x016A: {\n      n: \"BrtExternSheet\",\n      f: parsenoop\n    },\n    0x016B: {\n      n: \"BrtExternTableStart\",\n      f: parsenoop\n    },\n    0x016C: {\n      n: \"BrtExternTableEnd\",\n      f: parsenoop\n    },\n    0x016E: {\n      n: \"BrtExternRowHdr\",\n      f: parsenoop\n    },\n    0x016F: {\n      n: \"BrtExternCellBlank\",\n      f: parsenoop\n    },\n    0x0170: {\n      n: \"BrtExternCellReal\",\n      f: parsenoop\n    },\n    0x0171: {\n      n: \"BrtExternCellBool\",\n      f: parsenoop\n    },\n    0x0172: {\n      n: \"BrtExternCellError\",\n      f: parsenoop\n    },\n    0x0173: {\n      n: \"BrtExternCellString\",\n      f: parsenoop\n    },\n    0x0174: {\n      n: \"BrtBeginEsmdx\",\n      f: parsenoop\n    },\n    0x0175: {\n      n: \"BrtEndEsmdx\",\n      f: parsenoop\n    },\n    0x0176: {\n      n: \"BrtBeginMdxSet\",\n      f: parsenoop\n    },\n    0x0177: {\n      n: \"BrtEndMdxSet\",\n      f: parsenoop\n    },\n    0x0178: {\n      n: \"BrtBeginMdxMbrProp\",\n      f: parsenoop\n    },\n    0x0179: {\n      n: \"BrtEndMdxMbrProp\",\n      f: parsenoop\n    },\n    0x017A: {\n      n: \"BrtBeginMdxKPI\",\n      f: parsenoop\n    },\n    0x017B: {\n      n: \"BrtEndMdxKPI\",\n      f: parsenoop\n    },\n    0x017C: {\n      n: \"BrtBeginEsstr\",\n      f: parsenoop\n    },\n    0x017D: {\n      n: \"BrtEndEsstr\",\n      f: parsenoop\n    },\n    0x017E: {\n      n: \"BrtBeginPRFItem\",\n      f: parsenoop\n    },\n    0x017F: {\n      n: \"BrtEndPRFItem\",\n      f: parsenoop\n    },\n    0x0180: {\n      n: \"BrtBeginPivotCacheIDs\",\n      f: parsenoop\n    },\n    0x0181: {\n      n: \"BrtEndPivotCacheIDs\",\n      f: parsenoop\n    },\n    0x0182: {\n      n: \"BrtBeginPivotCacheID\",\n      f: parsenoop\n    },\n    0x0183: {\n      n: \"BrtEndPivotCacheID\",\n      f: parsenoop\n    },\n    0x0184: {\n      n: \"BrtBeginISXVIs\",\n      f: parsenoop\n    },\n    0x0185: {\n      n: \"BrtEndISXVIs\",\n      f: parsenoop\n    },\n    0x0186: {\n      n: \"BrtBeginColInfos\",\n      f: parsenoop\n    },\n    0x0187: {\n      n: \"BrtEndColInfos\",\n      f: parsenoop\n    },\n    0x0188: {\n      n: \"BrtBeginRwBrk\",\n      f: parsenoop\n    },\n    0x0189: {\n      n: \"BrtEndRwBrk\",\n      f: parsenoop\n    },\n    0x018A: {\n      n: \"BrtBeginColBrk\",\n      f: parsenoop\n    },\n    0x018B: {\n      n: \"BrtEndColBrk\",\n      f: parsenoop\n    },\n    0x018C: {\n      n: \"BrtBrk\",\n      f: parsenoop\n    },\n    0x018D: {\n      n: \"BrtUserBookView\",\n      f: parsenoop\n    },\n    0x018E: {\n      n: \"BrtInfo\",\n      f: parsenoop\n    },\n    0x018F: {\n      n: \"BrtCUsr\",\n      f: parsenoop\n    },\n    0x0190: {\n      n: \"BrtUsr\",\n      f: parsenoop\n    },\n    0x0191: {\n      n: \"BrtBeginUsers\",\n      f: parsenoop\n    },\n    0x0193: {\n      n: \"BrtEOF\",\n      f: parsenoop\n    },\n    0x0194: {\n      n: \"BrtUCR\",\n      f: parsenoop\n    },\n    0x0195: {\n      n: \"BrtRRInsDel\",\n      f: parsenoop\n    },\n    0x0196: {\n      n: \"BrtRREndInsDel\",\n      f: parsenoop\n    },\n    0x0197: {\n      n: \"BrtRRMove\",\n      f: parsenoop\n    },\n    0x0198: {\n      n: \"BrtRREndMove\",\n      f: parsenoop\n    },\n    0x0199: {\n      n: \"BrtRRChgCell\",\n      f: parsenoop\n    },\n    0x019A: {\n      n: \"BrtRREndChgCell\",\n      f: parsenoop\n    },\n    0x019B: {\n      n: \"BrtRRHeader\",\n      f: parsenoop\n    },\n    0x019C: {\n      n: \"BrtRRUserView\",\n      f: parsenoop\n    },\n    0x019D: {\n      n: \"BrtRRRenSheet\",\n      f: parsenoop\n    },\n    0x019E: {\n      n: \"BrtRRInsertSh\",\n      f: parsenoop\n    },\n    0x019F: {\n      n: \"BrtRRDefName\",\n      f: parsenoop\n    },\n    0x01A0: {\n      n: \"BrtRRNote\",\n      f: parsenoop\n    },\n    0x01A1: {\n      n: \"BrtRRConflict\",\n      f: parsenoop\n    },\n    0x01A2: {\n      n: \"BrtRRTQSIF\",\n      f: parsenoop\n    },\n    0x01A3: {\n      n: \"BrtRRFormat\",\n      f: parsenoop\n    },\n    0x01A4: {\n      n: \"BrtRREndFormat\",\n      f: parsenoop\n    },\n    0x01A5: {\n      n: \"BrtRRAutoFmt\",\n      f: parsenoop\n    },\n    0x01A6: {\n      n: \"BrtBeginUserShViews\",\n      f: parsenoop\n    },\n    0x01A7: {\n      n: \"BrtBeginUserShView\",\n      f: parsenoop\n    },\n    0x01A8: {\n      n: \"BrtEndUserShView\",\n      f: parsenoop\n    },\n    0x01A9: {\n      n: \"BrtEndUserShViews\",\n      f: parsenoop\n    },\n    0x01AA: {\n      n: \"BrtArrFmla\",\n      f: parsenoop\n    },\n    0x01AB: {\n      n: \"BrtShrFmla\",\n      f: parsenoop\n    },\n    0x01AC: {\n      n: \"BrtTable\",\n      f: parsenoop\n    },\n    0x01AD: {\n      n: \"BrtBeginExtConnections\",\n      f: parsenoop\n    },\n    0x01AE: {\n      n: \"BrtEndExtConnections\",\n      f: parsenoop\n    },\n    0x01AF: {\n      n: \"BrtBeginPCDCalcMems\",\n      f: parsenoop\n    },\n    0x01B0: {\n      n: \"BrtEndPCDCalcMems\",\n      f: parsenoop\n    },\n    0x01B1: {\n      n: \"BrtBeginPCDCalcMem\",\n      f: parsenoop\n    },\n    0x01B2: {\n      n: \"BrtEndPCDCalcMem\",\n      f: parsenoop\n    },\n    0x01B3: {\n      n: \"BrtBeginPCDHGLevels\",\n      f: parsenoop\n    },\n    0x01B4: {\n      n: \"BrtEndPCDHGLevels\",\n      f: parsenoop\n    },\n    0x01B5: {\n      n: \"BrtBeginPCDHGLevel\",\n      f: parsenoop\n    },\n    0x01B6: {\n      n: \"BrtEndPCDHGLevel\",\n      f: parsenoop\n    },\n    0x01B7: {\n      n: \"BrtBeginPCDHGLGroups\",\n      f: parsenoop\n    },\n    0x01B8: {\n      n: \"BrtEndPCDHGLGroups\",\n      f: parsenoop\n    },\n    0x01B9: {\n      n: \"BrtBeginPCDHGLGroup\",\n      f: parsenoop\n    },\n    0x01BA: {\n      n: \"BrtEndPCDHGLGroup\",\n      f: parsenoop\n    },\n    0x01BB: {\n      n: \"BrtBeginPCDHGLGMembers\",\n      f: parsenoop\n    },\n    0x01BC: {\n      n: \"BrtEndPCDHGLGMembers\",\n      f: parsenoop\n    },\n    0x01BD: {\n      n: \"BrtBeginPCDHGLGMember\",\n      f: parsenoop\n    },\n    0x01BE: {\n      n: \"BrtEndPCDHGLGMember\",\n      f: parsenoop\n    },\n    0x01BF: {\n      n: \"BrtBeginQSI\",\n      f: parsenoop\n    },\n    0x01C0: {\n      n: \"BrtEndQSI\",\n      f: parsenoop\n    },\n    0x01C1: {\n      n: \"BrtBeginQSIR\",\n      f: parsenoop\n    },\n    0x01C2: {\n      n: \"BrtEndQSIR\",\n      f: parsenoop\n    },\n    0x01C3: {\n      n: \"BrtBeginDeletedNames\",\n      f: parsenoop\n    },\n    0x01C4: {\n      n: \"BrtEndDeletedNames\",\n      f: parsenoop\n    },\n    0x01C5: {\n      n: \"BrtBeginDeletedName\",\n      f: parsenoop\n    },\n    0x01C6: {\n      n: \"BrtEndDeletedName\",\n      f: parsenoop\n    },\n    0x01C7: {\n      n: \"BrtBeginQSIFs\",\n      f: parsenoop\n    },\n    0x01C8: {\n      n: \"BrtEndQSIFs\",\n      f: parsenoop\n    },\n    0x01C9: {\n      n: \"BrtBeginQSIF\",\n      f: parsenoop\n    },\n    0x01CA: {\n      n: \"BrtEndQSIF\",\n      f: parsenoop\n    },\n    0x01CB: {\n      n: \"BrtBeginAutoSortScope\",\n      f: parsenoop\n    },\n    0x01CC: {\n      n: \"BrtEndAutoSortScope\",\n      f: parsenoop\n    },\n    0x01CD: {\n      n: \"BrtBeginConditionalFormatting\",\n      f: parsenoop\n    },\n    0x01CE: {\n      n: \"BrtEndConditionalFormatting\",\n      f: parsenoop\n    },\n    0x01CF: {\n      n: \"BrtBeginCFRule\",\n      f: parsenoop\n    },\n    0x01D0: {\n      n: \"BrtEndCFRule\",\n      f: parsenoop\n    },\n    0x01D1: {\n      n: \"BrtBeginIconSet\",\n      f: parsenoop\n    },\n    0x01D2: {\n      n: \"BrtEndIconSet\",\n      f: parsenoop\n    },\n    0x01D3: {\n      n: \"BrtBeginDatabar\",\n      f: parsenoop\n    },\n    0x01D4: {\n      n: \"BrtEndDatabar\",\n      f: parsenoop\n    },\n    0x01D5: {\n      n: \"BrtBeginColorScale\",\n      f: parsenoop\n    },\n    0x01D6: {\n      n: \"BrtEndColorScale\",\n      f: parsenoop\n    },\n    0x01D7: {\n      n: \"BrtCFVO\",\n      f: parsenoop\n    },\n    0x01D8: {\n      n: \"BrtExternValueMeta\",\n      f: parsenoop\n    },\n    0x01D9: {\n      n: \"BrtBeginColorPalette\",\n      f: parsenoop\n    },\n    0x01DA: {\n      n: \"BrtEndColorPalette\",\n      f: parsenoop\n    },\n    0x01DB: {\n      n: \"BrtIndexedColor\",\n      f: parsenoop\n    },\n    0x01DC: {\n      n: \"BrtMargins\",\n      f: parsenoop\n    },\n    0x01DD: {\n      n: \"BrtPrintOptions\",\n      f: parsenoop\n    },\n    0x01DE: {\n      n: \"BrtPageSetup\",\n      f: parsenoop\n    },\n    0x01DF: {\n      n: \"BrtBeginHeaderFooter\",\n      f: parsenoop\n    },\n    0x01E0: {\n      n: \"BrtEndHeaderFooter\",\n      f: parsenoop\n    },\n    0x01E1: {\n      n: \"BrtBeginSXCrtFormat\",\n      f: parsenoop\n    },\n    0x01E2: {\n      n: \"BrtEndSXCrtFormat\",\n      f: parsenoop\n    },\n    0x01E3: {\n      n: \"BrtBeginSXCrtFormats\",\n      f: parsenoop\n    },\n    0x01E4: {\n      n: \"BrtEndSXCrtFormats\",\n      f: parsenoop\n    },\n    0x01E5: {\n      n: \"BrtWsFmtInfo\",\n      f: parsenoop\n    },\n    0x01E6: {\n      n: \"BrtBeginMgs\",\n      f: parsenoop\n    },\n    0x01E7: {\n      n: \"BrtEndMGs\",\n      f: parsenoop\n    },\n    0x01E8: {\n      n: \"BrtBeginMGMaps\",\n      f: parsenoop\n    },\n    0x01E9: {\n      n: \"BrtEndMGMaps\",\n      f: parsenoop\n    },\n    0x01EA: {\n      n: \"BrtBeginMG\",\n      f: parsenoop\n    },\n    0x01EB: {\n      n: \"BrtEndMG\",\n      f: parsenoop\n    },\n    0x01EC: {\n      n: \"BrtBeginMap\",\n      f: parsenoop\n    },\n    0x01ED: {\n      n: \"BrtEndMap\",\n      f: parsenoop\n    },\n    0x01EE: {\n      n: \"BrtHLink\",\n      f: parse_BrtHLink\n    },\n    0x01EF: {\n      n: \"BrtBeginDCon\",\n      f: parsenoop\n    },\n    0x01F0: {\n      n: \"BrtEndDCon\",\n      f: parsenoop\n    },\n    0x01F1: {\n      n: \"BrtBeginDRefs\",\n      f: parsenoop\n    },\n    0x01F2: {\n      n: \"BrtEndDRefs\",\n      f: parsenoop\n    },\n    0x01F3: {\n      n: \"BrtDRef\",\n      f: parsenoop\n    },\n    0x01F4: {\n      n: \"BrtBeginScenMan\",\n      f: parsenoop\n    },\n    0x01F5: {\n      n: \"BrtEndScenMan\",\n      f: parsenoop\n    },\n    0x01F6: {\n      n: \"BrtBeginSct\",\n      f: parsenoop\n    },\n    0x01F7: {\n      n: \"BrtEndSct\",\n      f: parsenoop\n    },\n    0x01F8: {\n      n: \"BrtSlc\",\n      f: parsenoop\n    },\n    0x01F9: {\n      n: \"BrtBeginDXFs\",\n      f: parsenoop\n    },\n    0x01FA: {\n      n: \"BrtEndDXFs\",\n      f: parsenoop\n    },\n    0x01FB: {\n      n: \"BrtDXF\",\n      f: parsenoop\n    },\n    0x01FC: {\n      n: \"BrtBeginTableStyles\",\n      f: parsenoop\n    },\n    0x01FD: {\n      n: \"BrtEndTableStyles\",\n      f: parsenoop\n    },\n    0x01FE: {\n      n: \"BrtBeginTableStyle\",\n      f: parsenoop\n    },\n    0x01FF: {\n      n: \"BrtEndTableStyle\",\n      f: parsenoop\n    },\n    0x0200: {\n      n: \"BrtTableStyleElement\",\n      f: parsenoop\n    },\n    0x0201: {\n      n: \"BrtTableStyleClient\",\n      f: parsenoop\n    },\n    0x0202: {\n      n: \"BrtBeginVolDeps\",\n      f: parsenoop\n    },\n    0x0203: {\n      n: \"BrtEndVolDeps\",\n      f: parsenoop\n    },\n    0x0204: {\n      n: \"BrtBeginVolType\",\n      f: parsenoop\n    },\n    0x0205: {\n      n: \"BrtEndVolType\",\n      f: parsenoop\n    },\n    0x0206: {\n      n: \"BrtBeginVolMain\",\n      f: parsenoop\n    },\n    0x0207: {\n      n: \"BrtEndVolMain\",\n      f: parsenoop\n    },\n    0x0208: {\n      n: \"BrtBeginVolTopic\",\n      f: parsenoop\n    },\n    0x0209: {\n      n: \"BrtEndVolTopic\",\n      f: parsenoop\n    },\n    0x020A: {\n      n: \"BrtVolSubtopic\",\n      f: parsenoop\n    },\n    0x020B: {\n      n: \"BrtVolRef\",\n      f: parsenoop\n    },\n    0x020C: {\n      n: \"BrtVolNum\",\n      f: parsenoop\n    },\n    0x020D: {\n      n: \"BrtVolErr\",\n      f: parsenoop\n    },\n    0x020E: {\n      n: \"BrtVolStr\",\n      f: parsenoop\n    },\n    0x020F: {\n      n: \"BrtVolBool\",\n      f: parsenoop\n    },\n    0x0210: {\n      n: \"BrtBeginCalcChain$\",\n      f: parsenoop\n    },\n    0x0211: {\n      n: \"BrtEndCalcChain$\",\n      f: parsenoop\n    },\n    0x0212: {\n      n: \"BrtBeginSortState\",\n      f: parsenoop\n    },\n    0x0213: {\n      n: \"BrtEndSortState\",\n      f: parsenoop\n    },\n    0x0214: {\n      n: \"BrtBeginSortCond\",\n      f: parsenoop\n    },\n    0x0215: {\n      n: \"BrtEndSortCond\",\n      f: parsenoop\n    },\n    0x0216: {\n      n: \"BrtBookProtection\",\n      f: parsenoop\n    },\n    0x0217: {\n      n: \"BrtSheetProtection\",\n      f: parsenoop\n    },\n    0x0218: {\n      n: \"BrtRangeProtection\",\n      f: parsenoop\n    },\n    0x0219: {\n      n: \"BrtPhoneticInfo\",\n      f: parsenoop\n    },\n    0x021A: {\n      n: \"BrtBeginECTxtWiz\",\n      f: parsenoop\n    },\n    0x021B: {\n      n: \"BrtEndECTxtWiz\",\n      f: parsenoop\n    },\n    0x021C: {\n      n: \"BrtBeginECTWFldInfoLst\",\n      f: parsenoop\n    },\n    0x021D: {\n      n: \"BrtEndECTWFldInfoLst\",\n      f: parsenoop\n    },\n    0x021E: {\n      n: \"BrtBeginECTwFldInfo\",\n      f: parsenoop\n    },\n    0x0224: {\n      n: \"BrtFileSharing\",\n      f: parsenoop\n    },\n    0x0225: {\n      n: \"BrtOleSize\",\n      f: parsenoop\n    },\n    0x0226: {\n      n: \"BrtDrawing\",\n      f: parsenoop\n    },\n    0x0227: {\n      n: \"BrtLegacyDrawing\",\n      f: parsenoop\n    },\n    0x0228: {\n      n: \"BrtLegacyDrawingHF\",\n      f: parsenoop\n    },\n    0x0229: {\n      n: \"BrtWebOpt\",\n      f: parsenoop\n    },\n    0x022A: {\n      n: \"BrtBeginWebPubItems\",\n      f: parsenoop\n    },\n    0x022B: {\n      n: \"BrtEndWebPubItems\",\n      f: parsenoop\n    },\n    0x022C: {\n      n: \"BrtBeginWebPubItem\",\n      f: parsenoop\n    },\n    0x022D: {\n      n: \"BrtEndWebPubItem\",\n      f: parsenoop\n    },\n    0x022E: {\n      n: \"BrtBeginSXCondFmt\",\n      f: parsenoop\n    },\n    0x022F: {\n      n: \"BrtEndSXCondFmt\",\n      f: parsenoop\n    },\n    0x0230: {\n      n: \"BrtBeginSXCondFmts\",\n      f: parsenoop\n    },\n    0x0231: {\n      n: \"BrtEndSXCondFmts\",\n      f: parsenoop\n    },\n    0x0232: {\n      n: \"BrtBkHim\",\n      f: parsenoop\n    },\n    0x0234: {\n      n: \"BrtColor\",\n      f: parsenoop\n    },\n    0x0235: {\n      n: \"BrtBeginIndexedColors\",\n      f: parsenoop\n    },\n    0x0236: {\n      n: \"BrtEndIndexedColors\",\n      f: parsenoop\n    },\n    0x0239: {\n      n: \"BrtBeginMRUColors\",\n      f: parsenoop\n    },\n    0x023A: {\n      n: \"BrtEndMRUColors\",\n      f: parsenoop\n    },\n    0x023C: {\n      n: \"BrtMRUColor\",\n      f: parsenoop\n    },\n    0x023D: {\n      n: \"BrtBeginDVals\",\n      f: parsenoop\n    },\n    0x023E: {\n      n: \"BrtEndDVals\",\n      f: parsenoop\n    },\n    0x0241: {\n      n: \"BrtSupNameStart\",\n      f: parsenoop\n    },\n    0x0242: {\n      n: \"BrtSupNameValueStart\",\n      f: parsenoop\n    },\n    0x0243: {\n      n: \"BrtSupNameValueEnd\",\n      f: parsenoop\n    },\n    0x0244: {\n      n: \"BrtSupNameNum\",\n      f: parsenoop\n    },\n    0x0245: {\n      n: \"BrtSupNameErr\",\n      f: parsenoop\n    },\n    0x0246: {\n      n: \"BrtSupNameSt\",\n      f: parsenoop\n    },\n    0x0247: {\n      n: \"BrtSupNameNil\",\n      f: parsenoop\n    },\n    0x0248: {\n      n: \"BrtSupNameBool\",\n      f: parsenoop\n    },\n    0x0249: {\n      n: \"BrtSupNameFmla\",\n      f: parsenoop\n    },\n    0x024A: {\n      n: \"BrtSupNameBits\",\n      f: parsenoop\n    },\n    0x024B: {\n      n: \"BrtSupNameEnd\",\n      f: parsenoop\n    },\n    0x024C: {\n      n: \"BrtEndSupBook\",\n      f: parsenoop\n    },\n    0x024D: {\n      n: \"BrtCellSmartTagProperty\",\n      f: parsenoop\n    },\n    0x024E: {\n      n: \"BrtBeginCellSmartTag\",\n      f: parsenoop\n    },\n    0x024F: {\n      n: \"BrtEndCellSmartTag\",\n      f: parsenoop\n    },\n    0x0250: {\n      n: \"BrtBeginCellSmartTags\",\n      f: parsenoop\n    },\n    0x0251: {\n      n: \"BrtEndCellSmartTags\",\n      f: parsenoop\n    },\n    0x0252: {\n      n: \"BrtBeginSmartTags\",\n      f: parsenoop\n    },\n    0x0253: {\n      n: \"BrtEndSmartTags\",\n      f: parsenoop\n    },\n    0x0254: {\n      n: \"BrtSmartTagType\",\n      f: parsenoop\n    },\n    0x0255: {\n      n: \"BrtBeginSmartTagTypes\",\n      f: parsenoop\n    },\n    0x0256: {\n      n: \"BrtEndSmartTagTypes\",\n      f: parsenoop\n    },\n    0x0257: {\n      n: \"BrtBeginSXFilters\",\n      f: parsenoop\n    },\n    0x0258: {\n      n: \"BrtEndSXFilters\",\n      f: parsenoop\n    },\n    0x0259: {\n      n: \"BrtBeginSXFILTER\",\n      f: parsenoop\n    },\n    0x025A: {\n      n: \"BrtEndSXFilter\",\n      f: parsenoop\n    },\n    0x025B: {\n      n: \"BrtBeginFills\",\n      f: parsenoop\n    },\n    0x025C: {\n      n: \"BrtEndFills\",\n      f: parsenoop\n    },\n    0x025D: {\n      n: \"BrtBeginCellWatches\",\n      f: parsenoop\n    },\n    0x025E: {\n      n: \"BrtEndCellWatches\",\n      f: parsenoop\n    },\n    0x025F: {\n      n: \"BrtCellWatch\",\n      f: parsenoop\n    },\n    0x0260: {\n      n: \"BrtBeginCRErrs\",\n      f: parsenoop\n    },\n    0x0261: {\n      n: \"BrtEndCRErrs\",\n      f: parsenoop\n    },\n    0x0262: {\n      n: \"BrtCrashRecErr\",\n      f: parsenoop\n    },\n    0x0263: {\n      n: \"BrtBeginFonts\",\n      f: parsenoop\n    },\n    0x0264: {\n      n: \"BrtEndFonts\",\n      f: parsenoop\n    },\n    0x0265: {\n      n: \"BrtBeginBorders\",\n      f: parsenoop\n    },\n    0x0266: {\n      n: \"BrtEndBorders\",\n      f: parsenoop\n    },\n    0x0267: {\n      n: \"BrtBeginFmts\",\n      f: parsenoop\n    },\n    0x0268: {\n      n: \"BrtEndFmts\",\n      f: parsenoop\n    },\n    0x0269: {\n      n: \"BrtBeginCellXFs\",\n      f: parsenoop\n    },\n    0x026A: {\n      n: \"BrtEndCellXFs\",\n      f: parsenoop\n    },\n    0x026B: {\n      n: \"BrtBeginStyles\",\n      f: parsenoop\n    },\n    0x026C: {\n      n: \"BrtEndStyles\",\n      f: parsenoop\n    },\n    0x0271: {\n      n: \"BrtBigName\",\n      f: parsenoop\n    },\n    0x0272: {\n      n: \"BrtBeginCellStyleXFs\",\n      f: parsenoop\n    },\n    0x0273: {\n      n: \"BrtEndCellStyleXFs\",\n      f: parsenoop\n    },\n    0x0274: {\n      n: \"BrtBeginComments\",\n      f: parsenoop\n    },\n    0x0275: {\n      n: \"BrtEndComments\",\n      f: parsenoop\n    },\n    0x0276: {\n      n: \"BrtBeginCommentAuthors\",\n      f: parsenoop\n    },\n    0x0277: {\n      n: \"BrtEndCommentAuthors\",\n      f: parsenoop\n    },\n    0x0278: {\n      n: \"BrtCommentAuthor\",\n      f: parse_BrtCommentAuthor\n    },\n    0x0279: {\n      n: \"BrtBeginCommentList\",\n      f: parsenoop\n    },\n    0x027A: {\n      n: \"BrtEndCommentList\",\n      f: parsenoop\n    },\n    0x027B: {\n      n: \"BrtBeginComment\",\n      f: parse_BrtBeginComment\n    },\n    0x027C: {\n      n: \"BrtEndComment\",\n      f: parsenoop\n    },\n    0x027D: {\n      n: \"BrtCommentText\",\n      f: parse_BrtCommentText\n    },\n    0x027E: {\n      n: \"BrtBeginOleObjects\",\n      f: parsenoop\n    },\n    0x027F: {\n      n: \"BrtOleObject\",\n      f: parsenoop\n    },\n    0x0280: {\n      n: \"BrtEndOleObjects\",\n      f: parsenoop\n    },\n    0x0281: {\n      n: \"BrtBeginSxrules\",\n      f: parsenoop\n    },\n    0x0282: {\n      n: \"BrtEndSxRules\",\n      f: parsenoop\n    },\n    0x0283: {\n      n: \"BrtBeginActiveXControls\",\n      f: parsenoop\n    },\n    0x0284: {\n      n: \"BrtActiveX\",\n      f: parsenoop\n    },\n    0x0285: {\n      n: \"BrtEndActiveXControls\",\n      f: parsenoop\n    },\n    0x0286: {\n      n: \"BrtBeginPCDSDTCEMembersSortBy\",\n      f: parsenoop\n    },\n    0x0288: {\n      n: \"BrtBeginCellIgnoreECs\",\n      f: parsenoop\n    },\n    0x0289: {\n      n: \"BrtCellIgnoreEC\",\n      f: parsenoop\n    },\n    0x028A: {\n      n: \"BrtEndCellIgnoreECs\",\n      f: parsenoop\n    },\n    0x028B: {\n      n: \"BrtCsProp\",\n      f: parsenoop\n    },\n    0x028C: {\n      n: \"BrtCsPageSetup\",\n      f: parsenoop\n    },\n    0x028D: {\n      n: \"BrtBeginUserCsViews\",\n      f: parsenoop\n    },\n    0x028E: {\n      n: \"BrtEndUserCsViews\",\n      f: parsenoop\n    },\n    0x028F: {\n      n: \"BrtBeginUserCsView\",\n      f: parsenoop\n    },\n    0x0290: {\n      n: \"BrtEndUserCsView\",\n      f: parsenoop\n    },\n    0x0291: {\n      n: \"BrtBeginPcdSFCIEntries\",\n      f: parsenoop\n    },\n    0x0292: {\n      n: \"BrtEndPCDSFCIEntries\",\n      f: parsenoop\n    },\n    0x0293: {\n      n: \"BrtPCDSFCIEntry\",\n      f: parsenoop\n    },\n    0x0294: {\n      n: \"BrtBeginListParts\",\n      f: parsenoop\n    },\n    0x0295: {\n      n: \"BrtListPart\",\n      f: parsenoop\n    },\n    0x0296: {\n      n: \"BrtEndListParts\",\n      f: parsenoop\n    },\n    0x0297: {\n      n: \"BrtSheetCalcProp\",\n      f: parsenoop\n    },\n    0x0298: {\n      n: \"BrtBeginFnGroup\",\n      f: parsenoop\n    },\n    0x0299: {\n      n: \"BrtFnGroup\",\n      f: parsenoop\n    },\n    0x029A: {\n      n: \"BrtEndFnGroup\",\n      f: parsenoop\n    },\n    0x029B: {\n      n: \"BrtSupAddin\",\n      f: parsenoop\n    },\n    0x029C: {\n      n: \"BrtSXTDMPOrder\",\n      f: parsenoop\n    },\n    0x029D: {\n      n: \"BrtCsProtection\",\n      f: parsenoop\n    },\n    0x029F: {\n      n: \"BrtBeginWsSortMap\",\n      f: parsenoop\n    },\n    0x02A0: {\n      n: \"BrtEndWsSortMap\",\n      f: parsenoop\n    },\n    0x02A1: {\n      n: \"BrtBeginRRSort\",\n      f: parsenoop\n    },\n    0x02A2: {\n      n: \"BrtEndRRSort\",\n      f: parsenoop\n    },\n    0x02A3: {\n      n: \"BrtRRSortItem\",\n      f: parsenoop\n    },\n    0x02A4: {\n      n: \"BrtFileSharingIso\",\n      f: parsenoop\n    },\n    0x02A5: {\n      n: \"BrtBookProtectionIso\",\n      f: parsenoop\n    },\n    0x02A6: {\n      n: \"BrtSheetProtectionIso\",\n      f: parsenoop\n    },\n    0x02A7: {\n      n: \"BrtCsProtectionIso\",\n      f: parsenoop\n    },\n    0x02A8: {\n      n: \"BrtRangeProtectionIso\",\n      f: parsenoop\n    },\n    0x0400: {\n      n: \"BrtRwDescent\",\n      f: parsenoop\n    },\n    0x0401: {\n      n: \"BrtKnownFonts\",\n      f: parsenoop\n    },\n    0x0402: {\n      n: \"BrtBeginSXTupleSet\",\n      f: parsenoop\n    },\n    0x0403: {\n      n: \"BrtEndSXTupleSet\",\n      f: parsenoop\n    },\n    0x0404: {\n      n: \"BrtBeginSXTupleSetHeader\",\n      f: parsenoop\n    },\n    0x0405: {\n      n: \"BrtEndSXTupleSetHeader\",\n      f: parsenoop\n    },\n    0x0406: {\n      n: \"BrtSXTupleSetHeaderItem\",\n      f: parsenoop\n    },\n    0x0407: {\n      n: \"BrtBeginSXTupleSetData\",\n      f: parsenoop\n    },\n    0x0408: {\n      n: \"BrtEndSXTupleSetData\",\n      f: parsenoop\n    },\n    0x0409: {\n      n: \"BrtBeginSXTupleSetRow\",\n      f: parsenoop\n    },\n    0x040A: {\n      n: \"BrtEndSXTupleSetRow\",\n      f: parsenoop\n    },\n    0x040B: {\n      n: \"BrtSXTupleSetRowItem\",\n      f: parsenoop\n    },\n    0x040C: {\n      n: \"BrtNameExt\",\n      f: parsenoop\n    },\n    0x040D: {\n      n: \"BrtPCDH14\",\n      f: parsenoop\n    },\n    0x040E: {\n      n: \"BrtBeginPCDCalcMem14\",\n      f: parsenoop\n    },\n    0x040F: {\n      n: \"BrtEndPCDCalcMem14\",\n      f: parsenoop\n    },\n    0x0410: {\n      n: \"BrtSXTH14\",\n      f: parsenoop\n    },\n    0x0411: {\n      n: \"BrtBeginSparklineGroup\",\n      f: parsenoop\n    },\n    0x0412: {\n      n: \"BrtEndSparklineGroup\",\n      f: parsenoop\n    },\n    0x0413: {\n      n: \"BrtSparkline\",\n      f: parsenoop\n    },\n    0x0414: {\n      n: \"BrtSXDI14\",\n      f: parsenoop\n    },\n    0x0415: {\n      n: \"BrtWsFmtInfoEx14\",\n      f: parsenoop\n    },\n    0x0416: {\n      n: \"BrtBeginConditionalFormatting14\",\n      f: parsenoop\n    },\n    0x0417: {\n      n: \"BrtEndConditionalFormatting14\",\n      f: parsenoop\n    },\n    0x0418: {\n      n: \"BrtBeginCFRule14\",\n      f: parsenoop\n    },\n    0x0419: {\n      n: \"BrtEndCFRule14\",\n      f: parsenoop\n    },\n    0x041A: {\n      n: \"BrtCFVO14\",\n      f: parsenoop\n    },\n    0x041B: {\n      n: \"BrtBeginDatabar14\",\n      f: parsenoop\n    },\n    0x041C: {\n      n: \"BrtBeginIconSet14\",\n      f: parsenoop\n    },\n    0x041D: {\n      n: \"BrtDVal14\",\n      f: parsenoop\n    },\n    0x041E: {\n      n: \"BrtBeginDVals14\",\n      f: parsenoop\n    },\n    0x041F: {\n      n: \"BrtColor14\",\n      f: parsenoop\n    },\n    0x0420: {\n      n: \"BrtBeginSparklines\",\n      f: parsenoop\n    },\n    0x0421: {\n      n: \"BrtEndSparklines\",\n      f: parsenoop\n    },\n    0x0422: {\n      n: \"BrtBeginSparklineGroups\",\n      f: parsenoop\n    },\n    0x0423: {\n      n: \"BrtEndSparklineGroups\",\n      f: parsenoop\n    },\n    0x0425: {\n      n: \"BrtSXVD14\",\n      f: parsenoop\n    },\n    0x0426: {\n      n: \"BrtBeginSxview14\",\n      f: parsenoop\n    },\n    0x0427: {\n      n: \"BrtEndSxview14\",\n      f: parsenoop\n    },\n    0x042A: {\n      n: \"BrtBeginPCD14\",\n      f: parsenoop\n    },\n    0x042B: {\n      n: \"BrtEndPCD14\",\n      f: parsenoop\n    },\n    0x042C: {\n      n: \"BrtBeginExtConn14\",\n      f: parsenoop\n    },\n    0x042D: {\n      n: \"BrtEndExtConn14\",\n      f: parsenoop\n    },\n    0x042E: {\n      n: \"BrtBeginSlicerCacheIDs\",\n      f: parsenoop\n    },\n    0x042F: {\n      n: \"BrtEndSlicerCacheIDs\",\n      f: parsenoop\n    },\n    0x0430: {\n      n: \"BrtBeginSlicerCacheID\",\n      f: parsenoop\n    },\n    0x0431: {\n      n: \"BrtEndSlicerCacheID\",\n      f: parsenoop\n    },\n    0x0433: {\n      n: \"BrtBeginSlicerCache\",\n      f: parsenoop\n    },\n    0x0434: {\n      n: \"BrtEndSlicerCache\",\n      f: parsenoop\n    },\n    0x0435: {\n      n: \"BrtBeginSlicerCacheDef\",\n      f: parsenoop\n    },\n    0x0436: {\n      n: \"BrtEndSlicerCacheDef\",\n      f: parsenoop\n    },\n    0x0437: {\n      n: \"BrtBeginSlicersEx\",\n      f: parsenoop\n    },\n    0x0438: {\n      n: \"BrtEndSlicersEx\",\n      f: parsenoop\n    },\n    0x0439: {\n      n: \"BrtBeginSlicerEx\",\n      f: parsenoop\n    },\n    0x043A: {\n      n: \"BrtEndSlicerEx\",\n      f: parsenoop\n    },\n    0x043B: {\n      n: \"BrtBeginSlicer\",\n      f: parsenoop\n    },\n    0x043C: {\n      n: \"BrtEndSlicer\",\n      f: parsenoop\n    },\n    0x043D: {\n      n: \"BrtSlicerCachePivotTables\",\n      f: parsenoop\n    },\n    0x043E: {\n      n: \"BrtBeginSlicerCacheOlapImpl\",\n      f: parsenoop\n    },\n    0x043F: {\n      n: \"BrtEndSlicerCacheOlapImpl\",\n      f: parsenoop\n    },\n    0x0440: {\n      n: \"BrtBeginSlicerCacheLevelsData\",\n      f: parsenoop\n    },\n    0x0441: {\n      n: \"BrtEndSlicerCacheLevelsData\",\n      f: parsenoop\n    },\n    0x0442: {\n      n: \"BrtBeginSlicerCacheLevelData\",\n      f: parsenoop\n    },\n    0x0443: {\n      n: \"BrtEndSlicerCacheLevelData\",\n      f: parsenoop\n    },\n    0x0444: {\n      n: \"BrtBeginSlicerCacheSiRanges\",\n      f: parsenoop\n    },\n    0x0445: {\n      n: \"BrtEndSlicerCacheSiRanges\",\n      f: parsenoop\n    },\n    0x0446: {\n      n: \"BrtBeginSlicerCacheSiRange\",\n      f: parsenoop\n    },\n    0x0447: {\n      n: \"BrtEndSlicerCacheSiRange\",\n      f: parsenoop\n    },\n    0x0448: {\n      n: \"BrtSlicerCacheOlapItem\",\n      f: parsenoop\n    },\n    0x0449: {\n      n: \"BrtBeginSlicerCacheSelections\",\n      f: parsenoop\n    },\n    0x044A: {\n      n: \"BrtSlicerCacheSelection\",\n      f: parsenoop\n    },\n    0x044B: {\n      n: \"BrtEndSlicerCacheSelections\",\n      f: parsenoop\n    },\n    0x044C: {\n      n: \"BrtBeginSlicerCacheNative\",\n      f: parsenoop\n    },\n    0x044D: {\n      n: \"BrtEndSlicerCacheNative\",\n      f: parsenoop\n    },\n    0x044E: {\n      n: \"BrtSlicerCacheNativeItem\",\n      f: parsenoop\n    },\n    0x044F: {\n      n: \"BrtRangeProtection14\",\n      f: parsenoop\n    },\n    0x0450: {\n      n: \"BrtRangeProtectionIso14\",\n      f: parsenoop\n    },\n    0x0451: {\n      n: \"BrtCellIgnoreEC14\",\n      f: parsenoop\n    },\n    0x0457: {\n      n: \"BrtList14\",\n      f: parsenoop\n    },\n    0x0458: {\n      n: \"BrtCFIcon\",\n      f: parsenoop\n    },\n    0x0459: {\n      n: \"BrtBeginSlicerCachesPivotCacheIDs\",\n      f: parsenoop\n    },\n    0x045A: {\n      n: \"BrtEndSlicerCachesPivotCacheIDs\",\n      f: parsenoop\n    },\n    0x045B: {\n      n: \"BrtBeginSlicers\",\n      f: parsenoop\n    },\n    0x045C: {\n      n: \"BrtEndSlicers\",\n      f: parsenoop\n    },\n    0x045D: {\n      n: \"BrtWbProp14\",\n      f: parsenoop\n    },\n    0x045E: {\n      n: \"BrtBeginSXEdit\",\n      f: parsenoop\n    },\n    0x045F: {\n      n: \"BrtEndSXEdit\",\n      f: parsenoop\n    },\n    0x0460: {\n      n: \"BrtBeginSXEdits\",\n      f: parsenoop\n    },\n    0x0461: {\n      n: \"BrtEndSXEdits\",\n      f: parsenoop\n    },\n    0x0462: {\n      n: \"BrtBeginSXChange\",\n      f: parsenoop\n    },\n    0x0463: {\n      n: \"BrtEndSXChange\",\n      f: parsenoop\n    },\n    0x0464: {\n      n: \"BrtBeginSXChanges\",\n      f: parsenoop\n    },\n    0x0465: {\n      n: \"BrtEndSXChanges\",\n      f: parsenoop\n    },\n    0x0466: {\n      n: \"BrtSXTupleItems\",\n      f: parsenoop\n    },\n    0x0468: {\n      n: \"BrtBeginSlicerStyle\",\n      f: parsenoop\n    },\n    0x0469: {\n      n: \"BrtEndSlicerStyle\",\n      f: parsenoop\n    },\n    0x046A: {\n      n: \"BrtSlicerStyleElement\",\n      f: parsenoop\n    },\n    0x046B: {\n      n: \"BrtBeginStyleSheetExt14\",\n      f: parsenoop\n    },\n    0x046C: {\n      n: \"BrtEndStyleSheetExt14\",\n      f: parsenoop\n    },\n    0x046D: {\n      n: \"BrtBeginSlicerCachesPivotCacheID\",\n      f: parsenoop\n    },\n    0x046E: {\n      n: \"BrtEndSlicerCachesPivotCacheID\",\n      f: parsenoop\n    },\n    0x046F: {\n      n: \"BrtBeginConditionalFormattings\",\n      f: parsenoop\n    },\n    0x0470: {\n      n: \"BrtEndConditionalFormattings\",\n      f: parsenoop\n    },\n    0x0471: {\n      n: \"BrtBeginPCDCalcMemExt\",\n      f: parsenoop\n    },\n    0x0472: {\n      n: \"BrtEndPCDCalcMemExt\",\n      f: parsenoop\n    },\n    0x0473: {\n      n: \"BrtBeginPCDCalcMemsExt\",\n      f: parsenoop\n    },\n    0x0474: {\n      n: \"BrtEndPCDCalcMemsExt\",\n      f: parsenoop\n    },\n    0x0475: {\n      n: \"BrtPCDField14\",\n      f: parsenoop\n    },\n    0x0476: {\n      n: \"BrtBeginSlicerStyles\",\n      f: parsenoop\n    },\n    0x0477: {\n      n: \"BrtEndSlicerStyles\",\n      f: parsenoop\n    },\n    0x0478: {\n      n: \"BrtBeginSlicerStyleElements\",\n      f: parsenoop\n    },\n    0x0479: {\n      n: \"BrtEndSlicerStyleElements\",\n      f: parsenoop\n    },\n    0x047A: {\n      n: \"BrtCFRuleExt\",\n      f: parsenoop\n    },\n    0x047B: {\n      n: \"BrtBeginSXCondFmt14\",\n      f: parsenoop\n    },\n    0x047C: {\n      n: \"BrtEndSXCondFmt14\",\n      f: parsenoop\n    },\n    0x047D: {\n      n: \"BrtBeginSXCondFmts14\",\n      f: parsenoop\n    },\n    0x047E: {\n      n: \"BrtEndSXCondFmts14\",\n      f: parsenoop\n    },\n    0x0480: {\n      n: \"BrtBeginSortCond14\",\n      f: parsenoop\n    },\n    0x0481: {\n      n: \"BrtEndSortCond14\",\n      f: parsenoop\n    },\n    0x0482: {\n      n: \"BrtEndDVals14\",\n      f: parsenoop\n    },\n    0x0483: {\n      n: \"BrtEndIconSet14\",\n      f: parsenoop\n    },\n    0x0484: {\n      n: \"BrtEndDatabar14\",\n      f: parsenoop\n    },\n    0x0485: {\n      n: \"BrtBeginColorScale14\",\n      f: parsenoop\n    },\n    0x0486: {\n      n: \"BrtEndColorScale14\",\n      f: parsenoop\n    },\n    0x0487: {\n      n: \"BrtBeginSxrules14\",\n      f: parsenoop\n    },\n    0x0488: {\n      n: \"BrtEndSxrules14\",\n      f: parsenoop\n    },\n    0x0489: {\n      n: \"BrtBeginPRule14\",\n      f: parsenoop\n    },\n    0x048A: {\n      n: \"BrtEndPRule14\",\n      f: parsenoop\n    },\n    0x048B: {\n      n: \"BrtBeginPRFilters14\",\n      f: parsenoop\n    },\n    0x048C: {\n      n: \"BrtEndPRFilters14\",\n      f: parsenoop\n    },\n    0x048D: {\n      n: \"BrtBeginPRFilter14\",\n      f: parsenoop\n    },\n    0x048E: {\n      n: \"BrtEndPRFilter14\",\n      f: parsenoop\n    },\n    0x048F: {\n      n: \"BrtBeginPRFItem14\",\n      f: parsenoop\n    },\n    0x0490: {\n      n: \"BrtEndPRFItem14\",\n      f: parsenoop\n    },\n    0x0491: {\n      n: \"BrtBeginCellIgnoreECs14\",\n      f: parsenoop\n    },\n    0x0492: {\n      n: \"BrtEndCellIgnoreECs14\",\n      f: parsenoop\n    },\n    0x0493: {\n      n: \"BrtDxf14\",\n      f: parsenoop\n    },\n    0x0494: {\n      n: \"BrtBeginDxF14s\",\n      f: parsenoop\n    },\n    0x0495: {\n      n: \"BrtEndDxf14s\",\n      f: parsenoop\n    },\n    0x0499: {\n      n: \"BrtFilter14\",\n      f: parsenoop\n    },\n    0x049A: {\n      n: \"BrtBeginCustomFilters14\",\n      f: parsenoop\n    },\n    0x049C: {\n      n: \"BrtCustomFilter14\",\n      f: parsenoop\n    },\n    0x049D: {\n      n: \"BrtIconFilter14\",\n      f: parsenoop\n    },\n    0x049E: {\n      n: \"BrtPivotCacheConnectionName\",\n      f: parsenoop\n    },\n    0x0800: {\n      n: \"BrtBeginDecoupledPivotCacheIDs\",\n      f: parsenoop\n    },\n    0x0801: {\n      n: \"BrtEndDecoupledPivotCacheIDs\",\n      f: parsenoop\n    },\n    0x0802: {\n      n: \"BrtDecoupledPivotCacheID\",\n      f: parsenoop\n    },\n    0x0803: {\n      n: \"BrtBeginPivotTableRefs\",\n      f: parsenoop\n    },\n    0x0804: {\n      n: \"BrtEndPivotTableRefs\",\n      f: parsenoop\n    },\n    0x0805: {\n      n: \"BrtPivotTableRef\",\n      f: parsenoop\n    },\n    0x0806: {\n      n: \"BrtSlicerCacheBookPivotTables\",\n      f: parsenoop\n    },\n    0x0807: {\n      n: \"BrtBeginSxvcells\",\n      f: parsenoop\n    },\n    0x0808: {\n      n: \"BrtEndSxvcells\",\n      f: parsenoop\n    },\n    0x0809: {\n      n: \"BrtBeginSxRow\",\n      f: parsenoop\n    },\n    0x080A: {\n      n: \"BrtEndSxRow\",\n      f: parsenoop\n    },\n    0x080C: {\n      n: \"BrtPcdCalcMem15\",\n      f: parsenoop\n    },\n    0x0813: {\n      n: \"BrtQsi15\",\n      f: parsenoop\n    },\n    0x0814: {\n      n: \"BrtBeginWebExtensions\",\n      f: parsenoop\n    },\n    0x0815: {\n      n: \"BrtEndWebExtensions\",\n      f: parsenoop\n    },\n    0x0816: {\n      n: \"BrtWebExtension\",\n      f: parsenoop\n    },\n    0x0817: {\n      n: \"BrtAbsPath15\",\n      f: parsenoop\n    },\n    0x0818: {\n      n: \"BrtBeginPivotTableUISettings\",\n      f: parsenoop\n    },\n    0x0819: {\n      n: \"BrtEndPivotTableUISettings\",\n      f: parsenoop\n    },\n    0x081B: {\n      n: \"BrtTableSlicerCacheIDs\",\n      f: parsenoop\n    },\n    0x081C: {\n      n: \"BrtTableSlicerCacheID\",\n      f: parsenoop\n    },\n    0x081D: {\n      n: \"BrtBeginTableSlicerCache\",\n      f: parsenoop\n    },\n    0x081E: {\n      n: \"BrtEndTableSlicerCache\",\n      f: parsenoop\n    },\n    0x081F: {\n      n: \"BrtSxFilter15\",\n      f: parsenoop\n    },\n    0x0820: {\n      n: \"BrtBeginTimelineCachePivotCacheIDs\",\n      f: parsenoop\n    },\n    0x0821: {\n      n: \"BrtEndTimelineCachePivotCacheIDs\",\n      f: parsenoop\n    },\n    0x0822: {\n      n: \"BrtTimelineCachePivotCacheID\",\n      f: parsenoop\n    },\n    0x0823: {\n      n: \"BrtBeginTimelineCacheIDs\",\n      f: parsenoop\n    },\n    0x0824: {\n      n: \"BrtEndTimelineCacheIDs\",\n      f: parsenoop\n    },\n    0x0825: {\n      n: \"BrtBeginTimelineCacheID\",\n      f: parsenoop\n    },\n    0x0826: {\n      n: \"BrtEndTimelineCacheID\",\n      f: parsenoop\n    },\n    0x0827: {\n      n: \"BrtBeginTimelinesEx\",\n      f: parsenoop\n    },\n    0x0828: {\n      n: \"BrtEndTimelinesEx\",\n      f: parsenoop\n    },\n    0x0829: {\n      n: \"BrtBeginTimelineEx\",\n      f: parsenoop\n    },\n    0x082A: {\n      n: \"BrtEndTimelineEx\",\n      f: parsenoop\n    },\n    0x082B: {\n      n: \"BrtWorkBookPr15\",\n      f: parsenoop\n    },\n    0x082C: {\n      n: \"BrtPCDH15\",\n      f: parsenoop\n    },\n    0x082D: {\n      n: \"BrtBeginTimelineStyle\",\n      f: parsenoop\n    },\n    0x082E: {\n      n: \"BrtEndTimelineStyle\",\n      f: parsenoop\n    },\n    0x082F: {\n      n: \"BrtTimelineStyleElement\",\n      f: parsenoop\n    },\n    0x0830: {\n      n: \"BrtBeginTimelineStylesheetExt15\",\n      f: parsenoop\n    },\n    0x0831: {\n      n: \"BrtEndTimelineStylesheetExt15\",\n      f: parsenoop\n    },\n    0x0832: {\n      n: \"BrtBeginTimelineStyles\",\n      f: parsenoop\n    },\n    0x0833: {\n      n: \"BrtEndTimelineStyles\",\n      f: parsenoop\n    },\n    0x0834: {\n      n: \"BrtBeginTimelineStyleElements\",\n      f: parsenoop\n    },\n    0x0835: {\n      n: \"BrtEndTimelineStyleElements\",\n      f: parsenoop\n    },\n    0x0836: {\n      n: \"BrtDxf15\",\n      f: parsenoop\n    },\n    0x0837: {\n      n: \"BrtBeginDxfs15\",\n      f: parsenoop\n    },\n    0x0838: {\n      n: \"brtEndDxfs15\",\n      f: parsenoop\n    },\n    0x0839: {\n      n: \"BrtSlicerCacheHideItemsWithNoData\",\n      f: parsenoop\n    },\n    0x083A: {\n      n: \"BrtBeginItemUniqueNames\",\n      f: parsenoop\n    },\n    0x083B: {\n      n: \"BrtEndItemUniqueNames\",\n      f: parsenoop\n    },\n    0x083C: {\n      n: \"BrtItemUniqueName\",\n      f: parsenoop\n    },\n    0x083D: {\n      n: \"BrtBeginExtConn15\",\n      f: parsenoop\n    },\n    0x083E: {\n      n: \"BrtEndExtConn15\",\n      f: parsenoop\n    },\n    0x083F: {\n      n: \"BrtBeginOledbPr15\",\n      f: parsenoop\n    },\n    0x0840: {\n      n: \"BrtEndOledbPr15\",\n      f: parsenoop\n    },\n    0x0841: {\n      n: \"BrtBeginDataFeedPr15\",\n      f: parsenoop\n    },\n    0x0842: {\n      n: \"BrtEndDataFeedPr15\",\n      f: parsenoop\n    },\n    0x0843: {\n      n: \"BrtTextPr15\",\n      f: parsenoop\n    },\n    0x0844: {\n      n: \"BrtRangePr15\",\n      f: parsenoop\n    },\n    0x0845: {\n      n: \"BrtDbCommand15\",\n      f: parsenoop\n    },\n    0x0846: {\n      n: \"BrtBeginDbTables15\",\n      f: parsenoop\n    },\n    0x0847: {\n      n: \"BrtEndDbTables15\",\n      f: parsenoop\n    },\n    0x0848: {\n      n: \"BrtDbTable15\",\n      f: parsenoop\n    },\n    0x0849: {\n      n: \"BrtBeginDataModel\",\n      f: parsenoop\n    },\n    0x084A: {\n      n: \"BrtEndDataModel\",\n      f: parsenoop\n    },\n    0x084B: {\n      n: \"BrtBeginModelTables\",\n      f: parsenoop\n    },\n    0x084C: {\n      n: \"BrtEndModelTables\",\n      f: parsenoop\n    },\n    0x084D: {\n      n: \"BrtModelTable\",\n      f: parsenoop\n    },\n    0x084E: {\n      n: \"BrtBeginModelRelationships\",\n      f: parsenoop\n    },\n    0x084F: {\n      n: \"BrtEndModelRelationships\",\n      f: parsenoop\n    },\n    0x0850: {\n      n: \"BrtModelRelationship\",\n      f: parsenoop\n    },\n    0x0851: {\n      n: \"BrtBeginECTxtWiz15\",\n      f: parsenoop\n    },\n    0x0852: {\n      n: \"BrtEndECTxtWiz15\",\n      f: parsenoop\n    },\n    0x0853: {\n      n: \"BrtBeginECTWFldInfoLst15\",\n      f: parsenoop\n    },\n    0x0854: {\n      n: \"BrtEndECTWFldInfoLst15\",\n      f: parsenoop\n    },\n    0x0855: {\n      n: \"BrtBeginECTWFldInfo15\",\n      f: parsenoop\n    },\n    0x0856: {\n      n: \"BrtFieldListActiveItem\",\n      f: parsenoop\n    },\n    0x0857: {\n      n: \"BrtPivotCacheIdVersion\",\n      f: parsenoop\n    },\n    0x0858: {\n      n: \"BrtSXDI15\",\n      f: parsenoop\n    },\n    0xFFFF: {\n      n: \"\",\n      f: parsenoop\n    }\n  };\n  var evert_RE = evert_key(XLSBRecordEnum, 'n');\n  /* [MS-XLS] 2.3 Record Enumeration */\n\n  var XLSRecordEnum = {\n    0x0003: {\n      n: \"BIFF2NUM\",\n      f: parse_BIFF2NUM\n    },\n    0x0004: {\n      n: \"BIFF2STR\",\n      f: parse_BIFF2STR\n    },\n    0x0006: {\n      n: \"Formula\",\n      f: parse_Formula\n    },\n    0x0009: {\n      n: 'BOF',\n      f: parse_BOF\n    },\n    0x000a: {\n      n: 'EOF',\n      f: parse_EOF\n    },\n    0x000c: {\n      n: \"CalcCount\",\n      f: parse_CalcCount\n    },\n    0x000d: {\n      n: \"CalcMode\",\n      f: parse_CalcMode\n    },\n    0x000e: {\n      n: \"CalcPrecision\",\n      f: parse_CalcPrecision\n    },\n    0x000f: {\n      n: \"CalcRefMode\",\n      f: parse_CalcRefMode\n    },\n    0x0010: {\n      n: \"CalcDelta\",\n      f: parse_CalcDelta\n    },\n    0x0011: {\n      n: \"CalcIter\",\n      f: parse_CalcIter\n    },\n    0x0012: {\n      n: \"Protect\",\n      f: parse_Protect\n    },\n    0x0013: {\n      n: \"Password\",\n      f: parse_Password\n    },\n    0x0014: {\n      n: \"Header\",\n      f: parse_Header\n    },\n    0x0015: {\n      n: \"Footer\",\n      f: parse_Footer\n    },\n    0x0017: {\n      n: \"ExternSheet\",\n      f: parse_ExternSheet\n    },\n    0x0018: {\n      n: \"Lbl\",\n      f: parse_Lbl\n    },\n    0x0019: {\n      n: \"WinProtect\",\n      f: parse_WinProtect\n    },\n    0x001a: {\n      n: \"VerticalPageBreaks\",\n      f: parse_VerticalPageBreaks\n    },\n    0x001b: {\n      n: \"HorizontalPageBreaks\",\n      f: parse_HorizontalPageBreaks\n    },\n    0x001c: {\n      n: \"Note\",\n      f: parse_Note\n    },\n    0x001d: {\n      n: \"Selection\",\n      f: parse_Selection\n    },\n    0x0022: {\n      n: \"Date1904\",\n      f: parse_Date1904\n    },\n    0x0023: {\n      n: \"ExternName\",\n      f: parse_ExternName\n    },\n    0x0026: {\n      n: \"LeftMargin\",\n      f: parse_LeftMargin\n    },\n    0x0027: {\n      n: \"RightMargin\",\n      f: parse_RightMargin\n    },\n    0x0028: {\n      n: \"TopMargin\",\n      f: parse_TopMargin\n    },\n    0x0029: {\n      n: \"BottomMargin\",\n      f: parse_BottomMargin\n    },\n    0x002a: {\n      n: \"PrintRowCol\",\n      f: parse_PrintRowCol\n    },\n    0x002b: {\n      n: \"PrintGrid\",\n      f: parse_PrintGrid\n    },\n    0x002f: {\n      n: \"FilePass\",\n      f: parse_FilePass\n    },\n    0x0031: {\n      n: \"Font\",\n      f: parse_Font\n    },\n    0x0033: {\n      n: \"PrintSize\",\n      f: parse_PrintSize\n    },\n    0x003c: {\n      n: \"Continue\",\n      f: parse_Continue\n    },\n    0x003d: {\n      n: \"Window1\",\n      f: parse_Window1\n    },\n    0x0040: {\n      n: \"Backup\",\n      f: parse_Backup\n    },\n    0x0041: {\n      n: \"Pane\",\n      f: parse_Pane\n    },\n    0x0042: {\n      n: 'CodePage',\n      f: parse_CodePage\n    },\n    0x004d: {\n      n: \"Pls\",\n      f: parse_Pls\n    },\n    0x0050: {\n      n: \"DCon\",\n      f: parse_DCon\n    },\n    0x0051: {\n      n: \"DConRef\",\n      f: parse_DConRef\n    },\n    0x0052: {\n      n: \"DConName\",\n      f: parse_DConName\n    },\n    0x0055: {\n      n: \"DefColWidth\",\n      f: parse_DefColWidth\n    },\n    0x0059: {\n      n: \"XCT\",\n      f: parse_XCT\n    },\n    0x005a: {\n      n: \"CRN\",\n      f: parse_CRN\n    },\n    0x005b: {\n      n: \"FileSharing\",\n      f: parse_FileSharing\n    },\n    0x005c: {\n      n: 'WriteAccess',\n      f: parse_WriteAccess\n    },\n    0x005d: {\n      n: \"Obj\",\n      f: parse_Obj\n    },\n    0x005e: {\n      n: \"Uncalced\",\n      f: parse_Uncalced\n    },\n    0x005f: {\n      n: \"CalcSaveRecalc\",\n      f: parse_CalcSaveRecalc\n    },\n    0x0060: {\n      n: \"Template\",\n      f: parse_Template\n    },\n    0x0061: {\n      n: \"Intl\",\n      f: parse_Intl\n    },\n    0x0063: {\n      n: \"ObjProtect\",\n      f: parse_ObjProtect\n    },\n    0x007d: {\n      n: \"ColInfo\",\n      f: parse_ColInfo\n    },\n    0x0080: {\n      n: \"Guts\",\n      f: parse_Guts\n    },\n    0x0081: {\n      n: \"WsBool\",\n      f: parse_WsBool\n    },\n    0x0082: {\n      n: \"GridSet\",\n      f: parse_GridSet\n    },\n    0x0083: {\n      n: \"HCenter\",\n      f: parse_HCenter\n    },\n    0x0084: {\n      n: \"VCenter\",\n      f: parse_VCenter\n    },\n    0x0085: {\n      n: 'BoundSheet8',\n      f: parse_BoundSheet8\n    },\n    0x0086: {\n      n: \"WriteProtect\",\n      f: parse_WriteProtect\n    },\n    0x008c: {\n      n: \"Country\",\n      f: parse_Country\n    },\n    0x008d: {\n      n: \"HideObj\",\n      f: parse_HideObj\n    },\n    0x0090: {\n      n: \"Sort\",\n      f: parse_Sort\n    },\n    0x0092: {\n      n: \"Palette\",\n      f: parse_Palette\n    },\n    0x0097: {\n      n: \"Sync\",\n      f: parse_Sync\n    },\n    0x0098: {\n      n: \"LPr\",\n      f: parse_LPr\n    },\n    0x0099: {\n      n: \"DxGCol\",\n      f: parse_DxGCol\n    },\n    0x009a: {\n      n: \"FnGroupName\",\n      f: parse_FnGroupName\n    },\n    0x009b: {\n      n: \"FilterMode\",\n      f: parse_FilterMode\n    },\n    0x009c: {\n      n: \"BuiltInFnGroupCount\",\n      f: parse_BuiltInFnGroupCount\n    },\n    0x009d: {\n      n: \"AutoFilterInfo\",\n      f: parse_AutoFilterInfo\n    },\n    0x009e: {\n      n: \"AutoFilter\",\n      f: parse_AutoFilter\n    },\n    0x00a0: {\n      n: \"Scl\",\n      f: parse_Scl\n    },\n    0x00a1: {\n      n: \"Setup\",\n      f: parse_Setup\n    },\n    0x00ae: {\n      n: \"ScenMan\",\n      f: parse_ScenMan\n    },\n    0x00af: {\n      n: \"SCENARIO\",\n      f: parse_SCENARIO\n    },\n    0x00b0: {\n      n: \"SxView\",\n      f: parse_SxView\n    },\n    0x00b1: {\n      n: \"Sxvd\",\n      f: parse_Sxvd\n    },\n    0x00b2: {\n      n: \"SXVI\",\n      f: parse_SXVI\n    },\n    0x00b4: {\n      n: \"SxIvd\",\n      f: parse_SxIvd\n    },\n    0x00b5: {\n      n: \"SXLI\",\n      f: parse_SXLI\n    },\n    0x00b6: {\n      n: \"SXPI\",\n      f: parse_SXPI\n    },\n    0x00b8: {\n      n: \"DocRoute\",\n      f: parse_DocRoute\n    },\n    0x00b9: {\n      n: \"RecipName\",\n      f: parse_RecipName\n    },\n    0x00bd: {\n      n: \"MulRk\",\n      f: parse_MulRk\n    },\n    0x00be: {\n      n: \"MulBlank\",\n      f: parse_MulBlank\n    },\n    0x00c1: {\n      n: 'Mms',\n      f: parse_Mms\n    },\n    0x00c5: {\n      n: \"SXDI\",\n      f: parse_SXDI\n    },\n    0x00c6: {\n      n: \"SXDB\",\n      f: parse_SXDB\n    },\n    0x00c7: {\n      n: \"SXFDB\",\n      f: parse_SXFDB\n    },\n    0x00c8: {\n      n: \"SXDBB\",\n      f: parse_SXDBB\n    },\n    0x00c9: {\n      n: \"SXNum\",\n      f: parse_SXNum\n    },\n    0x00ca: {\n      n: \"SxBool\",\n      f: parse_SxBool\n    },\n    0x00cb: {\n      n: \"SxErr\",\n      f: parse_SxErr\n    },\n    0x00cc: {\n      n: \"SXInt\",\n      f: parse_SXInt\n    },\n    0x00cd: {\n      n: \"SXString\",\n      f: parse_SXString\n    },\n    0x00ce: {\n      n: \"SXDtr\",\n      f: parse_SXDtr\n    },\n    0x00cf: {\n      n: \"SxNil\",\n      f: parse_SxNil\n    },\n    0x00d0: {\n      n: \"SXTbl\",\n      f: parse_SXTbl\n    },\n    0x00d1: {\n      n: \"SXTBRGIITM\",\n      f: parse_SXTBRGIITM\n    },\n    0x00d2: {\n      n: \"SxTbpg\",\n      f: parse_SxTbpg\n    },\n    0x00d3: {\n      n: \"ObProj\",\n      f: parse_ObProj\n    },\n    0x00d5: {\n      n: \"SXStreamID\",\n      f: parse_SXStreamID\n    },\n    0x00d7: {\n      n: \"DBCell\",\n      f: parse_DBCell\n    },\n    0x00d8: {\n      n: \"SXRng\",\n      f: parse_SXRng\n    },\n    0x00d9: {\n      n: \"SxIsxoper\",\n      f: parse_SxIsxoper\n    },\n    0x00da: {\n      n: \"BookBool\",\n      f: parse_BookBool\n    },\n    0x00dc: {\n      n: \"DbOrParamQry\",\n      f: parse_DbOrParamQry\n    },\n    0x00dd: {\n      n: \"ScenarioProtect\",\n      f: parse_ScenarioProtect\n    },\n    0x00de: {\n      n: \"OleObjectSize\",\n      f: parse_OleObjectSize\n    },\n    0x00e0: {\n      n: \"XF\",\n      f: parse_XF\n    },\n    0x00e1: {\n      n: 'InterfaceHdr',\n      f: parse_InterfaceHdr\n    },\n    0x00e2: {\n      n: 'InterfaceEnd',\n      f: parse_InterfaceEnd\n    },\n    0x00e3: {\n      n: \"SXVS\",\n      f: parse_SXVS\n    },\n    0x00e5: {\n      n: \"MergeCells\",\n      f: parse_MergeCells\n    },\n    0x00e9: {\n      n: \"BkHim\",\n      f: parse_BkHim\n    },\n    0x00eb: {\n      n: \"MsoDrawingGroup\",\n      f: parse_MsoDrawingGroup\n    },\n    0x00ec: {\n      n: \"MsoDrawing\",\n      f: parse_MsoDrawing\n    },\n    0x00ed: {\n      n: \"MsoDrawingSelection\",\n      f: parse_MsoDrawingSelection\n    },\n    0x00ef: {\n      n: \"PhoneticInfo\",\n      f: parse_PhoneticInfo\n    },\n    0x00f0: {\n      n: \"SxRule\",\n      f: parse_SxRule\n    },\n    0x00f1: {\n      n: \"SXEx\",\n      f: parse_SXEx\n    },\n    0x00f2: {\n      n: \"SxFilt\",\n      f: parse_SxFilt\n    },\n    0x00f4: {\n      n: \"SxDXF\",\n      f: parse_SxDXF\n    },\n    0x00f5: {\n      n: \"SxItm\",\n      f: parse_SxItm\n    },\n    0x00f6: {\n      n: \"SxName\",\n      f: parse_SxName\n    },\n    0x00f7: {\n      n: \"SxSelect\",\n      f: parse_SxSelect\n    },\n    0x00f8: {\n      n: \"SXPair\",\n      f: parse_SXPair\n    },\n    0x00f9: {\n      n: \"SxFmla\",\n      f: parse_SxFmla\n    },\n    0x00fb: {\n      n: \"SxFormat\",\n      f: parse_SxFormat\n    },\n    0x00fc: {\n      n: \"SST\",\n      f: parse_SST\n    },\n    0x00fd: {\n      n: \"LabelSst\",\n      f: parse_LabelSst\n    },\n    0x00ff: {\n      n: \"ExtSST\",\n      f: parse_ExtSST\n    },\n    0x0100: {\n      n: \"SXVDEx\",\n      f: parse_SXVDEx\n    },\n    0x0103: {\n      n: \"SXFormula\",\n      f: parse_SXFormula\n    },\n    0x0122: {\n      n: \"SXDBEx\",\n      f: parse_SXDBEx\n    },\n    0x0137: {\n      n: \"RRDInsDel\",\n      f: parse_RRDInsDel\n    },\n    0x0138: {\n      n: \"RRDHead\",\n      f: parse_RRDHead\n    },\n    0x013b: {\n      n: \"RRDChgCell\",\n      f: parse_RRDChgCell\n    },\n    0x013d: {\n      n: \"RRTabId\",\n      f: parse_RRTabId\n    },\n    0x013e: {\n      n: \"RRDRenSheet\",\n      f: parse_RRDRenSheet\n    },\n    0x013f: {\n      n: \"RRSort\",\n      f: parse_RRSort\n    },\n    0x0140: {\n      n: \"RRDMove\",\n      f: parse_RRDMove\n    },\n    0x014a: {\n      n: \"RRFormat\",\n      f: parse_RRFormat\n    },\n    0x014b: {\n      n: \"RRAutoFmt\",\n      f: parse_RRAutoFmt\n    },\n    0x014d: {\n      n: \"RRInsertSh\",\n      f: parse_RRInsertSh\n    },\n    0x014e: {\n      n: \"RRDMoveBegin\",\n      f: parse_RRDMoveBegin\n    },\n    0x014f: {\n      n: \"RRDMoveEnd\",\n      f: parse_RRDMoveEnd\n    },\n    0x0150: {\n      n: \"RRDInsDelBegin\",\n      f: parse_RRDInsDelBegin\n    },\n    0x0151: {\n      n: \"RRDInsDelEnd\",\n      f: parse_RRDInsDelEnd\n    },\n    0x0152: {\n      n: \"RRDConflict\",\n      f: parse_RRDConflict\n    },\n    0x0153: {\n      n: \"RRDDefName\",\n      f: parse_RRDDefName\n    },\n    0x0154: {\n      n: \"RRDRstEtxp\",\n      f: parse_RRDRstEtxp\n    },\n    0x015f: {\n      n: \"LRng\",\n      f: parse_LRng\n    },\n    0x0160: {\n      n: \"UsesELFs\",\n      f: parse_UsesELFs\n    },\n    0x0161: {\n      n: \"DSF\",\n      f: parse_DSF\n    },\n    0x0191: {\n      n: \"CUsr\",\n      f: parse_CUsr\n    },\n    0x0192: {\n      n: \"CbUsr\",\n      f: parse_CbUsr\n    },\n    0x0193: {\n      n: \"UsrInfo\",\n      f: parse_UsrInfo\n    },\n    0x0194: {\n      n: \"UsrExcl\",\n      f: parse_UsrExcl\n    },\n    0x0195: {\n      n: \"FileLock\",\n      f: parse_FileLock\n    },\n    0x0196: {\n      n: \"RRDInfo\",\n      f: parse_RRDInfo\n    },\n    0x0197: {\n      n: \"BCUsrs\",\n      f: parse_BCUsrs\n    },\n    0x0198: {\n      n: \"UsrChk\",\n      f: parse_UsrChk\n    },\n    0x01a9: {\n      n: \"UserBView\",\n      f: parse_UserBView\n    },\n    0x01aa: {\n      n: \"UserSViewBegin\",\n      f: parse_UserSViewBegin\n    },\n    0x01ab: {\n      n: \"UserSViewEnd\",\n      f: parse_UserSViewEnd\n    },\n    0x01ac: {\n      n: \"RRDUserView\",\n      f: parse_RRDUserView\n    },\n    0x01ad: {\n      n: \"Qsi\",\n      f: parse_Qsi\n    },\n    0x01ae: {\n      n: \"SupBook\",\n      f: parse_SupBook\n    },\n    0x01af: {\n      n: \"Prot4Rev\",\n      f: parse_Prot4Rev\n    },\n    0x01b0: {\n      n: \"CondFmt\",\n      f: parse_CondFmt\n    },\n    0x01b1: {\n      n: \"CF\",\n      f: parse_CF\n    },\n    0x01b2: {\n      n: \"DVal\",\n      f: parse_DVal\n    },\n    0x01b5: {\n      n: \"DConBin\",\n      f: parse_DConBin\n    },\n    0x01b6: {\n      n: \"TxO\",\n      f: parse_TxO\n    },\n    0x01b7: {\n      n: \"RefreshAll\",\n      f: parse_RefreshAll\n    },\n    0x01b8: {\n      n: \"HLink\",\n      f: parse_HLink\n    },\n    0x01b9: {\n      n: \"Lel\",\n      f: parse_Lel\n    },\n    0x01ba: {\n      n: \"CodeName\",\n      f: parse_XLSCodeName\n    },\n    0x01bb: {\n      n: \"SXFDBType\",\n      f: parse_SXFDBType\n    },\n    0x01bc: {\n      n: \"Prot4RevPass\",\n      f: parse_Prot4RevPass\n    },\n    0x01bd: {\n      n: \"ObNoMacros\",\n      f: parse_ObNoMacros\n    },\n    0x01be: {\n      n: \"Dv\",\n      f: parse_Dv\n    },\n    0x01c0: {\n      n: \"Excel9File\",\n      f: parse_Excel9File\n    },\n    0x01c1: {\n      n: \"RecalcId\",\n      f: parse_RecalcId,\n      r: 2\n    },\n    0x01c2: {\n      n: \"EntExU2\",\n      f: parse_EntExU2\n    },\n    0x0200: {\n      n: \"Dimensions\",\n      f: parse_Dimensions\n    },\n    0x0201: {\n      n: \"Blank\",\n      f: parse_Blank\n    },\n    0x0203: {\n      n: \"Number\",\n      f: parse_Number\n    },\n    0x0204: {\n      n: \"Label\",\n      f: parse_Label\n    },\n    0x0205: {\n      n: \"BoolErr\",\n      f: parse_BoolErr\n    },\n    0x0207: {\n      n: \"String\",\n      f: parse_String\n    },\n    0x0208: {\n      n: 'Row',\n      f: parse_Row\n    },\n    0x020b: {\n      n: \"Index\",\n      f: parse_Index\n    },\n    0x0221: {\n      n: \"Array\",\n      f: parse_Array\n    },\n    0x0225: {\n      n: \"DefaultRowHeight\",\n      f: parse_DefaultRowHeight\n    },\n    0x0236: {\n      n: \"Table\",\n      f: parse_Table\n    },\n    0x023e: {\n      n: \"Window2\",\n      f: parse_Window2\n    },\n    0x027e: {\n      n: \"RK\",\n      f: parse_RK\n    },\n    0x0293: {\n      n: \"Style\",\n      f: parse_Style\n    },\n    0x0418: {\n      n: \"BigName\",\n      f: parse_BigName\n    },\n    0x041e: {\n      n: \"Format\",\n      f: parse_Format\n    },\n    0x043c: {\n      n: \"ContinueBigName\",\n      f: parse_ContinueBigName\n    },\n    0x04bc: {\n      n: \"ShrFmla\",\n      f: parse_ShrFmla\n    },\n    0x0800: {\n      n: \"HLinkTooltip\",\n      f: parse_HLinkTooltip\n    },\n    0x0801: {\n      n: \"WebPub\",\n      f: parse_WebPub\n    },\n    0x0802: {\n      n: \"QsiSXTag\",\n      f: parse_QsiSXTag\n    },\n    0x0803: {\n      n: \"DBQueryExt\",\n      f: parse_DBQueryExt\n    },\n    0x0804: {\n      n: \"ExtString\",\n      f: parse_ExtString\n    },\n    0x0805: {\n      n: \"TxtQry\",\n      f: parse_TxtQry\n    },\n    0x0806: {\n      n: \"Qsir\",\n      f: parse_Qsir\n    },\n    0x0807: {\n      n: \"Qsif\",\n      f: parse_Qsif\n    },\n    0x0808: {\n      n: \"RRDTQSIF\",\n      f: parse_RRDTQSIF\n    },\n    0x0809: {\n      n: 'BOF',\n      f: parse_BOF\n    },\n    0x080a: {\n      n: \"OleDbConn\",\n      f: parse_OleDbConn\n    },\n    0x080b: {\n      n: \"WOpt\",\n      f: parse_WOpt\n    },\n    0x080c: {\n      n: \"SXViewEx\",\n      f: parse_SXViewEx\n    },\n    0x080d: {\n      n: \"SXTH\",\n      f: parse_SXTH\n    },\n    0x080e: {\n      n: \"SXPIEx\",\n      f: parse_SXPIEx\n    },\n    0x080f: {\n      n: \"SXVDTEx\",\n      f: parse_SXVDTEx\n    },\n    0x0810: {\n      n: \"SXViewEx9\",\n      f: parse_SXViewEx9\n    },\n    0x0812: {\n      n: \"ContinueFrt\",\n      f: parse_ContinueFrt\n    },\n    0x0813: {\n      n: \"RealTimeData\",\n      f: parse_RealTimeData\n    },\n    0x0850: {\n      n: \"ChartFrtInfo\",\n      f: parse_ChartFrtInfo\n    },\n    0x0851: {\n      n: \"FrtWrapper\",\n      f: parse_FrtWrapper\n    },\n    0x0852: {\n      n: \"StartBlock\",\n      f: parse_StartBlock\n    },\n    0x0853: {\n      n: \"EndBlock\",\n      f: parse_EndBlock\n    },\n    0x0854: {\n      n: \"StartObject\",\n      f: parse_StartObject\n    },\n    0x0855: {\n      n: \"EndObject\",\n      f: parse_EndObject\n    },\n    0x0856: {\n      n: \"CatLab\",\n      f: parse_CatLab\n    },\n    0x0857: {\n      n: \"YMult\",\n      f: parse_YMult\n    },\n    0x0858: {\n      n: \"SXViewLink\",\n      f: parse_SXViewLink\n    },\n    0x0859: {\n      n: \"PivotChartBits\",\n      f: parse_PivotChartBits\n    },\n    0x085a: {\n      n: \"FrtFontList\",\n      f: parse_FrtFontList\n    },\n    0x0862: {\n      n: \"SheetExt\",\n      f: parse_SheetExt\n    },\n    0x0863: {\n      n: \"BookExt\",\n      f: parse_BookExt,\n      r: 12\n    },\n    0x0864: {\n      n: \"SXAddl\",\n      f: parse_SXAddl\n    },\n    0x0865: {\n      n: \"CrErr\",\n      f: parse_CrErr\n    },\n    0x0866: {\n      n: \"HFPicture\",\n      f: parse_HFPicture\n    },\n    0x0867: {\n      n: 'FeatHdr',\n      f: parse_FeatHdr\n    },\n    0x0868: {\n      n: \"Feat\",\n      f: parse_Feat\n    },\n    0x086a: {\n      n: \"DataLabExt\",\n      f: parse_DataLabExt\n    },\n    0x086b: {\n      n: \"DataLabExtContents\",\n      f: parse_DataLabExtContents\n    },\n    0x086c: {\n      n: \"CellWatch\",\n      f: parse_CellWatch\n    },\n    0x0871: {\n      n: \"FeatHdr11\",\n      f: parse_FeatHdr11\n    },\n    0x0872: {\n      n: \"Feature11\",\n      f: parse_Feature11\n    },\n    0x0874: {\n      n: \"DropDownObjIds\",\n      f: parse_DropDownObjIds\n    },\n    0x0875: {\n      n: \"ContinueFrt11\",\n      f: parse_ContinueFrt11\n    },\n    0x0876: {\n      n: \"DConn\",\n      f: parse_DConn\n    },\n    0x0877: {\n      n: \"List12\",\n      f: parse_List12\n    },\n    0x0878: {\n      n: \"Feature12\",\n      f: parse_Feature12\n    },\n    0x0879: {\n      n: \"CondFmt12\",\n      f: parse_CondFmt12\n    },\n    0x087a: {\n      n: \"CF12\",\n      f: parse_CF12\n    },\n    0x087b: {\n      n: \"CFEx\",\n      f: parse_CFEx\n    },\n    0x087c: {\n      n: \"XFCRC\",\n      f: parse_XFCRC,\n      r: 12\n    },\n    0x087d: {\n      n: \"XFExt\",\n      f: parse_XFExt,\n      r: 12\n    },\n    0x087e: {\n      n: \"AutoFilter12\",\n      f: parse_AutoFilter12\n    },\n    0x087f: {\n      n: \"ContinueFrt12\",\n      f: parse_ContinueFrt12\n    },\n    0x0884: {\n      n: \"MDTInfo\",\n      f: parse_MDTInfo\n    },\n    0x0885: {\n      n: \"MDXStr\",\n      f: parse_MDXStr\n    },\n    0x0886: {\n      n: \"MDXTuple\",\n      f: parse_MDXTuple\n    },\n    0x0887: {\n      n: \"MDXSet\",\n      f: parse_MDXSet\n    },\n    0x0888: {\n      n: \"MDXProp\",\n      f: parse_MDXProp\n    },\n    0x0889: {\n      n: \"MDXKPI\",\n      f: parse_MDXKPI\n    },\n    0x088a: {\n      n: \"MDB\",\n      f: parse_MDB\n    },\n    0x088b: {\n      n: \"PLV\",\n      f: parse_PLV\n    },\n    0x088c: {\n      n: \"Compat12\",\n      f: parse_Compat12,\n      r: 12\n    },\n    0x088d: {\n      n: \"DXF\",\n      f: parse_DXF\n    },\n    0x088e: {\n      n: \"TableStyles\",\n      f: parse_TableStyles,\n      r: 12\n    },\n    0x088f: {\n      n: \"TableStyle\",\n      f: parse_TableStyle\n    },\n    0x0890: {\n      n: \"TableStyleElement\",\n      f: parse_TableStyleElement\n    },\n    0x0892: {\n      n: \"StyleExt\",\n      f: parse_StyleExt\n    },\n    0x0893: {\n      n: \"NamePublish\",\n      f: parse_NamePublish\n    },\n    0x0894: {\n      n: \"NameCmt\",\n      f: parse_NameCmt\n    },\n    0x0895: {\n      n: \"SortData\",\n      f: parse_SortData\n    },\n    0x0896: {\n      n: \"Theme\",\n      f: parse_Theme,\n      r: 12\n    },\n    0x0897: {\n      n: \"GUIDTypeLib\",\n      f: parse_GUIDTypeLib\n    },\n    0x0898: {\n      n: \"FnGrp12\",\n      f: parse_FnGrp12\n    },\n    0x0899: {\n      n: \"NameFnGrp12\",\n      f: parse_NameFnGrp12\n    },\n    0x089a: {\n      n: \"MTRSettings\",\n      f: parse_MTRSettings,\n      r: 12\n    },\n    0x089b: {\n      n: \"CompressPictures\",\n      f: parse_CompressPictures\n    },\n    0x089c: {\n      n: \"HeaderFooter\",\n      f: parse_HeaderFooter\n    },\n    0x089d: {\n      n: \"CrtLayout12\",\n      f: parse_CrtLayout12\n    },\n    0x089e: {\n      n: \"CrtMlFrt\",\n      f: parse_CrtMlFrt\n    },\n    0x089f: {\n      n: \"CrtMlFrtContinue\",\n      f: parse_CrtMlFrtContinue\n    },\n    0x08a3: {\n      n: \"ForceFullCalculation\",\n      f: parse_ForceFullCalculation\n    },\n    0x08a4: {\n      n: \"ShapePropsStream\",\n      f: parse_ShapePropsStream\n    },\n    0x08a5: {\n      n: \"TextPropsStream\",\n      f: parse_TextPropsStream\n    },\n    0x08a6: {\n      n: \"RichTextStream\",\n      f: parse_RichTextStream\n    },\n    0x08a7: {\n      n: \"CrtLayout12A\",\n      f: parse_CrtLayout12A\n    },\n    0x1001: {\n      n: \"Units\",\n      f: parse_Units\n    },\n    0x1002: {\n      n: \"Chart\",\n      f: parse_Chart\n    },\n    0x1003: {\n      n: \"Series\",\n      f: parse_Series\n    },\n    0x1006: {\n      n: \"DataFormat\",\n      f: parse_DataFormat\n    },\n    0x1007: {\n      n: \"LineFormat\",\n      f: parse_LineFormat\n    },\n    0x1009: {\n      n: \"MarkerFormat\",\n      f: parse_MarkerFormat\n    },\n    0x100a: {\n      n: \"AreaFormat\",\n      f: parse_AreaFormat\n    },\n    0x100b: {\n      n: \"PieFormat\",\n      f: parse_PieFormat\n    },\n    0x100c: {\n      n: \"AttachedLabel\",\n      f: parse_AttachedLabel\n    },\n    0x100d: {\n      n: \"SeriesText\",\n      f: parse_SeriesText\n    },\n    0x1014: {\n      n: \"ChartFormat\",\n      f: parse_ChartFormat\n    },\n    0x1015: {\n      n: \"Legend\",\n      f: parse_Legend\n    },\n    0x1016: {\n      n: \"SeriesList\",\n      f: parse_SeriesList\n    },\n    0x1017: {\n      n: \"Bar\",\n      f: parse_Bar\n    },\n    0x1018: {\n      n: \"Line\",\n      f: parse_Line\n    },\n    0x1019: {\n      n: \"Pie\",\n      f: parse_Pie\n    },\n    0x101a: {\n      n: \"Area\",\n      f: parse_Area\n    },\n    0x101b: {\n      n: \"Scatter\",\n      f: parse_Scatter\n    },\n    0x101c: {\n      n: \"CrtLine\",\n      f: parse_CrtLine\n    },\n    0x101d: {\n      n: \"Axis\",\n      f: parse_Axis\n    },\n    0x101e: {\n      n: \"Tick\",\n      f: parse_Tick\n    },\n    0x101f: {\n      n: \"ValueRange\",\n      f: parse_ValueRange\n    },\n    0x1020: {\n      n: \"CatSerRange\",\n      f: parse_CatSerRange\n    },\n    0x1021: {\n      n: \"AxisLine\",\n      f: parse_AxisLine\n    },\n    0x1022: {\n      n: \"CrtLink\",\n      f: parse_CrtLink\n    },\n    0x1024: {\n      n: \"DefaultText\",\n      f: parse_DefaultText\n    },\n    0x1025: {\n      n: \"Text\",\n      f: parse_Text\n    },\n    0x1026: {\n      n: \"FontX\",\n      f: parse_FontX\n    },\n    0x1027: {\n      n: \"ObjectLink\",\n      f: parse_ObjectLink\n    },\n    0x1032: {\n      n: \"Frame\",\n      f: parse_Frame\n    },\n    0x1033: {\n      n: \"Begin\",\n      f: parse_Begin\n    },\n    0x1034: {\n      n: \"End\",\n      f: parse_End\n    },\n    0x1035: {\n      n: \"PlotArea\",\n      f: parse_PlotArea\n    },\n    0x103a: {\n      n: \"Chart3d\",\n      f: parse_Chart3d\n    },\n    0x103c: {\n      n: \"PicF\",\n      f: parse_PicF\n    },\n    0x103d: {\n      n: \"DropBar\",\n      f: parse_DropBar\n    },\n    0x103e: {\n      n: \"Radar\",\n      f: parse_Radar\n    },\n    0x103f: {\n      n: \"Surf\",\n      f: parse_Surf\n    },\n    0x1040: {\n      n: \"RadarArea\",\n      f: parse_RadarArea\n    },\n    0x1041: {\n      n: \"AxisParent\",\n      f: parse_AxisParent\n    },\n    0x1043: {\n      n: \"LegendException\",\n      f: parse_LegendException\n    },\n    0x1044: {\n      n: \"ShtProps\",\n      f: parse_ShtProps\n    },\n    0x1045: {\n      n: \"SerToCrt\",\n      f: parse_SerToCrt\n    },\n    0x1046: {\n      n: \"AxesUsed\",\n      f: parse_AxesUsed\n    },\n    0x1048: {\n      n: \"SBaseRef\",\n      f: parse_SBaseRef\n    },\n    0x104a: {\n      n: \"SerParent\",\n      f: parse_SerParent\n    },\n    0x104b: {\n      n: \"SerAuxTrend\",\n      f: parse_SerAuxTrend\n    },\n    0x104e: {\n      n: \"IFmtRecord\",\n      f: parse_IFmtRecord\n    },\n    0x104f: {\n      n: \"Pos\",\n      f: parse_Pos\n    },\n    0x1050: {\n      n: \"AlRuns\",\n      f: parse_AlRuns\n    },\n    0x1051: {\n      n: \"BRAI\",\n      f: parse_BRAI\n    },\n    0x105b: {\n      n: \"SerAuxErrBar\",\n      f: parse_SerAuxErrBar\n    },\n    0x105c: {\n      n: \"ClrtClient\",\n      f: parse_ClrtClient\n    },\n    0x105d: {\n      n: \"SerFmt\",\n      f: parse_SerFmt\n    },\n    0x105f: {\n      n: \"Chart3DBarShape\",\n      f: parse_Chart3DBarShape\n    },\n    0x1060: {\n      n: \"Fbi\",\n      f: parse_Fbi\n    },\n    0x1061: {\n      n: \"BopPop\",\n      f: parse_BopPop\n    },\n    0x1062: {\n      n: \"AxcExt\",\n      f: parse_AxcExt\n    },\n    0x1063: {\n      n: \"Dat\",\n      f: parse_Dat\n    },\n    0x1064: {\n      n: \"PlotGrowth\",\n      f: parse_PlotGrowth\n    },\n    0x1065: {\n      n: \"SIIndex\",\n      f: parse_SIIndex\n    },\n    0x1066: {\n      n: \"GelFrame\",\n      f: parse_GelFrame\n    },\n    0x1067: {\n      n: \"BopPopCustom\",\n      f: parse_BopPopCustom\n    },\n    0x1068: {\n      n: \"Fbi2\",\n      f: parse_Fbi2\n    },\n\n    /* These are specified in an older version of the spec */\n    0x0016: {\n      n: \"ExternCount\",\n      f: parsenoop\n    },\n    0x007e: {\n      n: \"RK\",\n      f: parsenoop\n    },\n\n    /* Not necessarily same as 0x027e */\n    0x007f: {\n      n: \"ImData\",\n      f: parsenoop\n    },\n    0x0087: {\n      n: \"Addin\",\n      f: parsenoop\n    },\n    0x0088: {\n      n: \"Edg\",\n      f: parsenoop\n    },\n    0x0089: {\n      n: \"Pub\",\n      f: parsenoop\n    },\n    0x0091: {\n      n: \"Sub\",\n      f: parsenoop\n    },\n    0x0094: {\n      n: \"LHRecord\",\n      f: parsenoop\n    },\n    0x0095: {\n      n: \"LHNGraph\",\n      f: parsenoop\n    },\n    0x0096: {\n      n: \"Sound\",\n      f: parsenoop\n    },\n    0x00a9: {\n      n: \"CoordList\",\n      f: parsenoop\n    },\n    0x00ab: {\n      n: \"GCW\",\n      f: parsenoop\n    },\n    0x00bc: {\n      n: \"ShrFmla\",\n      f: parsenoop\n    },\n\n    /* Not necessarily same as 0x04bc */\n    0x00c2: {\n      n: \"AddMenu\",\n      f: parsenoop\n    },\n    0x00c3: {\n      n: \"DelMenu\",\n      f: parsenoop\n    },\n    0x00d6: {\n      n: \"RString\",\n      f: parsenoop\n    },\n    0x00df: {\n      n: \"UDDesc\",\n      f: parsenoop\n    },\n    0x00ea: {\n      n: \"TabIdConf\",\n      f: parsenoop\n    },\n    0x0162: {\n      n: \"XL5Modify\",\n      f: parsenoop\n    },\n    0x01a5: {\n      n: \"FileSharing2\",\n      f: parsenoop\n    },\n    0x0218: {\n      n: \"Name\",\n      f: parsenoop\n    },\n    0x0223: {\n      n: \"ExternName\",\n      f: parse_ExternName\n    },\n    0x0231: {\n      n: \"Font\",\n      f: parsenoop\n    },\n    0x0406: {\n      n: \"Formula\",\n      f: parse_Formula\n    },\n    0x086d: {\n      n: \"FeatInfo\",\n      f: parsenoop\n    },\n    0x0873: {\n      n: \"FeatInfo11\",\n      f: parsenoop\n    },\n    0x0881: {\n      n: \"SXAddl12\",\n      f: parsenoop\n    },\n    0x08c0: {\n      n: \"AutoWebPub\",\n      f: parsenoop\n    },\n    0x08c1: {\n      n: \"ListObj\",\n      f: parsenoop\n    },\n    0x08c2: {\n      n: \"ListField\",\n      f: parsenoop\n    },\n    0x08c3: {\n      n: \"ListDV\",\n      f: parsenoop\n    },\n    0x08c4: {\n      n: \"ListCondFmt\",\n      f: parsenoop\n    },\n    0x08c5: {\n      n: \"ListCF\",\n      f: parsenoop\n    },\n    0x08c6: {\n      n: \"FMQry\",\n      f: parsenoop\n    },\n    0x08c7: {\n      n: \"FMSQry\",\n      f: parsenoop\n    },\n    0x08c8: {\n      n: \"PLV\",\n      f: parsenoop\n    },\n\n    /* supposedly PLV for Excel 11 */\n    0x08c9: {\n      n: \"LnExt\",\n      f: parsenoop\n    },\n    0x08ca: {\n      n: \"MkrExt\",\n      f: parsenoop\n    },\n    0x08cb: {\n      n: \"CrtCoopt\",\n      f: parsenoop\n    },\n    0x0000: {}\n  };\n  /* Helper function to call out to ODS parser */\n\n  function parse_ods(zip, opts) {\n    if (typeof module !== \"undefined\" && typeof require !== 'undefined' && typeof ODS === 'undefined') ODS = require('./od' + 's');\n    if (typeof ODS === 'undefined' || !ODS.parse_ods) throw new Error(\"Unsupported ODS\");\n    return ODS.parse_ods(zip, opts);\n  }\n\n  function fix_opts_func(defaults) {\n    return function fix_opts(opts) {\n      for (var i = 0; i != defaults.length; ++i) {\n        var d = defaults[i];\n        if (opts[d[0]] === undefined) opts[d[0]] = d[1];\n        if (d[2] === 'n') opts[d[0]] = Number(opts[d[0]]);\n      }\n    };\n  }\n\n  var fix_read_opts = fix_opts_func([['cellNF', false],\n  /* emit cell number format string as .z */\n  ['cellHTML', true],\n  /* emit html string as .h */\n  ['cellFormula', true],\n  /* emit formulae as .f */\n  ['cellStyles', false],\n  /* emits style/theme as .s */\n  ['cellDates', false],\n  /* emit date cells with type `d` */\n  ['sheetStubs', false],\n  /* emit empty cells */\n  ['sheetRows', 0, 'n'],\n  /* read n rows (0 = read all rows) */\n  ['bookDeps', false],\n  /* parse calculation chains */\n  ['bookSheets', false],\n  /* only try to get sheet names (no Sheets) */\n  ['bookProps', false],\n  /* only try to get properties (no Sheets) */\n  ['bookFiles', false],\n  /* include raw file structure (keys, files, cfb) */\n  ['bookVBA', false],\n  /* include vba raw data (vbaraw) */\n  ['password', ''],\n  /* password */\n  ['WTF', false]\n  /* WTF mode (throws errors) */\n  ]);\n  var fix_write_opts = fix_opts_func([['cellDates', false],\n  /* write date cells with type `d` */\n  ['bookSST', false],\n  /* Generate Shared String Table */\n  ['bookType', 'xlsx'],\n  /* Type of workbook (xlsx/m/b) */\n  ['WTF', false]\n  /* WTF mode (throws errors) */\n  ]);\n\n  function safe_parse_wbrels(wbrels, sheets) {\n    if (!wbrels) return 0;\n\n    try {\n      wbrels = sheets.map(function pwbr(w) {\n        return [w.name, wbrels['!id'][w.id].Target];\n      });\n    } catch (e) {\n      return null;\n    }\n\n    return !wbrels || wbrels.length === 0 ? null : wbrels;\n  }\n\n  function safe_parse_ws(zip, path, relsPath, sheet, sheetRels, sheets, opts) {\n    try {\n      sheetRels[sheet] = parse_rels(getzipdata(zip, relsPath, true), path);\n      sheets[sheet] = parse_ws(getzipdata(zip, path), path, opts, sheetRels[sheet]);\n    } catch (e) {\n      if (opts.WTF) throw e;\n    }\n  }\n\n  var nodirs = function nodirs(x) {\n    return x.substr(-1) != '/';\n  };\n\n  function parse_zip(zip, opts) {\n    make_ssf(SSF);\n    opts = opts || {};\n    fix_read_opts(opts);\n    reset_cp();\n    /* OpenDocument Part 3 Section 2.2.1 OpenDocument Package */\n\n    if (safegetzipfile(zip, 'META-INF/manifest.xml')) return parse_ods(zip, opts);\n    var entries = keys(zip.files).filter(nodirs).sort();\n    var dir = parse_ct(getzipdata(zip, '[Content_Types].xml'), opts);\n    var xlsb = false;\n    var sheets, binname;\n\n    if (dir.workbooks.length === 0) {\n      binname = \"xl/workbook.xml\";\n      if (getzipdata(zip, binname, true)) dir.workbooks.push(binname);\n    }\n\n    if (dir.workbooks.length === 0) {\n      binname = \"xl/workbook.bin\";\n      if (!getzipfile(zip, binname, true)) throw new Error(\"Could not find workbook\");\n      dir.workbooks.push(binname);\n      xlsb = true;\n    }\n\n    if (dir.workbooks[0].substr(-3) == \"bin\") xlsb = true;\n    if (xlsb) set_cp(1200);\n\n    if (!opts.bookSheets && !opts.bookProps) {\n      strs = [];\n      if (dir.sst) strs = parse_sst(getzipdata(zip, dir.sst.replace(/^\\//, '')), dir.sst, opts); // parse themes before styles so that we can reliably decode theme/tint into rgb when parsing styles\n\n      themes = {};\n      if (opts.cellStyles && dir.themes.length) themes = parse_theme(getzipdata(zip, dir.themes[0].replace(/^\\//, ''), true), dir.themes[0], opts);\n      styles = {};\n      if (dir.style) styles = parse_sty(getzipdata(zip, dir.style.replace(/^\\//, '')), dir.style, opts);\n    }\n\n    var wb = parse_wb(getzipdata(zip, dir.workbooks[0].replace(/^\\//, '')), dir.workbooks[0], opts);\n    var props = {},\n        propdata = \"\";\n\n    if (dir.coreprops.length !== 0) {\n      propdata = getzipdata(zip, dir.coreprops[0].replace(/^\\//, ''), true);\n      if (propdata) props = parse_core_props(propdata);\n\n      if (dir.extprops.length !== 0) {\n        propdata = getzipdata(zip, dir.extprops[0].replace(/^\\//, ''), true);\n        if (propdata) parse_ext_props(propdata, props);\n      }\n    }\n\n    var custprops = {};\n\n    if (!opts.bookSheets || opts.bookProps) {\n      if (dir.custprops.length !== 0) {\n        propdata = getzipdata(zip, dir.custprops[0].replace(/^\\//, ''), true);\n        if (propdata) custprops = parse_cust_props(propdata, opts);\n      }\n    }\n\n    var out = {};\n\n    if (opts.bookSheets || opts.bookProps) {\n      if (props.Worksheets && props.SheetNames.length > 0) sheets = props.SheetNames;else if (wb.Sheets) sheets = wb.Sheets.map(function pluck(x) {\n        return x.name;\n      });\n\n      if (opts.bookProps) {\n        out.Props = props;\n        out.Custprops = custprops;\n      }\n\n      if (typeof sheets !== 'undefined') out.SheetNames = sheets;\n      if (opts.bookSheets ? out.SheetNames : opts.bookProps) return out;\n    }\n\n    sheets = {};\n    var deps = {};\n    if (opts.bookDeps && dir.calcchain) deps = parse_cc(getzipdata(zip, dir.calcchain.replace(/^\\//, '')), dir.calcchain, opts);\n    var i = 0;\n    var sheetRels = {};\n    var path, relsPath;\n\n    if (!props.Worksheets) {\n      var wbsheets = wb.Sheets;\n      props.Worksheets = wbsheets.length;\n      props.SheetNames = [];\n\n      for (var j = 0; j != wbsheets.length; ++j) {\n        props.SheetNames[j] = wbsheets[j].name;\n      }\n    }\n\n    var wbext = xlsb ? \"bin\" : \"xml\";\n    var wbrelsfile = 'xl/_rels/workbook.' + wbext + '.rels';\n    var wbrels = parse_rels(getzipdata(zip, wbrelsfile, true), wbrelsfile);\n    if (wbrels) wbrels = safe_parse_wbrels(wbrels, wb.Sheets);\n    /* Numbers iOS hack */\n\n    var nmode = getzipdata(zip, \"xl/worksheets/sheet.xml\", true) ? 1 : 0;\n\n    for (i = 0; i != props.Worksheets; ++i) {\n      if (wbrels) path = 'xl/' + wbrels[i][1].replace(/[\\/]?xl\\//, \"\");else {\n        path = 'xl/worksheets/sheet' + (i + 1 - nmode) + \".\" + wbext;\n        path = path.replace(/sheet0\\./, \"sheet.\");\n      }\n      relsPath = path.replace(/^(.*)(\\/)([^\\/]*)$/, \"$1/_rels/$3.rels\");\n      safe_parse_ws(zip, path, relsPath, props.SheetNames[i], sheetRels, sheets, opts);\n    }\n\n    if (dir.comments) parse_comments(zip, dir.comments, sheets, sheetRels, opts);\n    out = {\n      Directory: dir,\n      Workbook: wb,\n      Props: props,\n      Custprops: custprops,\n      Deps: deps,\n      Sheets: sheets,\n      SheetNames: props.SheetNames,\n      Strings: strs,\n      Styles: styles,\n      Themes: themes,\n      SSF: SSF.get_table()\n    };\n\n    if (opts.bookFiles) {\n      out.keys = entries;\n      out.files = zip.files;\n    }\n\n    if (opts.bookVBA) {\n      if (dir.vba.length > 0) out.vbaraw = getzipdata(zip, dir.vba[0], true);else if (dir.defaults.bin === 'application/vnd.ms-office.vbaProject') out.vbaraw = getzipdata(zip, 'xl/vbaProject.bin', true);\n    }\n\n    return out;\n  }\n\n  function add_rels(rels, rId, f, type, relobj) {\n    if (!relobj) relobj = {};\n    if (!rels['!id']) rels['!id'] = {};\n    relobj.Id = 'rId' + rId;\n    relobj.Type = type;\n    relobj.Target = f;\n    if (rels['!id'][relobj.Id]) throw new Error(\"Cannot rewrite rId \" + rId);\n    rels['!id'][relobj.Id] = relobj;\n    rels[('/' + relobj.Target).replace(\"//\", \"/\")] = relobj;\n  }\n\n  function write_zip(wb, opts) {\n    if (wb && !wb.SSF) {\n      wb.SSF = SSF.get_table();\n    }\n\n    if (wb && wb.SSF) {\n      make_ssf(SSF);\n      SSF.load_table(wb.SSF);\n      opts.revssf = evert_num(wb.SSF);\n      opts.revssf[wb.SSF[65535]] = 0;\n    }\n\n    opts.rels = {};\n    opts.wbrels = {};\n    opts.Strings = [];\n    opts.Strings.Count = 0;\n    opts.Strings.Unique = 0;\n    var wbext = opts.bookType == \"xlsb\" ? \"bin\" : \"xml\";\n    var ct = {\n      workbooks: [],\n      sheets: [],\n      calcchains: [],\n      themes: [],\n      styles: [],\n      coreprops: [],\n      extprops: [],\n      custprops: [],\n      strs: [],\n      comments: [],\n      vba: [],\n      TODO: [],\n      rels: [],\n      xmlns: \"\"\n    };\n    fix_write_opts(opts = opts || {});\n    var zip = new jszip();\n    var f = \"\",\n        rId = 0;\n    opts.cellXfs = [];\n    get_cell_style(opts.cellXfs, {}, {\n      revssf: {\n        \"General\": 0\n      }\n    });\n    f = \"docProps/core.xml\";\n    zip.file(f, write_core_props(wb.Props, opts));\n    ct.coreprops.push(f);\n    add_rels(opts.rels, 2, f, RELS.CORE_PROPS);\n    f = \"docProps/app.xml\";\n    if (!wb.Props) wb.Props = {};\n    wb.Props.SheetNames = wb.SheetNames;\n    wb.Props.Worksheets = wb.SheetNames.length;\n    zip.file(f, write_ext_props(wb.Props, opts));\n    ct.extprops.push(f);\n    add_rels(opts.rels, 3, f, RELS.EXT_PROPS);\n\n    if (wb.Custprops !== wb.Props && keys(wb.Custprops || {}).length > 0) {\n      f = \"docProps/custom.xml\";\n      zip.file(f, write_cust_props(wb.Custprops, opts));\n      ct.custprops.push(f);\n      add_rels(opts.rels, 4, f, RELS.CUST_PROPS);\n    }\n\n    f = \"xl/workbook.\" + wbext;\n    zip.file(f, write_wb(wb, f, opts));\n    ct.workbooks.push(f);\n    add_rels(opts.rels, 1, f, RELS.WB);\n\n    for (rId = 1; rId <= wb.SheetNames.length; ++rId) {\n      f = \"xl/worksheets/sheet\" + rId + \".\" + wbext;\n      zip.file(f, write_ws(rId - 1, f, opts, wb));\n      ct.sheets.push(f);\n      add_rels(opts.wbrels, rId, \"worksheets/sheet\" + rId + \".\" + wbext, RELS.WS);\n    }\n\n    if (opts.Strings != null && opts.Strings.length > 0) {\n      f = \"xl/sharedStrings.\" + wbext;\n      zip.file(f, write_sst(opts.Strings, f, opts));\n      ct.strs.push(f);\n      add_rels(opts.wbrels, ++rId, \"sharedStrings.\" + wbext, RELS.SST);\n    }\n    /* TODO: something more intelligent with themes */\n\n\n    f = \"xl/theme/theme1.xml\";\n    zip.file(f, write_theme(opts));\n    ct.themes.push(f);\n    add_rels(opts.wbrels, ++rId, \"theme/theme1.xml\", RELS.THEME);\n    /* TODO: something more intelligent with styles */\n\n    f = \"xl/styles.\" + wbext;\n    zip.file(f, write_sty(wb, f, opts));\n    ct.styles.push(f);\n    add_rels(opts.wbrels, ++rId, \"styles.\" + wbext, RELS.STY);\n    zip.file(\"[Content_Types].xml\", write_ct(ct, opts));\n    zip.file('_rels/.rels', write_rels(opts.rels));\n    zip.file('xl/_rels/workbook.' + wbext + '.rels', write_rels(opts.wbrels));\n    return zip;\n  }\n\n  function firstbyte(f, o) {\n    switch ((o || {}).type || \"base64\") {\n      case 'buffer':\n        return f[0];\n\n      case 'base64':\n        return Base64.decode(f.substr(0, 12)).charCodeAt(0);\n\n      case 'binary':\n        return f.charCodeAt(0);\n\n      case 'array':\n        return f[0];\n\n      default:\n        throw new Error(\"Unrecognized type \" + o.type);\n    }\n  }\n\n  function read_zip(data, opts) {\n    var zip,\n        d = data;\n    var o = opts || {};\n    if (!o.type) o.type = has_buf && Buffer.isBuffer(data) ? \"buffer\" : \"base64\";\n\n    switch (o.type) {\n      case \"base64\":\n        zip = new jszip(d, {\n          base64: true\n        });\n        break;\n\n      case \"binary\":\n      case \"array\":\n        zip = new jszip(d, {\n          base64: false\n        });\n        break;\n\n      case \"buffer\":\n        zip = new jszip(d);\n        break;\n\n      case \"file\":\n        zip = new jszip(d = _fs.readFileSync(data));\n        break;\n\n      default:\n        throw new Error(\"Unrecognized type \" + o.type);\n    }\n\n    return parse_zip(zip, o);\n  }\n\n  function readSync(data, opts) {\n    var zip,\n        d = data,\n        isfile = false,\n        n;\n    var o = opts || {};\n    if (!o.type) o.type = has_buf && Buffer.isBuffer(data) ? \"buffer\" : \"base64\";\n\n    if (o.type == \"file\") {\n      isfile = true;\n      o.type = \"buffer\";\n      d = _fs.readFileSync(data);\n    }\n\n    switch (n = firstbyte(d, o)) {\n      case 0xD0:\n        if (isfile) o.type = \"file\";\n        return parse_xlscfb(CFB.read(data, o), o);\n\n      case 0x09:\n        return parse_xlscfb(s2a(o.type === 'base64' ? Base64.decode(data) : data), o);\n\n      case 0x3C:\n        return parse_xlml(d, o);\n\n      case 0x50:\n        if (isfile) o.type = \"file\";\n        return read_zip(data, opts);\n\n      default:\n        throw new Error(\"Unsupported file \" + n);\n    }\n  }\n\n  function readFileSync(data, opts) {\n    var o = opts || {};\n    o.type = 'file';\n    var wb = readSync(data, o);\n    wb.FILENAME = data;\n    return wb;\n  }\n\n  function write_zip_type(wb, opts) {\n    var o = opts || {};\n    style_builder = new StyleBuilder(opts);\n    var z = write_zip(wb, o);\n\n    switch (o.type) {\n      case \"base64\":\n        return z.generate({\n          type: \"base64\"\n        });\n\n      case \"binary\":\n        return z.generate({\n          type: \"string\"\n        });\n\n      case \"buffer\":\n        return z.generate({\n          type: \"nodebuffer\"\n        });\n\n      case \"file\":\n        return _fs.writeFileSync(o.file, z.generate({\n          type: \"nodebuffer\"\n        }));\n\n      default:\n        throw new Error(\"Unrecognized type \" + o.type);\n    }\n  }\n\n  function writeSync(wb, opts) {\n    var o = opts || {};\n\n    switch (o.bookType) {\n      case 'xml':\n        return write_xlml(wb, o);\n\n      default:\n        return write_zip_type(wb, o);\n    }\n  }\n\n  function writeFileSync(wb, filename, opts) {\n    var o = opts || {};\n    o.type = 'file';\n    o.file = filename;\n\n    switch (o.file.substr(-5).toLowerCase()) {\n      case '.xlsx':\n        o.bookType = 'xlsx';\n        break;\n\n      case '.xlsm':\n        o.bookType = 'xlsm';\n        break;\n\n      case '.xlsb':\n        o.bookType = 'xlsb';\n        break;\n\n      default:\n        switch (o.file.substr(-4).toLowerCase()) {\n          case '.xls':\n            o.bookType = 'xls';\n            break;\n\n          case '.xml':\n            o.bookType = 'xml';\n            break;\n        }\n\n    }\n\n    return writeSync(wb, o);\n  }\n\n  function decode_row(rowstr) {\n    return parseInt(unfix_row(rowstr), 10) - 1;\n  }\n\n  function encode_row(row) {\n    return \"\" + (row + 1);\n  }\n\n  function fix_row(cstr) {\n    return cstr.replace(/([A-Z]|^)(\\d+)$/, \"$1$$$2\");\n  }\n\n  function unfix_row(cstr) {\n    return cstr.replace(/\\$(\\d+)$/, \"$1\");\n  }\n\n  function decode_col(colstr) {\n    var c = unfix_col(colstr),\n        d = 0,\n        i = 0;\n\n    for (; i !== c.length; ++i) {\n      d = 26 * d + c.charCodeAt(i) - 64;\n    }\n\n    return d - 1;\n  }\n\n  function encode_col(col) {\n    var s = \"\";\n\n    for (++col; col; col = Math.floor((col - 1) / 26)) {\n      s = String.fromCharCode((col - 1) % 26 + 65) + s;\n    }\n\n    return s;\n  }\n\n  function fix_col(cstr) {\n    return cstr.replace(/^([A-Z])/, \"$$$1\");\n  }\n\n  function unfix_col(cstr) {\n    return cstr.replace(/^\\$([A-Z])/, \"$1\");\n  }\n\n  function split_cell(cstr) {\n    return cstr.replace(/(\\$?[A-Z]*)(\\$?\\d*)/, \"$1,$2\").split(\",\");\n  }\n\n  function decode_cell(cstr) {\n    var splt = split_cell(cstr);\n    return {\n      c: decode_col(splt[0]),\n      r: decode_row(splt[1])\n    };\n  }\n\n  function encode_cell(cell) {\n    return encode_col(cell.c) + encode_row(cell.r);\n  }\n\n  function fix_cell(cstr) {\n    return fix_col(fix_row(cstr));\n  }\n\n  function unfix_cell(cstr) {\n    return unfix_col(unfix_row(cstr));\n  }\n\n  function decode_range(range) {\n    var x = range.split(\":\").map(decode_cell);\n    return {\n      s: x[0],\n      e: x[x.length - 1]\n    };\n  }\n\n  function encode_range(cs, ce) {\n    if (ce === undefined || typeof ce === 'number') return encode_range(cs.s, cs.e);\n    if (typeof cs !== 'string') cs = encode_cell(cs);\n    if (typeof ce !== 'string') ce = encode_cell(ce);\n    return cs == ce ? cs : cs + \":\" + ce;\n  }\n\n  function safe_decode_range(range) {\n    var o = {\n      s: {\n        c: 0,\n        r: 0\n      },\n      e: {\n        c: 0,\n        r: 0\n      }\n    };\n    var idx = 0,\n        i = 0,\n        cc = 0;\n    var len = range.length;\n\n    for (idx = 0; i < len; ++i) {\n      if ((cc = range.charCodeAt(i) - 64) < 1 || cc > 26) break;\n      idx = 26 * idx + cc;\n    }\n\n    o.s.c = --idx;\n\n    for (idx = 0; i < len; ++i) {\n      if ((cc = range.charCodeAt(i) - 48) < 0 || cc > 9) break;\n      idx = 10 * idx + cc;\n    }\n\n    o.s.r = --idx;\n\n    if (i === len || range.charCodeAt(++i) === 58) {\n      o.e.c = o.s.c;\n      o.e.r = o.s.r;\n      return o;\n    }\n\n    for (idx = 0; i != len; ++i) {\n      if ((cc = range.charCodeAt(i) - 64) < 1 || cc > 26) break;\n      idx = 26 * idx + cc;\n    }\n\n    o.e.c = --idx;\n\n    for (idx = 0; i != len; ++i) {\n      if ((cc = range.charCodeAt(i) - 48) < 0 || cc > 9) break;\n      idx = 10 * idx + cc;\n    }\n\n    o.e.r = --idx;\n    return o;\n  }\n\n  function safe_format_cell(cell, v) {\n    if (cell.z !== undefined) try {\n      return cell.w = SSF.format(cell.z, v);\n    } catch (e) {}\n    if (!cell.XF) return v;\n\n    try {\n      return cell.w = SSF.format(cell.XF.ifmt || 0, v);\n    } catch (e) {\n      return '' + v;\n    }\n  }\n\n  function format_cell(cell, v) {\n    if (cell == null || cell.t == null) return \"\";\n    if (cell.w !== undefined) return cell.w;\n    if (v === undefined) return safe_format_cell(cell, cell.v);\n    return safe_format_cell(cell, v);\n  }\n\n  function sheet_to_json(sheet, opts) {\n    var val,\n        row,\n        range,\n        header = 0,\n        offset = 1,\n        r,\n        hdr = [],\n        isempty,\n        R,\n        C,\n        v;\n    var o = opts != null ? opts : {};\n    var raw = o.raw;\n    if (sheet == null || sheet[\"!ref\"] == null) return [];\n    range = o.range !== undefined ? o.range : sheet[\"!ref\"];\n    if (o.header === 1) header = 1;else if (o.header === \"A\") header = 2;else if (Array.isArray(o.header)) header = 3;\n\n    switch (typeof range) {\n      case 'string':\n        r = safe_decode_range(range);\n        break;\n\n      case 'number':\n        r = safe_decode_range(sheet[\"!ref\"]);\n        r.s.r = range;\n        break;\n\n      default:\n        r = range;\n    }\n\n    if (header > 0) offset = 0;\n    var rr = encode_row(r.s.r);\n    var cols = new Array(r.e.c - r.s.c + 1);\n    var out = new Array(r.e.r - r.s.r - offset + 1);\n    var outi = 0;\n\n    for (C = r.s.c; C <= r.e.c; ++C) {\n      cols[C] = encode_col(C);\n      val = sheet[cols[C] + rr];\n\n      switch (header) {\n        case 1:\n          hdr[C] = C;\n          break;\n\n        case 2:\n          hdr[C] = cols[C];\n          break;\n\n        case 3:\n          hdr[C] = o.header[C - r.s.c];\n          break;\n\n        default:\n          if (val === undefined) continue;\n          hdr[C] = format_cell(val);\n      }\n    }\n\n    for (R = r.s.r + offset; R <= r.e.r; ++R) {\n      rr = encode_row(R);\n      isempty = true;\n      if (header === 1) row = [];else {\n        row = {};\n        if (Object.defineProperty) Object.defineProperty(row, '__rowNum__', {\n          value: R,\n          enumerable: false\n        });else row.__rowNum__ = R;\n      }\n\n      for (C = r.s.c; C <= r.e.c; ++C) {\n        val = sheet[cols[C] + rr];\n        if (val === undefined || val.t === undefined) continue;\n        v = val.v;\n\n        switch (val.t) {\n          case 'e':\n            continue;\n\n          case 's':\n            break;\n\n          case 'b':\n          case 'n':\n            break;\n\n          default:\n            throw 'unrecognized type ' + val.t;\n        }\n\n        if (v !== undefined) {\n          row[hdr[C]] = raw ? v : format_cell(val, v);\n          isempty = false;\n        }\n      }\n\n      if (isempty === false || header === 1) out[outi++] = row;\n    }\n\n    out.length = outi;\n    return out;\n  }\n\n  function sheet_to_row_object_array(sheet, opts) {\n    return sheet_to_json(sheet, opts != null ? opts : {});\n  }\n\n  function sheet_to_csv(sheet, opts) {\n    var out = \"\",\n        txt = \"\",\n        qreg = /\"/g;\n    var o = opts == null ? {} : opts;\n    if (sheet == null || sheet[\"!ref\"] == null) return \"\";\n    var r = safe_decode_range(sheet[\"!ref\"]);\n    var FS = o.FS !== undefined ? o.FS : \",\",\n        fs = FS.charCodeAt(0);\n    var RS = o.RS !== undefined ? o.RS : \"\\n\",\n        rs = RS.charCodeAt(0);\n    var row = \"\",\n        rr = \"\",\n        cols = [];\n    var i = 0,\n        cc = 0,\n        val;\n    var R = 0,\n        C = 0;\n\n    for (C = r.s.c; C <= r.e.c; ++C) {\n      cols[C] = encode_col(C);\n    }\n\n    for (R = r.s.r; R <= r.e.r; ++R) {\n      row = \"\";\n      rr = encode_row(R);\n\n      for (C = r.s.c; C <= r.e.c; ++C) {\n        val = sheet[cols[C] + rr];\n        txt = val !== undefined ? '' + format_cell(val) : \"\";\n\n        for (i = 0, cc = 0; i !== txt.length; ++i) {\n          if ((cc = txt.charCodeAt(i)) === fs || cc === rs || cc === 34) {\n            txt = \"\\\"\" + txt.replace(qreg, '\"\"') + \"\\\"\";\n            break;\n          }\n        }\n\n        row += (C === r.s.c ? \"\" : FS) + txt;\n      }\n\n      out += row + RS;\n    }\n\n    return out;\n  }\n\n  var make_csv = sheet_to_csv;\n\n  function sheet_to_formulae(sheet) {\n    var cmds,\n        y = \"\",\n        x,\n        val = \"\";\n    if (sheet == null || sheet[\"!ref\"] == null) return \"\";\n    var r = safe_decode_range(sheet['!ref']),\n        rr = \"\",\n        cols = [],\n        C;\n    cmds = new Array((r.e.r - r.s.r + 1) * (r.e.c - r.s.c + 1));\n    var i = 0;\n\n    for (C = r.s.c; C <= r.e.c; ++C) {\n      cols[C] = encode_col(C);\n    }\n\n    for (var R = r.s.r; R <= r.e.r; ++R) {\n      rr = encode_row(R);\n\n      for (C = r.s.c; C <= r.e.c; ++C) {\n        y = cols[C] + rr;\n        x = sheet[y];\n        val = \"\";\n        if (x === undefined) continue;\n        if (x.f != null) val = x.f;else if (x.w !== undefined) val = \"'\" + x.w;else if (x.v === undefined) continue;else val = \"\" + x.v;\n        cmds[i++] = y + \"=\" + val;\n      }\n    }\n\n    cmds.length = i;\n    return cmds;\n  }\n\n  var utils = {\n    encode_col: encode_col,\n    encode_row: encode_row,\n    encode_cell: encode_cell,\n    encode_range: encode_range,\n    decode_col: decode_col,\n    decode_row: decode_row,\n    split_cell: split_cell,\n    decode_cell: decode_cell,\n    decode_range: decode_range,\n    format_cell: format_cell,\n    get_formulae: sheet_to_formulae,\n    make_csv: sheet_to_csv,\n    make_json: sheet_to_json,\n    make_formulae: sheet_to_formulae,\n    sheet_to_csv: sheet_to_csv,\n    sheet_to_json: sheet_to_json,\n    sheet_to_formulae: sheet_to_formulae,\n    sheet_to_row_object_array: sheet_to_row_object_array\n  }; /////////////////////////////////////////////////////////////////////////////////////////////////////\n\n  var XmlNode = function () {\n    function XmlNode(tagName, attributes, children) {\n      if (!(this instanceof XmlNode)) {\n        return new XmlNode(tagName, attributes, children);\n      }\n\n      this.tagName = tagName;\n      this._attributes = attributes || {};\n      this._children = children || [];\n      this._prefix = '';\n      return this;\n    }\n\n    XmlNode.prototype.createElement = function () {\n      return new XmlNode(arguments);\n    };\n\n    XmlNode.prototype.children = function () {\n      return this._children;\n    };\n\n    XmlNode.prototype.append = function (node) {\n      this._children.push(node);\n\n      return this;\n    };\n\n    XmlNode.prototype.prefix = function (prefix) {\n      if (arguments.length == 0) {\n        return this._prefix;\n      }\n\n      this._prefix = prefix;\n      return this;\n    };\n\n    XmlNode.prototype.attr = function (attr, value) {\n      if (value == undefined) {\n        delete this._attributes[attr];\n        return this;\n      }\n\n      if (arguments.length == 0) {\n        return this._attributes;\n      } else if (typeof attr == 'string' && arguments.length == 1) {\n        return this._attributes.attr[attr];\n      }\n\n      if (typeof attr == 'object' && arguments.length == 1) {\n        for (var key in attr) {\n          this._attributes[key] = attr[key];\n        }\n      } else if (arguments.length == 2 && typeof attr == 'string') {\n        this._attributes[attr] = value;\n      }\n\n      return this;\n    };\n\n    var APOS = \"'\";\n    QUOTE = '\"';\n    var ESCAPED_QUOTE = {};\n    ESCAPED_QUOTE[QUOTE] = '&quot;';\n    ESCAPED_QUOTE[APOS] = '&apos;';\n\n    XmlNode.prototype.escapeAttributeValue = function (att_value) {\n      return '\"' + att_value.replace(/\\\"/g, '&quot;') + '\"'; // TODO Extend with four other codes\n    };\n\n    XmlNode.prototype.toXml = function (node) {\n      if (!node) node = this;\n      var xml = node._prefix;\n      xml += '<' + node.tagName;\n\n      if (node._attributes) {\n        for (var key in node._attributes) {\n          xml += ' ' + key + '=' + this.escapeAttributeValue('' + node._attributes[key]) + '';\n        }\n      }\n\n      if (node._children && node._children.length > 0) {\n        xml += \">\";\n\n        for (var i = 0; i < node._children.length; i++) {\n          xml += this.toXml(node._children[i]);\n        }\n\n        xml += '</' + node.tagName + '>';\n      } else {\n        xml += '/>';\n      }\n\n      return xml;\n    };\n\n    return XmlNode;\n  }(); /////////////////////////////////////////////////////////////////////////////////////////////////////\n\n\n  var StyleBuilder = function StyleBuilder(options) {\n    var customNumFmtId = 164;\n    var table_fmt = {\n      0: 'General',\n      1: '0',\n      2: '0.00',\n      3: '#,##0',\n      4: '#,##0.00',\n      9: '0%',\n      10: '0.00%',\n      11: '0.00E+00',\n      12: '# ?/?',\n      13: '# ??/??',\n      14: 'm/d/yy',\n      15: 'd-mmm-yy',\n      16: 'd-mmm',\n      17: 'mmm-yy',\n      18: 'h:mm AM/PM',\n      19: 'h:mm:ss AM/PM',\n      20: 'h:mm',\n      21: 'h:mm:ss',\n      22: 'm/d/yy h:mm',\n      37: '#,##0 ;(#,##0)',\n      38: '#,##0 ;[Red](#,##0)',\n      39: '#,##0.00;(#,##0.00)',\n      40: '#,##0.00;[Red](#,##0.00)',\n      45: 'mm:ss',\n      46: '[h]:mm:ss',\n      47: 'mmss.0',\n      48: '##0.0E+0',\n      49: '@',\n      56: '\"上午/下午 \"hh\"時\"mm\"分\"ss\"秒 \"'\n    };\n    var fmt_table = {};\n\n    for (var idx in table_fmt) {\n      fmt_table[table_fmt[idx]] = idx;\n    } // cache style specs to avoid excessive duplication\n\n\n    _hashIndex = {};\n    _listIndex = [];\n    return {\n      initialize: function initialize(options) {\n        this.$fonts = XmlNode('fonts').attr('count', 0).attr(\"x14ac:knownFonts\", \"1\");\n        this.$fills = XmlNode('fills').attr('count', 0);\n        this.$borders = XmlNode('borders').attr('count', 0);\n        this.$numFmts = XmlNode('numFmts').attr('count', 0);\n        this.$cellStyleXfs = XmlNode('cellStyleXfs');\n        this.$xf = XmlNode('xf').attr('numFmtId', 0).attr('fontId', 0).attr('fillId', 0).attr('borderId', 0);\n        this.$cellXfs = XmlNode('cellXfs').attr('count', 0);\n        this.$cellStyles = XmlNode('cellStyles').append(XmlNode('cellStyle').attr('name', 'Normal').attr('xfId', 0).attr('builtinId', 0));\n        this.$dxfs = XmlNode('dxfs').attr('count', \"0\");\n        this.$tableStyles = XmlNode('tableStyles').attr('count', '0').attr('defaultTableStyle', 'TableStyleMedium9').attr('defaultPivotStyle', 'PivotStyleMedium4');\n        this.$styles = XmlNode('styleSheet').attr('xmlns:mc', 'http://schemas.openxmlformats.org/markup-compatibility/2006').attr('xmlns:x14ac', 'http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac').attr('xmlns', 'http://schemas.openxmlformats.org/spreadsheetml/2006/main').attr('mc:Ignorable', 'x14ac').prefix('<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>').append(this.$numFmts).append(this.$fonts).append(this.$fills).append(this.$borders).append(this.$cellStyleXfs.append(this.$xf)).append(this.$cellXfs).append(this.$cellStyles).append(this.$dxfs).append(this.$tableStyles); // need to specify styles at index 0 and 1.\n        // the second style MUST be gray125 for some reason\n\n        var defaultStyle = options.defaultCellStyle || {};\n        if (!defaultStyle.font) defaultStyle.font = {\n          name: 'Calibri',\n          sz: '12'\n        };\n        if (!defaultStyle.font.name) defaultStyle.font.name = 'Calibri';\n        if (!defaultStyle.font.sz) defaultStyle.font.sz = 11;\n        if (!defaultStyle.fill) defaultStyle.fill = {\n          patternType: \"none\",\n          fgColor: {}\n        };\n        if (!defaultStyle.border) defaultStyle.border = {};\n        if (!defaultStyle.numFmt) defaultStyle.numFmt = 0;\n        this.defaultStyle = defaultStyle;\n        var gray125Style = JSON.parse(JSON.stringify(defaultStyle));\n        gray125Style.fill = {\n          patternType: \"gray125\",\n          fgColor: {}\n        };\n        this.addStyles([defaultStyle, gray125Style]);\n        return this;\n      },\n      // create a style entry and returns an integer index that can be used in the cell .s property\n      // these format of this object follows the emerging Common Spreadsheet Format\n      addStyle: function addStyle(attributes) {\n        var hashKey = JSON.stringify(attributes);\n        var index = _hashIndex[hashKey];\n\n        if (index == undefined) {\n          index = this._addXf(attributes); //_listIndex.push(attributes) -1;\n\n          _hashIndex[hashKey] = index;\n        } else {\n          index = _hashIndex[hashKey];\n        }\n\n        return index;\n      },\n      // create style entries and returns array of integer indexes that can be used in cell .s property\n      addStyles: function addStyles(styles) {\n        var self = this;\n        return styles.map(function (style) {\n          return self.addStyle(style);\n        });\n      },\n      _duckTypeStyle: function _duckTypeStyle(attributes) {\n        if (typeof attributes == 'object' && (attributes.patternFill || attributes.fgColor)) {\n          return {\n            fill: attributes\n          }; // this must be read via XLSX.parseFile(...)\n        } else if (attributes.font || attributes.numFmt || attributes.border || attributes.fill) {\n          return attributes;\n        } else {\n          return this._getStyleCSS(attributes);\n        }\n      },\n      _getStyleCSS: function _getStyleCSS(css) {\n        return css; //TODO\n      },\n      // Create an <xf> record for the style as well as corresponding <font>, <fill>, <border>, <numfmts>\n      // Right now this is simple and creates a <font>, <fill>, <border>, <numfmts> for every <xf>\n      // We could perhaps get fancier and avoid duplicating  auxiliary entries as Excel presumably intended, but bother.\n      _addXf: function _addXf(attributes) {\n        var fontId = this._addFont(attributes.font);\n\n        var fillId = this._addFill(attributes.fill);\n\n        var borderId = this._addBorder(attributes.border);\n\n        var numFmtId = this._addNumFmt(attributes.numFmt);\n\n        var $xf = XmlNode('xf').attr(\"numFmtId\", numFmtId).attr(\"fontId\", fontId).attr(\"fillId\", fillId).attr(\"borderId\", borderId).attr(\"xfId\", \"0\");\n\n        if (fontId > 0) {\n          $xf.attr('applyFont', \"1\");\n        }\n\n        if (fillId > 0) {\n          $xf.attr('applyFill', \"1\");\n        }\n\n        if (borderId > 0) {\n          $xf.attr('applyBorder', \"1\");\n        }\n\n        if (numFmtId > 0) {\n          $xf.attr('applyNumberFormat', \"1\");\n        }\n\n        if (attributes.alignment) {\n          var $alignment = XmlNode('alignment');\n\n          if (attributes.alignment.horizontal) {\n            $alignment.attr('horizontal', attributes.alignment.horizontal);\n          }\n\n          if (attributes.alignment.vertical) {\n            $alignment.attr('vertical', attributes.alignment.vertical);\n          }\n\n          if (attributes.alignment.indent) {\n            $alignment.attr('indent', attributes.alignment.indent);\n          }\n\n          if (attributes.alignment.readingOrder) {\n            $alignment.attr('readingOrder', attributes.alignment.readingOrder);\n          }\n\n          if (attributes.alignment.wrapText) {\n            $alignment.attr('wrapText', attributes.alignment.wrapText);\n          }\n\n          if (attributes.alignment.textRotation != undefined) {\n            $alignment.attr('textRotation', attributes.alignment.textRotation);\n          }\n\n          $xf.append($alignment).attr('applyAlignment', 1);\n        }\n\n        this.$cellXfs.append($xf);\n        var count = +this.$cellXfs.children().length;\n        this.$cellXfs.attr('count', count);\n        return count - 1;\n      },\n      _addFont: function _addFont(attributes) {\n        if (!attributes) {\n          return 0;\n        }\n\n        var $font = XmlNode('font').append(XmlNode('sz').attr('val', attributes.sz || this.defaultStyle.font.sz)).append(XmlNode('name').attr('val', attributes.name || this.defaultStyle.font.name));\n        if (attributes.bold) $font.append(XmlNode('b'));\n        if (attributes.underline) $font.append(XmlNode('u'));\n        if (attributes.italic) $font.append(XmlNode('i'));\n        if (attributes.strike) $font.append(XmlNode('strike'));\n        if (attributes.outline) $font.append(XmlNode('outline'));\n        if (attributes.shadow) $font.append(XmlNode('shadow'));\n\n        if (attributes.vertAlign) {\n          $font.append(XmlNode('vertAlign').attr('val', attributes.vertAlign));\n        }\n\n        if (attributes.color) {\n          if (attributes.color.theme) {\n            $font.append(XmlNode('color').attr('theme', attributes.color.theme));\n\n            if (attributes.color.tint) {\n              //tint only if theme\n              $font.append(XmlNode('tint').attr('theme', attributes.color.tint));\n            }\n          } else if (attributes.color.rgb) {\n            // not both rgb and theme\n            $font.append(XmlNode('color').attr('rgb', attributes.color.rgb));\n          }\n        }\n\n        this.$fonts.append($font);\n        var count = this.$fonts.children().length;\n        this.$fonts.attr('count', count);\n        return count - 1;\n      },\n      _addNumFmt: function _addNumFmt(numFmt) {\n        if (!numFmt) {\n          return 0;\n        }\n\n        if (typeof numFmt == 'string') {\n          var numFmtIdx = fmt_table[numFmt];\n\n          if (numFmtIdx >= 0) {\n            return numFmtIdx; // we found a match against built in formats\n          }\n        }\n\n        if (/^[0-9]+$/.exec(numFmt)) {\n          return numFmt; // we're matching an integer against some known code\n        }\n\n        numFmt = numFmt.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\"/g, '&quot;').replace(/'/g, '&apos;');\n        var $numFmt = XmlNode('numFmt').attr('numFmtId', ++customNumFmtId).attr('formatCode', numFmt);\n        this.$numFmts.append($numFmt);\n        var count = this.$numFmts.children().length;\n        this.$numFmts.attr('count', count);\n        return customNumFmtId;\n      },\n      _addFill: function _addFill(attributes) {\n        if (!attributes) {\n          return 0;\n        }\n\n        var $patternFill = XmlNode('patternFill').attr('patternType', attributes.patternType || 'solid');\n\n        if (attributes.fgColor) {\n          var $fgColor = XmlNode('fgColor'); //Excel doesn't like it when we set both rgb and theme+tint, but xlsx.parseFile() sets both\n          //var $fgColor = createElement('<fgColor/>', null, null, {xmlMode: true}).attr(attributes.fgColor)\n\n          if (attributes.fgColor.rgb) {\n            if (attributes.fgColor.rgb.length == 6) {\n              attributes.fgColor.rgb = \"FF\" + attributes.fgColor.rgb; /// add alpha to an RGB as Excel expects aRGB\n            }\n\n            $fgColor.attr('rgb', attributes.fgColor.rgb);\n            $patternFill.append($fgColor);\n          } else if (attributes.fgColor.theme) {\n            $fgColor.attr('theme', attributes.fgColor.theme);\n\n            if (attributes.fgColor.tint) {\n              $fgColor.attr('tint', attributes.fgColor.tint);\n            }\n\n            $patternFill.append($fgColor);\n          }\n\n          if (!attributes.bgColor) {\n            attributes.bgColor = {\n              \"indexed\": \"64\"\n            };\n          }\n        }\n\n        if (attributes.bgColor) {\n          var $bgColor = XmlNode('bgColor').attr(attributes.bgColor);\n          $patternFill.append($bgColor);\n        }\n\n        var $fill = XmlNode('fill').append($patternFill);\n        this.$fills.append($fill);\n        var count = this.$fills.children().length;\n        this.$fills.attr('count', count);\n        return count - 1;\n      },\n      _getSubBorder: function _getSubBorder(direction, spec) {\n        var $direction = XmlNode(direction);\n\n        if (spec) {\n          if (spec.style) $direction.attr('style', spec.style);\n\n          if (spec.color) {\n            var $color = XmlNode('color');\n\n            if (spec.color.auto) {\n              $color.attr('auto', spec.color.auto);\n            } else if (spec.color.rgb) {\n              $color.attr('rgb', spec.color.rgb);\n            } else if (spec.color.theme || spec.color.tint) {\n              $color.attr('theme', spec.color.theme || \"1\");\n              $color.attr('tint', spec.color.tint || \"0\");\n            }\n\n            $direction.append($color);\n          }\n        }\n\n        return $direction;\n      },\n      _addBorder: function _addBorder(attributes) {\n        if (!attributes) {\n          return 0;\n        }\n\n        var self = this;\n        var $border = XmlNode('border').attr(\"diagonalUp\", attributes.diagonalUp).attr(\"diagonalDown\", attributes.diagonalDown);\n        var directions = [\"left\", \"right\", \"top\", \"bottom\", \"diagonal\"];\n        directions.forEach(function (direction) {\n          $border.append(self._getSubBorder(direction, attributes[direction]));\n        });\n        this.$borders.append($border);\n        var count = this.$borders.children().length;\n        this.$borders.attr('count', count);\n        return count - 1;\n      },\n      toXml: function toXml() {\n        return this.$styles.toXml();\n      }\n    }.initialize(options || {});\n  };\n\n  XLSX.parse_xlscfb = parse_xlscfb;\n  XLSX.parse_zip = parse_zip;\n  XLSX.read = readSync; //xlsread\n\n  XLSX.readFile = readFileSync; //readFile\n\n  XLSX.readFileSync = readFileSync;\n  XLSX.write = writeSync;\n  XLSX.writeFile = writeFileSync;\n  XLSX.writeFileSync = writeFileSync;\n  XLSX.utils = utils;\n  XLSX.CFB = CFB;\n  XLSX.SSF = SSF;\n})(typeof exports !== 'undefined' ? exports : XLSX);\n\nvar XLS = XLSX;","map":{"version":3,"sources":["C:/Users/Tateh/Desktop/ReactJs/generador-descuentos/node_modules/react-export-excel/node_modules/xlsx/xlsx.js"],"names":["XLSX","make_xlsx","version","current_codepage","current_cptable","module","require","cptable","reset_cp","set_cp","cp","char_codes","data","o","i","len","length","charCodeAt","debom_xml","_getchar","_gc1","x","String","fromCharCode","utils","decode","substr","_gc2","Base64","make_b64","map","encode","input","utf8","c1","c2","c3","e1","e2","e3","e4","isNaN","charAt","b64_decode","replace","indexOf","has_buf","Buffer","new_raw_buf","Array","s2a","s","split","bconcat","bufs","concat","apply","chr0","chr1","SSF","make_ssf","_strrev","fill","c","l","pad0","v","d","t","pad_","rpad_","pad0r1","Math","round","pad0r2","p2_32","pow","pad0r","isgeneral","opts_fmt","fixopts","y","undefined","opts","table_fmt","days","months","frac","D","mixed","sgn","B","P_2","P_1","P","Q_2","Q_1","Q","A","floor","q","general_fmt_int","_general_int","general_fmt_num","make_general_fmt_num","gnr1","gnr2","gnr4","gnr5","gnr6","gfn2","w","gfn5","toFixed","toPrecision","toExponential","gfn3","gfn4","V","log","abs","LOG10E","_general_num","general_fmt","Error","_general","fix_hijri","date","parse_date_code","b2","time","dow","dout","out","T","u","m","H","M","S","date1904","Date","setDate","getDate","getFullYear","getMonth","getDay","write_date","type","fmt","val","ss0","ss","tt","outl","commaify","j","write_num","make_write_num","pct1","write_num_pct","sfmt","mul","write_num_cm","idx","write_num_exp","match","period","ee","fakee","$$","$1","$2","$3","frac1","write_num_f1","r","aval","sign","den","parseInt","rr","base","myn","myd","write_num_f2","dec1","closeparen","phone","hashq","str","cc","rnd","dd","dec","flr","write_num_flt","ffmt","oo","ri","ff","oa","min","max","lres","rres","write_num_cm2","write_num_pct2","write_num_exp2","write_num_int","split_fmt","in_str","_split","abstime","eval_fmt","flen","lst","dt","hr","toLowerCase","bt","ssm","nstr","jj","vv","myv","ostr","decpt","lasti","retval","_eval","cfregex","cfregex2","chkcond","thresh","parseFloat","choose_fmt","f","lat","m1","m2","format","table","_table","load","load_entry","get_table","load_table","tbl","XLMLFormatMap","DO_NOT_EXPORT_CFB","CFB","_CFB","exports","parse","file","mver","ssz","nmfs","ndfs","dir_start","minifat_start","difat_start","fat_addrs","blob","slice","prep_blob","mv","check_get_mver","header","check_shifts","nds","read_shift","chk","sectors","sectorify","sleuth_fat","sector_list","make_sector_list","name","ENDOFCHAIN","files","Paths","FileIndex","FullPaths","FullPathDir","read_directory","build_full_paths","root_name","shift","root","find_path","make_find_path","raw","find","HEADER_SIGNATURE","HEADER_CLSID","nsectors","ceil","FI","FPD","FP","L","R","C","pl","dad","push","UCFullPaths","UCPaths","toUpperCase","path","k","UCPath","cnt","sector","__readInt32LE","get_sector_list","start","chkd","sl","buf","buf_chain","modulus","addr","nodes","__toBuffer","minifat_store","namelen","ctime","mtime","__utf16le","color","clsid","state","ct","read_date","mt","size","storage","content","MSSZ","offset","__readUInt32LE","fs","readFileSync","filename","options","readSync","consts","MAXREGSECT","DIFSECT","FATSECT","FREESECT","HEADER_MINOR_VERSION","MAXREGSID","NOSTREAM","EntryTypes","read","ReadShift","CheckField","isval","keys","Object","evert_key","obj","key","K","evert","evert_num","evert_arr","datenum","epoch","cc2str","arr","getdata","asNodeBuffer","_data","getContent","prototype","call","toString","asBinary","safegetzipfile","zip","lowerCaseFiles","getzipfile","getzipdata","safe","e","_fs","jszip","JSZip","attregexg","tagregex","nsregex","nsregex2","parsexmltag","tag","skip_root","z","eq","substring","strip_ns","encodings","rencoding","rencstr","unescapexml","encregex","coderegex","text","decregex","charegex","escapexml","xlml_fixstr","entregex","entrepl","parsexmlbool","value","utf8read","utf8reada","orig","utf8readb","ww","corpus","utf8readc","matchtag","mtcache","g","RegExp","vtregex","vt_cache","vt_regex","vtvregex","vtmregex","parseVector","h","matches","baseType","res","forEach","wtregex","writetag","wxt_helper","join","writextag","write_w3cdtf","toISOString","write_vt","XML_HEADER","XMLNS","main","readIEEE754","isLE","nl","ml","el","eMax","eBias","bits","NaN","Infinity","___toBuffer","toBuffer_","___utf16le","utf16le_","b","__readUInt16LE","__hexlify","___hexlify","hexlify_","__utf8","___utf8","__readUInt8","__lpstr","___lpstr","lpstr_","__lpwstr","___lpwstr","lpwstr_","__double","___double","is_buf","is_buf_a","a","isArray","utf16le_b","isBuffer","lpstr_b","readUInt32LE","lpwstr_b","utf8_b","double_","readDoubleLE","is_buf_b","__readInt16LE","___unhexlify","__unhexlify","oI","oR","loc","lens","WriteShift","writeUInt16LE","writeUInt32LE","writeDoubleLE","writeInt32LE","hexstr","fld","pos","write_shift","parsenoop","writenoop","new_buf","sz","recordhopper","cb","tmpbyte","cntbyte","RT","XLSBRecordEnum","buf_array","blksz","newblk","ba_newblk","curbuf","endbuf","ba_endbuf","next","ba_next","end","ba_end","ba_push","_bufs","write_record","ba","payload","evert_RE","p","shift_cell_xls","cell","tgt","cRel","rRel","shift_range_xls","range","OFFCRYPTO","make_offcrypto","O","_crypto","crypto","rc4","md5","hex","createHash","update","digest","parse_StrRun","ich","ifnt","parse_RichStr","flags","parse_XLWideString","rgsStrRun","dwSizeStrRun","write_RichStr","write_XLWideString","parse_XLSBCell","col","iStyleRef","fPhShow","write_XLSBCell","parse_XLSBCodeName","parse_XLNullableWideString","cchCharacters","write_XLNullableWideString","parse_RelID","write_RelID","parse_RkNumber","fX100","fInt","RK","parse_UncheckedRfX","write_UncheckedRfX","parse_Xnum","write_Xnum","BErr","RBErr","parse_BrtColor","fValidRGB","xColorType","index","nTintAndShade","bRed","bGreen","bBlue","bAlpha","parse_FontFlags","fItalic","fStrikeout","fOutline","fShadow","fCondense","fExtend","VT_EMPTY","VT_NULL","VT_I2","VT_I4","VT_R4","VT_R8","VT_CY","VT_DATE","VT_BSTR","VT_ERROR","VT_BOOL","VT_VARIANT","VT_DECIMAL","VT_I1","VT_UI1","VT_UI2","VT_UI4","VT_I8","VT_UI8","VT_INT","VT_UINT","VT_LPSTR","VT_LPWSTR","VT_FILETIME","VT_BLOB","VT_STREAM","VT_STORAGE","VT_STREAMED_Object","VT_STORED_Object","VT_BLOB_Object","VT_CF","VT_CLSID","VT_VERSIONED_STREAM","VT_VECTOR","VT_ARRAY","VT_STRING","VT_USTR","VT_CUSTOM","DocSummaryPIDDSI","n","SummaryPIDSI","SpecialProperties","hasOwnProperty","CountryEnum","XLSFillPattern","rgbify","XLSIcv","ct2type","CT_LIST","workbooks","xlsx","xlsm","xlsb","xltx","strs","sheets","styles","type2ct","CT","parse_ct","ctext","calcchains","themes","coreprops","extprops","custprops","comments","vba","TODO","rels","xmlns","Extension","ContentType","PartName","WTF","console","error","calcchain","sst","style","defaults","CTYPE_XML_ROOT","xsd","xsi","CTYPE_DEFAULTS","write_ct","f1","bookType","f2","f3","RELS","WB","SHEET","parse_rels","currentFilePath","hash","resolveRelativePathIntoAbsolute","to","toksFrom","pop","toksTo","reversed","tokTo","rel","Type","Target","Id","TargetMode","canonictarget","RELS_ROOT","write_rels","rid","CORE_PROPS","CORE_PROPS_REGEX","parse_core_props","cur","CORE_PROPS_XML_ROOT","dc","dcterms","dcmitype","cp_doit","write_core_props","Props","title","subject","creator","keywords","description","CreatedDate","ModifiedDate","EXT_PROPS","parse_ext_props","HeadingPairs","TitlesOfParts","widx","Worksheets","parts","SheetNames","EXT_PROPS_XML_ROOT","vt","write_ext_props","W","Application","CUST_PROPS","custregex","parse_cust_props","xmlnsvt","toks","warn","CUST_PROPS_XML_ROOT","write_cust_props","pid","custprop","xlml_set_prop","parse_FILETIME","dwLowDateTime","dwHighDateTime","parse_lpstr","pad","parse_lpwstr","parse_VtStringBase","stringType","parse_VtString","parse_VtUnalignedString","parse_VtVecUnalignedLpstrValue","ret","parse_VtVecUnalignedLpstr","parse_VtHeadingPair","headingString","parse_TypedPropertyValue","headerParts","parse_VtVecHeadingPairValue","cElements","parse_VtVecHeadingPair","parse_dictionary","CodePage","dict","parse_BLOB","bytes","parse_ClipboardData","Size","parse_VtVector","_opts","parse_PropertySet","PIDSI","start_addr","NumProps","Dictionary","DictObj","PropID","Offset","PropH","fail","piddsi","oldpos","parsebool","parse_PropertySetStream","NumSets","FMTID0","FMTID1","Offset0","Offset1","vers","SystemIdentifier","PSet0","rval","FMTID","PSet1","parsenoop2","parslurp","target","parslurp2","parseuint16","parseuint16a","parse_Boolean","parse_Bes","parse_ShortXLUnicodeString","cch","width","encoding","biff","fHighByte","parse_XLUnicodeRichExtendedString","fExtSt","fRichSt","cRun","cbExtRst","msg","parse_XLUnicodeStringNoCch","parse_XLUnicodeString","parse_XLUnicodeString2","parse_ControlInfo","parse_URLMoniker","extra","url","parse_FileMoniker","cAnti","ansiLength","ansiPath","endServer","versionNumber","cbUnicodePathSize","cbUnicodePathBytes","usKeyValue","unicodePath","parse_HyperlinkMoniker","parse_HyperlinkString","parse_Hyperlink","sVer","displayName","targetFrameName","moniker","oleMoniker","location","guid","fileTime","parse_LongRGBA","parse_LongRGB","parse_XLSCell","rw","ixfe","parse_frtHeader","rt","parse_OptXLUnicodeString","HIDEOBJENUM","parse_HideObjEnum","parse_XTI","iSupBook","itabFirst","itabLast","parse_RkRec","parse_AddinUdf","udfName","parse_Ref8U","rwFirst","rwLast","colFirst","colLast","parse_RefU","parse_Ref","parse_FtCmo","ot","id","parse_FtNts","fSharedNote","parse_FtCf","cf","FtTab","parse_FtArray","fts","ft","parse_FontIndex","parse_BOF","BIFFVer","parse_InterfaceHdr","parse_WriteAccess","enc","UserName","parse_BoundSheet8","hidden","hs","parse_SST","ucnt","Count","Unique","parse_ExtSST","extsst","dsst","parse_Row","Col","rht","parse_ForceFullCalculation","fullcalc","parse_CompressPictures","parse_RecalcId","parse_DefaultRowHeight","miyRw","fl","Unsynced","DyZero","ExAsc","ExDsc","parse_Window1","xWn","yWn","dxWn","dyWn","iTabCur","iTabFirst","ctabSel","wTabRatio","Pos","Dim","Flags","CurTab","FirstTab","Selected","TabRatio","parse_Font","parse_LabelSst","isst","parse_Label","parse_Format","ifmt","fmtstr","parse_Dimensions","parse_RK","rkrec","rknum","parse_MulRk","rkrecs","lastcol","parse_CellStyleXF","patternType","icvFore","icvBack","parse_CellXF","parse_StyleXF","parse_XF","fStyle","parse_Guts","parse_BoolErr","parse_Number","xnum","parse_XLHeaderFooter","parse_SupBook","ctab","virtPath","rgst","sbcch","parse_ExternName","body","fBuiltIn","fWantAdvise","fWantPict","fOle","fOleLink","fIcon","parse_Lbl","chKey","cce","itab","rgce","parse_NameParsedFormula","Name","parse_ExternSheet","snames","parse_ShrFmla","ref","cUse","parse_SharedParsedFormula","parse_Array","parse_ArrayParsedFormula","parse_MTRSettings","fMTREnabled","fUserSetThreadCount","cUserThreadCount","parse_NoteSh","row","idObj","stAuthor","parse_Note","parse_MergeCells","merges","cmcs","parse_Obj","cmo","parse_TxO","lastobj","controlInfo","cchText","cbRuns","ifntEmpty","texts","hdr","parse_HLink","hlink","parse_HLinkTooltip","wzTooltip","parse_Country","parse_ClrtClient","ccv","parse_Palette","parse_XFCRC","cxfs","crc","parse_Style","parse_StyleExt","parse_ColInfo","parse_Window2","parse_Backup","parse_Blank","parse_BottomMargin","parse_BuiltInFnGroupCount","parse_CalcCount","parse_CalcDelta","parse_CalcIter","parse_CalcMode","parse_CalcPrecision","parse_CalcRefMode","parse_CalcSaveRecalc","parse_CodePage","parse_Compat12","parse_Date1904","parse_DefColWidth","parse_DSF","parse_EntExU2","parse_EOF","parse_Excel9File","parse_FeatHdr","parse_FontX","parse_Footer","parse_GridSet","parse_HCenter","parse_Header","parse_HideObj","parse_InterfaceEnd","parse_LeftMargin","parse_Mms","parse_ObjProtect","parse_Password","parse_PrintGrid","parse_PrintRowCol","parse_PrintSize","parse_Prot4Rev","parse_Prot4RevPass","parse_Protect","parse_RefreshAll","parse_RightMargin","parse_RRTabId","parse_ScenarioProtect","parse_Scl","parse_String","parse_SxBool","parse_TopMargin","parse_UsesELFs","parse_VCenter","parse_WinProtect","parse_WriteProtect","parse_VerticalPageBreaks","parse_HorizontalPageBreaks","parse_Selection","parse_Continue","parse_Pane","parse_Pls","parse_DCon","parse_DConRef","parse_DConName","parse_XCT","parse_CRN","parse_FileSharing","parse_Uncalced","parse_Template","parse_Intl","parse_WsBool","parse_Sort","parse_Sync","parse_LPr","parse_DxGCol","parse_FnGroupName","parse_FilterMode","parse_AutoFilterInfo","parse_AutoFilter","parse_Setup","parse_ScenMan","parse_SCENARIO","parse_SxView","parse_Sxvd","parse_SXVI","parse_SxIvd","parse_SXLI","parse_SXPI","parse_DocRoute","parse_RecipName","parse_MulBlank","parse_SXDI","parse_SXDB","parse_SXFDB","parse_SXDBB","parse_SXNum","parse_SxErr","parse_SXInt","parse_SXString","parse_SXDtr","parse_SxNil","parse_SXTbl","parse_SXTBRGIITM","parse_SxTbpg","parse_ObProj","parse_SXStreamID","parse_DBCell","parse_SXRng","parse_SxIsxoper","parse_BookBool","parse_DbOrParamQry","parse_OleObjectSize","parse_SXVS","parse_BkHim","parse_MsoDrawingGroup","parse_MsoDrawing","parse_MsoDrawingSelection","parse_PhoneticInfo","parse_SxRule","parse_SXEx","parse_SxFilt","parse_SxDXF","parse_SxItm","parse_SxName","parse_SxSelect","parse_SXPair","parse_SxFmla","parse_SxFormat","parse_SXVDEx","parse_SXFormula","parse_SXDBEx","parse_RRDInsDel","parse_RRDHead","parse_RRDChgCell","parse_RRDRenSheet","parse_RRSort","parse_RRDMove","parse_RRFormat","parse_RRAutoFmt","parse_RRInsertSh","parse_RRDMoveBegin","parse_RRDMoveEnd","parse_RRDInsDelBegin","parse_RRDInsDelEnd","parse_RRDConflict","parse_RRDDefName","parse_RRDRstEtxp","parse_LRng","parse_CUsr","parse_CbUsr","parse_UsrInfo","parse_UsrExcl","parse_FileLock","parse_RRDInfo","parse_BCUsrs","parse_UsrChk","parse_UserBView","parse_UserSViewBegin","parse_UserSViewEnd","parse_RRDUserView","parse_Qsi","parse_CondFmt","parse_CF","parse_DVal","parse_DConBin","parse_Lel","parse_XLSCodeName","parse_SXFDBType","parse_ObNoMacros","parse_Dv","parse_Index","parse_Table","parse_BigName","parse_ContinueBigName","parse_WebPub","parse_QsiSXTag","parse_DBQueryExt","parse_ExtString","parse_TxtQry","parse_Qsir","parse_Qsif","parse_RRDTQSIF","parse_OleDbConn","parse_WOpt","parse_SXViewEx","parse_SXTH","parse_SXPIEx","parse_SXVDTEx","parse_SXViewEx9","parse_ContinueFrt","parse_RealTimeData","parse_ChartFrtInfo","parse_FrtWrapper","parse_StartBlock","parse_EndBlock","parse_StartObject","parse_EndObject","parse_CatLab","parse_YMult","parse_SXViewLink","parse_PivotChartBits","parse_FrtFontList","parse_SheetExt","parse_BookExt","parse_SXAddl","parse_CrErr","parse_HFPicture","parse_Feat","parse_DataLabExt","parse_DataLabExtContents","parse_CellWatch","parse_FeatHdr11","parse_Feature11","parse_DropDownObjIds","parse_ContinueFrt11","parse_DConn","parse_List12","parse_Feature12","parse_CondFmt12","parse_CF12","parse_CFEx","parse_AutoFilter12","parse_ContinueFrt12","parse_MDTInfo","parse_MDXStr","parse_MDXTuple","parse_MDXSet","parse_MDXProp","parse_MDXKPI","parse_MDB","parse_PLV","parse_DXF","parse_TableStyles","parse_TableStyle","parse_TableStyleElement","parse_NamePublish","parse_NameCmt","parse_SortData","parse_GUIDTypeLib","parse_FnGrp12","parse_NameFnGrp12","parse_HeaderFooter","parse_CrtLayout12","parse_CrtMlFrt","parse_CrtMlFrtContinue","parse_ShapePropsStream","parse_TextPropsStream","parse_RichTextStream","parse_CrtLayout12A","parse_Units","parse_Chart","parse_Series","parse_DataFormat","parse_LineFormat","parse_MarkerFormat","parse_AreaFormat","parse_PieFormat","parse_AttachedLabel","parse_SeriesText","parse_ChartFormat","parse_Legend","parse_SeriesList","parse_Bar","parse_Line","parse_Pie","parse_Area","parse_Scatter","parse_CrtLine","parse_Axis","parse_Tick","parse_ValueRange","parse_CatSerRange","parse_AxisLine","parse_CrtLink","parse_DefaultText","parse_Text","parse_ObjectLink","parse_Frame","parse_Begin","parse_End","parse_PlotArea","parse_Chart3d","parse_PicF","parse_DropBar","parse_Radar","parse_Surf","parse_RadarArea","parse_AxisParent","parse_LegendException","parse_ShtProps","parse_SerToCrt","parse_AxesUsed","parse_SBaseRef","parse_SerParent","parse_SerAuxTrend","parse_IFmtRecord","parse_Pos","parse_AlRuns","parse_BRAI","parse_SerAuxErrBar","parse_SerFmt","parse_Chart3DBarShape","parse_Fbi","parse_BopPop","parse_AxcExt","parse_Dat","parse_PlotGrowth","parse_SIIndex","parse_GelFrame","parse_BopPopCustom","parse_Fbi2","parse_BIFF5String","parse_BIFF2STR","parse_BIFF2NUM","num","CS2CP","parse_rs","parse_rs_factory","tregex","rpregex","rregex","rend","nlregex","parse_rpr","rpr","intro","outro","font","strike","rgb","family","parse_r","terms","rs","sitregex","sirregex","parse_si","html","cellHTML","sstr0","sstr1","sstr2","parse_sst_xml","count","uniqueCount","SST","straywsregex","write_sst_xml","bookSST","sitag","parse_BrtBeginSst","parse_sst_bin","pass","hopper_sst","write_BrtBeginSst","write_BrtSSTItem","write_sst_bin","_JS2ANSI","parse_Version","Major","Minor","parse_EncryptionHeader","tmp","AlgID","parse_EncryptionVerifier","parse_RC4CryptoHeader","EncryptionVersionInfo","EncryptionHeader","EncryptionVerifier","parse_RC4Header","Salt","EncryptedVerifier","EncryptedVerifierHash","crypto_CreatePasswordVerifier_Method1","Password","Verifier","PasswordArray","PasswordDecoded","PasswordByte","Intermediate1","Intermediate2","Intermediate3","crypto_CreateXorArray_Method1","PadArray","InitialCode","XorMatrix","Ror","Byte","XorRor","byte1","byte2","CreateXorKey_Method1","XorKey","CurrentElement","Char","password","Index","ObfuscationArray","Temp","PasswordLastChar","PadIndex","crypto_DecryptData_Method1","Data","XorArrayIndex","XorArray","Value","crypto_MakeXorDecryptor","parse_XORObfuscation","verificationBytes","verifier","valid","insitu_decrypt","parse_FilePassHeader","Info","parse_FilePass","hex2RGB","rgb2Hex","rgb2HSL","G","H6","L2","hsl2RGB","hsl","h6","X","rgb_tint","tint","rev","DEF_MDW","MAX_MDW","MIN_MDW","MDW","width2px","px2char","px","char2width","chr","cycle_width","collw","find_mdw","coll","XLMLPatternTypeMap","parse_fills","Fills","bgColor","indexed","theme","themeElements","clrScheme","raw_rgb","fgColor","parse_fonts","Fonts","bold","underline","italic","outline","shadow","vertAlign","parse_borders","Borders","border","sub_border","diagonalUp","diagonalDown","left","right","top","bottom","diagonal","auto","parse_numFmts","NumberFmt","formatCode","numFmtId","write_numFmts","NF","parse_cellXfs","CellXf","xf","fillId","alignment","vertical","horizontal","textRotation","indent","wrapText","write_cellXfs","cellXfs","parse_sty_xml","make_pstyx","numFmtRegex","cellXfRegex","fillsRegex","bordersRegex","STYLES_XML_ROOT","STY","write_sty_xml","wb","style_builder","toXml","parse_BrtFmt","stFmtCode","parse_BrtFont","dyHeight","grbit","bls","sss","uls","bFamily","bCharSet","brtColor","bFontScheme","Bold","Italic","Strikeout","Outline","Shadow","Condense","Extend","Sub","Sup","parse_BrtXF","ixfeParent","parse_sty_bin","hopper_sty","write_sty_bin","THEME","parse_clrScheme","lastClr","parse_fontScheme","parse_fmtScheme","clrsregex","fntsregex","fmtsregex","parse_themeElements","themeltregex","parse_theme_xml","write_theme","themeXml","parse_Theme","dwThemeVersion","parse_ColorTheme","parse_FullColorExt","xclrType","nTintShade","xclrValue","parse_IcvXF","parse_XFExtGradient","parse_ExtProp","extType","parse_XFExt","cexts","ext","update_xfext","xfext","xfe","parse_cc_xml","write_cc_xml","parse_BrtCalcChainItem$","encode_cell","parse_cc_bin","hopper_cc","write_cc_bin","parse_comments","dirComments","sheetRels","canonicalpath","parse_cmnt","sheetNames","sheetName","insertCommentsIntoSheet","sheet","comment","safe_decode_range","thisCell","decode_cell","encoded","encode_range","author","parse_comments_xml","authors","commentList","trim","authorId","sheetRows","textMatch","write_comments_xml","parse_BrtBeginComment","iauthor","rfx","parse_BrtCommentAuthor","parse_BrtCommentText","parse_comments_bin","hopper_cmnt","write_comments_bin","rc_to_a1","rcregex","rcbase","rcfunc","$4","$5","encode_col","encode_row","fstr","parseread","parseread1","parse_ColRelU","parse_RgceArea","parse_RgceAreaRel","parse_RgceLoc","parse_RgceLocRel","cl","parse_PtgArea","area","parse_PtgArea3d","ixti","parse_PtgAreaErr","parse_PtgAreaErr3d","parse_PtgAreaN","parse_PtgArray","parse_PtgAttrBaxcel","bitSemi","bitBaxcel","parse_PtgAttrChoose","parse_PtgAttrGoto","bitGoto","parse_PtgAttrIf","bitIf","parse_PtgAttrSemi","parse_PtgAttrSpaceType","parse_PtgAttrSpace","parse_PtgAttrSpaceSemi","parse_PtgRef","ptg","parse_PtgRefN","parse_PtgRef3d","parse_PtgFunc","iftab","FtabArgc","Ftab","parse_PtgFuncVar","cparams","tab","parsetab","Cetab","parse_PtgAttrSum","parse_PtgConcat","parse_PtgExp","parse_PtgErr","parse_PtgInt","parse_PtgBool","parse_PtgNum","parse_PtgStr","parse_SerAr","parse_PtgExtraMem","parse_PtgExtraArray","cols","rows","parse_PtgName","nameindex","parse_PtgNameX","parse_PtgMemArea","parse_PtgMemFunc","parse_PtgRefErr","parse_PtgAdd","parse_PtgDiv","parse_PtgEq","parse_PtgGe","parse_PtgGt","parse_PtgIsect","parse_PtgLe","parse_PtgLt","parse_PtgMissArg","parse_PtgMul","parse_PtgNe","parse_PtgParen","parse_PtgPercent","parse_PtgPower","parse_PtgRange","parse_PtgSub","parse_PtgUminus","parse_PtgUnion","parse_PtgUplus","parse_PtgMemErr","parse_PtgMemNoMem","parse_PtgRefErr3d","parse_PtgTbl","PtgTypes","PtgDupes","Ptg18","Ptg19","parse_Formula","parse_FormulaValue","chn","cbf","parse_XLSCellParsedFormula","formula","shared","parse_RgbExtra","parse_Rgce","rgcb","ptgs","mapper","stringify_formula","supbooks","_range","stack","nameidx","fflen","argc","func","args","lbl","XLSXFutureFunctions","bookidx","externbook","sharedf","parsedf","fnd","arrayf","parse_XLSBCellParsedFormula","PtgDataType","_ssfopts","WS","get_sst_id","get_cell_style","exec","numFmt","addStyle","revssf","fontId","borderId","xfId","applyNumberFormat","get_cell_style_csf","cellXf","applyAlignment","JSON","stringify","safe_format","fmtid","fillid","cellNF","parse_ws_xml_dim","ws","mergecregex","sheetdataregex","hlinkregex","dimregex","colregex","parse_ws_xml","ridx","mergecells","columns","cellStyles","parse_ws_xml_cols","refguess","mtch","parse_ws_xml_data","parse_ws_xml_hlinks","tmpref","write_ws_xml_merges","write_ws_xml_pagesetup","setup","pageSetup","scale","orientation","horizontalDpi","verticalDpi","Rel","rng","seencol","coli","colm","colM","wpx","wch","write_ws_xml_cols","customWidth","write_ws_xml_cell","oldt","oldv","cellDates","os","Strings","parse_ws_xml_data_factory","cellregex","rowregex","isregex","match_v","match_f","sdata","guess","cells","cref","tagr","tagc","sstr","do_format","marr","marrlen","xlen","cellFormula","sheetStubs","write_ws_xml_data","WS_XML_ROOT","write_ws_xml","sidx","rdata","Sheets","kids","pane","selection","activeCell","sqref","sheetView","showGridLines","tabSelected","workbookViewId","write_ws_xml_row_breaks","write_ws_xml_col_breaks","breaks","brk","thisBreak","nextBreak","man","manualBreakCount","parse_BrtRowHdr","parse_BrtWsDim","write_BrtWsDim","parse_BrtWsProp","parse_BrtCellBlank","write_BrtCellBlank","parse_BrtCellBool","fBool","parse_BrtCellError","parse_BrtCellIsst","parse_BrtCellReal","parse_BrtCellRk","parse_BrtCellSt","parse_BrtFmlaBool","parse_BrtFmlaError","parse_BrtFmlaNum","parse_BrtFmlaString","parse_BrtMergeCell","parse_BrtHLink","relId","tooltip","display","parse_ws_bin","ws_parse","write_ws_bin_cell","write_CELLTABLE","write_ws_bin","WBPropsDef","WBViewDef","SheetDef","CalcPrDef","CustomWBViewDef","push_defaults_array","push_defaults","parse_wb_defaults","WBProps","CalcPr","WBView","wbnsregex","parse_wb_xml","AppVersion","xml_wb","WB_XML_ROOT","safe1904","Workbook","write_wb_xml","sheetId","hasPrintHeaders","printHeader","printColumns","localSheetId","parse_BrtBundleSh","hsState","iTabID","strRelID","write_BrtBundleSh","parse_BrtWbProp","strName","write_BrtWbProp","parse_BrtFRTArchID$","ArchID","parse_wb_bin","hopper_wb","write_BUNDLESHS","write_BrtFileVersion","write_BOOKVIEWS","write_BrtCalcProp","write_BrtFileRecover","write_wb_bin","parse_wb","parse_ws","parse_sty","parse_theme","parse_sst","parse_cc","write_wb","write_ws","write_sty","write_sst","attregexg2","attregex2","_chr","xlml_parsexmltag","words","xlml_parsexmltagobj","xlml_format","xlml_set_custprop","Custprops","Rn","safe_format_xlml","nf","process_style_xlml","stag","Interior","I","Pattern","ID","parse_xlml_data","xml","csty","sid","StyleID","interiors","Parent","UTC","Formula","xlml_clean_comment","xlml_normalize","xlmlregex","parse_xlml_xml","sheetnames","cursheet","sheetname","dtag","didx","fidx","pidx","cstys","lastIndex","HRef","HRefScreenTip","MergeAcross","MergeDown","Format","Span","Author","seen","bookSheets","bookProps","parse_xlml","fix_read_opts","write_xlml","parse_compobj","UserType","Reserved1","slurp","XLSRecordEnum","ll","safe_format_xf","XF","make_cell","parse_workbook","Directory","found_sheet","last_formula","cur_sheet","Preamble","lastcell","last_cell","cmnt","rngC","rngR","shared_formulae","array_formulae","temp_val","country","cell_valid","XFs","palette","get_rgb","getrgb","icv","process_cell_style","pcs","line","xfd","addcell","rrtabid","lastuser","codepage","winlocked","wtf","objects","sbc","sbci","sbcli","last_Rn","file_depth","RecordType","Date1904","WriteProtect","RefreshAll","CalcCount","CalcDelta","CalcIter","CalcMode","CalcPrecision","CalcSaveRecalc","CalcRefMode","FullCalc","TxO","noteobj","sheetnamesraw","sort","Number","Encryption","Metadata","Country","parse_xlscfb","cfb","CompObj","Summary","CompObjP","SummaryP","WorkbookP","parse_props","props","DocSummary","bookFiles","DSI","SI","parse_ods","ODS","fix_opts_func","fix_opts","fix_write_opts","safe_parse_wbrels","wbrels","pwbr","safe_parse_ws","relsPath","nodirs","parse_zip","entries","filter","dir","binname","propdata","pluck","deps","bookDeps","wbsheets","wbext","wbrelsfile","nmode","Deps","Styles","Themes","bookVBA","vbaraw","bin","add_rels","rId","relobj","write_zip","firstbyte","read_zip","base64","isfile","FILENAME","write_zip_type","StyleBuilder","generate","writeFileSync","writeSync","decode_row","rowstr","unfix_row","fix_row","cstr","decode_col","colstr","unfix_col","fix_col","split_cell","splt","fix_cell","unfix_cell","decode_range","cs","ce","safe_format_cell","format_cell","sheet_to_json","isempty","outi","defineProperty","enumerable","__rowNum__","sheet_to_row_object_array","sheet_to_csv","txt","qreg","FS","RS","make_csv","sheet_to_formulae","cmds","get_formulae","make_json","make_formulae","XmlNode","tagName","attributes","children","_attributes","_children","_prefix","createElement","arguments","append","node","prefix","attr","APOS","QUOTE","ESCAPED_QUOTE","escapeAttributeValue","att_value","customNumFmtId","fmt_table","_hashIndex","_listIndex","initialize","$fonts","$fills","$borders","$numFmts","$cellStyleXfs","$xf","$cellXfs","$cellStyles","$dxfs","$tableStyles","$styles","defaultStyle","defaultCellStyle","gray125Style","addStyles","hashKey","_addXf","self","_duckTypeStyle","patternFill","_getStyleCSS","css","_addFont","_addFill","_addBorder","_addNumFmt","$alignment","readingOrder","$font","numFmtIdx","$numFmt","$patternFill","$fgColor","$bgColor","$fill","_getSubBorder","direction","spec","$direction","$color","$border","directions","readFile","write","writeFile","XLS"],"mappings":"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","sourcesContent":["/* xlsx.js (C) 2013-2015 SheetJS -- http://sheetjs.com */\r\n/* vim: set ts=2: */\r\n/*jshint -W041 */\r\n/*jshint funcscope:true, eqnull:true */\r\nvar XLSX = {};\r\n(function make_xlsx(XLSX){\r\nXLSX.version = '0.8.20';\r\nvar current_codepage = 1200, current_cptable;\r\nif(typeof module !== \"undefined\" && typeof require !== 'undefined') {\r\n\tif(typeof cptable === 'undefined') cptable = require('./dist/cpexcel');\r\n\tcurrent_cptable = cptable[current_codepage];\r\n}\r\nfunction reset_cp() { set_cp(1200); }\r\nvar set_cp = function(cp) { current_codepage = cp; };\r\n\r\nfunction char_codes(data) { var o = []; for(var i = 0, len = data.length; i < len; ++i) o[i] = data.charCodeAt(i); return o; }\r\nvar debom_xml = function(data) { return data; };\r\n\r\nvar _getchar = function _gc1(x) { return String.fromCharCode(x); };\r\nif(typeof cptable !== 'undefined') {\r\n\tset_cp = function(cp) { current_codepage = cp; current_cptable = cptable[cp]; };\r\n\tdebom_xml = function(data) {\r\n\t\tif(data.charCodeAt(0) === 0xFF && data.charCodeAt(1) === 0xFE) { return cptable.utils.decode(1200, char_codes(data.substr(2))); }\r\n\t\treturn data;\r\n\t};\r\n\t_getchar = function _gc2(x) {\r\n\t\tif(current_codepage === 1200) return String.fromCharCode(x);\r\n\t\treturn cptable.utils.decode(current_codepage, [x&255,x>>8])[0];\r\n\t};\r\n}\r\nvar Base64 = (function make_b64(){\r\n\tvar map = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\";\r\n\treturn {\r\n\t\tencode: function(input, utf8) {\r\n\t\t\tvar o = \"\";\r\n\t\t\tvar c1, c2, c3, e1, e2, e3, e4;\r\n\t\t\tfor(var i = 0; i < input.length; ) {\r\n\t\t\t\tc1 = input.charCodeAt(i++);\r\n\t\t\t\tc2 = input.charCodeAt(i++);\r\n\t\t\t\tc3 = input.charCodeAt(i++);\r\n\t\t\t\te1 = c1 >> 2;\r\n\t\t\t\te2 = (c1 & 3) << 4 | c2 >> 4;\r\n\t\t\t\te3 = (c2 & 15) << 2 | c3 >> 6;\r\n\t\t\t\te4 = c3 & 63;\r\n\t\t\t\tif (isNaN(c2)) { e3 = e4 = 64; }\r\n\t\t\t\telse if (isNaN(c3)) { e4 = 64; }\r\n\t\t\t\to += map.charAt(e1) + map.charAt(e2) + map.charAt(e3) + map.charAt(e4);\r\n\t\t\t}\r\n\t\t\treturn o;\r\n\t\t},\r\n\t\tdecode: function b64_decode(input, utf8) {\r\n\t\t\tvar o = \"\";\r\n\t\t\tvar c1, c2, c3;\r\n\t\t\tvar e1, e2, e3, e4;\r\n\t\t\tinput = input.replace(/[^A-Za-z0-9\\+\\/\\=]/g, \"\");\r\n\t\t\tfor(var i = 0; i < input.length;) {\r\n\t\t\t\te1 = map.indexOf(input.charAt(i++));\r\n\t\t\t\te2 = map.indexOf(input.charAt(i++));\r\n\t\t\t\te3 = map.indexOf(input.charAt(i++));\r\n\t\t\t\te4 = map.indexOf(input.charAt(i++));\r\n\t\t\t\tc1 = e1 << 2 | e2 >> 4;\r\n\t\t\t\tc2 = (e2 & 15) << 4 | e3 >> 2;\r\n\t\t\t\tc3 = (e3 & 3) << 6 | e4;\r\n\t\t\t\to += String.fromCharCode(c1);\r\n\t\t\t\tif (e3 != 64) { o += String.fromCharCode(c2); }\r\n\t\t\t\tif (e4 != 64) { o += String.fromCharCode(c3); }\r\n\t\t\t}\r\n\t\t\treturn o;\r\n\t\t}\r\n\t};\r\n})();\r\nvar has_buf = (typeof Buffer !== 'undefined');\r\n\r\nfunction new_raw_buf(len) {\r\n\t/* jshint -W056 */\r\n\treturn new (has_buf ? Buffer : Array)(len);\r\n\t/* jshint +W056 */\r\n}\r\n\r\nfunction s2a(s) {\r\n\tif(has_buf) return new Buffer(s, \"binary\");\r\n\treturn s.split(\"\").map(function(x){ return x.charCodeAt(0) & 0xff; });\r\n}\r\n\r\nvar bconcat = function(bufs) { return [].concat.apply([], bufs); };\r\n\r\nvar chr0 = /\\u0000/g, chr1 = /[\\u0001-\\u0006]/;\r\n/* ssf.js (C) 2013-2014 SheetJS -- http://sheetjs.com */\r\n/*jshint -W041 */\r\nvar SSF = {};\r\nvar make_ssf = function make_ssf(SSF){\r\nSSF.version = '0.8.1';\r\nfunction _strrev(x) { var o = \"\", i = x.length-1; while(i>=0) o += x.charAt(i--); return o; }\r\nfunction fill(c,l) { var o = \"\"; while(o.length < l) o+=c; return o; }\r\nfunction pad0(v,d){var t=\"\"+v; return t.length>=d?t:fill('0',d-t.length)+t;}\r\nfunction pad_(v,d){var t=\"\"+v;return t.length>=d?t:fill(' ',d-t.length)+t;}\r\nfunction rpad_(v,d){var t=\"\"+v; return t.length>=d?t:t+fill(' ',d-t.length);}\r\nfunction pad0r1(v,d){var t=\"\"+Math.round(v); return t.length>=d?t:fill('0',d-t.length)+t;}\r\nfunction pad0r2(v,d){var t=\"\"+v; return t.length>=d?t:fill('0',d-t.length)+t;}\r\nvar p2_32 = Math.pow(2,32);\r\nfunction pad0r(v,d){if(v>p2_32||v<-p2_32) return pad0r1(v,d); var i = Math.round(v); return pad0r2(i,d); }\r\nfunction isgeneral(s, i) { return s.length >= 7 + i && (s.charCodeAt(i)|32) === 103 && (s.charCodeAt(i+1)|32) === 101 && (s.charCodeAt(i+2)|32) === 110 && (s.charCodeAt(i+3)|32) === 101 && (s.charCodeAt(i+4)|32) === 114 && (s.charCodeAt(i+5)|32) === 97 && (s.charCodeAt(i+6)|32) === 108; }\r\n/* Options */\r\nvar opts_fmt = [\r\n\t[\"date1904\", 0],\r\n\t[\"output\", \"\"],\r\n\t[\"WTF\", false]\r\n];\r\nfunction fixopts(o){\r\n\tfor(var y = 0; y != opts_fmt.length; ++y) if(o[opts_fmt[y][0]]===undefined) o[opts_fmt[y][0]]=opts_fmt[y][1];\r\n}\r\nSSF.opts = opts_fmt;\r\nvar table_fmt = {\r\n\t0:  'General',\r\n\t1:  '0',\r\n\t2:  '0.00',\r\n\t3:  '#,##0',\r\n\t4:  '#,##0.00',\r\n\t9:  '0%',\r\n\t10: '0.00%',\r\n\t11: '0.00E+00',\r\n\t12: '# ?/?',\r\n\t13: '# ??/??',\r\n\t14: 'm/d/yy',\r\n\t15: 'd-mmm-yy',\r\n\t16: 'd-mmm',\r\n\t17: 'mmm-yy',\r\n\t18: 'h:mm AM/PM',\r\n\t19: 'h:mm:ss AM/PM',\r\n\t20: 'h:mm',\r\n\t21: 'h:mm:ss',\r\n\t22: 'm/d/yy h:mm',\r\n\t37: '#,##0 ;(#,##0)',\r\n\t38: '#,##0 ;[Red](#,##0)',\r\n\t39: '#,##0.00;(#,##0.00)',\r\n\t40: '#,##0.00;[Red](#,##0.00)',\r\n\t45: 'mm:ss',\r\n\t46: '[h]:mm:ss',\r\n\t47: 'mmss.0',\r\n\t48: '##0.0E+0',\r\n\t49: '@',\r\n\t56: '\"上午/下午 \"hh\"時\"mm\"分\"ss\"秒 \"',\r\n\t65535: 'General'\r\n};\r\nvar days = [\r\n\t['Sun', 'Sunday'],\r\n\t['Mon', 'Monday'],\r\n\t['Tue', 'Tuesday'],\r\n\t['Wed', 'Wednesday'],\r\n\t['Thu', 'Thursday'],\r\n\t['Fri', 'Friday'],\r\n\t['Sat', 'Saturday']\r\n];\r\nvar months = [\r\n\t['J', 'Jan', 'January'],\r\n\t['F', 'Feb', 'February'],\r\n\t['M', 'Mar', 'March'],\r\n\t['A', 'Apr', 'April'],\r\n\t['M', 'May', 'May'],\r\n\t['J', 'Jun', 'June'],\r\n\t['J', 'Jul', 'July'],\r\n\t['A', 'Aug', 'August'],\r\n\t['S', 'Sep', 'September'],\r\n\t['O', 'Oct', 'October'],\r\n\t['N', 'Nov', 'November'],\r\n\t['D', 'Dec', 'December']\r\n];\r\nfunction frac(x, D, mixed) {\r\n\tvar sgn = x < 0 ? -1 : 1;\r\n\tvar B = x * sgn;\r\n\tvar P_2 = 0, P_1 = 1, P = 0;\r\n\tvar Q_2 = 1, Q_1 = 0, Q = 0;\r\n\tvar A = Math.floor(B);\r\n\twhile(Q_1 < D) {\r\n\t\tA = Math.floor(B);\r\n\t\tP = A * P_1 + P_2;\r\n\t\tQ = A * Q_1 + Q_2;\r\n\t\tif((B - A) < 0.0000000005) break;\r\n\t\tB = 1 / (B - A);\r\n\t\tP_2 = P_1; P_1 = P;\r\n\t\tQ_2 = Q_1; Q_1 = Q;\r\n\t}\r\n\tif(Q > D) { Q = Q_1; P = P_1; }\r\n\tif(Q > D) { Q = Q_2; P = P_2; }\r\n\tif(!mixed) return [0, sgn * P, Q];\r\n\tif(Q===0) throw \"Unexpected state: \"+P+\" \"+P_1+\" \"+P_2+\" \"+Q+\" \"+Q_1+\" \"+Q_2;\r\n\tvar q = Math.floor(sgn * P/Q);\r\n\treturn [q, sgn*P - q*Q, Q];\r\n}\r\nfunction general_fmt_int(v, opts) { return \"\"+v; }\r\nSSF._general_int = general_fmt_int;\r\nvar general_fmt_num = (function make_general_fmt_num() {\r\nvar gnr1 = /\\.(\\d*[1-9])0+$/, gnr2 = /\\.0*$/, gnr4 = /\\.(\\d*[1-9])0+/, gnr5 = /\\.0*[Ee]/, gnr6 = /(E[+-])(\\d)$/;\r\nfunction gfn2(v) {\r\n\tvar w = (v<0?12:11);\r\n\tvar o = gfn5(v.toFixed(12)); if(o.length <= w) return o;\r\n\to = v.toPrecision(10); if(o.length <= w) return o;\r\n\treturn v.toExponential(5);\r\n}\r\nfunction gfn3(v) {\r\n\tvar o = v.toFixed(11).replace(gnr1,\".$1\");\r\n\tif(o.length > (v<0?12:11)) o = v.toPrecision(6);\r\n\treturn o;\r\n}\r\nfunction gfn4(o) {\r\n\tfor(var i = 0; i != o.length; ++i) if((o.charCodeAt(i) | 0x20) === 101) return o.replace(gnr4,\".$1\").replace(gnr5,\"E\").replace(\"e\",\"E\").replace(gnr6,\"$10$2\");\r\n\treturn o;\r\n}\r\nfunction gfn5(o) {\r\n\t//for(var i = 0; i != o.length; ++i) if(o.charCodeAt(i) === 46) return o.replace(gnr2,\"\").replace(gnr1,\".$1\");\r\n\t//return o;\r\n\treturn o.indexOf(\".\") > -1 ? o.replace(gnr2,\"\").replace(gnr1,\".$1\") : o;\r\n}\r\nreturn function general_fmt_num(v, opts) {\r\n\tvar V = Math.floor(Math.log(Math.abs(v))*Math.LOG10E), o;\r\n\tif(V >= -4 && V <= -1) o = v.toPrecision(10+V);\r\n\telse if(Math.abs(V) <= 9) o = gfn2(v);\r\n\telse if(V === 10) o = v.toFixed(10).substr(0,12);\r\n\telse o = gfn3(v);\r\n\treturn gfn5(gfn4(o));\r\n};})();\r\nSSF._general_num = general_fmt_num;\r\nfunction general_fmt(v, opts) {\r\n\tswitch(typeof v) {\r\n\t\tcase 'string': return v;\r\n\t\tcase 'boolean': return v ? \"TRUE\" : \"FALSE\";\r\n\t\tcase 'number': return (v|0) === v ? general_fmt_int(v, opts) : general_fmt_num(v, opts);\r\n\t}\r\n\tthrow new Error(\"unsupported value in General format: \" + v);\r\n}\r\nSSF._general = general_fmt;\r\nfunction fix_hijri(date, o) { return 0; }\r\nfunction parse_date_code(v,opts,b2) {\r\n\tif(v > 2958465 || v < 0) return null;\r\n\tvar date = (v|0), time = Math.floor(86400 * (v - date)), dow=0;\r\n\tvar dout=[];\r\n\tvar out={D:date, T:time, u:86400*(v-date)-time,y:0,m:0,d:0,H:0,M:0,S:0,q:0};\r\n\tif(Math.abs(out.u) < 1e-6) out.u = 0;\r\n\tfixopts(opts != null ? opts : (opts=[]));\r\n\tif(opts.date1904) date += 1462;\r\n\tif(out.u > 0.999) {\r\n\t\tout.u = 0;\r\n\t\tif(++time == 86400) { time = 0; ++date; }\r\n\t}\r\n\tif(date === 60) {dout = b2 ? [1317,10,29] : [1900,2,29]; dow=3;}\r\n\telse if(date === 0) {dout = b2 ? [1317,8,29] : [1900,1,0]; dow=6;}\r\n\telse {\r\n\t\tif(date > 60) --date;\r\n\t\t/* 1 = Jan 1 1900 */\r\n\t\tvar d = new Date(1900,0,1);\r\n\t\td.setDate(d.getDate() + date - 1);\r\n\t\tdout = [d.getFullYear(), d.getMonth()+1,d.getDate()];\r\n\t\tdow = d.getDay();\r\n\t\tif(date < 60) dow = (dow + 6) % 7;\r\n\t\tif(b2) dow = fix_hijri(d, dout);\r\n\t}\r\n\tout.y = dout[0]; out.m = dout[1]; out.d = dout[2];\r\n\tout.S = time % 60; time = Math.floor(time / 60);\r\n\tout.M = time % 60; time = Math.floor(time / 60);\r\n\tout.H = time;\r\n\tout.q = dow;\r\n\treturn out;\r\n}\r\nSSF.parse_date_code = parse_date_code;\r\n/*jshint -W086 */\r\nfunction write_date(type, fmt, val, ss0) {\r\n\tvar o=\"\", ss=0, tt=0, y = val.y, out, outl = 0;\r\n\tswitch(type) {\r\n\t\tcase 98: /* 'b' buddhist year */\r\n\t\t\ty = val.y + 543;\r\n\t\t\t/* falls through */\r\n\t\tcase 121: /* 'y' year */\r\n\t\tswitch(fmt.length) {\r\n\t\t\tcase 1: case 2: out = y % 100; outl = 2; break;\r\n\t\t\tdefault: out = y % 10000; outl = 4; break;\r\n\t\t} break;\r\n\t\tcase 109: /* 'm' month */\r\n\t\tswitch(fmt.length) {\r\n\t\t\tcase 1: case 2: out = val.m; outl = fmt.length; break;\r\n\t\t\tcase 3: return months[val.m-1][1];\r\n\t\t\tcase 5: return months[val.m-1][0];\r\n\t\t\tdefault: return months[val.m-1][2];\r\n\t\t} break;\r\n\t\tcase 100: /* 'd' day */\r\n\t\tswitch(fmt.length) {\r\n\t\t\tcase 1: case 2: out = val.d; outl = fmt.length; break;\r\n\t\t\tcase 3: return days[val.q][0];\r\n\t\t\tdefault: return days[val.q][1];\r\n\t\t} break;\r\n\t\tcase 104: /* 'h' 12-hour */\r\n\t\tswitch(fmt.length) {\r\n\t\t\tcase 1: case 2: out = 1+(val.H+11)%12; outl = fmt.length; break;\r\n\t\t\tdefault: throw 'bad hour format: ' + fmt;\r\n\t\t} break;\r\n\t\tcase 72: /* 'H' 24-hour */\r\n\t\tswitch(fmt.length) {\r\n\t\t\tcase 1: case 2: out = val.H; outl = fmt.length; break;\r\n\t\t\tdefault: throw 'bad hour format: ' + fmt;\r\n\t\t} break;\r\n\t\tcase 77: /* 'M' minutes */\r\n\t\tswitch(fmt.length) {\r\n\t\t\tcase 1: case 2: out = val.M; outl = fmt.length; break;\r\n\t\t\tdefault: throw 'bad minute format: ' + fmt;\r\n\t\t} break;\r\n\t\tcase 115: /* 's' seconds */\r\n\t\tif(val.u === 0) switch(fmt) {\r\n\t\t\tcase 's': case 'ss': return pad0(val.S, fmt.length);\r\n\t\t\tcase '.0': case '.00': case '.000':\r\n\t\t}\r\n\t\tswitch(fmt) {\r\n\t\t\tcase 's': case 'ss': case '.0': case '.00': case '.000':\r\n\t\t\t\tif(ss0 >= 2) tt = ss0 === 3 ? 1000 : 100;\r\n\t\t\t\telse tt = ss0 === 1 ? 10 : 1;\r\n\t\t\t\tss = Math.round((tt)*(val.S + val.u));\r\n\t\t\t\tif(ss >= 60*tt) ss = 0;\r\n\t\t\t\tif(fmt === 's') return ss === 0 ? \"0\" : \"\"+ss/tt;\r\n\t\t\t\to = pad0(ss,2 + ss0);\r\n\t\t\t\tif(fmt === 'ss') return o.substr(0,2);\r\n\t\t\t\treturn \".\" + o.substr(2,fmt.length-1);\r\n\t\t\tdefault: throw 'bad second format: ' + fmt;\r\n\t\t}\r\n\t\tcase 90: /* 'Z' absolute time */\r\n\t\tswitch(fmt) {\r\n\t\t\tcase '[h]': case '[hh]': out = val.D*24+val.H; break;\r\n\t\t\tcase '[m]': case '[mm]': out = (val.D*24+val.H)*60+val.M; break;\r\n\t\t\tcase '[s]': case '[ss]': out = ((val.D*24+val.H)*60+val.M)*60+Math.round(val.S+val.u); break;\r\n\t\t\tdefault: throw 'bad abstime format: ' + fmt;\r\n\t\t} outl = fmt.length === 3 ? 1 : 2; break;\r\n\t\tcase 101: /* 'e' era */\r\n\t\t\tout = y; outl = 1;\r\n\t}\r\n\tif(outl > 0) return pad0(out, outl); else return \"\";\r\n}\r\n/*jshint +W086 */\r\nfunction commaify(s) {\r\n\tif(s.length <= 3) return s;\r\n\tvar j = (s.length % 3), o = s.substr(0,j);\r\n\tfor(; j!=s.length; j+=3) o+=(o.length > 0 ? \",\" : \"\") + s.substr(j,3);\r\n\treturn o;\r\n}\r\nvar write_num = (function make_write_num(){\r\nvar pct1 = /%/g;\r\nfunction write_num_pct(type, fmt, val){\r\n\tvar sfmt = fmt.replace(pct1,\"\"), mul = fmt.length - sfmt.length;\r\n\treturn write_num(type, sfmt, val * Math.pow(10,2*mul)) + fill(\"%\",mul);\r\n}\r\nfunction write_num_cm(type, fmt, val){\r\n\tvar idx = fmt.length - 1;\r\n\twhile(fmt.charCodeAt(idx-1) === 44) --idx;\r\n\treturn write_num(type, fmt.substr(0,idx), val / Math.pow(10,3*(fmt.length-idx)));\r\n}\r\nfunction write_num_exp(fmt, val){\r\n\tvar o;\r\n\tvar idx = fmt.indexOf(\"E\") - fmt.indexOf(\".\") - 1;\r\n\tif(fmt.match(/^#+0.0E\\+0$/)) {\r\n\t\tvar period = fmt.indexOf(\".\"); if(period === -1) period=fmt.indexOf('E');\r\n\t\tvar ee = Math.floor(Math.log(Math.abs(val))*Math.LOG10E)%period;\r\n\t\tif(ee < 0) ee += period;\r\n\t\to = (val/Math.pow(10,ee)).toPrecision(idx+1+(period+ee)%period);\r\n\t\tif(o.indexOf(\"e\") === -1) {\r\n\t\t\tvar fakee = Math.floor(Math.log(Math.abs(val))*Math.LOG10E);\r\n\t\t\tif(o.indexOf(\".\") === -1) o = o[0] + \".\" + o.substr(1) + \"E+\" + (fakee - o.length+ee);\r\n\t\t\telse o += \"E+\" + (fakee - ee);\r\n\t\t\twhile(o.substr(0,2) === \"0.\") {\r\n\t\t\t\to = o[0] + o.substr(2,period) + \".\" + o.substr(2+period);\r\n\t\t\t\to = o.replace(/^0+([1-9])/,\"$1\").replace(/^0+\\./,\"0.\");\r\n\t\t\t}\r\n\t\t\to = o.replace(/\\+-/,\"-\");\r\n\t\t}\r\n\t\to = o.replace(/^([+-]?)(\\d*)\\.(\\d*)[Ee]/,function($$,$1,$2,$3) { return $1 + $2 + $3.substr(0,(period+ee)%period) + \".\" + $3.substr(ee) + \"E\"; });\r\n\t} else o = val.toExponential(idx);\r\n\tif(fmt.match(/E\\+00$/) && o.match(/e[+-]\\d$/)) o = o.substr(0,o.length-1) + \"0\" + o[o.length-1];\r\n\tif(fmt.match(/E\\-/) && o.match(/e\\+/)) o = o.replace(/e\\+/,\"e\");\r\n\treturn o.replace(\"e\",\"E\");\r\n}\r\nvar frac1 = /# (\\?+)( ?)\\/( ?)(\\d+)/;\r\nfunction write_num_f1(r, aval, sign) {\r\n\tvar den = parseInt(r[4]), rr = Math.round(aval * den), base = Math.floor(rr/den);\r\n\tvar myn = (rr - base*den), myd = den;\r\n\treturn sign + (base === 0 ? \"\" : \"\"+base) + \" \" + (myn === 0 ? fill(\" \", r[1].length + 1 + r[4].length) : pad_(myn,r[1].length) + r[2] + \"/\" + r[3] + pad0(myd,r[4].length));\r\n}\r\nfunction write_num_f2(r, aval, sign) {\r\n\treturn sign + (aval === 0 ? \"\" : \"\"+aval) + fill(\" \", r[1].length + 2 + r[4].length);\r\n}\r\nvar dec1 = /^#*0*\\.(0+)/;\r\nvar closeparen = /\\).*[0#]/;\r\nvar phone = /\\(###\\) ###\\\\?-####/;\r\nfunction hashq(str) {\r\n\tvar o = \"\", cc;\r\n\tfor(var i = 0; i != str.length; ++i) switch((cc=str.charCodeAt(i))) {\r\n\t\tcase 35: break;\r\n\t\tcase 63: o+= \" \"; break;\r\n\t\tcase 48: o+= \"0\"; break;\r\n\t\tdefault: o+= String.fromCharCode(cc);\r\n\t}\r\n\treturn o;\r\n}\r\nfunction rnd(val, d) { var dd = Math.pow(10,d); return \"\"+(Math.round(val * dd)/dd); }\r\nfunction dec(val, d) { return Math.round((val-Math.floor(val))*Math.pow(10,d)); }\r\nfunction flr(val) { if(val < 2147483647 && val > -2147483648) return \"\"+(val >= 0 ? (val|0) : (val-1|0)); return \"\"+Math.floor(val); }\r\nfunction write_num_flt(type, fmt, val) {\r\n\tif(type.charCodeAt(0) === 40 && !fmt.match(closeparen)) {\r\n\t\tvar ffmt = fmt.replace(/\\( */,\"\").replace(/ \\)/,\"\").replace(/\\)/,\"\");\r\n\t\tif(val >= 0) return write_num_flt('n', ffmt, val);\r\n\t\treturn '(' + write_num_flt('n', ffmt, -val) + ')';\r\n\t}\r\n\tif(fmt.charCodeAt(fmt.length - 1) === 44) return write_num_cm(type, fmt, val);\r\n\tif(fmt.indexOf('%') !== -1) return write_num_pct(type, fmt, val);\r\n\tif(fmt.indexOf('E') !== -1) return write_num_exp(fmt, val);\r\n\tif(fmt.charCodeAt(0) === 36) return \"$\"+write_num_flt(type,fmt.substr(fmt[1]==' '?2:1),val);\r\n\tvar o, oo;\r\n\tvar r, ri, ff, aval = Math.abs(val), sign = val < 0 ? \"-\" : \"\";\r\n\tif(fmt.match(/^00+$/)) return sign + pad0r(aval,fmt.length);\r\n\tif(fmt.match(/^[#?]+$/)) {\r\n\t\to = pad0r(val,0); if(o === \"0\") o = \"\";\r\n\t\treturn o.length > fmt.length ? o : hashq(fmt.substr(0,fmt.length-o.length)) + o;\r\n\t}\r\n\tif((r = fmt.match(frac1)) !== null) return write_num_f1(r, aval, sign);\r\n\tif(fmt.match(/^#+0+$/) !== null) return sign + pad0r(aval,fmt.length - fmt.indexOf(\"0\"));\r\n\tif((r = fmt.match(dec1)) !== null) {\r\n\t\to = rnd(val, r[1].length).replace(/^([^\\.]+)$/,\"$1.\"+r[1]).replace(/\\.$/,\".\"+r[1]).replace(/\\.(\\d*)$/,function($$, $1) { return \".\" + $1 + fill(\"0\", r[1].length-$1.length); });\r\n\t\treturn fmt.indexOf(\"0.\") !== -1 ? o : o.replace(/^0\\./,\".\");\r\n\t}\r\n\tfmt = fmt.replace(/^#+([0.])/, \"$1\");\r\n\tif((r = fmt.match(/^(0*)\\.(#*)$/)) !== null) {\r\n\t\treturn sign + rnd(aval, r[2].length).replace(/\\.(\\d*[1-9])0*$/,\".$1\").replace(/^(-?\\d*)$/,\"$1.\").replace(/^0\\./,r[1].length?\"0.\":\".\");\r\n\t}\r\n\tif((r = fmt.match(/^#,##0(\\.?)$/)) !== null) return sign + commaify(pad0r(aval,0));\r\n\tif((r = fmt.match(/^#,##0\\.([#0]*0)$/)) !== null) {\r\n\t\treturn val < 0 ? \"-\" + write_num_flt(type, fmt, -val) : commaify(\"\"+(Math.floor(val))) + \".\" + pad0(dec(val, r[1].length),r[1].length);\r\n\t}\r\n\tif((r = fmt.match(/^#,#*,#0/)) !== null) return write_num_flt(type,fmt.replace(/^#,#*,/,\"\"),val);\r\n\tif((r = fmt.match(/^([0#]+)(\\\\?-([0#]+))+$/)) !== null) {\r\n\t\to = _strrev(write_num_flt(type, fmt.replace(/[\\\\-]/g,\"\"), val));\r\n\t\tri = 0;\r\n\t\treturn _strrev(_strrev(fmt.replace(/\\\\/g,\"\")).replace(/[0#]/g,function(x){return ri<o.length?o[ri++]:x==='0'?'0':\"\";}));\r\n\t}\r\n\tif(fmt.match(phone) !== null) {\r\n\t\to = write_num_flt(type, \"##########\", val);\r\n\t\treturn \"(\" + o.substr(0,3) + \") \" + o.substr(3, 3) + \"-\" + o.substr(6);\r\n\t}\r\n\tvar oa = \"\";\r\n\tif((r = fmt.match(/^([#0?]+)( ?)\\/( ?)([#0?]+)/)) !== null) {\r\n\t\tri = Math.min(r[4].length,7);\r\n\t\tff = frac(aval, Math.pow(10,ri)-1, false);\r\n\t\to = \"\" + sign;\r\n\t\toa = write_num(\"n\", r[1], ff[1]);\r\n\t\tif(oa[oa.length-1] == \" \") oa = oa.substr(0,oa.length-1) + \"0\";\r\n\t\to += oa + r[2] + \"/\" + r[3];\r\n\t\toa = rpad_(ff[2],ri);\r\n\t\tif(oa.length < r[4].length) oa = hashq(r[4].substr(r[4].length-oa.length)) + oa;\r\n\t\to += oa;\r\n\t\treturn o;\r\n\t}\r\n\tif((r = fmt.match(/^# ([#0?]+)( ?)\\/( ?)([#0?]+)/)) !== null) {\r\n\t\tri = Math.min(Math.max(r[1].length, r[4].length),7);\r\n\t\tff = frac(aval, Math.pow(10,ri)-1, true);\r\n\t\treturn sign + (ff[0]||(ff[1] ? \"\" : \"0\")) + \" \" + (ff[1] ? pad_(ff[1],ri) + r[2] + \"/\" + r[3] + rpad_(ff[2],ri): fill(\" \", 2*ri+1 + r[2].length + r[3].length));\r\n\t}\r\n\tif((r = fmt.match(/^[#0?]+$/)) !== null) {\r\n\t\to = pad0r(val, 0);\r\n\t\tif(fmt.length <= o.length) return o;\r\n\t\treturn hashq(fmt.substr(0,fmt.length-o.length)) + o;\r\n\t}\r\n  if((r = fmt.match(/^([#0?]+)\\.([#0]+)$/)) !== null) {\r\n\t\to = \"\" + val.toFixed(Math.min(r[2].length,10)).replace(/([^0])0+$/,\"$1\");\r\n\t\tri = o.indexOf(\".\");\r\n\t\tvar lres = fmt.indexOf(\".\") - ri, rres = fmt.length - o.length - lres;\r\n\t\treturn hashq(fmt.substr(0,lres) + o + fmt.substr(fmt.length-rres));\r\n\t}\r\n\tif((r = fmt.match(/^00,000\\.([#0]*0)$/)) !== null) {\r\n\t\tri = dec(val, r[1].length);\r\n\t\treturn val < 0 ? \"-\" + write_num_flt(type, fmt, -val) : commaify(flr(val)).replace(/^\\d,\\d{3}$/,\"0$&\").replace(/^\\d*$/,function($$) { return \"00,\" + ($$.length < 3 ? pad0(0,3-$$.length) : \"\") + $$; }) + \".\" + pad0(ri,r[1].length);\r\n\t}\r\n\tswitch(fmt) {\r\n\t\tcase \"#,###\": var x = commaify(pad0r(aval,0)); return x !== \"0\" ? sign + x : \"\";\r\n\t\tdefault:\r\n\t}\r\n\tthrow new Error(\"unsupported format |\" + fmt + \"|\");\r\n}\r\nfunction write_num_cm2(type, fmt, val){\r\n\tvar idx = fmt.length - 1;\r\n\twhile(fmt.charCodeAt(idx-1) === 44) --idx;\r\n\treturn write_num(type, fmt.substr(0,idx), val / Math.pow(10,3*(fmt.length-idx)));\r\n}\r\nfunction write_num_pct2(type, fmt, val){\r\n\tvar sfmt = fmt.replace(pct1,\"\"), mul = fmt.length - sfmt.length;\r\n\treturn write_num(type, sfmt, val * Math.pow(10,2*mul)) + fill(\"%\",mul);\r\n}\r\nfunction write_num_exp2(fmt, val){\r\n\tvar o;\r\n\tvar idx = fmt.indexOf(\"E\") - fmt.indexOf(\".\") - 1;\r\n\tif(fmt.match(/^#+0.0E\\+0$/)) {\r\n\t\tvar period = fmt.indexOf(\".\"); if(period === -1) period=fmt.indexOf('E');\r\n\t\tvar ee = Math.floor(Math.log(Math.abs(val))*Math.LOG10E)%period;\r\n\t\tif(ee < 0) ee += period;\r\n\t\to = (val/Math.pow(10,ee)).toPrecision(idx+1+(period+ee)%period);\r\n\t\tif(!o.match(/[Ee]/)) {\r\n\t\t\tvar fakee = Math.floor(Math.log(Math.abs(val))*Math.LOG10E);\r\n\t\t\tif(o.indexOf(\".\") === -1) o = o[0] + \".\" + o.substr(1) + \"E+\" + (fakee - o.length+ee);\r\n\t\t\telse o += \"E+\" + (fakee - ee);\r\n\t\t\to = o.replace(/\\+-/,\"-\");\r\n\t\t}\r\n\t\to = o.replace(/^([+-]?)(\\d*)\\.(\\d*)[Ee]/,function($$,$1,$2,$3) { return $1 + $2 + $3.substr(0,(period+ee)%period) + \".\" + $3.substr(ee) + \"E\"; });\r\n\t} else o = val.toExponential(idx);\r\n\tif(fmt.match(/E\\+00$/) && o.match(/e[+-]\\d$/)) o = o.substr(0,o.length-1) + \"0\" + o[o.length-1];\r\n\tif(fmt.match(/E\\-/) && o.match(/e\\+/)) o = o.replace(/e\\+/,\"e\");\r\n\treturn o.replace(\"e\",\"E\");\r\n}\r\nfunction write_num_int(type, fmt, val) {\r\n\tif(type.charCodeAt(0) === 40 && !fmt.match(closeparen)) {\r\n\t\tvar ffmt = fmt.replace(/\\( */,\"\").replace(/ \\)/,\"\").replace(/\\)/,\"\");\r\n\t\tif(val >= 0) return write_num_int('n', ffmt, val);\r\n\t\treturn '(' + write_num_int('n', ffmt, -val) + ')';\r\n\t}\r\n\tif(fmt.charCodeAt(fmt.length - 1) === 44) return write_num_cm2(type, fmt, val);\r\n\tif(fmt.indexOf('%') !== -1) return write_num_pct2(type, fmt, val);\r\n\tif(fmt.indexOf('E') !== -1) return write_num_exp2(fmt, val);\r\n\tif(fmt.charCodeAt(0) === 36) return \"$\"+write_num_int(type,fmt.substr(fmt[1]==' '?2:1),val);\r\n\tvar o;\r\n\tvar r, ri, ff, aval = Math.abs(val), sign = val < 0 ? \"-\" : \"\";\r\n\tif(fmt.match(/^00+$/)) return sign + pad0(aval,fmt.length);\r\n\tif(fmt.match(/^[#?]+$/)) {\r\n\t\to = (\"\"+val); if(val === 0) o = \"\";\r\n\t\treturn o.length > fmt.length ? o : hashq(fmt.substr(0,fmt.length-o.length)) + o;\r\n\t}\r\n\tif((r = fmt.match(frac1)) !== null) return write_num_f2(r, aval, sign);\r\n\tif(fmt.match(/^#+0+$/) !== null) return sign + pad0(aval,fmt.length - fmt.indexOf(\"0\"));\r\n\tif((r = fmt.match(dec1)) !== null) {\r\n\t\to = (\"\"+val).replace(/^([^\\.]+)$/,\"$1.\"+r[1]).replace(/\\.$/,\".\"+r[1]).replace(/\\.(\\d*)$/,function($$, $1) { return \".\" + $1 + fill(\"0\", r[1].length-$1.length); });\r\n\t\treturn fmt.indexOf(\"0.\") !== -1 ? o : o.replace(/^0\\./,\".\");\r\n\t}\r\n\tfmt = fmt.replace(/^#+([0.])/, \"$1\");\r\n\tif((r = fmt.match(/^(0*)\\.(#*)$/)) !== null) {\r\n\t\treturn sign + (\"\"+aval).replace(/\\.(\\d*[1-9])0*$/,\".$1\").replace(/^(-?\\d*)$/,\"$1.\").replace(/^0\\./,r[1].length?\"0.\":\".\");\r\n\t}\r\n\tif((r = fmt.match(/^#,##0(\\.?)$/)) !== null) return sign + commaify((\"\"+aval));\r\n\tif((r = fmt.match(/^#,##0\\.([#0]*0)$/)) !== null) {\r\n\t\treturn val < 0 ? \"-\" + write_num_int(type, fmt, -val) : commaify((\"\"+val)) + \".\" + fill('0',r[1].length);\r\n\t}\r\n\tif((r = fmt.match(/^#,#*,#0/)) !== null) return write_num_int(type,fmt.replace(/^#,#*,/,\"\"),val);\r\n\tif((r = fmt.match(/^([0#]+)(\\\\?-([0#]+))+$/)) !== null) {\r\n\t\to = _strrev(write_num_int(type, fmt.replace(/[\\\\-]/g,\"\"), val));\r\n\t\tri = 0;\r\n\t\treturn _strrev(_strrev(fmt.replace(/\\\\/g,\"\")).replace(/[0#]/g,function(x){return ri<o.length?o[ri++]:x==='0'?'0':\"\";}));\r\n\t}\r\n\tif(fmt.match(phone) !== null) {\r\n\t\to = write_num_int(type, \"##########\", val);\r\n\t\treturn \"(\" + o.substr(0,3) + \") \" + o.substr(3, 3) + \"-\" + o.substr(6);\r\n\t}\r\n\tvar oa = \"\";\r\n\tif((r = fmt.match(/^([#0?]+)( ?)\\/( ?)([#0?]+)/)) !== null) {\r\n\t\tri = Math.min(r[4].length,7);\r\n\t\tff = frac(aval, Math.pow(10,ri)-1, false);\r\n\t\to = \"\" + sign;\r\n\t\toa = write_num(\"n\", r[1], ff[1]);\r\n\t\tif(oa[oa.length-1] == \" \") oa = oa.substr(0,oa.length-1) + \"0\";\r\n\t\to += oa + r[2] + \"/\" + r[3];\r\n\t\toa = rpad_(ff[2],ri);\r\n\t\tif(oa.length < r[4].length) oa = hashq(r[4].substr(r[4].length-oa.length)) + oa;\r\n\t\to += oa;\r\n\t\treturn o;\r\n\t}\r\n\tif((r = fmt.match(/^# ([#0?]+)( ?)\\/( ?)([#0?]+)/)) !== null) {\r\n\t\tri = Math.min(Math.max(r[1].length, r[4].length),7);\r\n\t\tff = frac(aval, Math.pow(10,ri)-1, true);\r\n\t\treturn sign + (ff[0]||(ff[1] ? \"\" : \"0\")) + \" \" + (ff[1] ? pad_(ff[1],ri) + r[2] + \"/\" + r[3] + rpad_(ff[2],ri): fill(\" \", 2*ri+1 + r[2].length + r[3].length));\r\n\t}\r\n\tif((r = fmt.match(/^[#0?]+$/)) !== null) {\r\n\t\to = \"\" + val;\r\n\t\tif(fmt.length <= o.length) return o;\r\n\t\treturn hashq(fmt.substr(0,fmt.length-o.length)) + o;\r\n\t}\r\n\tif((r = fmt.match(/^([#0]+)\\.([#0]+)$/)) !== null) {\r\n\t\to = \"\" + val.toFixed(Math.min(r[2].length,10)).replace(/([^0])0+$/,\"$1\");\r\n\t\tri = o.indexOf(\".\");\r\n\t\tvar lres = fmt.indexOf(\".\") - ri, rres = fmt.length - o.length - lres;\r\n\t\treturn hashq(fmt.substr(0,lres) + o + fmt.substr(fmt.length-rres));\r\n\t}\r\n\tif((r = fmt.match(/^00,000\\.([#0]*0)$/)) !== null) {\r\n\t\treturn val < 0 ? \"-\" + write_num_int(type, fmt, -val) : commaify(\"\"+val).replace(/^\\d,\\d{3}$/,\"0$&\").replace(/^\\d*$/,function($$) { return \"00,\" + ($$.length < 3 ? pad0(0,3-$$.length) : \"\") + $$; }) + \".\" + pad0(0,r[1].length);\r\n\t}\r\n\tswitch(fmt) {\r\n\t\tcase \"#,###\": var x = commaify(\"\"+aval); return x !== \"0\" ? sign + x : \"\";\r\n\t\tdefault:\r\n\t}\r\n\tthrow new Error(\"unsupported format |\" + fmt + \"|\");\r\n}\r\nreturn function write_num(type, fmt, val) {\r\n\treturn (val|0) === val ? write_num_int(type, fmt, val) : write_num_flt(type, fmt, val);\r\n};})();\r\nfunction split_fmt(fmt) {\r\n\tvar out = [];\r\n\tvar in_str = false, cc;\r\n\tfor(var i = 0, j = 0; i < fmt.length; ++i) switch((cc=fmt.charCodeAt(i))) {\r\n\t\tcase 34: /* '\"' */\r\n\t\t\tin_str = !in_str; break;\r\n\t\tcase 95: case 42: case 92: /* '_' '*' '\\\\' */\r\n\t\t\t++i; break;\r\n\t\tcase 59: /* ';' */\r\n\t\t\tout[out.length] = fmt.substr(j,i-j);\r\n\t\t\tj = i+1;\r\n\t}\r\n\tout[out.length] = fmt.substr(j);\r\n\tif(in_str === true) throw new Error(\"Format |\" + fmt + \"| unterminated string \");\r\n\treturn out;\r\n}\r\nSSF._split = split_fmt;\r\nvar abstime = /\\[[HhMmSs]*\\]/;\r\nfunction eval_fmt(fmt, v, opts, flen) {\r\n\tvar out = [], o = \"\", i = 0, c = \"\", lst='t', q, dt, j, cc;\r\n\tvar hr='H';\r\n\t/* Tokenize */\r\n\twhile(i < fmt.length) {\r\n\t\tswitch((c = fmt[i])) {\r\n\t\t\tcase 'G': /* General */\r\n\t\t\t\tif(!isgeneral(fmt, i)) throw new Error('unrecognized character ' + c + ' in ' +fmt);\r\n\t\t\t\tout[out.length] = {t:'G', v:'General'}; i+=7; break;\r\n\t\t\tcase '\"': /* Literal text */\r\n\t\t\t\tfor(o=\"\";(cc=fmt.charCodeAt(++i)) !== 34 && i < fmt.length;) o += String.fromCharCode(cc);\r\n\t\t\t\tout[out.length] = {t:'t', v:o}; ++i; break;\r\n\t\t\tcase '\\\\': var w = fmt[++i], t = (w === \"(\" || w === \")\") ? w : 't';\r\n\t\t\t\tout[out.length] = {t:t, v:w}; ++i; break;\r\n\t\t\tcase '_': out[out.length] = {t:'t', v:\" \"}; i+=2; break;\r\n\t\t\tcase '@': /* Text Placeholder */\r\n\t\t\t\tout[out.length] = {t:'T', v:v}; ++i; break;\r\n\t\t\tcase 'B': case 'b':\r\n\t\t\t\tif(fmt[i+1] === \"1\" || fmt[i+1] === \"2\") {\r\n          if(dt==null) { dt=parse_date_code(v, opts, fmt[i+1] === \"2\"); if(dt==null) return \"\"; }\r\n\t\t\t\t\tout[out.length] = {t:'X', v:fmt.substr(i,2)}; lst = c; i+=2; break;\r\n\t\t\t\t}\r\n\t\t\t\t/* falls through */\r\n\t\t\tcase 'M': case 'D': case 'Y': case 'H': case 'S': case 'E':\r\n\t\t\t\tc = c.toLowerCase();\r\n\t\t\t\t/* falls through */\r\n\t\t\tcase 'm': case 'd': case 'y': case 'h': case 's': case 'e': case 'g':\r\n\t\t\t\tif(v < 0) return \"\";\r\n\t\t\t\tif(dt==null) { dt=parse_date_code(v, opts); if(dt==null) return \"\"; }\r\n\t\t\t\to = c; while(++i<fmt.length && fmt[i].toLowerCase() === c) o+=c;\r\n\t\t\t\tif(c === 'm' && lst.toLowerCase() === 'h') c = 'M'; /* m = minute */\r\n\t\t\t\tif(c === 'h') c = hr;\r\n\t\t\t\tout[out.length] = {t:c, v:o}; lst = c; break;\r\n\t\t\tcase 'A':\r\n\t\t\t\tq={t:c, v:\"A\"};\r\n\t\t\t\tif(dt==null) dt=parse_date_code(v, opts);\r\n        if(fmt.substr(i, 3) === \"A/P\") { if(dt!=null) q.v = dt.H >= 12 ? \"P\" : \"A\"; q.t = 'T'; hr='h';i+=3;}\r\n        else if(fmt.substr(i,5) === \"AM/PM\") { if(dt!=null) q.v = dt.H >= 12 ? \"PM\" : \"AM\"; q.t = 'T'; i+=5; hr='h'; }\r\n\t\t\t\telse { q.t = \"t\"; ++i; }\r\n\t\t\t\tif(dt==null && q.t === 'T') return \"\";\r\n\t\t\t\tout[out.length] = q; lst = c; break;\r\n\t\t\tcase '[':\r\n\t\t\t\to = c;\r\n\t\t\t\twhile(fmt[i++] !== ']' && i < fmt.length) o += fmt[i];\r\n\t\t\t\tif(o.substr(-1) !== ']') throw 'unterminated \"[\" block: |' + o + '|';\r\n\t\t\t\tif(o.match(abstime)) {\r\n\t\t\t\t\tif(dt==null) { dt=parse_date_code(v, opts); if(dt==null) return \"\"; }\r\n\t\t\t\t\tout[out.length] = {t:'Z', v:o.toLowerCase()};\r\n\t\t\t\t} else { o=\"\"; }\r\n\t\t\t\tbreak;\r\n\t\t\t/* Numbers */\r\n\t\t\tcase '.':\r\n\t\t\t\tif(dt != null) {\r\n\t\t\t\t\to = c; while((c=fmt[++i]) === \"0\") o += c;\r\n\t\t\t\t\tout[out.length] = {t:'s', v:o}; break;\r\n\t\t\t\t}\r\n\t\t\t\t/* falls through */\r\n\t\t\tcase '0': case '#':\r\n\t\t\t\to = c; while(\"0#?.,E+-%\".indexOf(c=fmt[++i]) > -1 || c=='\\\\' && fmt[i+1] == \"-\" && \"0#\".indexOf(fmt[i+2])>-1) o += c;\r\n\t\t\t\tout[out.length] = {t:'n', v:o}; break;\r\n\t\t\tcase '?':\r\n\t\t\t\to = c; while(fmt[++i] === c) o+=c;\r\n\t\t\t\tq={t:c, v:o}; out[out.length] = q; lst = c; break;\r\n\t\t\tcase '*': ++i; if(fmt[i] == ' ' || fmt[i] == '*') ++i; break; // **\r\n\t\t\tcase '(': case ')': out[out.length] = {t:(flen===1?'t':c), v:c}; ++i; break;\r\n\t\t\tcase '1': case '2': case '3': case '4': case '5': case '6': case '7': case '8': case '9':\r\n\t\t\t\to = c; while(\"0123456789\".indexOf(fmt[++i]) > -1) o+=fmt[i];\r\n\t\t\t\tout[out.length] = {t:'D', v:o}; break;\r\n\t\t\tcase ' ': out[out.length] = {t:c, v:c}; ++i; break;\r\n\t\t\tdefault:\r\n\t\t\t\tif(\",$-+/():!^&'~{}<>=€acfijklopqrtuvwxz\".indexOf(c) === -1) throw new Error('unrecognized character ' + c + ' in ' + fmt);\r\n\t\t\t\tout[out.length] = {t:'t', v:c}; ++i; break;\r\n\t\t}\r\n\t}\r\n\tvar bt = 0, ss0 = 0, ssm;\r\n\tfor(i=out.length-1, lst='t'; i >= 0; --i) {\r\n\t\tswitch(out[i].t) {\r\n\t\t\tcase 'h': case 'H': out[i].t = hr; lst='h'; if(bt < 1) bt = 1; break;\r\n\t\t\tcase 's':\r\n\t\t\t\tif((ssm=out[i].v.match(/\\.0+$/))) ss0=Math.max(ss0,ssm[0].length-1);\r\n\t\t\t\tif(bt < 3) bt = 3;\r\n\t\t\t/* falls through */\r\n\t\t\tcase 'd': case 'y': case 'M': case 'e': lst=out[i].t; break;\r\n\t\t\tcase 'm': if(lst === 's') { out[i].t = 'M'; if(bt < 2) bt = 2; } break;\r\n\t\t\tcase 'X': if(out[i].v === \"B2\");\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'Z':\r\n\t\t\t\tif(bt < 1 && out[i].v.match(/[Hh]/)) bt = 1;\r\n\t\t\t\tif(bt < 2 && out[i].v.match(/[Mm]/)) bt = 2;\r\n\t\t\t\tif(bt < 3 && out[i].v.match(/[Ss]/)) bt = 3;\r\n\t\t}\r\n\t}\r\n\tswitch(bt) {\r\n\t\tcase 0: break;\r\n\t\tcase 1:\r\n\t\t\tif(dt.u >= 0.5) { dt.u = 0; ++dt.S; }\r\n\t\t\tif(dt.S >=  60) { dt.S = 0; ++dt.M; }\r\n\t\t\tif(dt.M >=  60) { dt.M = 0; ++dt.H; }\r\n\t\t\tbreak;\r\n\t\tcase 2:\r\n\t\t\tif(dt.u >= 0.5) { dt.u = 0; ++dt.S; }\r\n\t\t\tif(dt.S >=  60) { dt.S = 0; ++dt.M; }\r\n\t\t\tbreak;\r\n\t}\r\n\t/* replace fields */\r\n\tvar nstr = \"\", jj;\r\n\tfor(i=0; i < out.length; ++i) {\r\n\t\tswitch(out[i].t) {\r\n\t\t\tcase 't': case 'T': case ' ': case 'D': break;\r\n\t\t\tcase 'X': out[i] = undefined; break;\r\n\t\t\tcase 'd': case 'm': case 'y': case 'h': case 'H': case 'M': case 's': case 'e': case 'b': case 'Z':\r\n\t\t\t\tout[i].v = write_date(out[i].t.charCodeAt(0), out[i].v, dt, ss0);\r\n\t\t\t\tout[i].t = 't'; break;\r\n\t\t\tcase 'n': case '(': case '?':\r\n\t\t\t\tjj = i+1;\r\n\t\t\t\twhile(out[jj] != null && (\r\n\t\t\t\t\t(c=out[jj].t) === \"?\" || c === \"D\" ||\r\n\t\t\t\t\t(c === \" \" || c === \"t\") && out[jj+1] != null && (out[jj+1].t === '?' || out[jj+1].t === \"t\" && out[jj+1].v === '/') ||\r\n\t\t\t\t\tout[i].t === '(' && (c === ' ' || c === 'n' || c === ')') ||\r\n\t\t\t\t\tc === 't' && (out[jj].v === '/' || '$€'.indexOf(out[jj].v) > -1 || out[jj].v === ' ' && out[jj+1] != null && out[jj+1].t == '?')\r\n\t\t\t\t)) {\r\n\t\t\t\t\tout[i].v += out[jj].v;\r\n\t\t\t\t\tout[jj] = undefined; ++jj;\r\n\t\t\t\t}\r\n\t\t\t\tnstr += out[i].v;\r\n\t\t\t\ti = jj-1; break;\r\n\t\t\tcase 'G': out[i].t = 't'; out[i].v = general_fmt(v,opts); break;\r\n\t\t}\r\n\t}\r\n\tvar vv = \"\", myv, ostr;\r\n\tif(nstr.length > 0) {\r\n\t\tmyv = (v<0&&nstr.charCodeAt(0) === 45 ? -v : v); /* '-' */\r\n\t\tostr = write_num(nstr.charCodeAt(0) === 40 ? '(' : 'n', nstr, myv); /* '(' */\r\n\t\tjj=ostr.length-1;\r\n\t\tvar decpt = out.length;\r\n\t\tfor(i=0; i < out.length; ++i) if(out[i] != null && out[i].v.indexOf(\".\") > -1) { decpt = i; break; }\r\n\t\tvar lasti=out.length;\r\n\t\tif(decpt === out.length && ostr.indexOf(\"E\") === -1) {\r\n\t\t\tfor(i=out.length-1; i>= 0;--i) {\r\n\t\t\t\tif(out[i] == null || 'n?('.indexOf(out[i].t) === -1) continue;\r\n\t\t\t\tif(jj>=out[i].v.length-1) { jj -= out[i].v.length; out[i].v = ostr.substr(jj+1, out[i].v.length); }\r\n\t\t\t\telse if(jj < 0) out[i].v = \"\";\r\n\t\t\t\telse { out[i].v = ostr.substr(0, jj+1); jj = -1; }\r\n\t\t\t\tout[i].t = 't';\r\n\t\t\t\tlasti = i;\r\n\t\t\t}\r\n\t\t\tif(jj>=0 && lasti<out.length) out[lasti].v = ostr.substr(0,jj+1) + out[lasti].v;\r\n\t\t}\r\n\t\telse if(decpt !== out.length && ostr.indexOf(\"E\") === -1) {\r\n\t\t\tjj = ostr.indexOf(\".\")-1;\r\n\t\t\tfor(i=decpt; i>= 0; --i) {\r\n\t\t\t\tif(out[i] == null || 'n?('.indexOf(out[i].t) === -1) continue;\r\n\t\t\t\tj=out[i].v.indexOf(\".\")>-1&&i===decpt?out[i].v.indexOf(\".\")-1:out[i].v.length-1;\r\n\t\t\t\tvv = out[i].v.substr(j+1);\r\n\t\t\t\tfor(; j>=0; --j) {\r\n\t\t\t\t\tif(jj>=0 && (out[i].v[j] === \"0\" || out[i].v[j] === \"#\")) vv = ostr[jj--] + vv;\r\n\t\t\t\t}\r\n\t\t\t\tout[i].v = vv;\r\n\t\t\t\tout[i].t = 't';\r\n\t\t\t\tlasti = i;\r\n\t\t\t}\r\n\t\t\tif(jj>=0 && lasti<out.length) out[lasti].v = ostr.substr(0,jj+1) + out[lasti].v;\r\n\t\t\tjj = ostr.indexOf(\".\")+1;\r\n\t\t\tfor(i=decpt; i<out.length; ++i) {\r\n\t\t\t\tif(out[i] == null || 'n?('.indexOf(out[i].t) === -1 && i !== decpt ) continue;\r\n\t\t\t\tj=out[i].v.indexOf(\".\")>-1&&i===decpt?out[i].v.indexOf(\".\")+1:0;\r\n\t\t\t\tvv = out[i].v.substr(0,j);\r\n\t\t\t\tfor(; j<out[i].v.length; ++j) {\r\n\t\t\t\t\tif(jj<ostr.length) vv += ostr[jj++];\r\n\t\t\t\t}\r\n\t\t\t\tout[i].v = vv;\r\n\t\t\t\tout[i].t = 't';\r\n\t\t\t\tlasti = i;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tfor(i=0; i<out.length; ++i) if(out[i] != null && 'n(?'.indexOf(out[i].t)>-1) {\r\n\t\tmyv = (flen >1 && v < 0 && i>0 && out[i-1].v === \"-\" ? -v:v);\r\n\t\tout[i].v = write_num(out[i].t, out[i].v, myv);\r\n\t\tout[i].t = 't';\r\n\t}\r\n\tvar retval = \"\";\r\n\tfor(i=0; i !== out.length; ++i) if(out[i] != null) retval += out[i].v;\r\n\treturn retval;\r\n}\r\nSSF._eval = eval_fmt;\r\nvar cfregex = /\\[[=<>]/;\r\nvar cfregex2 = /\\[([=<>]*)(-?\\d+\\.?\\d*)\\]/;\r\nfunction chkcond(v, rr) {\r\n\tif(rr == null) return false;\r\n\tvar thresh = parseFloat(rr[2]);\r\n\tswitch(rr[1]) {\r\n\t\tcase \"=\":  if(v == thresh) return true; break;\r\n\t\tcase \">\":  if(v >  thresh) return true; break;\r\n\t\tcase \"<\":  if(v <  thresh) return true; break;\r\n\t\tcase \"<>\": if(v != thresh) return true; break;\r\n\t\tcase \">=\": if(v >= thresh) return true; break;\r\n\t\tcase \"<=\": if(v <= thresh) return true; break;\r\n\t}\r\n\treturn false;\r\n}\r\nfunction choose_fmt(f, v) {\r\n\tvar fmt = split_fmt(f);\r\n\tvar l = fmt.length, lat = fmt[l-1].indexOf(\"@\");\r\n\tif(l<4 && lat>-1) --l;\r\n\tif(fmt.length > 4) throw \"cannot find right format for |\" + fmt + \"|\";\r\n\tif(typeof v !== \"number\") return [4, fmt.length === 4 || lat>-1?fmt[fmt.length-1]:\"@\"];\r\n\tswitch(fmt.length) {\r\n\t\tcase 1: fmt = lat>-1 ? [\"General\", \"General\", \"General\", fmt[0]] : [fmt[0], fmt[0], fmt[0], \"@\"]; break;\r\n\t\tcase 2: fmt = lat>-1 ? [fmt[0], fmt[0], fmt[0], fmt[1]] : [fmt[0], fmt[1], fmt[0], \"@\"]; break;\r\n\t\tcase 3: fmt = lat>-1 ? [fmt[0], fmt[1], fmt[0], fmt[2]] : [fmt[0], fmt[1], fmt[2], \"@\"]; break;\r\n\t\tcase 4: break;\r\n\t}\r\n\tvar ff = v > 0 ? fmt[0] : v < 0 ? fmt[1] : fmt[2];\r\n\tif(fmt[0].indexOf(\"[\") === -1 && fmt[1].indexOf(\"[\") === -1) return [l, ff];\r\n\tif(fmt[0].match(cfregex) != null || fmt[1].match(cfregex) != null) {\r\n\t\tvar m1 = fmt[0].match(cfregex2);\r\n\t\tvar m2 = fmt[1].match(cfregex2);\r\n\t\treturn chkcond(v, m1) ? [l, fmt[0]] : chkcond(v, m2) ? [l, fmt[1]] : [l, fmt[m1 != null && m2 != null ? 2 : 1]];\r\n\t}\r\n\treturn [l, ff];\r\n}\r\nfunction format(fmt,v,o) {\r\n\tfixopts(o != null ? o : (o=[]));\r\n\tvar sfmt = \"\";\r\n\tswitch(typeof fmt) {\r\n\t\tcase \"string\": sfmt = fmt; break;\r\n\t\tcase \"number\": sfmt = (o.table != null ? o.table : table_fmt)[fmt]; break;\r\n\t}\r\n\tif(isgeneral(sfmt,0)) return general_fmt(v, o);\r\n\tvar f = choose_fmt(sfmt, v);\r\n\tif(isgeneral(f[1])) return general_fmt(v, o);\r\n\tif(v === true) v = \"TRUE\"; else if(v === false) v = \"FALSE\";\r\n\telse if(v === \"\" || v == null) return \"\";\r\n\treturn eval_fmt(f[1], v, o, f[0]);\r\n}\r\nSSF._table = table_fmt;\r\nSSF.load = function load_entry(fmt, idx) { table_fmt[idx] = fmt; };\r\nSSF.format = format;\r\nSSF.get_table = function get_table() { return table_fmt; };\r\nSSF.load_table = function load_table(tbl) { for(var i=0; i!=0x0188; ++i) if(tbl[i] !== undefined) SSF.load(tbl[i], i); };\r\n};\r\nmake_ssf(SSF);\r\n/* map from xlml named formats to SSF TODO: localize */\r\nvar XLMLFormatMap = {\r\n\t\"General Number\": \"General\",\r\n\t\"General Date\": SSF._table[22],\r\n\t\"Long Date\": \"dddd, mmmm dd, yyyy\",\r\n\t\"Medium Date\": SSF._table[15],\r\n\t\"Short Date\": SSF._table[14],\r\n\t\"Long Time\": SSF._table[19],\r\n\t\"Medium Time\": SSF._table[18],\r\n\t\"Short Time\": SSF._table[20],\r\n\t\"Currency\": '\"$\"#,##0.00_);[Red]\\\\(\"$\"#,##0.00\\\\)',\r\n\t\"Fixed\": SSF._table[2],\r\n\t\"Standard\": SSF._table[4],\r\n\t\"Percent\": SSF._table[10],\r\n\t\"Scientific\": SSF._table[11],\r\n\t\"Yes/No\": '\"Yes\";\"Yes\";\"No\";@',\r\n\t\"True/False\": '\"True\";\"True\";\"False\";@',\r\n\t\"On/Off\": '\"Yes\";\"Yes\";\"No\";@'\r\n};\r\n\r\nvar DO_NOT_EXPORT_CFB = true;\r\n/* cfb.js (C) 2013-2014 SheetJS -- http://sheetjs.com */\r\n/* vim: set ts=2: */\r\n/*jshint eqnull:true */\r\n\r\n/* [MS-CFB] v20130118 */\r\nvar CFB = (function _CFB(){\r\nvar exports = {};\r\nexports.version = '0.10.2';\r\nfunction parse(file) {\r\nvar mver = 3; // major version\r\nvar ssz = 512; // sector size\r\nvar nmfs = 0; // number of mini FAT sectors\r\nvar ndfs = 0; // number of DIFAT sectors\r\nvar dir_start = 0; // first directory sector location\r\nvar minifat_start = 0; // first mini FAT sector location\r\nvar difat_start = 0; // first mini FAT sector location\r\n\r\nvar fat_addrs = []; // locations of FAT sectors\r\n\r\n/* [MS-CFB] 2.2 Compound File Header */\r\nvar blob = file.slice(0,512);\r\nprep_blob(blob, 0);\r\n\r\n/* major version */\r\nvar mv = check_get_mver(blob);\r\nmver = mv[0];\r\nswitch(mver) {\r\n\tcase 3: ssz = 512; break; case 4: ssz = 4096; break;\r\n\tdefault: throw \"Major Version: Expected 3 or 4 saw \" + mver;\r\n}\r\n\r\n/* reprocess header */\r\nif(ssz !== 512) { blob = file.slice(0,ssz); prep_blob(blob, 28 /* blob.l */); }\r\n/* Save header for final object */\r\nvar header = file.slice(0,ssz);\r\n\r\ncheck_shifts(blob, mver);\r\n\r\n// Number of Directory Sectors\r\nvar nds = blob.read_shift(4, 'i');\r\nif(mver === 3 && nds !== 0) throw '# Directory Sectors: Expected 0 saw ' + nds;\r\n\r\n// Number of FAT Sectors\r\n//var nfs = blob.read_shift(4, 'i');\r\nblob.l += 4;\r\n\r\n// First Directory Sector Location\r\ndir_start = blob.read_shift(4, 'i');\r\n\r\n// Transaction Signature\r\nblob.l += 4;\r\n\r\n// Mini Stream Cutoff Size\r\nblob.chk('00100000', 'Mini Stream Cutoff Size: ');\r\n\r\n// First Mini FAT Sector Location\r\nminifat_start = blob.read_shift(4, 'i');\r\n\r\n// Number of Mini FAT Sectors\r\nnmfs = blob.read_shift(4, 'i');\r\n\r\n// First DIFAT sector location\r\ndifat_start = blob.read_shift(4, 'i');\r\n\r\n// Number of DIFAT Sectors\r\nndfs = blob.read_shift(4, 'i');\r\n\r\n// Grab FAT Sector Locations\r\nfor(var q, j = 0; j < 109; ++j) { /* 109 = (512 - blob.l)>>>2; */\r\n\tq = blob.read_shift(4, 'i');\r\n\tif(q<0) break;\r\n\tfat_addrs[j] = q;\r\n}\r\n\r\n/** Break the file up into sectors */\r\nvar sectors = sectorify(file, ssz);\r\n\r\nsleuth_fat(difat_start, ndfs, sectors, ssz, fat_addrs);\r\n\r\n/** Chains */\r\nvar sector_list = make_sector_list(sectors, dir_start, fat_addrs, ssz);\r\n\r\nsector_list[dir_start].name = \"!Directory\";\r\nif(nmfs > 0 && minifat_start !== ENDOFCHAIN) sector_list[minifat_start].name = \"!MiniFAT\";\r\nsector_list[fat_addrs[0]].name = \"!FAT\";\r\nsector_list.fat_addrs = fat_addrs;\r\nsector_list.ssz = ssz;\r\n\r\n/* [MS-CFB] 2.6.1 Compound File Directory Entry */\r\nvar files = {}, Paths = [], FileIndex = [], FullPaths = [], FullPathDir = {};\r\nread_directory(dir_start, sector_list, sectors, Paths, nmfs, files, FileIndex);\r\n\r\nbuild_full_paths(FileIndex, FullPathDir, FullPaths, Paths);\r\n\r\nvar root_name = Paths.shift();\r\nPaths.root = root_name;\r\n\r\n/* [MS-CFB] 2.6.4 (Unicode 3.0.1 case conversion) */\r\nvar find_path = make_find_path(FullPaths, Paths, FileIndex, files, root_name);\r\n\r\nreturn {\r\n\traw: {header: header, sectors: sectors},\r\n\tFileIndex: FileIndex,\r\n\tFullPaths: FullPaths,\r\n\tFullPathDir: FullPathDir,\r\n\tfind: find_path\r\n};\r\n} // parse\r\n\r\n/* [MS-CFB] 2.2 Compound File Header -- read up to major version */\r\nfunction check_get_mver(blob) {\r\n\t// header signature 8\r\n\tblob.chk(HEADER_SIGNATURE, 'Header Signature: ');\r\n\r\n\t// clsid 16\r\n\tblob.chk(HEADER_CLSID, 'CLSID: ');\r\n\r\n\t// minor version 2\r\n\tvar mver = blob.read_shift(2, 'u');\r\n\r\n\treturn [blob.read_shift(2,'u'), mver];\r\n}\r\nfunction check_shifts(blob, mver) {\r\n\tvar shift = 0x09;\r\n\r\n\t// Byte Order\r\n\tblob.chk('feff', 'Byte Order: ');\r\n\r\n\t// Sector Shift\r\n\tswitch((shift = blob.read_shift(2))) {\r\n\t\tcase 0x09: if(mver !== 3) throw 'MajorVersion/SectorShift Mismatch'; break;\r\n\t\tcase 0x0c: if(mver !== 4) throw 'MajorVersion/SectorShift Mismatch'; break;\r\n\t\tdefault: throw 'Sector Shift: Expected 9 or 12 saw ' + shift;\r\n\t}\r\n\r\n\t// Mini Sector Shift\r\n\tblob.chk('0600', 'Mini Sector Shift: ');\r\n\r\n\t// Reserved\r\n\tblob.chk('000000000000', 'Reserved: ');\r\n}\r\n\r\n/** Break the file up into sectors */\r\nfunction sectorify(file, ssz) {\r\n\tvar nsectors = Math.ceil(file.length/ssz)-1;\r\n\tvar sectors = new Array(nsectors);\r\n\tfor(var i=1; i < nsectors; ++i) sectors[i-1] = file.slice(i*ssz,(i+1)*ssz);\r\n\tsectors[nsectors-1] = file.slice(nsectors*ssz);\r\n\treturn sectors;\r\n}\r\n\r\n/* [MS-CFB] 2.6.4 Red-Black Tree */\r\nfunction build_full_paths(FI, FPD, FP, Paths) {\r\n\tvar i = 0, L = 0, R = 0, C = 0, j = 0, pl = Paths.length;\r\n\tvar dad = new Array(pl), q = new Array(pl);\r\n\r\n\tfor(; i < pl; ++i) { dad[i]=q[i]=i; FP[i]=Paths[i]; }\r\n\r\n\tfor(; j < q.length; ++j) {\r\n\t\ti = q[j];\r\n\t\tL = FI[i].L; R = FI[i].R; C = FI[i].C;\r\n\t\tif(dad[i] === i) {\r\n\t\t\tif(L !== -1 /*NOSTREAM*/ && dad[L] !== L) dad[i] = dad[L];\r\n\t\t\tif(R !== -1 && dad[R] !== R) dad[i] = dad[R];\r\n\t\t}\r\n\t\tif(C !== -1 /*NOSTREAM*/) dad[C] = i;\r\n\t\tif(L !== -1) { dad[L] = dad[i]; q.push(L); }\r\n\t\tif(R !== -1) { dad[R] = dad[i]; q.push(R); }\r\n\t}\r\n\tfor(i=1; i !== pl; ++i) if(dad[i] === i) {\r\n\t\tif(R !== -1 /*NOSTREAM*/ && dad[R] !== R) dad[i] = dad[R];\r\n\t\telse if(L !== -1 && dad[L] !== L) dad[i] = dad[L];\r\n\t}\r\n\r\n\tfor(i=1; i < pl; ++i) {\r\n\t\tif(FI[i].type === 0 /* unknown */) continue;\r\n\t\tj = dad[i];\r\n\t\tif(j === 0) FP[i] = FP[0] + \"/\" + FP[i];\r\n\t\telse while(j !== 0) {\r\n\t\t\tFP[i] = FP[j] + \"/\" + FP[i];\r\n\t\t\tj = dad[j];\r\n\t\t}\r\n\t\tdad[i] = 0;\r\n\t}\r\n\r\n\tFP[0] += \"/\";\r\n\tfor(i=1; i < pl; ++i) {\r\n\t\tif(FI[i].type !== 2 /* stream */) FP[i] += \"/\";\r\n\t\tFPD[FP[i]] = FI[i];\r\n\t}\r\n}\r\n\r\n/* [MS-CFB] 2.6.4 */\r\nfunction make_find_path(FullPaths, Paths, FileIndex, files, root_name) {\r\n\tvar UCFullPaths = new Array(FullPaths.length);\r\n\tvar UCPaths = new Array(Paths.length), i;\r\n\tfor(i = 0; i < FullPaths.length; ++i) UCFullPaths[i] = FullPaths[i].toUpperCase().replace(chr0,'').replace(chr1,'!');\r\n\tfor(i = 0; i < Paths.length; ++i) UCPaths[i] = Paths[i].toUpperCase().replace(chr0,'').replace(chr1,'!');\r\n\treturn function find_path(path) {\r\n\t\tvar k;\r\n\t\tif(path.charCodeAt(0) === 47 /* \"/\" */) { k=true; path = root_name + path; }\r\n\t\telse k = path.indexOf(\"/\") !== -1;\r\n\t\tvar UCPath = path.toUpperCase().replace(chr0,'').replace(chr1,'!');\r\n\t\tvar w = k === true ? UCFullPaths.indexOf(UCPath) : UCPaths.indexOf(UCPath);\r\n\t\tif(w === -1) return null;\r\n\t\treturn k === true ? FileIndex[w] : files[Paths[w]];\r\n\t};\r\n}\r\n\r\n/** Chase down the rest of the DIFAT chain to build a comprehensive list\r\n    DIFAT chains by storing the next sector number as the last 32 bytes */\r\nfunction sleuth_fat(idx, cnt, sectors, ssz, fat_addrs) {\r\n\tvar q;\r\n\tif(idx === ENDOFCHAIN) {\r\n\t\tif(cnt !== 0) throw \"DIFAT chain shorter than expected\";\r\n\t} else if(idx !== -1 /*FREESECT*/) {\r\n\t\tvar sector = sectors[idx], m = (ssz>>>2)-1;\r\n\t\tfor(var i = 0; i < m; ++i) {\r\n\t\t\tif((q = __readInt32LE(sector,i*4)) === ENDOFCHAIN) break;\r\n\t\t\tfat_addrs.push(q);\r\n\t\t}\r\n\t\tsleuth_fat(__readInt32LE(sector,ssz-4),cnt - 1, sectors, ssz, fat_addrs);\r\n\t}\r\n}\r\n\r\n/** Follow the linked list of sectors for a given starting point */\r\nfunction get_sector_list(sectors, start, fat_addrs, ssz, chkd) {\r\n\tvar sl = sectors.length;\r\n\tvar buf, buf_chain;\r\n\tif(!chkd) chkd = new Array(sl);\r\n\tvar modulus = ssz - 1, j, jj;\r\n\tbuf = [];\r\n\tbuf_chain = [];\r\n\tfor(j=start; j>=0;) {\r\n\t\tchkd[j] = true;\r\n\t\tbuf[buf.length] = j;\r\n\t\tbuf_chain.push(sectors[j]);\r\n\t\tvar addr = fat_addrs[Math.floor(j*4/ssz)];\r\n\t\tjj = ((j*4) & modulus);\r\n\t\tif(ssz < 4 + jj) throw \"FAT boundary crossed: \" + j + \" 4 \"+ssz;\r\n\t\tj = __readInt32LE(sectors[addr], jj);\r\n\t}\r\n\treturn {nodes: buf, data:__toBuffer([buf_chain])};\r\n}\r\n\r\n/** Chase down the sector linked lists */\r\nfunction make_sector_list(sectors, dir_start, fat_addrs, ssz) {\r\n\tvar sl = sectors.length, sector_list = new Array(sl);\r\n\tvar chkd = new Array(sl), buf, buf_chain;\r\n\tvar modulus = ssz - 1, i, j, k, jj;\r\n\tfor(i=0; i < sl; ++i) {\r\n\t\tbuf = [];\r\n\t\tk = (i + dir_start); if(k >= sl) k-=sl;\r\n\t\tif(chkd[k] === true) continue;\r\n\t\tbuf_chain = [];\r\n\t\tfor(j=k; j>=0;) {\r\n\t\t\tchkd[j] = true;\r\n\t\t\tbuf[buf.length] = j;\r\n\t\t\tbuf_chain.push(sectors[j]);\r\n\t\t\tvar addr = fat_addrs[Math.floor(j*4/ssz)];\r\n\t\t\tjj = ((j*4) & modulus);\r\n\t\t\tif(ssz < 4 + jj) throw \"FAT boundary crossed: \" + j + \" 4 \"+ssz;\r\n\t\t\tj = __readInt32LE(sectors[addr], jj);\r\n\t\t}\r\n\t\tsector_list[k] = {nodes: buf, data:__toBuffer([buf_chain])};\r\n\t}\r\n\treturn sector_list;\r\n}\r\n\r\n/* [MS-CFB] 2.6.1 Compound File Directory Entry */\r\nfunction read_directory(dir_start, sector_list, sectors, Paths, nmfs, files, FileIndex) {\r\n\tvar blob;\r\n\tvar minifat_store = 0, pl = (Paths.length?2:0);\r\n\tvar sector = sector_list[dir_start].data;\r\n\tvar i = 0, namelen = 0, name, o, ctime, mtime;\r\n\tfor(; i < sector.length; i+= 128) {\r\n\t\tblob = sector.slice(i, i+128);\r\n\t\tprep_blob(blob, 64);\r\n\t\tnamelen = blob.read_shift(2);\r\n\t\tif(namelen === 0) continue;\r\n\t\tname = __utf16le(blob,0,namelen-pl);\r\n\t\tPaths.push(name);\r\n\t\to = {\r\n\t\t\tname:  name,\r\n\t\t\ttype:  blob.read_shift(1),\r\n\t\t\tcolor: blob.read_shift(1),\r\n\t\t\tL:     blob.read_shift(4, 'i'),\r\n\t\t\tR:     blob.read_shift(4, 'i'),\r\n\t\t\tC:     blob.read_shift(4, 'i'),\r\n\t\t\tclsid: blob.read_shift(16),\r\n\t\t\tstate: blob.read_shift(4, 'i')\r\n\t\t};\r\n\t\tctime = blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2);\r\n\t\tif(ctime !== 0) {\r\n\t\t\to.ctime = ctime; o.ct = read_date(blob, blob.l-8);\r\n\t\t}\r\n\t\tmtime = blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2);\r\n\t\tif(mtime !== 0) {\r\n\t\t\to.mtime = mtime; o.mt = read_date(blob, blob.l-8);\r\n\t\t}\r\n\t\to.start = blob.read_shift(4, 'i');\r\n\t\to.size = blob.read_shift(4, 'i');\r\n\t\tif(o.type === 5) { /* root */\r\n\t\t\tminifat_store = o.start;\r\n\t\t\tif(nmfs > 0 && minifat_store !== ENDOFCHAIN) sector_list[minifat_store].name = \"!StreamData\";\r\n\t\t\t/*minifat_size = o.size;*/\r\n\t\t} else if(o.size >= 4096 /* MSCSZ */) {\r\n\t\t\to.storage = 'fat';\r\n\t\t\tif(sector_list[o.start] === undefined) sector_list[o.start] = get_sector_list(sectors, o.start, sector_list.fat_addrs, sector_list.ssz);\r\n\t\t\tsector_list[o.start].name = o.name;\r\n\t\t\to.content = sector_list[o.start].data.slice(0,o.size);\r\n\t\t\tprep_blob(o.content, 0);\r\n\t\t} else {\r\n\t\t\to.storage = 'minifat';\r\n\t\t\tif(minifat_store !== ENDOFCHAIN && o.start !== ENDOFCHAIN) {\r\n\t\t\t\to.content = sector_list[minifat_store].data.slice(o.start*MSSZ,o.start*MSSZ+o.size);\r\n\t\t\t\tprep_blob(o.content, 0);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfiles[name] = o;\r\n\t\tFileIndex.push(o);\r\n\t}\r\n}\r\n\r\nfunction read_date(blob, offset) {\r\n\treturn new Date(( ( (__readUInt32LE(blob,offset+4)/1e7)*Math.pow(2,32)+__readUInt32LE(blob,offset)/1e7 ) - 11644473600)*1000);\r\n}\r\n\r\nvar fs;\r\nfunction readFileSync(filename, options) {\r\n\tif(fs === undefined) fs = require('fs');\r\n\treturn parse(fs.readFileSync(filename), options);\r\n}\r\n\r\nfunction readSync(blob, options) {\r\n\tswitch(options !== undefined && options.type !== undefined ? options.type : \"base64\") {\r\n\t\tcase \"file\": return readFileSync(blob, options);\r\n\t\tcase \"base64\": return parse(s2a(Base64.decode(blob)), options);\r\n\t\tcase \"binary\": return parse(s2a(blob), options);\r\n\t}\r\n\treturn parse(blob);\r\n}\r\n\r\n/** CFB Constants */\r\nvar MSSZ = 64; /* Mini Sector Size = 1<<6 */\r\n//var MSCSZ = 4096; /* Mini Stream Cutoff Size */\r\n/* 2.1 Compound File Sector Numbers and Types */\r\nvar ENDOFCHAIN = -2;\r\n/* 2.2 Compound File Header */\r\nvar HEADER_SIGNATURE = 'd0cf11e0a1b11ae1';\r\nvar HEADER_CLSID = '00000000000000000000000000000000';\r\nvar consts = {\r\n\t/* 2.1 Compund File Sector Numbers and Types */\r\n\tMAXREGSECT: -6,\r\n\tDIFSECT: -4,\r\n\tFATSECT: -3,\r\n\tENDOFCHAIN: ENDOFCHAIN,\r\n\tFREESECT: -1,\r\n\t/* 2.2 Compound File Header */\r\n\tHEADER_SIGNATURE: HEADER_SIGNATURE,\r\n\tHEADER_MINOR_VERSION: '3e00',\r\n\tMAXREGSID: -6,\r\n\tNOSTREAM: -1,\r\n\tHEADER_CLSID: HEADER_CLSID,\r\n\t/* 2.6.1 Compound File Directory Entry */\r\n\tEntryTypes: ['unknown','storage','stream','lockbytes','property','root']\r\n};\r\n\r\nexports.read = readSync;\r\nexports.parse = parse;\r\nexports.utils = {\r\n\tReadShift: ReadShift,\r\n\tCheckField: CheckField,\r\n\tprep_blob: prep_blob,\r\n\tbconcat: bconcat,\r\n\tconsts: consts\r\n};\r\n\r\nreturn exports;\r\n})();\r\n\r\nif(typeof require !== 'undefined' && typeof module !== 'undefined' && typeof DO_NOT_EXPORT_CFB === 'undefined') { module.exports = CFB; }\r\nfunction isval(x) { return x !== undefined && x !== null; }\r\n\r\nfunction keys(o) { return Object.keys(o); }\r\n\r\nfunction evert_key(obj, key) {\r\n\tvar o = [], K = keys(obj);\r\n\tfor(var i = 0; i !== K.length; ++i) o[obj[K[i]][key]] = K[i];\r\n\treturn o;\r\n}\r\n\r\nfunction evert(obj) {\r\n\tvar o = [], K = keys(obj);\r\n\tfor(var i = 0; i !== K.length; ++i) o[obj[K[i]]] = K[i];\r\n\treturn o;\r\n}\r\n\r\nfunction evert_num(obj) {\r\n\tvar o = [], K = keys(obj);\r\n\tfor(var i = 0; i !== K.length; ++i) o[obj[K[i]]] = parseInt(K[i],10);\r\n\treturn o;\r\n}\r\n\r\nfunction evert_arr(obj) {\r\n\tvar o = [], K = keys(obj);\r\n\tfor(var i = 0; i !== K.length; ++i) {\r\n\t\tif(o[obj[K[i]]] == null) o[obj[K[i]]] = [];\r\n\t\to[obj[K[i]]].push(K[i]);\r\n\t}\r\n\treturn o;\r\n}\r\n\r\n/* TODO: date1904 logic */\r\nfunction datenum(v, date1904) {\r\n\tif(date1904) v+=1462;\r\n\tvar epoch = Date.parse(v);\r\n\treturn (epoch + 2209161600000) / (24 * 60 * 60 * 1000);\r\n}\r\n\r\nfunction cc2str(arr) {\r\n\tvar o = \"\";\r\n\tfor(var i = 0; i != arr.length; ++i) o += String.fromCharCode(arr[i]);\r\n\treturn o;\r\n}\r\n\r\nfunction getdata(data) {\r\n\tif(!data) return null;\r\n\tif(data.name.substr(-4) === \".bin\") {\r\n\t\tif(data.data) return char_codes(data.data);\r\n\t\tif(data.asNodeBuffer && has_buf) return data.asNodeBuffer();\r\n\t\tif(data._data && data._data.getContent) return Array.prototype.slice.call(data._data.getContent());\r\n\t} else {\r\n\t\tif(data.data) return data.name.substr(-4) !== \".bin\" ? debom_xml(data.data) : char_codes(data.data);\r\n\t\tif(data.asNodeBuffer && has_buf) return debom_xml(data.asNodeBuffer().toString('binary'));\r\n\t\tif(data.asBinary) return debom_xml(data.asBinary());\r\n\t\tif(data._data && data._data.getContent) return debom_xml(cc2str(Array.prototype.slice.call(data._data.getContent(),0)));\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nfunction safegetzipfile(zip, file) {\r\n\tvar f = file; if(zip.files[f]) return zip.files[f];\r\n\r\n\tvar lowerCaseFiles = {};\r\n\tfor (var key in zip.files) {\r\n\t\tlowerCaseFiles[key.toLowerCase()] = zip.files[key];\r\n\t}\r\n\r\n\tf = file.toLowerCase(); if(lowerCaseFiles[f]) return lowerCaseFiles[f];\r\n\tf = f.replace(/\\//g,'\\\\'); if(lowerCaseFiles[f]) return lowerCaseFiles[f];\r\n\treturn null;\r\n}\r\n\r\nfunction getzipfile(zip, file) {\r\n\tvar o = safegetzipfile(zip, file);\r\n\tif(o == null) throw new Error(\"Cannot find file \" + file + \" in zip\");\r\n\treturn o;\r\n}\r\n\r\nfunction getzipdata(zip, file, safe) {\r\n\tif(!safe) return getdata(getzipfile(zip, file));\r\n\tif(!file) return null;\r\n\ttry { return getzipdata(zip, file); } catch(e) { return null; }\r\n}\r\n\r\nvar _fs, jszip;\r\nif(typeof JSZip !== 'undefined') jszip = JSZip;\r\nif (typeof exports !== 'undefined') {\r\n\tif (typeof module !== 'undefined' && module.exports) {\r\n\t\tif(has_buf && typeof jszip === 'undefined') jszip = require('js'+'zip');\r\n\t\tif(typeof jszip === 'undefined') jszip = require('./js'+'zip').JSZip;\r\n\t\t_fs = require('f'+'s');\r\n\t}\r\n}\r\nvar attregexg=/([\\w:]+)=((?:\")([^\"]*)(?:\")|(?:')([^']*)(?:'))/g;\r\nvar tagregex=/<[^>]*>/g;\r\nvar nsregex=/<\\w*:/, nsregex2 = /<(\\/?)\\w+:/;\r\nfunction parsexmltag(tag, skip_root) {\r\n\tvar z = [];\r\n\tvar eq = 0, c = 0;\r\n\tfor(; eq !== tag.length; ++eq) if((c = tag.charCodeAt(eq)) === 32 || c === 10 || c === 13) break;\r\n\tif(!skip_root) z[0] = tag.substr(0, eq);\r\n\tif(eq === tag.length) return z;\r\n\tvar m = tag.match(attregexg), j=0, w=\"\", v=\"\", i=0, q=\"\", cc=\"\";\r\n\tif(m) for(i = 0; i != m.length; ++i) {\r\n\t\tcc = m[i];\r\n\t\tfor(c=0; c != cc.length; ++c) if(cc.charCodeAt(c) === 61) break;\r\n\t\tq = cc.substr(0,c); v = cc.substring(c+2, cc.length-1);\r\n\t\tfor(j=0;j!=q.length;++j) if(q.charCodeAt(j) === 58) break;\r\n\t\tif(j===q.length) z[q] = v;\r\n\t\telse z[(j===5 && q.substr(0,5)===\"xmlns\"?\"xmlns\":\"\")+q.substr(j+1)] = v;\r\n\t}\r\n\treturn z;\r\n}\r\nfunction strip_ns(x) { return x.replace(nsregex2, \"<$1\"); }\r\n\r\nvar encodings = {\r\n\t'&quot;': '\"',\r\n\t'&apos;': \"'\",\r\n\t'&gt;': '>',\r\n\t'&lt;': '<',\r\n\t'&amp;': '&'\r\n};\r\nvar rencoding = evert(encodings);\r\nvar rencstr = \"&<>'\\\"\".split(\"\");\r\n\r\n// TODO: CP remap (need to read file version to determine OS)\r\nvar unescapexml = (function() {\r\n\tvar encregex = /&[a-z]*;/g, coderegex = /_x([\\da-fA-F]+)_/g;\r\n\treturn function unescapexml(text){\r\n\t\tvar s = text + '';\r\n\t\treturn s.replace(encregex, function($$) { return encodings[$$]; }).replace(coderegex,function(m,c) {return String.fromCharCode(parseInt(c,16));});\r\n\t};\r\n})();\r\n\r\nvar decregex=/[&<>'\"]/g, charegex = /[\\u0000-\\u0008\\u000b-\\u001f]/g;\r\nfunction escapexml(text){\r\n\tvar s = text + '';\r\n\treturn s.replace(decregex, function(y) { return rencoding[y]; }).replace(charegex,function(s) { return \"_x\" + (\"000\"+s.charCodeAt(0).toString(16)).substr(-4) + \"_\";});\r\n}\r\n\r\n/* TODO: handle codepages */\r\nvar xlml_fixstr = (function() {\r\n\tvar entregex = /&#(\\d+);/g;\r\n\tfunction entrepl($$,$1) { return String.fromCharCode(parseInt($1,10)); }\r\n\treturn function xlml_fixstr(str) { return str.replace(entregex,entrepl); };\r\n})();\r\n\r\nfunction parsexmlbool(value, tag) {\r\n\tswitch(value) {\r\n\t\tcase '1': case 'true': case 'TRUE': return true;\r\n\t\t/* case '0': case 'false': case 'FALSE':*/\r\n\t\tdefault: return false;\r\n\t}\r\n}\r\n\r\nvar utf8read = function utf8reada(orig) {\r\n\tvar out = \"\", i = 0, c = 0, d = 0, e = 0, f = 0, w = 0;\r\n\twhile (i < orig.length) {\r\n\t\tc = orig.charCodeAt(i++);\r\n\t\tif (c < 128) { out += String.fromCharCode(c); continue; }\r\n\t\td = orig.charCodeAt(i++);\r\n\t\tif (c>191 && c<224) { out += String.fromCharCode(((c & 31) << 6) | (d & 63)); continue; }\r\n\t\te = orig.charCodeAt(i++);\r\n\t\tif (c < 240) { out += String.fromCharCode(((c & 15) << 12) | ((d & 63) << 6) | (e & 63)); continue; }\r\n\t\tf = orig.charCodeAt(i++);\r\n\t\tw = (((c & 7) << 18) | ((d & 63) << 12) | ((e & 63) << 6) | (f & 63))-65536;\r\n\t\tout += String.fromCharCode(0xD800 + ((w>>>10)&1023));\r\n\t\tout += String.fromCharCode(0xDC00 + (w&1023));\r\n\t}\r\n\treturn out;\r\n};\r\n\r\n\r\nif(has_buf) {\r\n\tvar utf8readb = function utf8readb(data) {\r\n\t\tvar out = new Buffer(2*data.length), w, i, j = 1, k = 0, ww=0, c;\r\n\t\tfor(i = 0; i < data.length; i+=j) {\r\n\t\t\tj = 1;\r\n\t\t\tif((c=data.charCodeAt(i)) < 128) w = c;\r\n\t\t\telse if(c < 224) { w = (c&31)*64+(data.charCodeAt(i+1)&63); j=2; }\r\n\t\t\telse if(c < 240) { w=(c&15)*4096+(data.charCodeAt(i+1)&63)*64+(data.charCodeAt(i+2)&63); j=3; }\r\n\t\t\telse { j = 4;\r\n\t\t\t\tw = (c & 7)*262144+(data.charCodeAt(i+1)&63)*4096+(data.charCodeAt(i+2)&63)*64+(data.charCodeAt(i+3)&63);\r\n\t\t\t\tw -= 65536; ww = 0xD800 + ((w>>>10)&1023); w = 0xDC00 + (w&1023);\r\n\t\t\t}\r\n\t\t\tif(ww !== 0) { out[k++] = ww&255; out[k++] = ww>>>8; ww = 0; }\r\n\t\t\tout[k++] = w%256; out[k++] = w>>>8;\r\n\t\t}\r\n\t\tout.length = k;\r\n\t\treturn out.toString('ucs2');\r\n\t};\r\n\tvar corpus = \"foo bar baz\\u00e2\\u0098\\u0083\\u00f0\\u009f\\u008d\\u00a3\";\r\n\tif(utf8read(corpus) == utf8readb(corpus)) utf8read = utf8readb;\r\n\tvar utf8readc = function utf8readc(data) { return Buffer(data, 'binary').toString('utf8'); };\r\n\tif(utf8read(corpus) == utf8readc(corpus)) utf8read = utf8readc;\r\n}\r\n\r\n// matches <foo>...</foo> extracts content\r\nvar matchtag = (function() {\r\n\tvar mtcache = {};\r\n\treturn function matchtag(f,g) {\r\n\t\tvar t = f+\"|\"+g;\r\n\t\tif(mtcache[t] !== undefined) return mtcache[t];\r\n\t\treturn (mtcache[t] = new RegExp('<(?:\\\\w+:)?'+f+'(?: xml:space=\"preserve\")?(?:[^>]*)>([^\\u2603]*)</(?:\\\\w+:)?'+f+'>',(g||\"\")));\r\n\t};\r\n})();\r\n\r\nvar vtregex = (function(){ var vt_cache = {};\r\n\treturn function vt_regex(bt) {\r\n\t\tif(vt_cache[bt] !== undefined) return vt_cache[bt];\r\n\t\treturn (vt_cache[bt] = new RegExp(\"<vt:\" + bt + \">(.*?)</vt:\" + bt + \">\", 'g') );\r\n};})();\r\nvar vtvregex = /<\\/?vt:variant>/g, vtmregex = /<vt:([^>]*)>(.*)</;\r\nfunction parseVector(data) {\r\n\tvar h = parsexmltag(data);\r\n\r\n\tvar matches = data.match(vtregex(h.baseType))||[];\r\n\tif(matches.length != h.size) throw \"unexpected vector length \" + matches.length + \" != \" + h.size;\r\n\tvar res = [];\r\n\tmatches.forEach(function(x) {\r\n\t\tvar v = x.replace(vtvregex,\"\").match(vtmregex);\r\n\t\tres.push({v:v[2], t:v[1]});\r\n\t});\r\n\treturn res;\r\n}\r\n\r\nvar wtregex = /(^\\s|\\s$|\\n)/;\r\nfunction writetag(f,g) {return '<' + f + (g.match(wtregex)?' xml:space=\"preserve\"' : \"\") + '>' + g + '</' + f + '>';}\r\n\r\nfunction wxt_helper(h) { return keys(h).map(function(k) { return \" \" + k + '=\"' + h[k] + '\"';}).join(\"\"); }\r\nfunction writextag(f,g,h) { return '<' + f + (isval(h) ? wxt_helper(h) : \"\") + (isval(g) ? (g.match(wtregex)?' xml:space=\"preserve\"' : \"\") + '>' + g + '</' + f : \"/\") + '>';}\r\n\r\nfunction write_w3cdtf(d, t) { try { return d.toISOString().replace(/\\.\\d*/,\"\"); } catch(e) { if(t) throw e; } }\r\n\r\nfunction write_vt(s) {\r\n\tswitch(typeof s) {\r\n\t\tcase 'string': return writextag('vt:lpwstr', s);\r\n\t\tcase 'number': return writextag((s|0)==s?'vt:i4':'vt:r8', String(s));\r\n\t\tcase 'boolean': return writextag('vt:bool',s?'true':'false');\r\n\t}\r\n\tif(s instanceof Date) return writextag('vt:filetime', write_w3cdtf(s));\r\n\tthrow new Error(\"Unable to serialize \" + s);\r\n}\r\n\r\nvar XML_HEADER = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\r\\n';\r\nvar XMLNS = {\r\n\t'dc': 'http://purl.org/dc/elements/1.1/',\r\n\t'dcterms': 'http://purl.org/dc/terms/',\r\n\t'dcmitype': 'http://purl.org/dc/dcmitype/',\r\n\t'mx': 'http://schemas.microsoft.com/office/mac/excel/2008/main',\r\n\t'r': 'http://schemas.openxmlformats.org/officeDocument/2006/relationships',\r\n\t'sjs': 'http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties',\r\n\t'vt': 'http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes',\r\n\t'xsi': 'http://www.w3.org/2001/XMLSchema-instance',\r\n\t'xsd': 'http://www.w3.org/2001/XMLSchema'\r\n};\r\n\r\nXMLNS.main = [\r\n\t'http://schemas.openxmlformats.org/spreadsheetml/2006/main',\r\n\t'http://purl.oclc.org/ooxml/spreadsheetml/main',\r\n\t'http://schemas.microsoft.com/office/excel/2006/main',\r\n\t'http://schemas.microsoft.com/office/excel/2006/2'\r\n];\r\n\r\nfunction readIEEE754(buf, idx, isLE, nl, ml) {\r\n\tif(isLE === undefined) isLE = true;\r\n\tif(!nl) nl = 8;\r\n\tif(!ml && nl === 8) ml = 52;\r\n\tvar e, m, el = nl * 8 - ml - 1, eMax = (1 << el) - 1, eBias = eMax >> 1;\r\n\tvar bits = -7, d = isLE ? -1 : 1, i = isLE ? (nl - 1) : 0, s = buf[idx + i];\r\n\r\n\ti += d;\r\n\te = s & ((1 << (-bits)) - 1); s >>>= (-bits); bits += el;\r\n\tfor (; bits > 0; e = e * 256 + buf[idx + i], i += d, bits -= 8);\r\n\tm = e & ((1 << (-bits)) - 1); e >>>= (-bits); bits += ml;\r\n\tfor (; bits > 0; m = m * 256 + buf[idx + i], i += d, bits -= 8);\r\n\tif (e === eMax) return m ? NaN : ((s ? -1 : 1) * Infinity);\r\n\telse if (e === 0) e = 1 - eBias;\r\n\telse { m = m + Math.pow(2, ml); e = e - eBias; }\r\n\treturn (s ? -1 : 1) * m * Math.pow(2, e - ml);\r\n}\r\n\r\nvar __toBuffer, ___toBuffer;\r\n__toBuffer = ___toBuffer = function toBuffer_(bufs) { var x = []; for(var i = 0; i < bufs[0].length; ++i) { x.push.apply(x, bufs[0][i]); } return x; };\r\nvar __utf16le, ___utf16le;\r\n__utf16le = ___utf16le = function utf16le_(b,s,e) { var ss=[]; for(var i=s; i<e; i+=2) ss.push(String.fromCharCode(__readUInt16LE(b,i))); return ss.join(\"\"); };\r\nvar __hexlify, ___hexlify;\r\n__hexlify = ___hexlify = function hexlify_(b,s,l) { return b.slice(s,(s+l)).map(function(x){return (x<16?\"0\":\"\") + x.toString(16);}).join(\"\"); };\r\nvar __utf8, ___utf8;\r\n__utf8 = ___utf8 = function(b,s,e) { var ss=[]; for(var i=s; i<e; i++) ss.push(String.fromCharCode(__readUInt8(b,i))); return ss.join(\"\"); };\r\nvar __lpstr, ___lpstr;\r\n__lpstr = ___lpstr = function lpstr_(b,i) { var len = __readUInt32LE(b,i); return len > 0 ? __utf8(b, i+4,i+4+len-1) : \"\";};\r\nvar __lpwstr, ___lpwstr;\r\n__lpwstr = ___lpwstr = function lpwstr_(b,i) { var len = 2*__readUInt32LE(b,i); return len > 0 ? __utf8(b, i+4,i+4+len-1) : \"\";};\r\nvar __double, ___double;\r\n__double = ___double = function(b, idx) { return readIEEE754(b, idx);};\r\n\r\nvar is_buf = function is_buf_a(a) { return Array.isArray(a); };\r\nif(has_buf) {\r\n\t__utf16le = function utf16le_b(b,s,e) { if(!Buffer.isBuffer(b)) return ___utf16le(b,s,e); return b.toString('utf16le',s,e); };\r\n\t__hexlify = function(b,s,l) { return Buffer.isBuffer(b) ? b.toString('hex',s,s+l) : ___hexlify(b,s,l); };\r\n\t__lpstr = function lpstr_b(b,i) { if(!Buffer.isBuffer(b)) return ___lpstr(b, i); var len = b.readUInt32LE(i); return len > 0 ? b.toString('utf8',i+4,i+4+len-1) : \"\";};\r\n\t__lpwstr = function lpwstr_b(b,i) { if(!Buffer.isBuffer(b)) return ___lpwstr(b, i); var len = 2*b.readUInt32LE(i); return b.toString('utf16le',i+4,i+4+len-1);};\r\n\t__utf8 = function utf8_b(s,e) { return this.toString('utf8',s,e); };\r\n\t__toBuffer = function(bufs) { return (bufs[0].length > 0 && Buffer.isBuffer(bufs[0][0])) ? Buffer.concat(bufs[0]) : ___toBuffer(bufs);};\r\n\tbconcat = function(bufs) { return Buffer.isBuffer(bufs[0]) ? Buffer.concat(bufs) : [].concat.apply([], bufs); };\r\n\t__double = function double_(b,i) { if(Buffer.isBuffer(b)) return b.readDoubleLE(i); return ___double(b,i); };\r\n\tis_buf = function is_buf_b(a) { return Buffer.isBuffer(a) || Array.isArray(a); };\r\n}\r\n\r\n/* from js-xls */\r\nif(typeof cptable !== 'undefined') {\r\n\t__utf16le = function(b,s,e) { return cptable.utils.decode(1200, b.slice(s,e)); };\r\n\t__utf8 = function(b,s,e) { return cptable.utils.decode(65001, b.slice(s,e)); };\r\n\t__lpstr = function(b,i) { var len = __readUInt32LE(b,i); return len > 0 ? cptable.utils.decode(current_codepage, b.slice(i+4, i+4+len-1)) : \"\";};\r\n\t__lpwstr = function(b,i) { var len = 2*__readUInt32LE(b,i); return len > 0 ? cptable.utils.decode(1200, b.slice(i+4,i+4+len-1)) : \"\";};\r\n}\r\n\r\nvar __readUInt8 = function(b, idx) { return b[idx]; };\r\nvar __readUInt16LE = function(b, idx) { return b[idx+1]*(1<<8)+b[idx]; };\r\nvar __readInt16LE = function(b, idx) { var u = b[idx+1]*(1<<8)+b[idx]; return (u < 0x8000) ? u : (0xffff - u + 1) * -1; };\r\nvar __readUInt32LE = function(b, idx) { return b[idx+3]*(1<<24)+(b[idx+2]<<16)+(b[idx+1]<<8)+b[idx]; };\r\nvar __readInt32LE = function(b, idx) { return (b[idx+3]<<24)|(b[idx+2]<<16)|(b[idx+1]<<8)|b[idx]; };\r\n\r\nvar ___unhexlify = function(s) { return s.match(/../g).map(function(x) { return parseInt(x,16);}); };\r\nvar __unhexlify = typeof Buffer !== \"undefined\" ? function(s) { return Buffer.isBuffer(s) ? new Buffer(s, 'hex') : ___unhexlify(s); } : ___unhexlify;\r\n\r\nfunction ReadShift(size, t) {\r\n\tvar o=\"\", oI, oR, oo=[], w, vv, i, loc;\r\n\tswitch(t) {\r\n\t\tcase 'dbcs':\r\n\t\t\tloc = this.l;\r\n\t\t\tif(has_buf && Buffer.isBuffer(this)) o = this.slice(this.l, this.l+2*size).toString(\"utf16le\");\r\n\t\t\telse for(i = 0; i != size; ++i) { o+=String.fromCharCode(__readUInt16LE(this, loc)); loc+=2; }\r\n\t\t\tsize *= 2;\r\n\t\t\tbreak;\r\n\r\n\t\tcase 'utf8': o = __utf8(this, this.l, this.l + size); break;\r\n\t\tcase 'utf16le': size *= 2; o = __utf16le(this, this.l, this.l + size); break;\r\n\r\n\t\t/* [MS-OLEDS] 2.1.4 LengthPrefixedAnsiString */\r\n\t\tcase 'lpstr': o = __lpstr(this, this.l); size = 5 + o.length; break;\r\n\t\t/* [MS-OLEDS] 2.1.5 LengthPrefixedUnicodeString */\r\n\t\tcase 'lpwstr': o = __lpwstr(this, this.l); size = 5 + o.length; if(o[o.length-1] == '\\u0000') size += 2; break;\r\n\r\n\t\tcase 'cstr': size = 0; o = \"\";\r\n\t\t\twhile((w=__readUInt8(this, this.l + size++))!==0) oo.push(_getchar(w));\r\n\t\t\to = oo.join(\"\"); break;\r\n\t\tcase 'wstr': size = 0; o = \"\";\r\n\t\t\twhile((w=__readUInt16LE(this,this.l +size))!==0){oo.push(_getchar(w));size+=2;}\r\n\t\t\tsize+=2; o = oo.join(\"\"); break;\r\n\r\n\t\t/* sbcs and dbcs support continue records in the SST way TODO codepages */\r\n\t\tcase 'dbcs-cont': o = \"\"; loc = this.l;\r\n\t\t\tfor(i = 0; i != size; ++i) {\r\n\t\t\t\tif(this.lens && this.lens.indexOf(loc) !== -1) {\r\n\t\t\t\t\tw = __readUInt8(this, loc);\r\n\t\t\t\t\tthis.l = loc + 1;\r\n\t\t\t\t\tvv = ReadShift.call(this, size-i, w ? 'dbcs-cont' : 'sbcs-cont');\r\n\t\t\t\t\treturn oo.join(\"\") + vv;\r\n\t\t\t\t}\r\n\t\t\t\too.push(_getchar(__readUInt16LE(this, loc)));\r\n\t\t\t\tloc+=2;\r\n\t\t\t} o = oo.join(\"\"); size *= 2; break;\r\n\r\n\t\tcase 'sbcs-cont': o = \"\"; loc = this.l;\r\n\t\t\tfor(i = 0; i != size; ++i) {\r\n\t\t\t\tif(this.lens && this.lens.indexOf(loc) !== -1) {\r\n\t\t\t\t\tw = __readUInt8(this, loc);\r\n\t\t\t\t\tthis.l = loc + 1;\r\n\t\t\t\t\tvv = ReadShift.call(this, size-i, w ? 'dbcs-cont' : 'sbcs-cont');\r\n\t\t\t\t\treturn oo.join(\"\") + vv;\r\n\t\t\t\t}\r\n\t\t\t\too.push(_getchar(__readUInt8(this, loc)));\r\n\t\t\t\tloc+=1;\r\n\t\t\t} o = oo.join(\"\"); break;\r\n\r\n\t\tdefault:\r\n\tswitch(size) {\r\n\t\tcase 1: oI = __readUInt8(this, this.l); this.l++; return oI;\r\n\t\tcase 2: oI = (t === 'i' ? __readInt16LE : __readUInt16LE)(this, this.l); this.l += 2; return oI;\r\n\t\tcase 4:\r\n\t\t\tif(t === 'i' || (this[this.l+3] & 0x80)===0) { oI = __readInt32LE(this, this.l); this.l += 4; return oI; }\r\n\t\t\telse { oR = __readUInt32LE(this, this.l); this.l += 4; return oR; } break;\r\n\t\tcase 8: if(t === 'f') { oR = __double(this, this.l); this.l += 8; return oR; }\r\n\t\t/* falls through */\r\n\t\tcase 16: o = __hexlify(this, this.l, size); break;\r\n\t}}\r\n\tthis.l+=size; return o;\r\n}\r\n\r\nfunction WriteShift(t, val, f) {\r\n\tvar size, i;\r\n\tif(f === 'dbcs') {\r\n\t\tfor(i = 0; i != val.length; ++i) this.writeUInt16LE(val.charCodeAt(i), this.l + 2 * i);\r\n\t\tsize = 2 * val.length;\r\n\t} else switch(t) {\r\n\t\tcase  1: size = 1; this[this.l] = val&255; break;\r\n\t\tcase  3: size = 3; this[this.l+2] = val & 255; val >>>= 8; this[this.l+1] = val&255; val >>>= 8; this[this.l] = val&255; break;\r\n\t\tcase  4: size = 4; this.writeUInt32LE(val, this.l); break;\r\n\t\tcase  8: size = 8; if(f === 'f') { this.writeDoubleLE(val, this.l); break; }\r\n\t\t/* falls through */\r\n\t\tcase 16: break;\r\n\t\tcase -4: size = 4; this.writeInt32LE(val, this.l); break;\r\n\t}\r\n\tthis.l += size; return this;\r\n}\r\n\r\nfunction CheckField(hexstr, fld) {\r\n\tvar m = __hexlify(this,this.l,hexstr.length>>1);\r\n\tif(m !== hexstr) throw fld + 'Expected ' + hexstr + ' saw ' + m;\r\n\tthis.l += hexstr.length>>1;\r\n}\r\n\r\nfunction prep_blob(blob, pos) {\r\n\tblob.l = pos;\r\n\tblob.read_shift = ReadShift;\r\n\tblob.chk = CheckField;\r\n\tblob.write_shift = WriteShift;\r\n}\r\n\r\nfunction parsenoop(blob, length) { blob.l += length; }\r\n\r\nfunction writenoop(blob, length) { blob.l += length; }\r\n\r\nfunction new_buf(sz) {\r\n\tvar o = new_raw_buf(sz);\r\n\tprep_blob(o, 0);\r\n\treturn o;\r\n}\r\n\r\n/* [MS-XLSB] 2.1.4 Record */\r\nfunction recordhopper(data, cb, opts) {\r\n\tvar tmpbyte, cntbyte, length;\r\n\tprep_blob(data, data.l || 0);\r\n\twhile(data.l < data.length) {\r\n\t\tvar RT = data.read_shift(1);\r\n\t\tif(RT & 0x80) RT = (RT & 0x7F) + ((data.read_shift(1) & 0x7F)<<7);\r\n\t\tvar R = XLSBRecordEnum[RT] || XLSBRecordEnum[0xFFFF];\r\n\t\ttmpbyte = data.read_shift(1);\r\n\t\tlength = tmpbyte & 0x7F;\r\n\t\tfor(cntbyte = 1; cntbyte <4 && (tmpbyte & 0x80); ++cntbyte) length += ((tmpbyte = data.read_shift(1)) & 0x7F)<<(7*cntbyte);\r\n\t\tvar d = R.f(data, length, opts);\r\n\t\tif(cb(d, R, RT)) return;\r\n\t}\r\n}\r\n\r\n/* control buffer usage for fixed-length buffers */\r\nfunction buf_array() {\r\n\tvar bufs = [], blksz = 2048;\r\n\tvar newblk = function ba_newblk(sz) {\r\n\t\tvar o = new_buf(sz);\r\n\t\tprep_blob(o, 0);\r\n\t\treturn o;\r\n\t};\r\n\r\n\tvar curbuf = newblk(blksz);\r\n\r\n\tvar endbuf = function ba_endbuf() {\r\n\t\tcurbuf.length = curbuf.l;\r\n\t\tif(curbuf.length > 0) bufs.push(curbuf);\r\n\t\tcurbuf = null;\r\n\t};\r\n\r\n\tvar next = function ba_next(sz) {\r\n\t\tif(sz < curbuf.length - curbuf.l) return curbuf;\r\n\t\tendbuf();\r\n\t\treturn (curbuf = newblk(Math.max(sz+1, blksz)));\r\n\t};\r\n\r\n\tvar end = function ba_end() {\r\n\t\tendbuf();\r\n\t\treturn __toBuffer([bufs]);\r\n\t};\r\n\r\n\tvar push = function ba_push(buf) { endbuf(); curbuf = buf; next(blksz); };\r\n\r\n\treturn { next:next, push:push, end:end, _bufs:bufs };\r\n}\r\n\r\nfunction write_record(ba, type, payload, length) {\r\n\tvar t = evert_RE[type], l;\r\n\tif(!length) length = XLSBRecordEnum[t].p || (payload||[]).length || 0;\r\n\tl = 1 + (t >= 0x80 ? 1 : 0) + 1 + length;\r\n\tif(length >= 0x80) ++l; if(length >= 0x4000) ++l; if(length >= 0x200000) ++l;\r\n\tvar o = ba.next(l);\r\n\tif(t <= 0x7F) o.write_shift(1, t);\r\n\telse {\r\n\t\to.write_shift(1, (t & 0x7F) + 0x80);\r\n\t\to.write_shift(1, (t >> 7));\r\n\t}\r\n\tfor(var i = 0; i != 4; ++i) {\r\n\t\tif(length >= 0x80) { o.write_shift(1, (length & 0x7F)+0x80); length >>= 7; }\r\n\t\telse { o.write_shift(1, length); break; }\r\n\t}\r\n\tif(length > 0 && is_buf(payload)) ba.push(payload);\r\n}\r\n/* XLS ranges enforced */\r\nfunction shift_cell_xls(cell, tgt) {\r\n\tif(tgt.s) {\r\n\t\tif(cell.cRel) cell.c += tgt.s.c;\r\n\t\tif(cell.rRel) cell.r += tgt.s.r;\r\n\t} else {\r\n\t\tcell.c += tgt.c;\r\n\t\tcell.r += tgt.r;\r\n\t}\r\n\tcell.cRel = cell.rRel = 0;\r\n\twhile(cell.c >= 0x100) cell.c -= 0x100;\r\n\twhile(cell.r >= 0x10000) cell.r -= 0x10000;\r\n\treturn cell;\r\n}\r\n\r\nfunction shift_range_xls(cell, range) {\r\n\tcell.s = shift_cell_xls(cell.s, range.s);\r\n\tcell.e = shift_cell_xls(cell.e, range.s);\r\n\treturn cell;\r\n}\r\n\r\nvar OFFCRYPTO = {};\r\nvar make_offcrypto = function(O, _crypto) {\r\n\tvar crypto;\r\n\tif(typeof _crypto !== 'undefined') crypto = _crypto;\r\n\telse if(typeof require !== 'undefined') {\r\n\t\ttry { crypto = require('cry'+'pto'); }\r\n\t\tcatch(e) { crypto = null; }\r\n\t}\r\n\r\n\tO.rc4 = function(key, data) {\r\n\t\tvar S = new Array(256);\r\n\t\tvar c = 0, i = 0, j = 0, t = 0;\r\n\t\tfor(i = 0; i != 256; ++i) S[i] = i;\r\n\t\tfor(i = 0; i != 256; ++i) {\r\n\t\t\tj = (j + S[i] + (key[i%key.length]).charCodeAt(0))&255;\r\n\t\t\tt = S[i]; S[i] = S[j]; S[j] = t;\r\n\t\t}\r\n\t\ti = j = 0; out = Buffer(data.length);\r\n\t\tfor(c = 0; c != data.length; ++c) {\r\n\t\t\ti = (i + 1)&255;\r\n\t\t\tj = (j + S[i])%256;\r\n\t\t\tt = S[i]; S[i] = S[j]; S[j] = t;\r\n\t\t\tout[c] = (data[c] ^ S[(S[i]+S[j])&255]);\r\n\t\t}\r\n\t\treturn out;\r\n\t};\r\n\r\n\tif(crypto) {\r\n\t\tO.md5 = function(hex) { return crypto.createHash('md5').update(hex).digest('hex'); };\r\n\t} else {\r\n\t\tO.md5 = function(hex) { throw \"unimplemented\"; };\r\n\t}\r\n};\r\nmake_offcrypto(OFFCRYPTO, typeof crypto !== \"undefined\" ? crypto : undefined);\r\n\r\n\r\n/* [MS-XLSB] 2.5.143 */\r\nfunction parse_StrRun(data, length) {\r\n\treturn { ich: data.read_shift(2), ifnt: data.read_shift(2) };\r\n}\r\n\r\n/* [MS-XLSB] 2.1.7.121 */\r\nfunction parse_RichStr(data, length) {\r\n\tvar start = data.l;\r\n\tvar flags = data.read_shift(1);\r\n\tvar str = parse_XLWideString(data);\r\n\tvar rgsStrRun = [];\r\n\tvar z = { t: str, h: str };\r\n\tif((flags & 1) !== 0) { /* fRichStr */\r\n\t\t/* TODO: formatted string */\r\n\t\tvar dwSizeStrRun = data.read_shift(4);\r\n\t\tfor(var i = 0; i != dwSizeStrRun; ++i) rgsStrRun.push(parse_StrRun(data));\r\n\t\tz.r = rgsStrRun;\r\n\t}\r\n\telse z.r = \"<t>\" + escapexml(str) + \"</t>\";\r\n\tif((flags & 2) !== 0) { /* fExtStr */\r\n\t\t/* TODO: phonetic string */\r\n\t}\r\n\tdata.l = start + length;\r\n\treturn z;\r\n}\r\nfunction write_RichStr(str, o) {\r\n\t/* TODO: formatted string */\r\n\tif(o == null) o = new_buf(5+2*str.t.length);\r\n\to.write_shift(1,0);\r\n\twrite_XLWideString(str.t, o);\r\n\treturn o;\r\n}\r\n\r\n/* [MS-XLSB] 2.5.9 */\r\nfunction parse_XLSBCell(data) {\r\n\tvar col = data.read_shift(4);\r\n\tvar iStyleRef = data.read_shift(2);\r\n\tiStyleRef += data.read_shift(1) <<16;\r\n\tvar fPhShow = data.read_shift(1);\r\n\treturn { c:col, iStyleRef: iStyleRef };\r\n}\r\nfunction write_XLSBCell(cell, o) {\r\n\tif(o == null) o = new_buf(8);\r\n\to.write_shift(-4, cell.c);\r\n\to.write_shift(3, cell.iStyleRef === undefined ? cell.iStyleRef : cell.s);\r\n\to.write_shift(1, 0); /* fPhShow */\r\n\treturn o;\r\n}\r\n\r\n\r\n/* [MS-XLSB] 2.5.21 */\r\nfunction parse_XLSBCodeName (data, length) { return parse_XLWideString(data, length); }\r\n\r\n/* [MS-XLSB] 2.5.166 */\r\nfunction parse_XLNullableWideString(data) {\r\n\tvar cchCharacters = data.read_shift(4);\r\n\treturn cchCharacters === 0 || cchCharacters === 0xFFFFFFFF ? \"\" : data.read_shift(cchCharacters, 'dbcs');\r\n}\r\nfunction write_XLNullableWideString(data, o) {\r\n\tif(!o) o = new_buf(127);\r\n\to.write_shift(4, data.length > 0 ? data.length : 0xFFFFFFFF);\r\n\tif(data.length > 0) o.write_shift(0, data, 'dbcs');\r\n\treturn o;\r\n}\r\n\r\n/* [MS-XLSB] 2.5.168 */\r\nfunction parse_XLWideString(data) {\r\n\tvar cchCharacters = data.read_shift(4);\r\n\treturn cchCharacters === 0 ? \"\" : data.read_shift(cchCharacters, 'dbcs');\r\n}\r\nfunction write_XLWideString(data, o) {\r\n\tif(o == null) o = new_buf(4+2*data.length);\r\n\to.write_shift(4, data.length);\r\n\tif(data.length > 0) o.write_shift(0, data, 'dbcs');\r\n\treturn o;\r\n}\r\n\r\n/* [MS-XLSB] 2.5.114 */\r\nvar parse_RelID = parse_XLNullableWideString;\r\nvar write_RelID = write_XLNullableWideString;\r\n\r\n\r\n/* [MS-XLSB] 2.5.122 */\r\n/* [MS-XLS] 2.5.217 */\r\nfunction parse_RkNumber(data) {\r\n\tvar b = data.slice(data.l, data.l+4);\r\n\tvar fX100 = b[0] & 1, fInt = b[0] & 2;\r\n\tdata.l+=4;\r\n\tb[0] &= 0xFC; // b[0] &= ~3;\r\n\tvar RK = fInt === 0 ? __double([0,0,0,0,b[0],b[1],b[2],b[3]],0) : __readInt32LE(b,0)>>2;\r\n\treturn fX100 ? RK/100 : RK;\r\n}\r\n\r\n/* [MS-XLSB] 2.5.153 */\r\nfunction parse_UncheckedRfX(data) {\r\n\tvar cell = {s: {}, e: {}};\r\n\tcell.s.r = data.read_shift(4);\r\n\tcell.e.r = data.read_shift(4);\r\n\tcell.s.c = data.read_shift(4);\r\n\tcell.e.c = data.read_shift(4);\r\n\treturn cell;\r\n}\r\n\r\nfunction write_UncheckedRfX(r, o) {\r\n\tif(!o) o = new_buf(16);\r\n\to.write_shift(4, r.s.r);\r\n\to.write_shift(4, r.e.r);\r\n\to.write_shift(4, r.s.c);\r\n\to.write_shift(4, r.e.c);\r\n\treturn o;\r\n}\r\n\r\n/* [MS-XLSB] 2.5.171 */\r\n/* [MS-XLS] 2.5.342 */\r\nfunction parse_Xnum(data, length) { return data.read_shift(8, 'f'); }\r\nfunction write_Xnum(data, o) { return (o || new_buf(8)).write_shift(8, 'f', data); }\r\n\r\n/* [MS-XLSB] 2.5.198.2 */\r\nvar BErr = {\r\n\t0x00: \"#NULL!\",\r\n\t0x07: \"#DIV/0!\",\r\n\t0x0F: \"#VALUE!\",\r\n\t0x17: \"#REF!\",\r\n\t0x1D: \"#NAME?\",\r\n\t0x24: \"#NUM!\",\r\n\t0x2A: \"#N/A\",\r\n\t0x2B: \"#GETTING_DATA\",\r\n\t0xFF: \"#WTF?\"\r\n};\r\nvar RBErr = evert_num(BErr);\r\n\r\n/* [MS-XLSB] 2.4.321 BrtColor */\r\nfunction parse_BrtColor(data, length) {\r\n\tvar out = {};\r\n\tvar d = data.read_shift(1);\r\n\tout.fValidRGB = d & 1;\r\n\tout.xColorType = d >>> 1;\r\n\tout.index = data.read_shift(1);\r\n\tout.nTintAndShade = data.read_shift(2, 'i');\r\n\tout.bRed   = data.read_shift(1);\r\n\tout.bGreen = data.read_shift(1);\r\n\tout.bBlue  = data.read_shift(1);\r\n\tout.bAlpha = data.read_shift(1);\r\n}\r\n\r\n/* [MS-XLSB] 2.5.52 */\r\nfunction parse_FontFlags(data, length) {\r\n\tvar d = data.read_shift(1);\r\n\tdata.l++;\r\n\tvar out = {\r\n\t\tfItalic: d & 0x2,\r\n\t\tfStrikeout: d & 0x8,\r\n\t\tfOutline: d & 0x10,\r\n\t\tfShadow: d & 0x20,\r\n\t\tfCondense: d & 0x40,\r\n\t\tfExtend: d & 0x80\r\n\t};\r\n\treturn out;\r\n}\r\n/* [MS-OLEPS] 2.2 PropertyType */\r\n{\r\n\tvar VT_EMPTY    = 0x0000;\r\n\tvar VT_NULL     = 0x0001;\r\n\tvar VT_I2       = 0x0002;\r\n\tvar VT_I4       = 0x0003;\r\n\tvar VT_R4       = 0x0004;\r\n\tvar VT_R8       = 0x0005;\r\n\tvar VT_CY       = 0x0006;\r\n\tvar VT_DATE     = 0x0007;\r\n\tvar VT_BSTR     = 0x0008;\r\n\tvar VT_ERROR    = 0x000A;\r\n\tvar VT_BOOL     = 0x000B;\r\n\tvar VT_VARIANT  = 0x000C;\r\n\tvar VT_DECIMAL  = 0x000E;\r\n\tvar VT_I1       = 0x0010;\r\n\tvar VT_UI1      = 0x0011;\r\n\tvar VT_UI2      = 0x0012;\r\n\tvar VT_UI4      = 0x0013;\r\n\tvar VT_I8       = 0x0014;\r\n\tvar VT_UI8      = 0x0015;\r\n\tvar VT_INT      = 0x0016;\r\n\tvar VT_UINT     = 0x0017;\r\n\tvar VT_LPSTR    = 0x001E;\r\n\tvar VT_LPWSTR   = 0x001F;\r\n\tvar VT_FILETIME = 0x0040;\r\n\tvar VT_BLOB     = 0x0041;\r\n\tvar VT_STREAM   = 0x0042;\r\n\tvar VT_STORAGE  = 0x0043;\r\n\tvar VT_STREAMED_Object  = 0x0044;\r\n\tvar VT_STORED_Object    = 0x0045;\r\n\tvar VT_BLOB_Object      = 0x0046;\r\n\tvar VT_CF       = 0x0047;\r\n\tvar VT_CLSID    = 0x0048;\r\n\tvar VT_VERSIONED_STREAM = 0x0049;\r\n\tvar VT_VECTOR   = 0x1000;\r\n\tvar VT_ARRAY    = 0x2000;\r\n\r\n\tvar VT_STRING   = 0x0050; // 2.3.3.1.11 VtString\r\n\tvar VT_USTR     = 0x0051; // 2.3.3.1.12 VtUnalignedString\r\n\tvar VT_CUSTOM   = [VT_STRING, VT_USTR];\r\n}\r\n\r\n/* [MS-OSHARED] 2.3.3.2.2.1 Document Summary Information PIDDSI */\r\nvar DocSummaryPIDDSI = {\r\n\t0x01: { n: 'CodePage', t: VT_I2 },\r\n\t0x02: { n: 'Category', t: VT_STRING },\r\n\t0x03: { n: 'PresentationFormat', t: VT_STRING },\r\n\t0x04: { n: 'ByteCount', t: VT_I4 },\r\n\t0x05: { n: 'LineCount', t: VT_I4 },\r\n\t0x06: { n: 'ParagraphCount', t: VT_I4 },\r\n\t0x07: { n: 'SlideCount', t: VT_I4 },\r\n\t0x08: { n: 'NoteCount', t: VT_I4 },\r\n\t0x09: { n: 'HiddenCount', t: VT_I4 },\r\n\t0x0a: { n: 'MultimediaClipCount', t: VT_I4 },\r\n\t0x0b: { n: 'Scale', t: VT_BOOL },\r\n\t0x0c: { n: 'HeadingPair', t: VT_VECTOR | VT_VARIANT },\r\n\t0x0d: { n: 'DocParts', t: VT_VECTOR | VT_LPSTR },\r\n\t0x0e: { n: 'Manager', t: VT_STRING },\r\n\t0x0f: { n: 'Company', t: VT_STRING },\r\n\t0x10: { n: 'LinksDirty', t: VT_BOOL },\r\n\t0x11: { n: 'CharacterCount', t: VT_I4 },\r\n\t0x13: { n: 'SharedDoc', t: VT_BOOL },\r\n\t0x16: { n: 'HLinksChanged', t: VT_BOOL },\r\n\t0x17: { n: 'AppVersion', t: VT_I4, p: 'version' },\r\n\t0x1A: { n: 'ContentType', t: VT_STRING },\r\n\t0x1B: { n: 'ContentStatus', t: VT_STRING },\r\n\t0x1C: { n: 'Language', t: VT_STRING },\r\n\t0x1D: { n: 'Version', t: VT_STRING },\r\n\t0xFF: {}\r\n};\r\n\r\n/* [MS-OSHARED] 2.3.3.2.1.1 Summary Information Property Set PIDSI */\r\nvar SummaryPIDSI = {\r\n\t0x01: { n: 'CodePage', t: VT_I2 },\r\n\t0x02: { n: 'Title', t: VT_STRING },\r\n\t0x03: { n: 'Subject', t: VT_STRING },\r\n\t0x04: { n: 'Author', t: VT_STRING },\r\n\t0x05: { n: 'Keywords', t: VT_STRING },\r\n\t0x06: { n: 'Comments', t: VT_STRING },\r\n\t0x07: { n: 'Template', t: VT_STRING },\r\n\t0x08: { n: 'LastAuthor', t: VT_STRING },\r\n\t0x09: { n: 'RevNumber', t: VT_STRING },\r\n\t0x0A: { n: 'EditTime', t: VT_FILETIME },\r\n\t0x0B: { n: 'LastPrinted', t: VT_FILETIME },\r\n\t0x0C: { n: 'CreatedDate', t: VT_FILETIME },\r\n\t0x0D: { n: 'ModifiedDate', t: VT_FILETIME },\r\n\t0x0E: { n: 'PageCount', t: VT_I4 },\r\n\t0x0F: { n: 'WordCount', t: VT_I4 },\r\n\t0x10: { n: 'CharCount', t: VT_I4 },\r\n\t0x11: { n: 'Thumbnail', t: VT_CF },\r\n\t0x12: { n: 'ApplicationName', t: VT_LPSTR },\r\n\t0x13: { n: 'DocumentSecurity', t: VT_I4 },\r\n\t0xFF: {}\r\n};\r\n\r\n/* [MS-OLEPS] 2.18 */\r\nvar SpecialProperties = {\r\n\t0x80000000: { n: 'Locale', t: VT_UI4 },\r\n\t0x80000003: { n: 'Behavior', t: VT_UI4 },\r\n\t0x72627262: {}\r\n};\r\n\r\n(function() {\r\n\tfor(var y in SpecialProperties) if(SpecialProperties.hasOwnProperty(y))\r\n\tDocSummaryPIDDSI[y] = SummaryPIDSI[y] = SpecialProperties[y];\r\n})();\r\n\r\n/* [MS-XLS] 2.4.63 Country/Region codes */\r\nvar CountryEnum = {\r\n\t0x0001: \"US\", // United States\r\n\t0x0002: \"CA\", // Canada\r\n\t0x0003: \"\", // Latin America (except Brazil)\r\n\t0x0007: \"RU\", // Russia\r\n\t0x0014: \"EG\", // Egypt\r\n\t0x001E: \"GR\", // Greece\r\n\t0x001F: \"NL\", // Netherlands\r\n\t0x0020: \"BE\", // Belgium\r\n\t0x0021: \"FR\", // France\r\n\t0x0022: \"ES\", // Spain\r\n\t0x0024: \"HU\", // Hungary\r\n\t0x0027: \"IT\", // Italy\r\n\t0x0029: \"CH\", // Switzerland\r\n\t0x002B: \"AT\", // Austria\r\n\t0x002C: \"GB\", // United Kingdom\r\n\t0x002D: \"DK\", // Denmark\r\n\t0x002E: \"SE\", // Sweden\r\n\t0x002F: \"NO\", // Norway\r\n\t0x0030: \"PL\", // Poland\r\n\t0x0031: \"DE\", // Germany\r\n\t0x0034: \"MX\", // Mexico\r\n\t0x0037: \"BR\", // Brazil\r\n\t0x003d: \"AU\", // Australia\r\n\t0x0040: \"NZ\", // New Zealand\r\n\t0x0042: \"TH\", // Thailand\r\n\t0x0051: \"JP\", // Japan\r\n\t0x0052: \"KR\", // Korea\r\n\t0x0054: \"VN\", // Viet Nam\r\n\t0x0056: \"CN\", // China\r\n\t0x005A: \"TR\", // Turkey\r\n\t0x0069: \"JS\", // Ramastan\r\n\t0x00D5: \"DZ\", // Algeria\r\n\t0x00D8: \"MA\", // Morocco\r\n\t0x00DA: \"LY\", // Libya\r\n\t0x015F: \"PT\", // Portugal\r\n\t0x0162: \"IS\", // Iceland\r\n\t0x0166: \"FI\", // Finland\r\n\t0x01A4: \"CZ\", // Czech Republic\r\n\t0x0376: \"TW\", // Taiwan\r\n\t0x03C1: \"LB\", // Lebanon\r\n\t0x03C2: \"JO\", // Jordan\r\n\t0x03C3: \"SY\", // Syria\r\n\t0x03C4: \"IQ\", // Iraq\r\n\t0x03C5: \"KW\", // Kuwait\r\n\t0x03C6: \"SA\", // Saudi Arabia\r\n\t0x03CB: \"AE\", // United Arab Emirates\r\n\t0x03CC: \"IL\", // Israel\r\n\t0x03CE: \"QA\", // Qatar\r\n\t0x03D5: \"IR\", // Iran\r\n\t0xFFFF: \"US\"  // United States\r\n};\r\n\r\n/* [MS-XLS] 2.5.127 */\r\nvar XLSFillPattern = [\r\n\tnull,\r\n\t'solid',\r\n\t'mediumGray',\r\n\t'darkGray',\r\n\t'lightGray',\r\n\t'darkHorizontal',\r\n\t'darkVertical',\r\n\t'darkDown',\r\n\t'darkUp',\r\n\t'darkGrid',\r\n\t'darkTrellis',\r\n\t'lightHorizontal',\r\n\t'lightVertical',\r\n\t'lightDown',\r\n\t'lightUp',\r\n\t'lightGrid',\r\n\t'lightTrellis',\r\n\t'gray125',\r\n\t'gray0625'\r\n];\r\n\r\nfunction rgbify(arr) { return arr.map(function(x) { return [(x>>16)&255,(x>>8)&255,x&255]; }); }\r\n\r\n/* [MS-XLS] 2.5.161 */\r\nvar XLSIcv = rgbify([\r\n\t/* Color Constants */\r\n\t0x000000,\r\n\t0xFFFFFF,\r\n\t0xFF0000,\r\n\t0x00FF00,\r\n\t0x0000FF,\r\n\t0xFFFF00,\r\n\t0xFF00FF,\r\n\t0x00FFFF,\r\n\r\n\t/* Defaults */\r\n\t0x000000,\r\n\t0xFFFFFF,\r\n\t0xFF0000,\r\n\t0x00FF00,\r\n\t0x0000FF,\r\n\t0xFFFF00,\r\n\t0xFF00FF,\r\n\t0x00FFFF,\r\n\r\n\t0x800000,\r\n\t0x008000,\r\n\t0x000080,\r\n\t0x808000,\r\n\t0x800080,\r\n\t0x008080,\r\n\t0xC0C0C0,\r\n\t0x808080,\r\n\t0x9999FF,\r\n\t0x993366,\r\n\t0xFFFFCC,\r\n\t0xCCFFFF,\r\n\t0x660066,\r\n\t0xFF8080,\r\n\t0x0066CC,\r\n\t0xCCCCFF,\r\n\r\n\t0x000080,\r\n\t0xFF00FF,\r\n\t0xFFFF00,\r\n\t0x00FFFF,\r\n\t0x800080,\r\n\t0x800000,\r\n\t0x008080,\r\n\t0x0000FF,\r\n\t0x00CCFF,\r\n\t0xCCFFFF,\r\n\t0xCCFFCC,\r\n\t0xFFFF99,\r\n\t0x99CCFF,\r\n\t0xFF99CC,\r\n\t0xCC99FF,\r\n\t0xFFCC99,\r\n\r\n\t0x3366FF,\r\n\t0x33CCCC,\r\n\t0x99CC00,\r\n\t0xFFCC00,\r\n\t0xFF9900,\r\n\t0xFF6600,\r\n\t0x666699,\r\n\t0x969696,\r\n\t0x003366,\r\n\t0x339966,\r\n\t0x003300,\r\n\t0x333300,\r\n\t0x993300,\r\n\t0x993366,\r\n\t0x333399,\r\n\t0x333333,\r\n\r\n\t/* Sheet */\r\n\t0xFFFFFF,\r\n\t0x000000\r\n]);\r\n\r\n/* Parts enumerated in OPC spec, MS-XLSB and MS-XLSX */\r\n/* 12.3 Part Summary <SpreadsheetML> */\r\n/* 14.2 Part Summary <DrawingML> */\r\n/* [MS-XLSX] 2.1 Part Enumerations */\r\n/* [MS-XLSB] 2.1.7 Part Enumeration */\r\nvar ct2type = {\r\n\t/* Workbook */\r\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\": \"workbooks\",\r\n\r\n\t/* Worksheet */\r\n\t\"application/vnd.ms-excel.binIndexWs\": \"TODO\", /* Binary Index */\r\n\r\n\t/* Chartsheet */\r\n\t\"application/vnd.ms-excel.chartsheet\": \"TODO\",\r\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml\": \"TODO\",\r\n\r\n\t/* Dialogsheet */\r\n\t\"application/vnd.ms-excel.dialogsheet\": \"TODO\",\r\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml\": \"TODO\",\r\n\r\n\t/* Macrosheet */\r\n\t\"application/vnd.ms-excel.macrosheet\": \"TODO\",\r\n\t\"application/vnd.ms-excel.macrosheet+xml\": \"TODO\",\r\n\t\"application/vnd.ms-excel.intlmacrosheet\": \"TODO\",\r\n\t\"application/vnd.ms-excel.binIndexMs\": \"TODO\", /* Binary Index */\r\n\r\n\t/* File Properties */\r\n\t\"application/vnd.openxmlformats-package.core-properties+xml\": \"coreprops\",\r\n\t\"application/vnd.openxmlformats-officedocument.custom-properties+xml\": \"custprops\",\r\n\t\"application/vnd.openxmlformats-officedocument.extended-properties+xml\": \"extprops\",\r\n\r\n\t/* Custom Data Properties */\r\n\t\"application/vnd.openxmlformats-officedocument.customXmlProperties+xml\": \"TODO\",\r\n\r\n\t/* Comments */\r\n\t\"application/vnd.ms-excel.comments\": \"comments\",\r\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml\": \"comments\",\r\n\r\n\t/* PivotTable */\r\n\t\"application/vnd.ms-excel.pivotTable\": \"TODO\",\r\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml\": \"TODO\",\r\n\r\n\t/* Calculation Chain */\r\n\t\"application/vnd.ms-excel.calcChain\": \"calcchains\",\r\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml\": \"calcchains\",\r\n\r\n\t/* Printer Settings */\r\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings\": \"TODO\",\r\n\r\n\t/* ActiveX */\r\n\t\"application/vnd.ms-office.activeX\": \"TODO\",\r\n\t\"application/vnd.ms-office.activeX+xml\": \"TODO\",\r\n\r\n\t/* Custom Toolbars */\r\n\t\"application/vnd.ms-excel.attachedToolbars\": \"TODO\",\r\n\r\n\t/* External Data Connections */\r\n\t\"application/vnd.ms-excel.connections\": \"TODO\",\r\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml\": \"TODO\",\r\n\r\n\t/* External Links */\r\n\t\"application/vnd.ms-excel.externalLink\": \"TODO\",\r\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml\": \"TODO\",\r\n\r\n\t/* Metadata */\r\n\t\"application/vnd.ms-excel.sheetMetadata\": \"TODO\",\r\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml\": \"TODO\",\r\n\r\n\t/* PivotCache */\r\n\t\"application/vnd.ms-excel.pivotCacheDefinition\": \"TODO\",\r\n\t\"application/vnd.ms-excel.pivotCacheRecords\": \"TODO\",\r\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml\": \"TODO\",\r\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml\": \"TODO\",\r\n\r\n\t/* Query Table */\r\n\t\"application/vnd.ms-excel.queryTable\": \"TODO\",\r\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml\": \"TODO\",\r\n\r\n\t/* Shared Workbook */\r\n\t\"application/vnd.ms-excel.userNames\": \"TODO\",\r\n\t\"application/vnd.ms-excel.revisionHeaders\": \"TODO\",\r\n\t\"application/vnd.ms-excel.revisionLog\": \"TODO\",\r\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml\": \"TODO\",\r\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml\": \"TODO\",\r\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml\": \"TODO\",\r\n\r\n\t/* Single Cell Table */\r\n\t\"application/vnd.ms-excel.tableSingleCells\": \"TODO\",\r\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml\": \"TODO\",\r\n\r\n\t/* Slicer */\r\n\t\"application/vnd.ms-excel.slicer\": \"TODO\",\r\n\t\"application/vnd.ms-excel.slicerCache\": \"TODO\",\r\n\t\"application/vnd.ms-excel.slicer+xml\": \"TODO\",\r\n\t\"application/vnd.ms-excel.slicerCache+xml\": \"TODO\",\r\n\r\n\t/* Sort Map */\r\n\t\"application/vnd.ms-excel.wsSortMap\": \"TODO\",\r\n\r\n\t/* Table */\r\n\t\"application/vnd.ms-excel.table\": \"TODO\",\r\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml\": \"TODO\",\r\n\r\n\t/* Themes */\r\n\t\"application/vnd.openxmlformats-officedocument.theme+xml\": \"themes\",\r\n\r\n\t/* Timeline */\r\n\t\"application/vnd.ms-excel.Timeline+xml\": \"TODO\", /* verify */\r\n\t\"application/vnd.ms-excel.TimelineCache+xml\": \"TODO\", /* verify */\r\n\r\n\t/* VBA */\r\n\t\"application/vnd.ms-office.vbaProject\": \"vba\",\r\n\t\"application/vnd.ms-office.vbaProjectSignature\": \"vba\",\r\n\r\n\t/* Volatile Dependencies */\r\n\t\"application/vnd.ms-office.volatileDependencies\": \"TODO\",\r\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml\": \"TODO\",\r\n\r\n\t/* Control Properties */\r\n\t\"application/vnd.ms-excel.controlproperties+xml\": \"TODO\",\r\n\r\n\t/* Data Model */\r\n\t\"application/vnd.openxmlformats-officedocument.model+data\": \"TODO\",\r\n\r\n\t/* Survey */\r\n\t\"application/vnd.ms-excel.Survey+xml\": \"TODO\",\r\n\r\n\t/* Drawing */\r\n\t\"application/vnd.openxmlformats-officedocument.drawing+xml\": \"TODO\",\r\n\t\"application/vnd.openxmlformats-officedocument.drawingml.chart+xml\": \"TODO\",\r\n\t\"application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml\": \"TODO\",\r\n\t\"application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml\": \"TODO\",\r\n\t\"application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml\": \"TODO\",\r\n\t\"application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml\": \"TODO\",\r\n\t\"application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml\": \"TODO\",\r\n\r\n\t/* VML */\r\n\t\"application/vnd.openxmlformats-officedocument.vmlDrawing\": \"TODO\",\r\n\r\n\t\"application/vnd.openxmlformats-package.relationships+xml\": \"rels\",\r\n\t\"application/vnd.openxmlformats-officedocument.oleObject\": \"TODO\",\r\n\r\n\t\"sheet\": \"js\"\r\n};\r\n\r\nvar CT_LIST = (function(){\r\n\tvar o = {\r\n\t\tworkbooks: {\r\n\t\t\txlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\",\r\n\t\t\txlsm: \"application/vnd.ms-excel.sheet.macroEnabled.main+xml\",\r\n\t\t\txlsb: \"application/vnd.ms-excel.sheet.binary.macroEnabled.main\",\r\n\t\t\txltx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml\"\r\n\t\t},\r\n\t\tstrs: { /* Shared Strings */\r\n\t\t\txlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml\",\r\n\t\t\txlsb: \"application/vnd.ms-excel.sharedStrings\"\r\n\t\t},\r\n\t\tsheets: {\r\n\t\t\txlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml\",\r\n\t\t\txlsb: \"application/vnd.ms-excel.worksheet\"\r\n\t\t},\r\n\t\tstyles: {/* Styles */\r\n\t\t\txlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml\",\r\n\t\t\txlsb: \"application/vnd.ms-excel.styles\"\r\n\t\t}\r\n\t};\r\n\tkeys(o).forEach(function(k) { if(!o[k].xlsm) o[k].xlsm = o[k].xlsx; });\r\n\tkeys(o).forEach(function(k){ keys(o[k]).forEach(function(v) { ct2type[o[k][v]] = k; }); });\r\n\treturn o;\r\n})();\r\n\r\nvar type2ct = evert_arr(ct2type);\r\n\r\nXMLNS.CT = 'http://schemas.openxmlformats.org/package/2006/content-types';\r\n\r\nfunction parse_ct(data, opts) {\r\n\tvar ctext = {};\r\n\tif(!data || !data.match) return data;\r\n\tvar ct = { workbooks: [], sheets: [], calcchains: [], themes: [], styles: [],\r\n\t\tcoreprops: [], extprops: [], custprops: [], strs:[], comments: [], vba: [],\r\n\t\tTODO:[], rels:[], xmlns: \"\" };\r\n\t(data.match(tagregex)||[]).forEach(function(x) {\r\n\t\tvar y = parsexmltag(x);\r\n\t\tswitch(y[0].replace(nsregex,\"<\")) {\r\n\t\t\tcase '<?xml': break;\r\n\t\t\tcase '<Types': ct.xmlns = y['xmlns' + (y[0].match(/<(\\w+):/)||[\"\",\"\"])[1] ]; break;\r\n\t\t\tcase '<Default': ctext[y.Extension] = y.ContentType; break;\r\n\t\t\tcase '<Override':\r\n\t\t\t\tif(ct[ct2type[y.ContentType]] !== undefined) ct[ct2type[y.ContentType]].push(y.PartName);\r\n\t\t\t\telse if(opts.WTF) console.error(y);\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t});\r\n\tif(ct.xmlns !== XMLNS.CT) throw new Error(\"Unknown Namespace: \" + ct.xmlns);\r\n\tct.calcchain = ct.calcchains.length > 0 ? ct.calcchains[0] : \"\";\r\n\tct.sst = ct.strs.length > 0 ? ct.strs[0] : \"\";\r\n\tct.style = ct.styles.length > 0 ? ct.styles[0] : \"\";\r\n\tct.defaults = ctext;\r\n\tdelete ct.calcchains;\r\n\treturn ct;\r\n}\r\n\r\nvar CTYPE_XML_ROOT = writextag('Types', null, {\r\n\t'xmlns': XMLNS.CT,\r\n\t'xmlns:xsd': XMLNS.xsd,\r\n\t'xmlns:xsi': XMLNS.xsi\r\n});\r\n\r\nvar CTYPE_DEFAULTS = [\r\n\t['xml', 'application/xml'],\r\n\t['bin', 'application/vnd.ms-excel.sheet.binary.macroEnabled.main'],\r\n\t['rels', type2ct.rels[0]]\r\n].map(function(x) {\r\n\treturn writextag('Default', null, {'Extension':x[0], 'ContentType': x[1]});\r\n});\r\n\r\nfunction write_ct(ct, opts) {\r\n\tvar o = [], v;\r\n\to[o.length] = (XML_HEADER);\r\n\to[o.length] = (CTYPE_XML_ROOT);\r\n\to = o.concat(CTYPE_DEFAULTS);\r\n\tvar f1 = function(w) {\r\n\t\tif(ct[w] && ct[w].length > 0) {\r\n\t\t\tv = ct[w][0];\r\n\t\t\to[o.length] = (writextag('Override', null, {\r\n\t\t\t\t'PartName': (v[0] == '/' ? \"\":\"/\") + v,\r\n\t\t\t\t'ContentType': CT_LIST[w][opts.bookType || 'xlsx']\r\n\t\t\t}));\r\n\t\t}\r\n\t};\r\n\tvar f2 = function(w) {\r\n\t\tct[w].forEach(function(v) {\r\n\t\t\to[o.length] = (writextag('Override', null, {\r\n\t\t\t\t'PartName': (v[0] == '/' ? \"\":\"/\") + v,\r\n\t\t\t\t'ContentType': CT_LIST[w][opts.bookType || 'xlsx']\r\n\t\t\t}));\r\n\t\t});\r\n\t};\r\n\tvar f3 = function(t) {\r\n\t\t(ct[t]||[]).forEach(function(v) {\r\n\t\t\to[o.length] = (writextag('Override', null, {\r\n\t\t\t\t'PartName': (v[0] == '/' ? \"\":\"/\") + v,\r\n\t\t\t\t'ContentType': type2ct[t][0]\r\n\t\t\t}));\r\n\t\t});\r\n\t};\r\n\tf1('workbooks');\r\n\tf2('sheets');\r\n\tf3('themes');\r\n\t['strs', 'styles'].forEach(f1);\r\n\t['coreprops', 'extprops', 'custprops'].forEach(f3);\r\n\tif(o.length>2){ o[o.length] = ('</Types>'); o[1]=o[1].replace(\"/>\",\">\"); }\r\n\treturn o.join(\"\");\r\n}\r\n/* 9.3.2 OPC Relationships Markup */\r\nvar RELS = {\r\n\tWB: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\",\r\n\tSHEET: \"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument\"\r\n};\r\n\r\nfunction parse_rels(data, currentFilePath) {\r\n\tif (!data) return data;\r\n\tif (currentFilePath.charAt(0) !== '/') {\r\n\t\tcurrentFilePath = '/'+currentFilePath;\r\n\t}\r\n\tvar rels = {};\r\n\tvar hash = {};\r\n\tvar resolveRelativePathIntoAbsolute = function (to) {\r\n\t\tvar toksFrom = currentFilePath.split('/');\r\n\t\ttoksFrom.pop(); // folder path\r\n\t\tvar toksTo = to.split('/');\r\n\t\tvar reversed = [];\r\n\t\twhile (toksTo.length !== 0) {\r\n\t\t\tvar tokTo = toksTo.shift();\r\n\t\t\tif (tokTo === '..') {\r\n\t\t\t\ttoksFrom.pop();\r\n\t\t\t} else if (tokTo !== '.') {\r\n\t\t\t\ttoksFrom.push(tokTo);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn toksFrom.join('/');\r\n\t};\r\n\r\n\tdata.match(tagregex).forEach(function(x) {\r\n\t\tvar y = parsexmltag(x);\r\n\t\t/* 9.3.2.2 OPC_Relationships */\r\n\t\tif (y[0] === '<Relationship') {\r\n\t\t\tvar rel = {}; rel.Type = y.Type; rel.Target = y.Target; rel.Id = y.Id; rel.TargetMode = y.TargetMode;\r\n\t\t\tvar canonictarget = y.TargetMode === 'External' ? y.Target : resolveRelativePathIntoAbsolute(y.Target);\r\n\t\t\trels[canonictarget] = rel;\r\n\t\t\thash[y.Id] = rel;\r\n\t\t}\r\n\t});\r\n\trels[\"!id\"] = hash;\r\n\treturn rels;\r\n}\r\n\r\nXMLNS.RELS = 'http://schemas.openxmlformats.org/package/2006/relationships';\r\n\r\nvar RELS_ROOT = writextag('Relationships', null, {\r\n\t//'xmlns:ns0': XMLNS.RELS,\r\n\t'xmlns': XMLNS.RELS\r\n});\r\n\r\n/* TODO */\r\nfunction write_rels(rels) {\r\n\tvar o = [];\r\n\to[o.length] = (XML_HEADER);\r\n\to[o.length] = (RELS_ROOT);\r\n\tkeys(rels['!id']).forEach(function(rid) { var rel = rels['!id'][rid];\r\n\t\to[o.length] = (writextag('Relationship', null, rel));\r\n\t});\r\n\tif(o.length>2){ o[o.length] = ('</Relationships>'); o[1]=o[1].replace(\"/>\",\">\"); }\r\n\treturn o.join(\"\");\r\n}\r\n/* ECMA-376 Part II 11.1 Core Properties Part */\r\n/* [MS-OSHARED] 2.3.3.2.[1-2].1 (PIDSI/PIDDSI) */\r\nvar CORE_PROPS = [\r\n\t[\"cp:category\", \"Category\"],\r\n\t[\"cp:contentStatus\", \"ContentStatus\"],\r\n\t[\"cp:keywords\", \"Keywords\"],\r\n\t[\"cp:lastModifiedBy\", \"LastAuthor\"],\r\n\t[\"cp:lastPrinted\", \"LastPrinted\"],\r\n\t[\"cp:revision\", \"RevNumber\"],\r\n\t[\"cp:version\", \"Version\"],\r\n\t[\"dc:creator\", \"Author\"],\r\n\t[\"dc:description\", \"Comments\"],\r\n\t[\"dc:identifier\", \"Identifier\"],\r\n\t[\"dc:language\", \"Language\"],\r\n\t[\"dc:subject\", \"Subject\"],\r\n\t[\"dc:title\", \"Title\"],\r\n\t[\"dcterms:created\", \"CreatedDate\", 'date'],\r\n\t[\"dcterms:modified\", \"ModifiedDate\", 'date']\r\n];\r\n\r\nXMLNS.CORE_PROPS = \"http://schemas.openxmlformats.org/package/2006/metadata/core-properties\";\r\nRELS.CORE_PROPS  = 'http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties';\r\n\r\nvar CORE_PROPS_REGEX = (function() {\r\n\tvar r = new Array(CORE_PROPS.length);\r\n\tfor(var i = 0; i < CORE_PROPS.length; ++i) {\r\n\t\tvar f = CORE_PROPS[i];\r\n\t\tvar g = \"(?:\"+ f[0].substr(0,f[0].indexOf(\":\")) +\":)\"+ f[0].substr(f[0].indexOf(\":\")+1);\r\n\t\tr[i] = new RegExp(\"<\" + g + \"[^>]*>(.*)<\\/\" + g + \">\");\r\n\t}\r\n\treturn r;\r\n})();\r\n\r\nfunction parse_core_props(data) {\r\n\tvar p = {};\r\n\r\n\tfor(var i = 0; i < CORE_PROPS.length; ++i) {\r\n\t\tvar f = CORE_PROPS[i], cur = data.match(CORE_PROPS_REGEX[i]);\r\n\t\tif(cur != null && cur.length > 0) p[f[1]] = cur[1];\r\n\t\tif(f[2] === 'date' && p[f[1]]) p[f[1]] = new Date(p[f[1]]);\r\n\t}\r\n\r\n\treturn p;\r\n}\r\n\r\nvar CORE_PROPS_XML_ROOT = writextag('cp:coreProperties', null, {\r\n\t//'xmlns': XMLNS.CORE_PROPS,\r\n\t'xmlns:cp': XMLNS.CORE_PROPS,\r\n\t'xmlns:dc': XMLNS.dc,\r\n\t'xmlns:dcterms': XMLNS.dcterms,\r\n\t'xmlns:dcmitype': XMLNS.dcmitype,\r\n\t'xmlns:xsi': XMLNS.xsi\r\n});\r\n\r\nfunction cp_doit(f, g, h, o, p) {\r\n\tif(p[f] != null || g == null || g === \"\") return;\r\n\tp[f] = g;\r\n\to[o.length] = (h ? writextag(f,g,h) : writetag(f,g));\r\n}\r\n\r\nfunction write_core_props(cp, opts) {\r\n\tvar o = [XML_HEADER, CORE_PROPS_XML_ROOT], p = {};\r\n  if (opts && opts.Props) {\r\n    if (opts.Props.title) o[o.length]       = '<dc:title>'       + opts.Props.title        + '</dc:title>';\r\n    if (opts.Props.subject) o[o.length]     = '<dc:subject>'     + opts.Props.subject      + '</dc:subject>';\r\n    if (opts.Props.creator) o[o.length]     = '<dc:creator>'     + opts.Props.creator      + '</dc:creator>';\r\n    if (opts.Props.keywords) o[o.length]    = '<cp:keywords>'    + opts.Props.keywords      + '</cp:keywords>';\r\n    if (opts.Props.description) o[o.length] = '<dc:description>' + opts.Props.description  + '</dc:description>';\r\n  }\r\n  if(cp) {\r\n\r\n    if(cp.CreatedDate != null) cp_doit(\"dcterms:created\", typeof cp.CreatedDate === \"string\" ? cp.CreatedDate : write_w3cdtf(cp.CreatedDate, opts.WTF), {\"xsi:type\":\"dcterms:W3CDTF\"}, o, p);\r\n    if(cp.ModifiedDate != null) cp_doit(\"dcterms:modified\", typeof cp.ModifiedDate === \"string\" ? cp.ModifiedDate : write_w3cdtf(cp.ModifiedDate, opts.WTF), {\"xsi:type\":\"dcterms:W3CDTF\"}, o, p);\r\n\r\n  \tfor(var i = 0; i != CORE_PROPS.length; ++i) { var f = CORE_PROPS[i]; cp_doit(f[0], cp[f[1]], null, o, p); }\r\n  }\r\n  if(o.length>2){ o[o.length] = ('</cp:coreProperties>'); o[1]=o[1].replace(\"/>\",\">\"); }\r\n  return o.join(\"\");\r\n}\r\n/* 15.2.12.3 Extended File Properties Part */\r\n/* [MS-OSHARED] 2.3.3.2.[1-2].1 (PIDSI/PIDDSI) */\r\nvar EXT_PROPS = [\r\n\t[\"Application\", \"Application\", \"string\"],\r\n\t[\"AppVersion\", \"AppVersion\", \"string\"],\r\n\t[\"Company\", \"Company\", \"string\"],\r\n\t[\"DocSecurity\", \"DocSecurity\", \"string\"],\r\n\t[\"Manager\", \"Manager\", \"string\"],\r\n\t[\"HyperlinksChanged\", \"HyperlinksChanged\", \"bool\"],\r\n\t[\"SharedDoc\", \"SharedDoc\", \"bool\"],\r\n\t[\"LinksUpToDate\", \"LinksUpToDate\", \"bool\"],\r\n\t[\"ScaleCrop\", \"ScaleCrop\", \"bool\"],\r\n\t[\"HeadingPairs\", \"HeadingPairs\", \"raw\"],\r\n\t[\"TitlesOfParts\", \"TitlesOfParts\", \"raw\"]\r\n];\r\n\r\nXMLNS.EXT_PROPS = \"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties\";\r\nRELS.EXT_PROPS  = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties';\r\n\r\nfunction parse_ext_props(data, p) {\r\n\tvar q = {}; if(!p) p = {};\r\n\r\n\tEXT_PROPS.forEach(function(f) {\r\n\t\tswitch(f[2]) {\r\n\t\t\tcase \"string\": p[f[1]] = (data.match(matchtag(f[0]))||[])[1]; break;\r\n\t\t\tcase \"bool\": p[f[1]] = (data.match(matchtag(f[0]))||[])[1] === \"true\"; break;\r\n\t\t\tcase \"raw\":\r\n\t\t\t\tvar cur = data.match(new RegExp(\"<\" + f[0] + \"[^>]*>(.*)<\\/\" + f[0] + \">\"));\r\n\t\t\t\tif(cur && cur.length > 0) q[f[1]] = cur[1];\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t});\r\n\r\n\tif(q.HeadingPairs && q.TitlesOfParts) {\r\n\t\tvar v = parseVector(q.HeadingPairs);\r\n\t\tvar j = 0, widx = 0;\r\n\t\tfor(var i = 0; i !== v.length; ++i) {\r\n\t\t\tswitch(v[i].v) {\r\n\t\t\t\tcase \"Worksheets\": widx = j; p.Worksheets = +(v[++i].v); break;\r\n\t\t\t\tcase \"Named Ranges\": ++i; break; // TODO: Handle Named Ranges\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar parts = parseVector(q.TitlesOfParts).map(function(x) { return utf8read(x.v); });\r\n\t\tp.SheetNames = parts.slice(widx, widx + p.Worksheets);\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nvar EXT_PROPS_XML_ROOT = writextag('Properties', null, {\r\n\t'xmlns': XMLNS.EXT_PROPS,\r\n\t'xmlns:vt': XMLNS.vt\r\n});\r\n\r\nfunction write_ext_props(cp, opts) {\r\n\tvar o = [], p = {}, W = writextag;\r\n\tif(!cp) cp = {};\r\n\tcp.Application = \"SheetJS\";\r\n\to[o.length] = (XML_HEADER);\r\n\to[o.length] = (EXT_PROPS_XML_ROOT);\r\n\r\n\tEXT_PROPS.forEach(function(f) {\r\n\t\tif(cp[f[1]] === undefined) return;\r\n\t\tvar v;\r\n\t\tswitch(f[2]) {\r\n\t\t\tcase 'string': v = cp[f[1]]; break;\r\n\t\t\tcase 'bool': v = cp[f[1]] ? 'true' : 'false'; break;\r\n\t\t}\r\n\t\tif(v !== undefined) o[o.length] = (W(f[0], v));\r\n\t});\r\n\r\n\t/* TODO: HeadingPairs, TitlesOfParts */\r\n\to[o.length] = (W('HeadingPairs', W('vt:vector', W('vt:variant', '<vt:lpstr>Worksheets</vt:lpstr>')+W('vt:variant', W('vt:i4', String(cp.Worksheets))), {size:2, baseType:\"variant\"})));\r\n\to[o.length] = (W('TitlesOfParts', W('vt:vector', cp.SheetNames.map(function(s) { return \"<vt:lpstr>\" + s + \"</vt:lpstr>\"; }).join(\"\"), {size: cp.Worksheets, baseType:\"lpstr\"})));\r\n\tif(o.length>2){ o[o.length] = ('</Properties>'); o[1]=o[1].replace(\"/>\",\">\"); }\r\n\treturn o.join(\"\");\r\n}\r\n/* 15.2.12.2 Custom File Properties Part */\r\nXMLNS.CUST_PROPS = \"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties\";\r\nRELS.CUST_PROPS  = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties';\r\n\r\nvar custregex = /<[^>]+>[^<]*/g;\r\nfunction parse_cust_props(data, opts) {\r\n\tvar p = {}, name;\r\n\tvar m = data.match(custregex);\r\n\tif(m) for(var i = 0; i != m.length; ++i) {\r\n\t\tvar x = m[i], y = parsexmltag(x);\r\n\t\tswitch(y[0]) {\r\n\t\t\tcase '<?xml': break;\r\n\t\t\tcase '<Properties':\r\n\t\t\t\tif(y.xmlns !== XMLNS.CUST_PROPS) throw \"unrecognized xmlns \" + y.xmlns;\r\n\t\t\t\tif(y.xmlnsvt && y.xmlnsvt !== XMLNS.vt) throw \"unrecognized vt \" + y.xmlnsvt;\r\n\t\t\t\tbreak;\r\n\t\t\tcase '<property': name = y.name; break;\r\n\t\t\tcase '</property>': name = null; break;\r\n\t\t\tdefault: if (x.indexOf('<vt:') === 0) {\r\n\t\t\t\tvar toks = x.split('>');\r\n\t\t\t\tvar type = toks[0].substring(4), text = toks[1];\r\n\t\t\t\t/* 22.4.2.32 (CT_Variant). Omit the binary types from 22.4 (Variant Types) */\r\n\t\t\t\tswitch(type) {\r\n\t\t\t\t\tcase 'lpstr': case 'lpwstr': case 'bstr': case 'lpwstr':\r\n\t\t\t\t\t\tp[name] = unescapexml(text);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'bool':\r\n\t\t\t\t\t\tp[name] = parsexmlbool(text, '<vt:bool>');\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'i1': case 'i2': case 'i4': case 'i8': case 'int': case 'uint':\r\n\t\t\t\t\t\tp[name] = parseInt(text, 10);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'r4': case 'r8': case 'decimal':\r\n\t\t\t\t\t\tp[name] = parseFloat(text);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'filetime': case 'date':\r\n\t\t\t\t\t\tp[name] = new Date(text);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'cy': case 'error':\r\n\t\t\t\t\t\tp[name] = unescapexml(text);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tif(typeof console !== 'undefined') console.warn('Unexpected', x, type, toks);\r\n\t\t\t\t}\r\n\t\t\t} else if(x.substr(0,2) === \"</\") {\r\n\t\t\t} else if(opts.WTF) throw new Error(x);\r\n\t\t}\r\n\t}\r\n\treturn p;\r\n}\r\n\r\nvar CUST_PROPS_XML_ROOT = writextag('Properties', null, {\r\n\t'xmlns': XMLNS.CUST_PROPS,\r\n\t'xmlns:vt': XMLNS.vt\r\n});\r\n\r\nfunction write_cust_props(cp, opts) {\r\n\tvar o = [XML_HEADER, CUST_PROPS_XML_ROOT];\r\n\tif(!cp) return o.join(\"\");\r\n\tvar pid = 1;\r\n\tkeys(cp).forEach(function custprop(k) { ++pid;\r\n\t\to[o.length] = (writextag('property', write_vt(cp[k]), {\r\n\t\t\t'fmtid': '{D5CDD505-2E9C-101B-9397-08002B2CF9AE}',\r\n\t\t\t'pid': pid,\r\n\t\t\t'name': k\r\n\t\t}));\r\n\t});\r\n\tif(o.length>2){ o[o.length] = '</Properties>'; o[1]=o[1].replace(\"/>\",\">\"); }\r\n\treturn o.join(\"\");\r\n}\r\nfunction xlml_set_prop(Props, tag, val) {\r\n\t/* TODO: Normalize the properties */\r\n\tswitch(tag) {\r\n\t\tcase 'Description': tag = 'Comments'; break;\r\n\t}\r\n\tProps[tag] = val;\r\n}\r\n\r\n/* [MS-DTYP] 2.3.3 FILETIME */\r\n/* [MS-OLEDS] 2.1.3 FILETIME (Packet Version) */\r\n/* [MS-OLEPS] 2.8 FILETIME (Packet Version) */\r\nfunction parse_FILETIME(blob) {\r\n\tvar dwLowDateTime = blob.read_shift(4), dwHighDateTime = blob.read_shift(4);\r\n\treturn new Date(((dwHighDateTime/1e7*Math.pow(2,32) + dwLowDateTime/1e7) - 11644473600)*1000).toISOString().replace(/\\.000/,\"\");\r\n}\r\n\r\n/* [MS-OSHARED] 2.3.3.1.4 Lpstr */\r\nfunction parse_lpstr(blob, type, pad) {\r\n\tvar str = blob.read_shift(0, 'lpstr');\r\n\tif(pad) blob.l += (4 - ((str.length+1) & 3)) & 3;\r\n\treturn str;\r\n}\r\n\r\n/* [MS-OSHARED] 2.3.3.1.6 Lpwstr */\r\nfunction parse_lpwstr(blob, type, pad) {\r\n\tvar str = blob.read_shift(0, 'lpwstr');\r\n\tif(pad) blob.l += (4 - ((str.length+1) & 3)) & 3;\r\n\treturn str;\r\n}\r\n\r\n\r\n/* [MS-OSHARED] 2.3.3.1.11 VtString */\r\n/* [MS-OSHARED] 2.3.3.1.12 VtUnalignedString */\r\nfunction parse_VtStringBase(blob, stringType, pad) {\r\n\tif(stringType === 0x1F /*VT_LPWSTR*/) return parse_lpwstr(blob);\r\n\treturn parse_lpstr(blob, stringType, pad);\r\n}\r\n\r\nfunction parse_VtString(blob, t, pad) { return parse_VtStringBase(blob, t, pad === false ? 0: 4); }\r\nfunction parse_VtUnalignedString(blob, t) { if(!t) throw new Error(\"dafuq?\"); return parse_VtStringBase(blob, t, 0); }\r\n\r\n/* [MS-OSHARED] 2.3.3.1.9 VtVecUnalignedLpstrValue */\r\nfunction parse_VtVecUnalignedLpstrValue(blob) {\r\n\tvar length = blob.read_shift(4);\r\n\tvar ret = [];\r\n\tfor(var i = 0; i != length; ++i) ret[i] = blob.read_shift(0, 'lpstr');\r\n\treturn ret;\r\n}\r\n\r\n/* [MS-OSHARED] 2.3.3.1.10 VtVecUnalignedLpstr */\r\nfunction parse_VtVecUnalignedLpstr(blob) {\r\n\treturn parse_VtVecUnalignedLpstrValue(blob);\r\n}\r\n\r\n/* [MS-OSHARED] 2.3.3.1.13 VtHeadingPair */\r\nfunction parse_VtHeadingPair(blob) {\r\n\tvar headingString = parse_TypedPropertyValue(blob, VT_USTR);\r\n\tvar headerParts = parse_TypedPropertyValue(blob, VT_I4);\r\n\treturn [headingString, headerParts];\r\n}\r\n\r\n/* [MS-OSHARED] 2.3.3.1.14 VtVecHeadingPairValue */\r\nfunction parse_VtVecHeadingPairValue(blob) {\r\n\tvar cElements = blob.read_shift(4);\r\n\tvar out = [];\r\n\tfor(var i = 0; i != cElements / 2; ++i) out.push(parse_VtHeadingPair(blob));\r\n\treturn out;\r\n}\r\n\r\n/* [MS-OSHARED] 2.3.3.1.15 VtVecHeadingPair */\r\nfunction parse_VtVecHeadingPair(blob) {\r\n\t// NOTE: When invoked, wType & padding were already consumed\r\n\treturn parse_VtVecHeadingPairValue(blob);\r\n}\r\n\r\n/* [MS-OLEPS] 2.18.1 Dictionary (uses 2.17, 2.16) */\r\nfunction parse_dictionary(blob,CodePage) {\r\n\tvar cnt = blob.read_shift(4);\r\n\tvar dict = {};\r\n\tfor(var j = 0; j != cnt; ++j) {\r\n\t\tvar pid = blob.read_shift(4);\r\n\t\tvar len = blob.read_shift(4);\r\n\t\tdict[pid] = blob.read_shift(len, (CodePage === 0x4B0 ?'utf16le':'utf8')).replace(chr0,'').replace(chr1,'!');\r\n\t}\r\n\tif(blob.l & 3) blob.l = (blob.l>>2+1)<<2;\r\n\treturn dict;\r\n}\r\n\r\n/* [MS-OLEPS] 2.9 BLOB */\r\nfunction parse_BLOB(blob) {\r\n\tvar size = blob.read_shift(4);\r\n\tvar bytes = blob.slice(blob.l,blob.l+size);\r\n\tif(size & 3 > 0) blob.l += (4 - (size & 3)) & 3;\r\n\treturn bytes;\r\n}\r\n\r\n/* [MS-OLEPS] 2.11 ClipboardData */\r\nfunction parse_ClipboardData(blob) {\r\n\t// TODO\r\n\tvar o = {};\r\n\to.Size = blob.read_shift(4);\r\n\t//o.Format = blob.read_shift(4);\r\n\tblob.l += o.Size;\r\n\treturn o;\r\n}\r\n\r\n/* [MS-OLEPS] 2.14 Vector and Array Property Types */\r\nfunction parse_VtVector(blob, cb) {\r\n\t/* [MS-OLEPS] 2.14.2 VectorHeader */\r\n/*\tvar Length = blob.read_shift(4);\r\n\tvar o = [];\r\n\tfor(var i = 0; i != Length; ++i) {\r\n\t\to.push(cb(blob));\r\n\t}\r\n\treturn o;*/\r\n}\r\n\r\n/* [MS-OLEPS] 2.15 TypedPropertyValue */\r\nfunction parse_TypedPropertyValue(blob, type, _opts) {\r\n\tvar t = blob.read_shift(2), ret, opts = _opts||{};\r\n\tblob.l += 2;\r\n\tif(type !== VT_VARIANT)\r\n\tif(t !== type && VT_CUSTOM.indexOf(type)===-1) throw new Error('Expected type ' + type + ' saw ' + t);\r\n\tswitch(type === VT_VARIANT ? t : type) {\r\n\t\tcase 0x02 /*VT_I2*/: ret = blob.read_shift(2, 'i'); if(!opts.raw) blob.l += 2; return ret;\r\n\t\tcase 0x03 /*VT_I4*/: ret = blob.read_shift(4, 'i'); return ret;\r\n\t\tcase 0x0B /*VT_BOOL*/: return blob.read_shift(4) !== 0x0;\r\n\t\tcase 0x13 /*VT_UI4*/: ret = blob.read_shift(4); return ret;\r\n\t\tcase 0x1E /*VT_LPSTR*/: return parse_lpstr(blob, t, 4).replace(chr0,'');\r\n\t\tcase 0x1F /*VT_LPWSTR*/: return parse_lpwstr(blob);\r\n\t\tcase 0x40 /*VT_FILETIME*/: return parse_FILETIME(blob);\r\n\t\tcase 0x41 /*VT_BLOB*/: return parse_BLOB(blob);\r\n\t\tcase 0x47 /*VT_CF*/: return parse_ClipboardData(blob);\r\n\t\tcase 0x50 /*VT_STRING*/: return parse_VtString(blob, t, !opts.raw && 4).replace(chr0,'');\r\n\t\tcase 0x51 /*VT_USTR*/: return parse_VtUnalignedString(blob, t, 4).replace(chr0,'');\r\n\t\tcase 0x100C /*VT_VECTOR|VT_VARIANT*/: return parse_VtVecHeadingPair(blob);\r\n\t\tcase 0x101E /*VT_LPSTR*/: return parse_VtVecUnalignedLpstr(blob);\r\n\t\tdefault: throw new Error(\"TypedPropertyValue unrecognized type \" + type + \" \" + t);\r\n\t}\r\n}\r\n/* [MS-OLEPS] 2.14.2 VectorHeader */\r\n/*function parse_VTVectorVariant(blob) {\r\n\tvar Length = blob.read_shift(4);\r\n\r\n\tif(Length & 1 !== 0) throw new Error(\"VectorHeader Length=\" + Length + \" must be even\");\r\n\tvar o = [];\r\n\tfor(var i = 0; i != Length; ++i) {\r\n\t\to.push(parse_TypedPropertyValue(blob, VT_VARIANT));\r\n\t}\r\n\treturn o;\r\n}*/\r\n\r\n/* [MS-OLEPS] 2.20 PropertySet */\r\nfunction parse_PropertySet(blob, PIDSI) {\r\n\tvar start_addr = blob.l;\r\n\tvar size = blob.read_shift(4);\r\n\tvar NumProps = blob.read_shift(4);\r\n\tvar Props = [], i = 0;\r\n\tvar CodePage = 0;\r\n\tvar Dictionary = -1, DictObj;\r\n\tfor(i = 0; i != NumProps; ++i) {\r\n\t\tvar PropID = blob.read_shift(4);\r\n\t\tvar Offset = blob.read_shift(4);\r\n\t\tProps[i] = [PropID, Offset + start_addr];\r\n\t}\r\n\tvar PropH = {};\r\n\tfor(i = 0; i != NumProps; ++i) {\r\n\t\tif(blob.l !== Props[i][1]) {\r\n\t\t\tvar fail = true;\r\n\t\t\tif(i>0 && PIDSI) switch(PIDSI[Props[i-1][0]].t) {\r\n\t\t\t\tcase 0x02 /*VT_I2*/: if(blob.l +2 === Props[i][1]) { blob.l+=2; fail = false; } break;\r\n\t\t\t\tcase 0x50 /*VT_STRING*/: if(blob.l <= Props[i][1]) { blob.l=Props[i][1]; fail = false; } break;\r\n\t\t\t\tcase 0x100C /*VT_VECTOR|VT_VARIANT*/: if(blob.l <= Props[i][1]) { blob.l=Props[i][1]; fail = false; } break;\r\n\t\t\t}\r\n\t\t\tif(!PIDSI && blob.l <= Props[i][1]) { fail=false; blob.l = Props[i][1]; }\r\n\t\t\tif(fail) throw new Error(\"Read Error: Expected address \" + Props[i][1] + ' at ' + blob.l + ' :' + i);\r\n\t\t}\r\n\t\tif(PIDSI) {\r\n\t\t\tvar piddsi = PIDSI[Props[i][0]];\r\n\t\t\tPropH[piddsi.n] = parse_TypedPropertyValue(blob, piddsi.t, {raw:true});\r\n\t\t\tif(piddsi.p === 'version') PropH[piddsi.n] = String(PropH[piddsi.n] >> 16) + \".\" + String(PropH[piddsi.n] & 0xFFFF);\r\n\t\t\tif(piddsi.n == \"CodePage\") switch(PropH[piddsi.n]) {\r\n\t\t\t\tcase 0: PropH[piddsi.n] = 1252;\r\n\t\t\t\t\t/* falls through */\r\n\t\t\t\tcase 10000: // OSX Roman\r\n\t\t\t\tcase 1252: // Windows Latin\r\n\r\n\t\t\t\tcase 874: // SB Windows Thai\r\n\t\t\t\tcase 1250: // SB Windows Central Europe\r\n\t\t\t\tcase 1251: // SB Windows Cyrillic\r\n\t\t\t\tcase 1253: // SB Windows Greek\r\n\t\t\t\tcase 1254: // SB Windows Turkish\r\n\t\t\t\tcase 1255: // SB Windows Hebrew\r\n\t\t\t\tcase 1256: // SB Windows Arabic\r\n\t\t\t\tcase 1257: // SB Windows Baltic\r\n\t\t\t\tcase 1258: // SB Windows Vietnam\r\n\r\n\t\t\t\tcase 932: // DB Windows Japanese Shift-JIS\r\n\t\t\t\tcase 936: // DB Windows Simplified Chinese GBK\r\n\t\t\t\tcase 949: // DB Windows Korean\r\n\t\t\t\tcase 950: // DB Windows Traditional Chinese Big5\r\n\r\n\t\t\t\tcase 1200: // UTF16LE\r\n\t\t\t\tcase 1201: // UTF16BE\r\n\t\t\t\tcase 65000: case -536: // UTF-7\r\n\t\t\t\tcase 65001: case -535: // UTF-8\r\n\t\t\t\t\tset_cp(CodePage = PropH[piddsi.n]); break;\r\n\t\t\t\tdefault: throw new Error(\"Unsupported CodePage: \" + PropH[piddsi.n]);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif(Props[i][0] === 0x1) {\r\n\t\t\t\tCodePage = PropH.CodePage = parse_TypedPropertyValue(blob, VT_I2);\r\n\t\t\t\tset_cp(CodePage);\r\n\t\t\t\tif(Dictionary !== -1) {\r\n\t\t\t\t\tvar oldpos = blob.l;\r\n\t\t\t\t\tblob.l = Props[Dictionary][1];\r\n\t\t\t\t\tDictObj = parse_dictionary(blob,CodePage);\r\n\t\t\t\t\tblob.l = oldpos;\r\n\t\t\t\t}\r\n\t\t\t} else if(Props[i][0] === 0) {\r\n\t\t\t\tif(CodePage === 0) { Dictionary = i; blob.l = Props[i+1][1]; continue; }\r\n\t\t\t\tDictObj = parse_dictionary(blob,CodePage);\r\n\t\t\t} else {\r\n\t\t\t\tvar name = DictObj[Props[i][0]];\r\n\t\t\t\tvar val;\r\n\t\t\t\t/* [MS-OSHARED] 2.3.3.2.3.1.2 + PROPVARIANT */\r\n\t\t\t\tswitch(blob[blob.l]) {\r\n\t\t\t\t\tcase 0x41 /*VT_BLOB*/: blob.l += 4; val = parse_BLOB(blob); break;\r\n\t\t\t\t\tcase 0x1E /*VT_LPSTR*/: blob.l += 4; val = parse_VtString(blob, blob[blob.l-4]); break;\r\n\t\t\t\t\tcase 0x1F /*VT_LPWSTR*/: blob.l += 4; val = parse_VtString(blob, blob[blob.l-4]); break;\r\n\t\t\t\t\tcase 0x03 /*VT_I4*/: blob.l += 4; val = blob.read_shift(4, 'i'); break;\r\n\t\t\t\t\tcase 0x13 /*VT_UI4*/: blob.l += 4; val = blob.read_shift(4); break;\r\n\t\t\t\t\tcase 0x05 /*VT_R8*/: blob.l += 4; val = blob.read_shift(8, 'f'); break;\r\n\t\t\t\t\tcase 0x0B /*VT_BOOL*/: blob.l += 4; val = parsebool(blob, 4); break;\r\n\t\t\t\t\tcase 0x40 /*VT_FILETIME*/: blob.l += 4; val = new Date(parse_FILETIME(blob)); break;\r\n\t\t\t\t\tdefault: throw new Error(\"unparsed value: \" + blob[blob.l]);\r\n\t\t\t\t}\r\n\t\t\t\tPropH[name] = val;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tblob.l = start_addr + size; /* step ahead to skip padding */\r\n\treturn PropH;\r\n}\r\n\r\n/* [MS-OLEPS] 2.21 PropertySetStream */\r\nfunction parse_PropertySetStream(file, PIDSI) {\r\n\tvar blob = file.content;\r\n\tprep_blob(blob, 0);\r\n\r\n\tvar NumSets, FMTID0, FMTID1, Offset0, Offset1;\r\n\tblob.chk('feff', 'Byte Order: ');\r\n\r\n\tvar vers = blob.read_shift(2); // TODO: check version\r\n\tvar SystemIdentifier = blob.read_shift(4);\r\n\tblob.chk(CFB.utils.consts.HEADER_CLSID, 'CLSID: ');\r\n\tNumSets = blob.read_shift(4);\r\n\tif(NumSets !== 1 && NumSets !== 2) throw \"Unrecognized #Sets: \" + NumSets;\r\n\tFMTID0 = blob.read_shift(16); Offset0 = blob.read_shift(4);\r\n\r\n\tif(NumSets === 1 && Offset0 !== blob.l) throw \"Length mismatch\";\r\n\telse if(NumSets === 2) { FMTID1 = blob.read_shift(16); Offset1 = blob.read_shift(4); }\r\n\tvar PSet0 = parse_PropertySet(blob, PIDSI);\r\n\r\n\tvar rval = { SystemIdentifier: SystemIdentifier };\r\n\tfor(var y in PSet0) rval[y] = PSet0[y];\r\n\t//rval.blob = blob;\r\n\trval.FMTID = FMTID0;\r\n\t//rval.PSet0 = PSet0;\r\n\tif(NumSets === 1) return rval;\r\n\tif(blob.l !== Offset1) throw \"Length mismatch 2: \" + blob.l + \" !== \" + Offset1;\r\n\tvar PSet1;\r\n\ttry { PSet1 = parse_PropertySet(blob, null); } catch(e) { }\r\n\tfor(y in PSet1) rval[y] = PSet1[y];\r\n\trval.FMTID = [FMTID0, FMTID1]; // TODO: verify FMTID0/1\r\n\treturn rval;\r\n}\r\n\r\n\r\nfunction parsenoop2(blob, length) { blob.read_shift(length); return null; }\r\n\r\nfunction parslurp(blob, length, cb) {\r\n\tvar arr = [], target = blob.l + length;\r\n\twhile(blob.l < target) arr.push(cb(blob, target - blob.l));\r\n\tif(target !== blob.l) throw new Error(\"Slurp error\");\r\n\treturn arr;\r\n}\r\n\r\nfunction parslurp2(blob, length, cb) {\r\n\tvar arr = [], target = blob.l + length, len = blob.read_shift(2);\r\n\twhile(len-- !== 0) arr.push(cb(blob, target - blob.l));\r\n\tif(target !== blob.l) throw new Error(\"Slurp error\");\r\n\treturn arr;\r\n}\r\n\r\nfunction parsebool(blob, length) { return blob.read_shift(length) === 0x1; }\r\n\r\nfunction parseuint16(blob) { return blob.read_shift(2, 'u'); }\r\nfunction parseuint16a(blob, length) { return parslurp(blob,length,parseuint16);}\r\n\r\n/* --- 2.5 Structures --- */\r\n\r\n/* [MS-XLS] 2.5.14 Boolean */\r\nvar parse_Boolean = parsebool;\r\n\r\n/* [MS-XLS] 2.5.10 Bes (boolean or error) */\r\nfunction parse_Bes(blob) {\r\n\tvar v = blob.read_shift(1), t = blob.read_shift(1);\r\n\treturn t === 0x01 ? v : v === 0x01;\r\n}\r\n\r\n/* [MS-XLS] 2.5.240 ShortXLUnicodeString */\r\nfunction parse_ShortXLUnicodeString(blob, length, opts) {\r\n\tvar cch = blob.read_shift(1);\r\n\tvar width = 1, encoding = 'sbcs-cont';\r\n\tvar cp = current_codepage;\r\n\tif(opts && opts.biff >= 8) current_codepage = 1200;\r\n\tif(opts === undefined || opts.biff !== 5) {\r\n\t\tvar fHighByte = blob.read_shift(1);\r\n\t\tif(fHighByte) { width = 2; encoding = 'dbcs-cont'; }\r\n\t}\r\n\tvar o = cch ? blob.read_shift(cch, encoding) : \"\";\r\n\tcurrent_codepage = cp;\r\n\treturn o;\r\n}\r\n\r\n/* 2.5.293 XLUnicodeRichExtendedString */\r\nfunction parse_XLUnicodeRichExtendedString(blob) {\r\n\tvar cp = current_codepage;\r\n\tcurrent_codepage = 1200;\r\n\tvar cch = blob.read_shift(2), flags = blob.read_shift(1);\r\n\tvar fHighByte = flags & 0x1, fExtSt = flags & 0x4, fRichSt = flags & 0x8;\r\n\tvar width = 1 + (flags & 0x1); // 0x0 -> utf8, 0x1 -> dbcs\r\n\tvar cRun, cbExtRst;\r\n\tvar z = {};\r\n\tif(fRichSt) cRun = blob.read_shift(2);\r\n\tif(fExtSt) cbExtRst = blob.read_shift(4);\r\n\tvar encoding = (flags & 0x1) ? 'dbcs-cont' : 'sbcs-cont';\r\n\tvar msg = cch === 0 ? \"\" : blob.read_shift(cch, encoding);\r\n\tif(fRichSt) blob.l += 4 * cRun; //TODO: parse this\r\n\tif(fExtSt) blob.l += cbExtRst; //TODO: parse this\r\n\tz.t = msg;\r\n\tif(!fRichSt) { z.raw = \"<t>\" + z.t + \"</t>\"; z.r = z.t; }\r\n\tcurrent_codepage = cp;\r\n\treturn z;\r\n}\r\n\r\n/* 2.5.296 XLUnicodeStringNoCch */\r\nfunction parse_XLUnicodeStringNoCch(blob, cch, opts) {\r\n\tvar retval;\r\n\tvar fHighByte = blob.read_shift(1);\r\n\tif(fHighByte===0) { retval = blob.read_shift(cch, 'sbcs-cont'); }\r\n\telse { retval = blob.read_shift(cch, 'dbcs-cont'); }\r\n\treturn retval;\r\n}\r\n\r\n/* 2.5.294 XLUnicodeString */\r\nfunction parse_XLUnicodeString(blob, length, opts) {\r\n\tvar cch = blob.read_shift(opts !== undefined && opts.biff > 0 && opts.biff < 8 ? 1 : 2);\r\n\tif(cch === 0) { blob.l++; return \"\"; }\r\n\treturn parse_XLUnicodeStringNoCch(blob, cch, opts);\r\n}\r\n/* BIFF5 override */\r\nfunction parse_XLUnicodeString2(blob, length, opts) {\r\n\tif(opts.biff !== 5 && opts.biff !== 2) return parse_XLUnicodeString(blob, length, opts);\r\n\tvar cch = blob.read_shift(1);\r\n\tif(cch === 0) { blob.l++; return \"\"; }\r\n\treturn blob.read_shift(cch, 'sbcs-cont');\r\n}\r\n\r\n/* [MS-XLS] 2.5.61 ControlInfo */\r\nvar parse_ControlInfo = parsenoop;\r\n\r\n/* [MS-OSHARED] 2.3.7.6 URLMoniker TODO: flags */\r\nvar parse_URLMoniker = function(blob, length) {\r\n\tvar len = blob.read_shift(4), start = blob.l;\r\n\tvar extra = false;\r\n\tif(len > 24) {\r\n\t\t/* look ahead */\r\n\t\tblob.l += len - 24;\r\n\t\tif(blob.read_shift(16) === \"795881f43b1d7f48af2c825dc4852763\") extra = true;\r\n\t\tblob.l = start;\r\n\t}\r\n\tvar url = blob.read_shift((extra?len-24:len)>>1, 'utf16le').replace(chr0,\"\");\r\n\tif(extra) blob.l += 24;\r\n\treturn url;\r\n};\r\n\r\n/* [MS-OSHARED] 2.3.7.8 FileMoniker TODO: all fields */\r\nvar parse_FileMoniker = function(blob, length) {\r\n\tvar cAnti = blob.read_shift(2);\r\n\tvar ansiLength = blob.read_shift(4);\r\n\tvar ansiPath = blob.read_shift(ansiLength, 'cstr');\r\n\tvar endServer = blob.read_shift(2);\r\n\tvar versionNumber = blob.read_shift(2);\r\n\tvar cbUnicodePathSize = blob.read_shift(4);\r\n\tif(cbUnicodePathSize === 0) return ansiPath.replace(/\\\\/g,\"/\");\r\n\tvar cbUnicodePathBytes = blob.read_shift(4);\r\n\tvar usKeyValue = blob.read_shift(2);\r\n\tvar unicodePath = blob.read_shift(cbUnicodePathBytes>>1, 'utf16le').replace(chr0,\"\");\r\n\treturn unicodePath;\r\n};\r\n\r\n/* [MS-OSHARED] 2.3.7.2 HyperlinkMoniker TODO: all the monikers */\r\nvar parse_HyperlinkMoniker = function(blob, length) {\r\n\tvar clsid = blob.read_shift(16); length -= 16;\r\n\tswitch(clsid) {\r\n\t\tcase \"e0c9ea79f9bace118c8200aa004ba90b\": return parse_URLMoniker(blob, length);\r\n\t\tcase \"0303000000000000c000000000000046\": return parse_FileMoniker(blob, length);\r\n\t\tdefault: throw \"unsupported moniker \" + clsid;\r\n\t}\r\n};\r\n\r\n/* [MS-OSHARED] 2.3.7.9 HyperlinkString */\r\nvar parse_HyperlinkString = function(blob, length) {\r\n\tvar len = blob.read_shift(4);\r\n\tvar o = blob.read_shift(len, 'utf16le').replace(chr0, \"\");\r\n\treturn o;\r\n};\r\n\r\n/* [MS-OSHARED] 2.3.7.1 Hyperlink Object TODO: unify params with XLSX */\r\nvar parse_Hyperlink = function(blob, length) {\r\n\tvar end = blob.l + length;\r\n\tvar sVer = blob.read_shift(4);\r\n\tif(sVer !== 2) throw new Error(\"Unrecognized streamVersion: \" + sVer);\r\n\tvar flags = blob.read_shift(2);\r\n\tblob.l += 2;\r\n\tvar displayName, targetFrameName, moniker, oleMoniker, location, guid, fileTime;\r\n\tif(flags & 0x0010) displayName = parse_HyperlinkString(blob, end - blob.l);\r\n\tif(flags & 0x0080) targetFrameName = parse_HyperlinkString(blob, end - blob.l);\r\n\tif((flags & 0x0101) === 0x0101) moniker = parse_HyperlinkString(blob, end - blob.l);\r\n\tif((flags & 0x0101) === 0x0001) oleMoniker = parse_HyperlinkMoniker(blob, end - blob.l);\r\n\tif(flags & 0x0008) location = parse_HyperlinkString(blob, end - blob.l);\r\n\tif(flags & 0x0020) guid = blob.read_shift(16);\r\n\tif(flags & 0x0040) fileTime = parse_FILETIME(blob, 8);\r\n\tblob.l = end;\r\n\tvar target = (targetFrameName||moniker||oleMoniker);\r\n\tif(location) target+=\"#\"+location;\r\n\treturn {Target: target};\r\n};\r\n\r\n/* 2.5.178 LongRGBA */\r\nfunction parse_LongRGBA(blob, length) { var r = blob.read_shift(1), g = blob.read_shift(1), b = blob.read_shift(1), a = blob.read_shift(1); return [r,g,b,a]; }\r\n\r\n/* 2.5.177 LongRGB */\r\nfunction parse_LongRGB(blob, length) { var x = parse_LongRGBA(blob, length); x[3] = 0; return x; }\r\n\r\n\r\n/* --- MS-XLS --- */\r\n\r\n/* 2.5.19 */\r\nfunction parse_XLSCell(blob, length) {\r\n\tvar rw = blob.read_shift(2); // 0-indexed\r\n\tvar col = blob.read_shift(2);\r\n\tvar ixfe = blob.read_shift(2);\r\n\treturn {r:rw, c:col, ixfe:ixfe};\r\n}\r\n\r\n/* 2.5.134 */\r\nfunction parse_frtHeader(blob) {\r\n\tvar rt = blob.read_shift(2);\r\n\tvar flags = blob.read_shift(2); // TODO: parse these flags\r\n\tblob.l += 8;\r\n\treturn {type: rt, flags: flags};\r\n}\r\n\r\n\r\n\r\nfunction parse_OptXLUnicodeString(blob, length, opts) { return length === 0 ? \"\" : parse_XLUnicodeString2(blob, length, opts); }\r\n\r\n/* 2.5.158 */\r\nvar HIDEOBJENUM = ['SHOWALL', 'SHOWPLACEHOLDER', 'HIDEALL'];\r\nvar parse_HideObjEnum = parseuint16;\r\n\r\n/* 2.5.344 */\r\nfunction parse_XTI(blob, length) {\r\n\tvar iSupBook = blob.read_shift(2), itabFirst = blob.read_shift(2,'i'), itabLast = blob.read_shift(2,'i');\r\n\treturn [iSupBook, itabFirst, itabLast];\r\n}\r\n\r\n/* 2.5.218 */\r\nfunction parse_RkRec(blob, length) {\r\n\tvar ixfe = blob.read_shift(2);\r\n\tvar RK = parse_RkNumber(blob);\r\n\t//console.log(\"::\", ixfe, RK,\";;\");\r\n\treturn [ixfe, RK];\r\n}\r\n\r\n/* 2.5.1 */\r\nfunction parse_AddinUdf(blob, length) {\r\n\tblob.l += 4; length -= 4;\r\n\tvar l = blob.l + length;\r\n\tvar udfName = parse_ShortXLUnicodeString(blob, length);\r\n\tvar cb = blob.read_shift(2);\r\n\tl -= blob.l;\r\n\tif(cb !== l) throw \"Malformed AddinUdf: padding = \" + l + \" != \" + cb;\r\n\tblob.l += cb;\r\n\treturn udfName;\r\n}\r\n\r\n/* 2.5.209 TODO: Check sizes */\r\nfunction parse_Ref8U(blob, length) {\r\n\tvar rwFirst = blob.read_shift(2);\r\n\tvar rwLast = blob.read_shift(2);\r\n\tvar colFirst = blob.read_shift(2);\r\n\tvar colLast = blob.read_shift(2);\r\n\treturn {s:{c:colFirst, r:rwFirst}, e:{c:colLast,r:rwLast}};\r\n}\r\n\r\n/* 2.5.211 */\r\nfunction parse_RefU(blob, length) {\r\n\tvar rwFirst = blob.read_shift(2);\r\n\tvar rwLast = blob.read_shift(2);\r\n\tvar colFirst = blob.read_shift(1);\r\n\tvar colLast = blob.read_shift(1);\r\n\treturn {s:{c:colFirst, r:rwFirst}, e:{c:colLast,r:rwLast}};\r\n}\r\n\r\n/* 2.5.207 */\r\nvar parse_Ref = parse_RefU;\r\n\r\n/* 2.5.143 */\r\nfunction parse_FtCmo(blob, length) {\r\n\tblob.l += 4;\r\n\tvar ot = blob.read_shift(2);\r\n\tvar id = blob.read_shift(2);\r\n\tvar flags = blob.read_shift(2);\r\n\tblob.l+=12;\r\n\treturn [id, ot, flags];\r\n}\r\n\r\n/* 2.5.149 */\r\nfunction parse_FtNts(blob, length) {\r\n\tvar out = {};\r\n\tblob.l += 4;\r\n\tblob.l += 16; // GUID TODO\r\n\tout.fSharedNote = blob.read_shift(2);\r\n\tblob.l += 4;\r\n\treturn out;\r\n}\r\n\r\n/* 2.5.142 */\r\nfunction parse_FtCf(blob, length) {\r\n\tvar out = {};\r\n\tblob.l += 4;\r\n\tblob.cf = blob.read_shift(2);\r\n\treturn out;\r\n}\r\n\r\n/* 2.5.140 - 2.5.154 and friends */\r\nvar FtTab = {\r\n\t0x15: parse_FtCmo,\r\n\t0x13: parsenoop,                                /* FtLbsData */\r\n\t0x12: function(blob, length) { blob.l += 12; }, /* FtCblsData */\r\n\t0x11: function(blob, length) { blob.l += 8; },  /* FtRboData */\r\n\t0x10: parsenoop,                                /* FtEdoData */\r\n\t0x0F: parsenoop,                                /* FtGboData */\r\n\t0x0D: parse_FtNts,                              /* FtNts */\r\n\t0x0C: function(blob, length) { blob.l += 24; }, /* FtSbs */\r\n\t0x0B: function(blob, length) { blob.l += 10; }, /* FtRbo */\r\n\t0x0A: function(blob, length) { blob.l += 16; }, /* FtCbls */\r\n\t0x09: parsenoop,                                /* FtPictFmla */\r\n\t0x08: function(blob, length) { blob.l += 6; },  /* FtPioGrbit */\r\n\t0x07: parse_FtCf,                               /* FtCf */\r\n\t0x06: function(blob, length) { blob.l += 6; },  /* FtGmo */\r\n\t0x04: parsenoop,                                /* FtMacro */\r\n\t0x00: function(blob, length) { blob.l += 4; }   /* FtEnding */\r\n};\r\nfunction parse_FtArray(blob, length, ot) {\r\n\tvar s = blob.l;\r\n\tvar fts = [];\r\n\twhile(blob.l < s + length) {\r\n\t\tvar ft = blob.read_shift(2);\r\n\t\tblob.l-=2;\r\n\t\ttry {\r\n\t\t\tfts.push(FtTab[ft](blob, s + length - blob.l));\r\n\t\t} catch(e) { blob.l = s + length; return fts; }\r\n\t}\r\n\tif(blob.l != s + length) blob.l = s + length; //throw \"bad Object Ft-sequence\";\r\n\treturn fts;\r\n}\r\n\r\n/* 2.5.129 */\r\nvar parse_FontIndex = parseuint16;\r\n\r\n/* --- 2.4 Records --- */\r\n\r\n/* 2.4.21 */\r\nfunction parse_BOF(blob, length) {\r\n\tvar o = {};\r\n\to.BIFFVer = blob.read_shift(2); length -= 2;\r\n\tswitch(o.BIFFVer) {\r\n\t\tcase 0x0600: /* BIFF8 */\r\n\t\tcase 0x0500: /* BIFF5 */\r\n\t\tcase 0x0002: case 0x0007: /* BIFF2 */\r\n\t\t\tbreak;\r\n\t\tdefault: throw \"Unexpected BIFF Ver \" + o.BIFFVer;\r\n\t}\r\n\tblob.read_shift(length);\r\n\treturn o;\r\n}\r\n\r\n\r\n/* 2.4.146 */\r\nfunction parse_InterfaceHdr(blob, length) {\r\n\tif(length === 0) return 0x04b0;\r\n\tvar q;\r\n\tif((q=blob.read_shift(2))!==0x04b0) throw 'InterfaceHdr codePage ' + q;\r\n\treturn 0x04b0;\r\n}\r\n\r\n\r\n/* 2.4.349 */\r\nfunction parse_WriteAccess(blob, length, opts) {\r\n\tif(opts.enc) { blob.l += length; return \"\"; }\r\n\tvar l = blob.l;\r\n\t// TODO: make sure XLUnicodeString doesnt overrun\r\n\tvar UserName = parse_XLUnicodeString(blob, 0, opts);\r\n\tblob.read_shift(length + l - blob.l);\r\n\treturn UserName;\r\n}\r\n\r\n/* 2.4.28 */\r\nfunction parse_BoundSheet8(blob, length, opts) {\r\n\tvar pos = blob.read_shift(4);\r\n\tvar hidden = blob.read_shift(1) >> 6;\r\n\tvar dt = blob.read_shift(1);\r\n\tswitch(dt) {\r\n\t\tcase 0: dt = 'Worksheet'; break;\r\n\t\tcase 1: dt = 'Macrosheet'; break;\r\n\t\tcase 2: dt = 'Chartsheet'; break;\r\n\t\tcase 6: dt = 'VBAModule'; break;\r\n\t}\r\n\tvar name = parse_ShortXLUnicodeString(blob, 0, opts);\r\n\tif(name.length === 0) name = \"Sheet1\";\r\n\treturn { pos:pos, hs:hidden, dt:dt, name:name };\r\n}\r\n\r\n/* 2.4.265 TODO */\r\nfunction parse_SST(blob, length) {\r\n\tvar cnt = blob.read_shift(4);\r\n\tvar ucnt = blob.read_shift(4);\r\n\tvar strs = [];\r\n\tfor(var i = 0; i != ucnt; ++i) {\r\n\t\tstrs.push(parse_XLUnicodeRichExtendedString(blob));\r\n\t}\r\n\tstrs.Count = cnt; strs.Unique = ucnt;\r\n\treturn strs;\r\n}\r\n\r\n/* 2.4.107 */\r\nfunction parse_ExtSST(blob, length) {\r\n\tvar extsst = {};\r\n\textsst.dsst = blob.read_shift(2);\r\n\tblob.l += length-2;\r\n\treturn extsst;\r\n}\r\n\r\n\r\n/* 2.4.221 TODO*/\r\nfunction parse_Row(blob, length) {\r\n\tvar rw = blob.read_shift(2), col = blob.read_shift(2), Col = blob.read_shift(2), rht = blob.read_shift(2);\r\n\tblob.read_shift(4); // reserved(2), unused(2)\r\n\tvar flags = blob.read_shift(1); // various flags\r\n\tblob.read_shift(1); // reserved\r\n\tblob.read_shift(2); //ixfe, other flags\r\n\treturn {r:rw, c:col, cnt:Col-col};\r\n}\r\n\r\n\r\n/* 2.4.125 */\r\nfunction parse_ForceFullCalculation(blob, length) {\r\n\tvar header = parse_frtHeader(blob);\r\n\tif(header.type != 0x08A3) throw \"Invalid Future Record \" + header.type;\r\n\tvar fullcalc = blob.read_shift(4);\r\n\treturn fullcalc !== 0x0;\r\n}\r\n\r\n\r\nvar parse_CompressPictures = parsenoop2; /* 2.4.55 Not interesting */\r\n\r\n\r\n\r\n/* 2.4.215 rt */\r\nfunction parse_RecalcId(blob, length) {\r\n\tblob.read_shift(2);\r\n\treturn blob.read_shift(4);\r\n}\r\n\r\n/* 2.4.87 */\r\nfunction parse_DefaultRowHeight (blob, length) {\r\n\tvar f = blob.read_shift(2), miyRw;\r\n\tmiyRw = blob.read_shift(2); // flags & 0x02 -> hidden, else empty\r\n\tvar fl = {Unsynced:f&1,DyZero:(f&2)>>1,ExAsc:(f&4)>>2,ExDsc:(f&8)>>3};\r\n\treturn [fl, miyRw];\r\n}\r\n\r\n/* 2.4.345 TODO */\r\nfunction parse_Window1(blob, length) {\r\n\tvar xWn = blob.read_shift(2), yWn = blob.read_shift(2), dxWn = blob.read_shift(2), dyWn = blob.read_shift(2);\r\n\tvar flags = blob.read_shift(2), iTabCur = blob.read_shift(2), iTabFirst = blob.read_shift(2);\r\n\tvar ctabSel = blob.read_shift(2), wTabRatio = blob.read_shift(2);\r\n\treturn { Pos: [xWn, yWn], Dim: [dxWn, dyWn], Flags: flags, CurTab: iTabCur,\r\n\t\tFirstTab: iTabFirst, Selected: ctabSel, TabRatio: wTabRatio };\r\n}\r\n\r\n/* 2.4.122 TODO */\r\nfunction parse_Font(blob, length, opts) {\r\n\tblob.l += 14;\r\n\tvar name = parse_ShortXLUnicodeString(blob, 0, opts);\r\n\treturn name;\r\n}\r\n\r\n/* 2.4.149 */\r\nfunction parse_LabelSst(blob, length) {\r\n\tvar cell = parse_XLSCell(blob);\r\n\tcell.isst = blob.read_shift(4);\r\n\treturn cell;\r\n}\r\n\r\n/* 2.4.148 */\r\nfunction parse_Label(blob, length, opts) {\r\n\tvar cell = parse_XLSCell(blob, 6);\r\n\tvar str = parse_XLUnicodeString(blob, length-6, opts);\r\n\tcell.val = str;\r\n\treturn cell;\r\n}\r\n\r\n/* 2.4.126 Number Formats */\r\nfunction parse_Format(blob, length, opts) {\r\n\tvar ifmt = blob.read_shift(2);\r\n\tvar fmtstr = parse_XLUnicodeString2(blob, 0, opts);\r\n\treturn [ifmt, fmtstr];\r\n}\r\n\r\n/* 2.4.90 */\r\nfunction parse_Dimensions(blob, length) {\r\n\tvar w = length === 10 ? 2 : 4;\r\n\tvar r = blob.read_shift(w), R = blob.read_shift(w),\r\n\t    c = blob.read_shift(2), C = blob.read_shift(2);\r\n\tblob.l += 2;\r\n\treturn {s: {r:r, c:c}, e: {r:R, c:C}};\r\n}\r\n\r\n/* 2.4.220 */\r\nfunction parse_RK(blob, length) {\r\n\tvar rw = blob.read_shift(2), col = blob.read_shift(2);\r\n\tvar rkrec = parse_RkRec(blob);\r\n\treturn {r:rw, c:col, ixfe:rkrec[0], rknum:rkrec[1]};\r\n}\r\n\r\n/* 2.4.175 */\r\nfunction parse_MulRk(blob, length) {\r\n\tvar target = blob.l + length - 2;\r\n\tvar rw = blob.read_shift(2), col = blob.read_shift(2);\r\n\tvar rkrecs = [];\r\n\twhile(blob.l < target) rkrecs.push(parse_RkRec(blob));\r\n\tif(blob.l !== target) throw \"MulRK read error\";\r\n\tvar lastcol = blob.read_shift(2);\r\n\tif(rkrecs.length != lastcol - col + 1) throw \"MulRK length mismatch\";\r\n\treturn {r:rw, c:col, C:lastcol, rkrec:rkrecs};\r\n}\r\n\r\n/* 2.5.20 2.5.249 TODO */\r\nfunction parse_CellStyleXF(blob, length, style) {\r\n\tvar o = {};\r\n\tvar a = blob.read_shift(4), b = blob.read_shift(4);\r\n\tvar c = blob.read_shift(4), d = blob.read_shift(2);\r\n\to.patternType = XLSFillPattern[c >> 26];\r\n\to.icvFore = d & 0x7F;\r\n\to.icvBack = (d >> 7) & 0x7F;\r\n\treturn o;\r\n}\r\nfunction parse_CellXF(blob, length) {return parse_CellStyleXF(blob,length,0);}\r\nfunction parse_StyleXF(blob, length) {return parse_CellStyleXF(blob,length,1);}\r\n\r\n/* 2.4.353 TODO: actually do this right */\r\nfunction parse_XF(blob, length) {\r\n\tvar o = {};\r\n\to.ifnt = blob.read_shift(2); o.ifmt = blob.read_shift(2); o.flags = blob.read_shift(2);\r\n\to.fStyle = (o.flags >> 2) & 0x01;\r\n\tlength -= 6;\r\n\to.data = parse_CellStyleXF(blob, length, o.fStyle);\r\n\treturn o;\r\n}\r\n\r\n/* 2.4.134 */\r\nfunction parse_Guts(blob, length) {\r\n\tblob.l += 4;\r\n\tvar out = [blob.read_shift(2), blob.read_shift(2)];\r\n\tif(out[0] !== 0) out[0]--;\r\n\tif(out[1] !== 0) out[1]--;\r\n\tif(out[0] > 7 || out[1] > 7) throw \"Bad Gutters: \" + out;\r\n\treturn out;\r\n}\r\n\r\n/* 2.4.24 */\r\nfunction parse_BoolErr(blob, length) {\r\n\tvar cell = parse_XLSCell(blob, 6);\r\n\tvar val = parse_Bes(blob, 2);\r\n\tcell.val = val;\r\n\tcell.t = (val === true || val === false) ? 'b' : 'e';\r\n\treturn cell;\r\n}\r\n\r\n/* 2.4.180 Number */\r\nfunction parse_Number(blob, length) {\r\n\tvar cell = parse_XLSCell(blob, 6);\r\n\tvar xnum = parse_Xnum(blob, 8);\r\n\tcell.val = xnum;\r\n\treturn cell;\r\n}\r\n\r\nvar parse_XLHeaderFooter = parse_OptXLUnicodeString; // TODO: parse 2.4.136\r\n\r\n/* 2.4.271 */\r\nfunction parse_SupBook(blob, length, opts) {\r\n\tvar end = blob.l + length;\r\n\tvar ctab = blob.read_shift(2);\r\n\tvar cch = blob.read_shift(2);\r\n\tvar virtPath;\r\n\tif(cch >=0x01 && cch <=0xff) virtPath = parse_XLUnicodeStringNoCch(blob, cch);\r\n\tvar rgst = blob.read_shift(end - blob.l);\r\n\topts.sbcch = cch;\r\n\treturn [cch, ctab, virtPath, rgst];\r\n}\r\n\r\n/* 2.4.105 TODO */\r\nfunction parse_ExternName(blob, length, opts) {\r\n\tvar flags = blob.read_shift(2);\r\n\tvar body;\r\n\tvar o = {\r\n\t\tfBuiltIn: flags & 0x01,\r\n\t\tfWantAdvise: (flags >>> 1) & 0x01,\r\n\t\tfWantPict: (flags >>> 2) & 0x01,\r\n\t\tfOle: (flags >>> 3) & 0x01,\r\n\t\tfOleLink: (flags >>> 4) & 0x01,\r\n\t\tcf: (flags >>> 5) & 0x3FF,\r\n\t\tfIcon: flags >>> 15 & 0x01\r\n\t};\r\n\tif(opts.sbcch === 0x3A01) body = parse_AddinUdf(blob, length-2);\r\n\t//else throw new Error(\"unsupported SupBook cch: \" + opts.sbcch);\r\n\to.body = body || blob.read_shift(length-2);\r\n\treturn o;\r\n}\r\n\r\n/* 2.4.150 TODO */\r\nfunction parse_Lbl(blob, length, opts) {\r\n\tif(opts.biff < 8) return parse_Label(blob, length, opts);\r\n\tvar target = blob.l + length;\r\n\tvar flags = blob.read_shift(2);\r\n\tvar chKey = blob.read_shift(1);\r\n\tvar cch = blob.read_shift(1);\r\n\tvar cce = blob.read_shift(2);\r\n\tblob.l += 2;\r\n\tvar itab = blob.read_shift(2);\r\n\tblob.l += 4;\r\n\tvar name = parse_XLUnicodeStringNoCch(blob, cch, opts);\r\n\tvar rgce = parse_NameParsedFormula(blob, target - blob.l, opts, cce);\r\n\treturn {\r\n\t\tchKey: chKey,\r\n\t\tName: name,\r\n\t\trgce: rgce\r\n\t};\r\n}\r\n\r\n/* 2.4.106 TODO: verify supbook manipulation */\r\nfunction parse_ExternSheet(blob, length, opts) {\r\n\tif(opts.biff < 8) return parse_ShortXLUnicodeString(blob, length, opts);\r\n\tvar o = parslurp2(blob,length,parse_XTI);\r\n\tvar oo = [];\r\n\tif(opts.sbcch === 0x0401) {\r\n\t\tfor(var i = 0; i != o.length; ++i) oo.push(opts.snames[o[i][1]]);\r\n\t\treturn oo;\r\n\t}\r\n\telse return o;\r\n}\r\n\r\n/* 2.4.260 */\r\nfunction parse_ShrFmla(blob, length, opts) {\r\n\tvar ref = parse_RefU(blob, 6);\r\n\tblob.l++;\r\n\tvar cUse = blob.read_shift(1);\r\n\tlength -= 8;\r\n\treturn [parse_SharedParsedFormula(blob, length, opts), cUse];\r\n}\r\n\r\n/* 2.4.4 TODO */\r\nfunction parse_Array(blob, length, opts) {\r\n\tvar ref = parse_Ref(blob, 6);\r\n\tblob.l += 6; length -= 12; /* TODO: fAlwaysCalc */\r\n\treturn [ref, parse_ArrayParsedFormula(blob, length, opts, ref)];\r\n}\r\n\r\n/* 2.4.173 */\r\nfunction parse_MTRSettings(blob, length) {\r\n\tvar fMTREnabled = blob.read_shift(4) !== 0x00;\r\n\tvar fUserSetThreadCount = blob.read_shift(4) !== 0x00;\r\n\tvar cUserThreadCount = blob.read_shift(4);\r\n\treturn [fMTREnabled, fUserSetThreadCount, cUserThreadCount];\r\n}\r\n\r\n/* 2.5.186 TODO: BIFF5 */\r\nfunction parse_NoteSh(blob, length, opts) {\r\n\tif(opts.biff < 8) return;\r\n\tvar row = blob.read_shift(2), col = blob.read_shift(2);\r\n\tvar flags = blob.read_shift(2), idObj = blob.read_shift(2);\r\n\tvar stAuthor = parse_XLUnicodeString2(blob, 0, opts);\r\n\tif(opts.biff < 8) blob.read_shift(1);\r\n\treturn [{r:row,c:col}, stAuthor, idObj, flags];\r\n}\r\n\r\n/* 2.4.179 */\r\nfunction parse_Note(blob, length, opts) {\r\n\t/* TODO: Support revisions */\r\n\treturn parse_NoteSh(blob, length, opts);\r\n}\r\n\r\n/* 2.4.168 */\r\nfunction parse_MergeCells(blob, length) {\r\n\tvar merges = [];\r\n\tvar cmcs = blob.read_shift(2);\r\n\twhile (cmcs--) merges.push(parse_Ref8U(blob,length));\r\n\treturn merges;\r\n}\r\n\r\n/* 2.4.181 TODO: parse all the things! */\r\nfunction parse_Obj(blob, length) {\r\n\tvar cmo = parse_FtCmo(blob, 22); // id, ot, flags\r\n\tvar fts = parse_FtArray(blob, length-22, cmo[1]);\r\n\treturn { cmo: cmo, ft:fts };\r\n}\r\n\r\n/* 2.4.329 TODO: parse properly */\r\nfunction parse_TxO(blob, length, opts) {\r\n\tvar s = blob.l;\r\ntry {\r\n\tblob.l += 4;\r\n\tvar ot = (opts.lastobj||{cmo:[0,0]}).cmo[1];\r\n\tvar controlInfo;\r\n\tif([0,5,7,11,12,14].indexOf(ot) == -1) blob.l += 6;\r\n\telse controlInfo = parse_ControlInfo(blob, 6, opts);\r\n\tvar cchText = blob.read_shift(2);\r\n\tvar cbRuns = blob.read_shift(2);\r\n\tvar ifntEmpty = parse_FontIndex(blob, 2);\r\n\tvar len = blob.read_shift(2);\r\n\tblob.l += len;\r\n\t//var fmla = parse_ObjFmla(blob, s + length - blob.l);\r\n\r\n\tvar texts = \"\";\r\n\tfor(var i = 1; i < blob.lens.length-1; ++i) {\r\n\t\tif(blob.l-s != blob.lens[i]) throw \"TxO: bad continue record\";\r\n\t\tvar hdr = blob[blob.l];\r\n\t\tvar t = parse_XLUnicodeStringNoCch(blob, blob.lens[i+1]-blob.lens[i]-1);\r\n\t\ttexts += t;\r\n\t\tif(texts.length >= (hdr ? cchText : 2*cchText)) break;\r\n\t}\r\n\tif(texts.length !== cchText && texts.length !== cchText*2) {\r\n\t\tthrow \"cchText: \" + cchText + \" != \" + texts.length;\r\n\t}\r\n\r\n\tblob.l = s + length;\r\n\t/* 2.5.272 TxORuns */\r\n//\tvar rgTxoRuns = [];\r\n//\tfor(var j = 0; j != cbRuns/8-1; ++j) blob.l += 8;\r\n//\tvar cchText2 = blob.read_shift(2);\r\n//\tif(cchText2 !== cchText) throw \"TxOLastRun mismatch: \" + cchText2 + \" \" + cchText;\r\n//\tblob.l += 6;\r\n//\tif(s + length != blob.l) throw \"TxO \" + (s + length) + \", at \" + blob.l;\r\n\treturn { t: texts };\r\n} catch(e) { blob.l = s + length; return { t: texts||\"\" }; }\r\n}\r\n\r\n/* 2.4.140 */\r\nvar parse_HLink = function(blob, length) {\r\n\tvar ref = parse_Ref8U(blob, 8);\r\n\tblob.l += 16; /* CLSID */\r\n\tvar hlink = parse_Hyperlink(blob, length-24);\r\n\treturn [ref, hlink];\r\n};\r\n\r\n/* 2.4.141 */\r\nvar parse_HLinkTooltip = function(blob, length) {\r\n\tvar end = blob.l + length;\r\n\tblob.read_shift(2);\r\n\tvar ref = parse_Ref8U(blob, 8);\r\n\tvar wzTooltip = blob.read_shift((length-10)/2, 'dbcs-cont');\r\n\twzTooltip = wzTooltip.replace(chr0,\"\");\r\n\treturn [ref, wzTooltip];\r\n};\r\n\r\n/* 2.4.63 */\r\nfunction parse_Country(blob, length) {\r\n\tvar o = [], d;\r\n\td = blob.read_shift(2); o[0] = CountryEnum[d] || d;\r\n\td = blob.read_shift(2); o[1] = CountryEnum[d] || d;\r\n\treturn o;\r\n}\r\n\r\n/* 2.4.50 ClrtClient */\r\nfunction parse_ClrtClient(blob, length) {\r\n\tvar ccv = blob.read_shift(2);\r\n\tvar o = [];\r\n\twhile(ccv-->0) o.push(parse_LongRGB(blob, 8));\r\n\treturn o;\r\n}\r\n\r\n/* 2.4.188 */\r\nfunction parse_Palette(blob, length) {\r\n\tvar ccv = blob.read_shift(2);\r\n\tvar o = [];\r\n\twhile(ccv-->0) o.push(parse_LongRGB(blob, 8));\r\n\treturn o;\r\n}\r\n\r\n/* 2.4.354 */\r\nfunction parse_XFCRC(blob, length) {\r\n\tblob.l += 2;\r\n\tvar o = {cxfs:0, crc:0};\r\n\to.cxfs = blob.read_shift(2);\r\n\to.crc = blob.read_shift(4);\r\n\treturn o;\r\n}\r\n\r\n\r\nvar parse_Style = parsenoop;\r\nvar parse_StyleExt = parsenoop;\r\n\r\nvar parse_ColInfo = parsenoop;\r\n\r\nvar parse_Window2 = parsenoop;\r\n\r\n\r\nvar parse_Backup = parsebool; /* 2.4.14 */\r\nvar parse_Blank = parse_XLSCell; /* 2.4.20 Just the cell */\r\nvar parse_BottomMargin = parse_Xnum; /* 2.4.27 */\r\nvar parse_BuiltInFnGroupCount = parseuint16; /* 2.4.30 0x0E or 0x10 but excel 2011 generates 0x11? */\r\nvar parse_CalcCount = parseuint16; /* 2.4.31 #Iterations */\r\nvar parse_CalcDelta = parse_Xnum; /* 2.4.32 */\r\nvar parse_CalcIter = parsebool;  /* 2.4.33 1=iterative calc */\r\nvar parse_CalcMode = parseuint16; /* 2.4.34 0=manual, 1=auto (def), 2=table */\r\nvar parse_CalcPrecision = parsebool; /* 2.4.35 */\r\nvar parse_CalcRefMode = parsenoop2; /* 2.4.36 */\r\nvar parse_CalcSaveRecalc = parsebool; /* 2.4.37 */\r\nvar parse_CodePage = parseuint16; /* 2.4.52 */\r\nvar parse_Compat12 = parsebool; /* 2.4.54 true = no compatibility check */\r\nvar parse_Date1904 = parsebool; /* 2.4.77 - 1=1904,0=1900 */\r\nvar parse_DefColWidth = parseuint16; /* 2.4.89 */\r\nvar parse_DSF = parsenoop2; /* 2.4.94 -- MUST be ignored */\r\nvar parse_EntExU2 = parsenoop2; /* 2.4.102 -- Explicitly says to ignore */\r\nvar parse_EOF = parsenoop2; /* 2.4.103 */\r\nvar parse_Excel9File = parsenoop2; /* 2.4.104 -- Optional and unused */\r\nvar parse_FeatHdr = parsenoop2; /* 2.4.112 */\r\nvar parse_FontX = parseuint16; /* 2.4.123 */\r\nvar parse_Footer = parse_XLHeaderFooter; /* 2.4.124 */\r\nvar parse_GridSet = parseuint16; /* 2.4.132, =1 */\r\nvar parse_HCenter = parsebool; /* 2.4.135 sheet centered horizontal on print */\r\nvar parse_Header = parse_XLHeaderFooter; /* 2.4.136 */\r\nvar parse_HideObj = parse_HideObjEnum; /* 2.4.139 */\r\nvar parse_InterfaceEnd = parsenoop2; /* 2.4.145 -- noop */\r\nvar parse_LeftMargin = parse_Xnum; /* 2.4.151 */\r\nvar parse_Mms = parsenoop2; /* 2.4.169 -- Explicitly says to ignore */\r\nvar parse_ObjProtect = parsebool; /* 2.4.183 -- must be 1 if present */\r\nvar parse_Password = parseuint16; /* 2.4.191 */\r\nvar parse_PrintGrid = parsebool; /* 2.4.202 */\r\nvar parse_PrintRowCol = parsebool; /* 2.4.203 */\r\nvar parse_PrintSize = parseuint16; /* 2.4.204 0:3 */\r\nvar parse_Prot4Rev = parsebool; /* 2.4.205 */\r\nvar parse_Prot4RevPass = parseuint16; /* 2.4.206 */\r\nvar parse_Protect = parsebool; /* 2.4.207 */\r\nvar parse_RefreshAll = parsebool; /* 2.4.217 -- must be 0 if not template */\r\nvar parse_RightMargin = parse_Xnum; /* 2.4.219 */\r\nvar parse_RRTabId = parseuint16a; /* 2.4.241 */\r\nvar parse_ScenarioProtect = parsebool; /* 2.4.245 */\r\nvar parse_Scl = parseuint16a; /* 2.4.247 num, den */\r\nvar parse_String = parse_XLUnicodeString; /* 2.4.268 */\r\nvar parse_SxBool = parsebool; /* 2.4.274 */\r\nvar parse_TopMargin = parse_Xnum; /* 2.4.328 */\r\nvar parse_UsesELFs = parsebool; /* 2.4.337 -- should be 0 */\r\nvar parse_VCenter = parsebool; /* 2.4.342 */\r\nvar parse_WinProtect = parsebool; /* 2.4.347 */\r\nvar parse_WriteProtect = parsenoop; /* 2.4.350 empty record */\r\n\r\n\r\n/* ---- */\r\nvar parse_VerticalPageBreaks = parsenoop;\r\nvar parse_HorizontalPageBreaks = parsenoop;\r\nvar parse_Selection = parsenoop;\r\nvar parse_Continue = parsenoop;\r\nvar parse_Pane = parsenoop;\r\nvar parse_Pls = parsenoop;\r\nvar parse_DCon = parsenoop;\r\nvar parse_DConRef = parsenoop;\r\nvar parse_DConName = parsenoop;\r\nvar parse_XCT = parsenoop;\r\nvar parse_CRN = parsenoop;\r\nvar parse_FileSharing = parsenoop;\r\nvar parse_Uncalced = parsenoop;\r\nvar parse_Template = parsenoop;\r\nvar parse_Intl = parsenoop;\r\nvar parse_WsBool = parsenoop;\r\nvar parse_Sort = parsenoop;\r\nvar parse_Sync = parsenoop;\r\nvar parse_LPr = parsenoop;\r\nvar parse_DxGCol = parsenoop;\r\nvar parse_FnGroupName = parsenoop;\r\nvar parse_FilterMode = parsenoop;\r\nvar parse_AutoFilterInfo = parsenoop;\r\nvar parse_AutoFilter = parsenoop;\r\nvar parse_Setup = parsenoop;\r\nvar parse_ScenMan = parsenoop;\r\nvar parse_SCENARIO = parsenoop;\r\nvar parse_SxView = parsenoop;\r\nvar parse_Sxvd = parsenoop;\r\nvar parse_SXVI = parsenoop;\r\nvar parse_SxIvd = parsenoop;\r\nvar parse_SXLI = parsenoop;\r\nvar parse_SXPI = parsenoop;\r\nvar parse_DocRoute = parsenoop;\r\nvar parse_RecipName = parsenoop;\r\nvar parse_MulBlank = parsenoop;\r\nvar parse_SXDI = parsenoop;\r\nvar parse_SXDB = parsenoop;\r\nvar parse_SXFDB = parsenoop;\r\nvar parse_SXDBB = parsenoop;\r\nvar parse_SXNum = parsenoop;\r\nvar parse_SxErr = parsenoop;\r\nvar parse_SXInt = parsenoop;\r\nvar parse_SXString = parsenoop;\r\nvar parse_SXDtr = parsenoop;\r\nvar parse_SxNil = parsenoop;\r\nvar parse_SXTbl = parsenoop;\r\nvar parse_SXTBRGIITM = parsenoop;\r\nvar parse_SxTbpg = parsenoop;\r\nvar parse_ObProj = parsenoop;\r\nvar parse_SXStreamID = parsenoop;\r\nvar parse_DBCell = parsenoop;\r\nvar parse_SXRng = parsenoop;\r\nvar parse_SxIsxoper = parsenoop;\r\nvar parse_BookBool = parsenoop;\r\nvar parse_DbOrParamQry = parsenoop;\r\nvar parse_OleObjectSize = parsenoop;\r\nvar parse_SXVS = parsenoop;\r\nvar parse_BkHim = parsenoop;\r\nvar parse_MsoDrawingGroup = parsenoop;\r\nvar parse_MsoDrawing = parsenoop;\r\nvar parse_MsoDrawingSelection = parsenoop;\r\nvar parse_PhoneticInfo = parsenoop;\r\nvar parse_SxRule = parsenoop;\r\nvar parse_SXEx = parsenoop;\r\nvar parse_SxFilt = parsenoop;\r\nvar parse_SxDXF = parsenoop;\r\nvar parse_SxItm = parsenoop;\r\nvar parse_SxName = parsenoop;\r\nvar parse_SxSelect = parsenoop;\r\nvar parse_SXPair = parsenoop;\r\nvar parse_SxFmla = parsenoop;\r\nvar parse_SxFormat = parsenoop;\r\nvar parse_SXVDEx = parsenoop;\r\nvar parse_SXFormula = parsenoop;\r\nvar parse_SXDBEx = parsenoop;\r\nvar parse_RRDInsDel = parsenoop;\r\nvar parse_RRDHead = parsenoop;\r\nvar parse_RRDChgCell = parsenoop;\r\nvar parse_RRDRenSheet = parsenoop;\r\nvar parse_RRSort = parsenoop;\r\nvar parse_RRDMove = parsenoop;\r\nvar parse_RRFormat = parsenoop;\r\nvar parse_RRAutoFmt = parsenoop;\r\nvar parse_RRInsertSh = parsenoop;\r\nvar parse_RRDMoveBegin = parsenoop;\r\nvar parse_RRDMoveEnd = parsenoop;\r\nvar parse_RRDInsDelBegin = parsenoop;\r\nvar parse_RRDInsDelEnd = parsenoop;\r\nvar parse_RRDConflict = parsenoop;\r\nvar parse_RRDDefName = parsenoop;\r\nvar parse_RRDRstEtxp = parsenoop;\r\nvar parse_LRng = parsenoop;\r\nvar parse_CUsr = parsenoop;\r\nvar parse_CbUsr = parsenoop;\r\nvar parse_UsrInfo = parsenoop;\r\nvar parse_UsrExcl = parsenoop;\r\nvar parse_FileLock = parsenoop;\r\nvar parse_RRDInfo = parsenoop;\r\nvar parse_BCUsrs = parsenoop;\r\nvar parse_UsrChk = parsenoop;\r\nvar parse_UserBView = parsenoop;\r\nvar parse_UserSViewBegin = parsenoop; // overloaded\r\nvar parse_UserSViewEnd = parsenoop;\r\nvar parse_RRDUserView = parsenoop;\r\nvar parse_Qsi = parsenoop;\r\nvar parse_CondFmt = parsenoop;\r\nvar parse_CF = parsenoop;\r\nvar parse_DVal = parsenoop;\r\nvar parse_DConBin = parsenoop;\r\nvar parse_Lel = parsenoop;\r\nvar parse_XLSCodeName = parse_XLUnicodeString;\r\nvar parse_SXFDBType = parsenoop;\r\nvar parse_ObNoMacros = parsenoop;\r\nvar parse_Dv = parsenoop;\r\nvar parse_Index = parsenoop;\r\nvar parse_Table = parsenoop;\r\nvar parse_BigName = parsenoop;\r\nvar parse_ContinueBigName = parsenoop;\r\nvar parse_WebPub = parsenoop;\r\nvar parse_QsiSXTag = parsenoop;\r\nvar parse_DBQueryExt = parsenoop;\r\nvar parse_ExtString = parsenoop;\r\nvar parse_TxtQry = parsenoop;\r\nvar parse_Qsir = parsenoop;\r\nvar parse_Qsif = parsenoop;\r\nvar parse_RRDTQSIF = parsenoop;\r\nvar parse_OleDbConn = parsenoop;\r\nvar parse_WOpt = parsenoop;\r\nvar parse_SXViewEx = parsenoop;\r\nvar parse_SXTH = parsenoop;\r\nvar parse_SXPIEx = parsenoop;\r\nvar parse_SXVDTEx = parsenoop;\r\nvar parse_SXViewEx9 = parsenoop;\r\nvar parse_ContinueFrt = parsenoop;\r\nvar parse_RealTimeData = parsenoop;\r\nvar parse_ChartFrtInfo = parsenoop;\r\nvar parse_FrtWrapper = parsenoop;\r\nvar parse_StartBlock = parsenoop;\r\nvar parse_EndBlock = parsenoop;\r\nvar parse_StartObject = parsenoop;\r\nvar parse_EndObject = parsenoop;\r\nvar parse_CatLab = parsenoop;\r\nvar parse_YMult = parsenoop;\r\nvar parse_SXViewLink = parsenoop;\r\nvar parse_PivotChartBits = parsenoop;\r\nvar parse_FrtFontList = parsenoop;\r\nvar parse_SheetExt = parsenoop;\r\nvar parse_BookExt = parsenoop;\r\nvar parse_SXAddl = parsenoop;\r\nvar parse_CrErr = parsenoop;\r\nvar parse_HFPicture = parsenoop;\r\nvar parse_Feat = parsenoop;\r\nvar parse_DataLabExt = parsenoop;\r\nvar parse_DataLabExtContents = parsenoop;\r\nvar parse_CellWatch = parsenoop;\r\nvar parse_FeatHdr11 = parsenoop;\r\nvar parse_Feature11 = parsenoop;\r\nvar parse_DropDownObjIds = parsenoop;\r\nvar parse_ContinueFrt11 = parsenoop;\r\nvar parse_DConn = parsenoop;\r\nvar parse_List12 = parsenoop;\r\nvar parse_Feature12 = parsenoop;\r\nvar parse_CondFmt12 = parsenoop;\r\nvar parse_CF12 = parsenoop;\r\nvar parse_CFEx = parsenoop;\r\nvar parse_AutoFilter12 = parsenoop;\r\nvar parse_ContinueFrt12 = parsenoop;\r\nvar parse_MDTInfo = parsenoop;\r\nvar parse_MDXStr = parsenoop;\r\nvar parse_MDXTuple = parsenoop;\r\nvar parse_MDXSet = parsenoop;\r\nvar parse_MDXProp = parsenoop;\r\nvar parse_MDXKPI = parsenoop;\r\nvar parse_MDB = parsenoop;\r\nvar parse_PLV = parsenoop;\r\nvar parse_DXF = parsenoop;\r\nvar parse_TableStyles = parsenoop;\r\nvar parse_TableStyle = parsenoop;\r\nvar parse_TableStyleElement = parsenoop;\r\nvar parse_NamePublish = parsenoop;\r\nvar parse_NameCmt = parsenoop;\r\nvar parse_SortData = parsenoop;\r\nvar parse_GUIDTypeLib = parsenoop;\r\nvar parse_FnGrp12 = parsenoop;\r\nvar parse_NameFnGrp12 = parsenoop;\r\nvar parse_HeaderFooter = parsenoop;\r\nvar parse_CrtLayout12 = parsenoop;\r\nvar parse_CrtMlFrt = parsenoop;\r\nvar parse_CrtMlFrtContinue = parsenoop;\r\nvar parse_ShapePropsStream = parsenoop;\r\nvar parse_TextPropsStream = parsenoop;\r\nvar parse_RichTextStream = parsenoop;\r\nvar parse_CrtLayout12A = parsenoop;\r\nvar parse_Units = parsenoop;\r\nvar parse_Chart = parsenoop;\r\nvar parse_Series = parsenoop;\r\nvar parse_DataFormat = parsenoop;\r\nvar parse_LineFormat = parsenoop;\r\nvar parse_MarkerFormat = parsenoop;\r\nvar parse_AreaFormat = parsenoop;\r\nvar parse_PieFormat = parsenoop;\r\nvar parse_AttachedLabel = parsenoop;\r\nvar parse_SeriesText = parsenoop;\r\nvar parse_ChartFormat = parsenoop;\r\nvar parse_Legend = parsenoop;\r\nvar parse_SeriesList = parsenoop;\r\nvar parse_Bar = parsenoop;\r\nvar parse_Line = parsenoop;\r\nvar parse_Pie = parsenoop;\r\nvar parse_Area = parsenoop;\r\nvar parse_Scatter = parsenoop;\r\nvar parse_CrtLine = parsenoop;\r\nvar parse_Axis = parsenoop;\r\nvar parse_Tick = parsenoop;\r\nvar parse_ValueRange = parsenoop;\r\nvar parse_CatSerRange = parsenoop;\r\nvar parse_AxisLine = parsenoop;\r\nvar parse_CrtLink = parsenoop;\r\nvar parse_DefaultText = parsenoop;\r\nvar parse_Text = parsenoop;\r\nvar parse_ObjectLink = parsenoop;\r\nvar parse_Frame = parsenoop;\r\nvar parse_Begin = parsenoop;\r\nvar parse_End = parsenoop;\r\nvar parse_PlotArea = parsenoop;\r\nvar parse_Chart3d = parsenoop;\r\nvar parse_PicF = parsenoop;\r\nvar parse_DropBar = parsenoop;\r\nvar parse_Radar = parsenoop;\r\nvar parse_Surf = parsenoop;\r\nvar parse_RadarArea = parsenoop;\r\nvar parse_AxisParent = parsenoop;\r\nvar parse_LegendException = parsenoop;\r\nvar parse_ShtProps = parsenoop;\r\nvar parse_SerToCrt = parsenoop;\r\nvar parse_AxesUsed = parsenoop;\r\nvar parse_SBaseRef = parsenoop;\r\nvar parse_SerParent = parsenoop;\r\nvar parse_SerAuxTrend = parsenoop;\r\nvar parse_IFmtRecord = parsenoop;\r\nvar parse_Pos = parsenoop;\r\nvar parse_AlRuns = parsenoop;\r\nvar parse_BRAI = parsenoop;\r\nvar parse_SerAuxErrBar = parsenoop;\r\nvar parse_SerFmt = parsenoop;\r\nvar parse_Chart3DBarShape = parsenoop;\r\nvar parse_Fbi = parsenoop;\r\nvar parse_BopPop = parsenoop;\r\nvar parse_AxcExt = parsenoop;\r\nvar parse_Dat = parsenoop;\r\nvar parse_PlotGrowth = parsenoop;\r\nvar parse_SIIndex = parsenoop;\r\nvar parse_GelFrame = parsenoop;\r\nvar parse_BopPopCustom = parsenoop;\r\nvar parse_Fbi2 = parsenoop;\r\n\r\n/* --- Specific to versions before BIFF8 --- */\r\nfunction parse_BIFF5String(blob) {\r\n\tvar len = blob.read_shift(1);\r\n\treturn blob.read_shift(len, 'sbcs-cont');\r\n}\r\n\r\n/* BIFF2_??? where ??? is the name from [XLS] */\r\nfunction parse_BIFF2STR(blob, length, opts) {\r\n\tvar cell = parse_XLSCell(blob, 6);\r\n\t++blob.l;\r\n\tvar str = parse_XLUnicodeString2(blob, length-7, opts);\r\n\tcell.val = str;\r\n\treturn cell;\r\n}\r\n\r\nfunction parse_BIFF2NUM(blob, length, opts) {\r\n\tvar cell = parse_XLSCell(blob, 6);\r\n\t++blob.l;\r\n\tvar num = parse_Xnum(blob, 8);\r\n\tcell.val = num;\r\n\treturn cell;\r\n}\r\n\r\n/* 18.4.1 charset to codepage mapping */\r\nvar CS2CP = {\r\n\t0:    1252, /* ANSI */\r\n\t1:   65001, /* DEFAULT */\r\n\t2:   65001, /* SYMBOL */\r\n\t77:  10000, /* MAC */\r\n\t128:   932, /* SHIFTJIS */\r\n\t129:   949, /* HANGUL */\r\n\t130:  1361, /* JOHAB */\r\n\t134:   936, /* GB2312 */\r\n\t136:   950, /* CHINESEBIG5 */\r\n\t161:  1253, /* GREEK */\r\n\t162:  1254, /* TURKISH */\r\n\t163:  1258, /* VIETNAMESE */\r\n\t177:  1255, /* HEBREW */\r\n\t178:  1256, /* ARABIC */\r\n\t186:  1257, /* BALTIC */\r\n\t204:  1251, /* RUSSIAN */\r\n\t222:   874, /* THAI */\r\n\t238:  1250, /* EASTEUROPE */\r\n\t255:  1252, /* OEM */\r\n\t69:   6969  /* MISC */\r\n};\r\n\r\n/* Parse a list of <r> tags */\r\nvar parse_rs = (function parse_rs_factory() {\r\n\tvar tregex = matchtag(\"t\"), rpregex = matchtag(\"rPr\"), rregex = /<r>/g, rend = /<\\/r>/, nlregex = /\\r\\n/g;\r\n\t/* 18.4.7 rPr CT_RPrElt */\r\n\tvar parse_rpr = function parse_rpr(rpr, intro, outro) {\r\n\t\tvar font = {}, cp = 65001;\r\n\t\tvar m = rpr.match(tagregex), i = 0;\r\n\t\tif(m) for(;i!=m.length; ++i) {\r\n\t\t\tvar y = parsexmltag(m[i]);\r\n\t\t\tswitch(y[0]) {\r\n\t\t\t\t/* 18.8.12 condense CT_BooleanProperty */\r\n\t\t\t\t/* ** not required . */\r\n\t\t\t\tcase '<condense': break;\r\n\t\t\t\t/* 18.8.17 extend CT_BooleanProperty */\r\n\t\t\t\t/* ** not required . */\r\n\t\t\t\tcase '<extend': break;\r\n\t\t\t\t/* 18.8.36 shadow CT_BooleanProperty */\r\n\t\t\t\t/* ** not required . */\r\n\t\t\t\tcase '<shadow':\r\n\t\t\t\t\t/* falls through */\r\n\t\t\t\tcase '<shadow/>': break;\r\n\r\n\t\t\t\t/* 18.4.1 charset CT_IntProperty TODO */\r\n\t\t\t\tcase '<charset':\r\n\t\t\t\t\tif(y.val == '1') break;\r\n\t\t\t\t\tcp = CS2CP[parseInt(y.val, 10)];\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t/* 18.4.2 outline CT_BooleanProperty TODO */\r\n\t\t\t\tcase '<outline':\r\n\t\t\t\t\t/* falls through */\r\n\t\t\t\tcase '<outline/>': break;\r\n\r\n\t\t\t\t/* 18.4.5 rFont CT_FontName */\r\n\t\t\t\tcase '<rFont': font.name = y.val; break;\r\n\r\n\t\t\t\t/* 18.4.11 sz CT_FontSize */\r\n\t\t\t\tcase '<sz': font.sz = y.val; break;\r\n\r\n\t\t\t\t/* 18.4.10 strike CT_BooleanProperty */\r\n\t\t\t\tcase '<strike':\r\n\t\t\t\t\tif(!y.val) break;\r\n\t\t\t\t\t/* falls through */\r\n\t\t\t\tcase '<strike/>': font.strike = 1; break;\r\n\t\t\t\tcase '</strike>': break;\r\n\r\n\t\t\t\t/* 18.4.13 u CT_UnderlineProperty */\r\n\t\t\t\tcase '<u':\r\n\t\t\t\t\tif(!y.val) break;\r\n\t\t\t\t\t/* falls through */\r\n\t\t\t\tcase '<u/>': font.u = 1; break;\r\n\t\t\t\tcase '</u>': break;\r\n\r\n\t\t\t\t/* 18.8.2 b */\r\n\t\t\t\tcase '<b':\r\n\t\t\t\t\tif(!y.val) break;\r\n\t\t\t\t\t/* falls through */\r\n\t\t\t\tcase '<b/>': font.b = 1; break;\r\n\t\t\t\tcase '</b>': break;\r\n\r\n\t\t\t\t/* 18.8.26 i */\r\n\t\t\t\tcase '<i':\r\n\t\t\t\t\tif(!y.val) break;\r\n\t\t\t\t\t/* falls through */\r\n\t\t\t\tcase '<i/>': font.i = 1; break;\r\n\t\t\t\tcase '</i>': break;\r\n\r\n\t\t\t\t/* 18.3.1.15 color CT_Color TODO: tint, theme, auto, indexed */\r\n\t\t\t\tcase '<color':\r\n\t\t\t\t\tif(y.rgb) font.color = y.rgb.substr(2,6);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t/* 18.8.18 family ST_FontFamily */\r\n\t\t\t\tcase '<family': font.family = y.val; break;\r\n\r\n\t\t\t\t/* 18.4.14 vertAlign CT_VerticalAlignFontProperty TODO */\r\n\t\t\t\tcase '<vertAlign': break;\r\n\r\n\t\t\t\t/* 18.8.35 scheme CT_FontScheme TODO */\r\n\t\t\t\tcase '<scheme': break;\r\n\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tif(y[0].charCodeAt(1) !== 47) throw 'Unrecognized rich format ' + y[0];\r\n\t\t\t}\r\n\t\t}\r\n\t\t/* TODO: These should be generated styles, not inline */\r\n\t\tvar style = [];\r\n\t\tif(font.b) style.push(\"font-weight: bold;\");\r\n\t\tif(font.i) style.push(\"font-style: italic;\");\r\n\t\tintro.push('<span style=\"' + style.join(\"\") + '\">');\r\n\t\toutro.push(\"</span>\");\r\n\t\treturn cp;\r\n\t};\r\n\r\n\t/* 18.4.4 r CT_RElt */\r\n\tfunction parse_r(r) {\r\n\t\tvar terms = [[],\"\",[]];\r\n\t\t/* 18.4.12 t ST_Xstring */\r\n\t\tvar t = r.match(tregex), cp = 65001;\r\n\t\tif(!isval(t)) return \"\";\r\n\t\tterms[1] = t[1];\r\n\r\n\t\tvar rpr = r.match(rpregex);\r\n\t\tif(isval(rpr)) cp = parse_rpr(rpr[1], terms[0], terms[2]);\r\n\r\n\t\treturn terms[0].join(\"\") + terms[1].replace(nlregex,'<br/>') + terms[2].join(\"\");\r\n\t}\r\n\treturn function parse_rs(rs) {\r\n\t\treturn rs.replace(rregex,\"\").split(rend).map(parse_r).join(\"\");\r\n\t};\r\n})();\r\n\r\n/* 18.4.8 si CT_Rst */\r\nvar sitregex = /<t[^>]*>([^<]*)<\\/t>/g, sirregex = /<r>/;\r\nfunction parse_si(x, opts) {\r\n\tvar html = opts ? opts.cellHTML : true;\r\n\tvar z = {};\r\n\tif(!x) return null;\r\n\tvar y;\r\n\t/* 18.4.12 t ST_Xstring (Plaintext String) */\r\n\tif(x.charCodeAt(1) === 116) {\r\n\t\tz.t = utf8read(unescapexml(x.substr(x.indexOf(\">\")+1).split(/<\\/t>/)[0]));\r\n\t\tz.r = x;\r\n\t\tif(html) z.h = z.t;\r\n\t}\r\n\t/* 18.4.4 r CT_RElt (Rich Text Run) */\r\n\telse if((y = x.match(sirregex))) {\r\n\t\tz.r = x;\r\n\t\tz.t = utf8read(unescapexml(x.match(sitregex).join(\"\").replace(tagregex,\"\")));\r\n\t\tif(html) z.h = parse_rs(x);\r\n\t}\r\n\t/* 18.4.3 phoneticPr CT_PhoneticPr (TODO: needed for Asian support) */\r\n\t/* 18.4.6 rPh CT_PhoneticRun (TODO: needed for Asian support) */\r\n\treturn z;\r\n}\r\n\r\n/* 18.4 Shared String Table */\r\nvar sstr0 = /<sst([^>]*)>([\\s\\S]*)<\\/sst>/;\r\nvar sstr1 = /<(?:si|sstItem)>/g;\r\nvar sstr2 = /<\\/(?:si|sstItem)>/;\r\nfunction parse_sst_xml(data, opts) {\r\n\tvar s = [], ss;\r\n\t/* 18.4.9 sst CT_Sst */\r\n\tvar sst = data.match(sstr0);\r\n\tif(isval(sst)) {\r\n\t\tss = sst[2].replace(sstr1,\"\").split(sstr2);\r\n\t\tfor(var i = 0; i != ss.length; ++i) {\r\n\t\t\tvar o = parse_si(ss[i], opts);\r\n\t\t\tif(o != null) s[s.length] = o;\r\n\t\t}\r\n\t\tsst = parsexmltag(sst[1]); s.Count = sst.count; s.Unique = sst.uniqueCount;\r\n\t}\r\n\treturn s;\r\n}\r\n\r\nRELS.SST = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings\";\r\nvar straywsregex = /^\\s|\\s$|[\\t\\n\\r]/;\r\nfunction write_sst_xml(sst, opts) {\r\n\tif(!opts.bookSST) return \"\";\r\n\tvar o = [XML_HEADER];\r\n\to[o.length] = (writextag('sst', null, {\r\n\t\txmlns: XMLNS.main[0],\r\n\t\tcount: sst.Count,\r\n\t\tuniqueCount: sst.Unique\r\n\t}));\r\n\tfor(var i = 0; i != sst.length; ++i) { if(sst[i] == null) continue;\r\n\t\tvar s = sst[i];\r\n\t\tvar sitag = \"<si>\";\r\n\t\tif(s.r) sitag += s.r;\r\n\t\telse {\r\n\t\t\tsitag += \"<t\";\r\n\t\t\tif(s.t.match(straywsregex)) sitag += ' xml:space=\"preserve\"';\r\n\t\t\tsitag += \">\" + escapexml(s.t) + \"</t>\";\r\n\t\t}\r\n\t\tsitag += \"</si>\";\r\n\t\to[o.length] = (sitag);\r\n\t}\r\n\tif(o.length>2){ o[o.length] = ('</sst>'); o[1]=o[1].replace(\"/>\",\">\"); }\r\n\treturn o.join(\"\");\r\n}\r\n/* [MS-XLSB] 2.4.219 BrtBeginSst */\r\nfunction parse_BrtBeginSst(data, length) {\r\n\treturn [data.read_shift(4), data.read_shift(4)];\r\n}\r\n\r\n/* [MS-XLSB] 2.1.7.45 Shared Strings */\r\nfunction parse_sst_bin(data, opts) {\r\n\tvar s = [];\r\n\tvar pass = false;\r\n\trecordhopper(data, function hopper_sst(val, R, RT) {\r\n\t\tswitch(R.n) {\r\n\t\t\tcase 'BrtBeginSst': s.Count = val[0]; s.Unique = val[1]; break;\r\n\t\t\tcase 'BrtSSTItem': s.push(val); break;\r\n\t\t\tcase 'BrtEndSst': return true;\r\n\t\t\t/* TODO: produce a test case with a future record */\r\n\t\t\tcase 'BrtFRTBegin': pass = true; break;\r\n\t\t\tcase 'BrtFRTEnd': pass = false; break;\r\n\t\t\tdefault: if(!pass || opts.WTF) throw new Error(\"Unexpected record \" + RT + \" \" + R.n);\r\n\t\t}\r\n\t});\r\n\treturn s;\r\n}\r\n\r\nfunction write_BrtBeginSst(sst, o) {\r\n\tif(!o) o = new_buf(8);\r\n\to.write_shift(4, sst.Count);\r\n\to.write_shift(4, sst.Unique);\r\n\treturn o;\r\n}\r\n\r\nvar write_BrtSSTItem = write_RichStr;\r\n\r\nfunction write_sst_bin(sst, opts) {\r\n\tvar ba = buf_array();\r\n\twrite_record(ba, \"BrtBeginSst\", write_BrtBeginSst(sst));\r\n\tfor(var i = 0; i < sst.length; ++i) write_record(ba, \"BrtSSTItem\", write_BrtSSTItem(sst[i]));\r\n\twrite_record(ba, \"BrtEndSst\");\r\n\treturn ba.end();\r\n}\r\nfunction _JS2ANSI(str) { if(typeof cptable !== 'undefined') return cptable.utils.encode(1252, str); return str.split(\"\").map(function(x) { return x.charCodeAt(0); }); }\r\n\r\n/* [MS-OFFCRYPTO] 2.1.4 Version */\r\nfunction parse_Version(blob, length) {\r\n\tvar o = {};\r\n\to.Major = blob.read_shift(2);\r\n\to.Minor = blob.read_shift(2);\r\n\treturn o;\r\n}\r\n/* [MS-OFFCRYPTO] 2.3.2 Encryption Header */\r\nfunction parse_EncryptionHeader(blob, length) {\r\n\tvar o = {};\r\n\to.Flags = blob.read_shift(4);\r\n\r\n\t// Check if SizeExtra is 0x00000000\r\n\tvar tmp = blob.read_shift(4);\r\n\tif(tmp !== 0) throw 'Unrecognized SizeExtra: ' + tmp;\r\n\r\n\to.AlgID = blob.read_shift(4);\r\n\tswitch(o.AlgID) {\r\n\t\tcase 0: case 0x6801: case 0x660E: case 0x660F: case 0x6610: break;\r\n\t\tdefault: throw 'Unrecognized encryption algorithm: ' + o.AlgID;\r\n\t}\r\n\tparsenoop(blob, length-12);\r\n\treturn o;\r\n}\r\n\r\n/* [MS-OFFCRYPTO] 2.3.3 Encryption Verifier */\r\nfunction parse_EncryptionVerifier(blob, length) {\r\n\treturn parsenoop(blob, length);\r\n}\r\n/* [MS-OFFCRYPTO] 2.3.5.1 RC4 CryptoAPI Encryption Header */\r\nfunction parse_RC4CryptoHeader(blob, length) {\r\n\tvar o = {};\r\n\tvar vers = o.EncryptionVersionInfo = parse_Version(blob, 4); length -= 4;\r\n\tif(vers.Minor != 2) throw 'unrecognized minor version code: ' + vers.Minor;\r\n\tif(vers.Major > 4 || vers.Major < 2) throw 'unrecognized major version code: ' + vers.Major;\r\n\to.Flags = blob.read_shift(4); length -= 4;\r\n\tvar sz = blob.read_shift(4); length -= 4;\r\n\to.EncryptionHeader = parse_EncryptionHeader(blob, sz); length -= sz;\r\n\to.EncryptionVerifier = parse_EncryptionVerifier(blob, length);\r\n\treturn o;\r\n}\r\n/* [MS-OFFCRYPTO] 2.3.6.1 RC4 Encryption Header */\r\nfunction parse_RC4Header(blob, length) {\r\n\tvar o = {};\r\n\tvar vers = o.EncryptionVersionInfo = parse_Version(blob, 4); length -= 4;\r\n\tif(vers.Major != 1 || vers.Minor != 1) throw 'unrecognized version code ' + vers.Major + ' : ' + vers.Minor;\r\n\to.Salt = blob.read_shift(16);\r\n\to.EncryptedVerifier = blob.read_shift(16);\r\n\to.EncryptedVerifierHash = blob.read_shift(16);\r\n\treturn o;\r\n}\r\n\r\n/* [MS-OFFCRYPTO] 2.3.7.1 Binary Document Password Verifier Derivation */\r\nfunction crypto_CreatePasswordVerifier_Method1(Password) {\r\n\tvar Verifier = 0x0000, PasswordArray;\r\n\tvar PasswordDecoded = _JS2ANSI(Password);\r\n\tvar len = PasswordDecoded.length + 1, i, PasswordByte;\r\n\tvar Intermediate1, Intermediate2, Intermediate3;\r\n\tPasswordArray = new_raw_buf(len);\r\n\tPasswordArray[0] = PasswordDecoded.length;\r\n\tfor(i = 1; i != len; ++i) PasswordArray[i] = PasswordDecoded[i-1];\r\n\tfor(i = len-1; i >= 0; --i) {\r\n\t\tPasswordByte = PasswordArray[i];\r\n\t\tIntermediate1 = ((Verifier & 0x4000) === 0x0000) ? 0 : 1;\r\n\t\tIntermediate2 = (Verifier << 1) & 0x7FFF;\r\n\t\tIntermediate3 = Intermediate1 | Intermediate2;\r\n\t\tVerifier = Intermediate3 ^ PasswordByte;\r\n\t}\r\n\treturn Verifier ^ 0xCE4B;\r\n}\r\n\r\n/* [MS-OFFCRYPTO] 2.3.7.2 Binary Document XOR Array Initialization */\r\nvar crypto_CreateXorArray_Method1 = (function() {\r\n\tvar PadArray = [0xBB, 0xFF, 0xFF, 0xBA, 0xFF, 0xFF, 0xB9, 0x80, 0x00, 0xBE, 0x0F, 0x00, 0xBF, 0x0F, 0x00];\r\n\tvar InitialCode = [0xE1F0, 0x1D0F, 0xCC9C, 0x84C0, 0x110C, 0x0E10, 0xF1CE, 0x313E, 0x1872, 0xE139, 0xD40F, 0x84F9, 0x280C, 0xA96A, 0x4EC3];\r\n\tvar XorMatrix = [0xAEFC, 0x4DD9, 0x9BB2, 0x2745, 0x4E8A, 0x9D14, 0x2A09, 0x7B61, 0xF6C2, 0xFDA5, 0xEB6B, 0xC6F7, 0x9DCF, 0x2BBF, 0x4563, 0x8AC6, 0x05AD, 0x0B5A, 0x16B4, 0x2D68, 0x5AD0, 0x0375, 0x06EA, 0x0DD4, 0x1BA8, 0x3750, 0x6EA0, 0xDD40, 0xD849, 0xA0B3, 0x5147, 0xA28E, 0x553D, 0xAA7A, 0x44D5, 0x6F45, 0xDE8A, 0xAD35, 0x4A4B, 0x9496, 0x390D, 0x721A, 0xEB23, 0xC667, 0x9CEF, 0x29FF, 0x53FE, 0xA7FC, 0x5FD9, 0x47D3, 0x8FA6, 0x0F6D, 0x1EDA, 0x3DB4, 0x7B68, 0xF6D0, 0xB861, 0x60E3, 0xC1C6, 0x93AD, 0x377B, 0x6EF6, 0xDDEC, 0x45A0, 0x8B40, 0x06A1, 0x0D42, 0x1A84, 0x3508, 0x6A10, 0xAA51, 0x4483, 0x8906, 0x022D, 0x045A, 0x08B4, 0x1168, 0x76B4, 0xED68, 0xCAF1, 0x85C3, 0x1BA7, 0x374E, 0x6E9C, 0x3730, 0x6E60, 0xDCC0, 0xA9A1, 0x4363, 0x86C6, 0x1DAD, 0x3331, 0x6662, 0xCCC4, 0x89A9, 0x0373, 0x06E6, 0x0DCC, 0x1021, 0x2042, 0x4084, 0x8108, 0x1231, 0x2462, 0x48C4];\r\n\tvar Ror = function(Byte) { return ((Byte/2) | (Byte*128)) & 0xFF; };\r\n\tvar XorRor = function(byte1, byte2) { return Ror(byte1 ^ byte2); };\r\n\tvar CreateXorKey_Method1 = function(Password) {\r\n\t\tvar XorKey = InitialCode[Password.length - 1];\r\n\t\tvar CurrentElement = 0x68;\r\n\t\tfor(var i = Password.length-1; i >= 0; --i) {\r\n\t\t\tvar Char = Password[i];\r\n\t\t\tfor(var j = 0; j != 7; ++j) {\r\n\t\t\t\tif(Char & 0x40) XorKey ^= XorMatrix[CurrentElement];\r\n\t\t\t\tChar *= 2; --CurrentElement;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn XorKey;\r\n\t};\r\n\treturn function(password) {\r\n\t\tvar Password = _JS2ANSI(password);\r\n\t\tvar XorKey = CreateXorKey_Method1(Password);\r\n\t\tvar Index = Password.length;\r\n\t\tvar ObfuscationArray = new_raw_buf(16);\r\n\t\tfor(var i = 0; i != 16; ++i) ObfuscationArray[i] = 0x00;\r\n\t\tvar Temp, PasswordLastChar, PadIndex;\r\n\t\tif((Index & 1) === 1) {\r\n\t\t\tTemp = XorKey >> 8;\r\n\t\t\tObfuscationArray[Index] = XorRor(PadArray[0], Temp);\r\n\t\t\t--Index;\r\n\t\t\tTemp = XorKey & 0xFF;\r\n\t\t\tPasswordLastChar = Password[Password.length - 1];\r\n\t\t\tObfuscationArray[Index] = XorRor(PasswordLastChar, Temp);\r\n\t\t}\r\n\t\twhile(Index > 0) {\r\n\t\t\t--Index;\r\n\t\t\tTemp = XorKey >> 8;\r\n\t\t\tObfuscationArray[Index] = XorRor(Password[Index], Temp);\r\n\t\t\t--Index;\r\n\t\t\tTemp = XorKey & 0xFF;\r\n\t\t\tObfuscationArray[Index] = XorRor(Password[Index], Temp);\r\n\t\t}\r\n\t\tIndex = 15;\r\n\t\tPadIndex = 15 - Password.length;\r\n\t\twhile(PadIndex > 0) {\r\n\t\t\tTemp = XorKey >> 8;\r\n\t\t\tObfuscationArray[Index] = XorRor(PadArray[PadIndex], Temp);\r\n\t\t\t--Index;\r\n\t\t\t--PadIndex;\r\n\t\t\tTemp = XorKey & 0xFF;\r\n\t\t\tObfuscationArray[Index] = XorRor(Password[Index], Temp);\r\n\t\t\t--Index;\r\n\t\t\t--PadIndex;\r\n\t\t}\r\n\t\treturn ObfuscationArray;\r\n\t};\r\n})();\r\n\r\n/* [MS-OFFCRYPTO] 2.3.7.3 Binary Document XOR Data Transformation Method 1 */\r\nvar crypto_DecryptData_Method1 = function(password, Data, XorArrayIndex, XorArray, O) {\r\n\t/* If XorArray is set, use it; if O is not set, make changes in-place */\r\n\tif(!O) O = Data;\r\n\tif(!XorArray) XorArray = crypto_CreateXorArray_Method1(password);\r\n\tvar Index, Value;\r\n\tfor(Index = 0; Index != Data.length; ++Index) {\r\n\t\tValue = Data[Index];\r\n\t\tValue ^= XorArray[XorArrayIndex];\r\n\t\tValue = ((Value>>5) | (Value<<3)) & 0xFF;\r\n\t\tO[Index] = Value;\r\n\t\t++XorArrayIndex;\r\n\t}\r\n\treturn [O, XorArrayIndex, XorArray];\r\n};\r\n\r\nvar crypto_MakeXorDecryptor = function(password) {\r\n\tvar XorArrayIndex = 0, XorArray = crypto_CreateXorArray_Method1(password);\r\n\treturn function(Data) {\r\n\t\tvar O = crypto_DecryptData_Method1(null, Data, XorArrayIndex, XorArray);\r\n\t\tXorArrayIndex = O[1];\r\n\t\treturn O[0];\r\n\t};\r\n};\r\n\r\n/* 2.5.343 */\r\nfunction parse_XORObfuscation(blob, length, opts, out) {\r\n\tvar o = { key: parseuint16(blob), verificationBytes: parseuint16(blob) };\r\n\tif(opts.password) o.verifier = crypto_CreatePasswordVerifier_Method1(opts.password);\r\n\tout.valid = o.verificationBytes === o.verifier;\r\n\tif(out.valid) out.insitu_decrypt = crypto_MakeXorDecryptor(opts.password);\r\n\treturn o;\r\n}\r\n\r\n/* 2.4.117 */\r\nfunction parse_FilePassHeader(blob, length, oo) {\r\n\tvar o = oo || {}; o.Info = blob.read_shift(2); blob.l -= 2;\r\n\tif(o.Info === 1) o.Data = parse_RC4Header(blob, length);\r\n\telse o.Data = parse_RC4CryptoHeader(blob, length);\r\n\treturn o;\r\n}\r\nfunction parse_FilePass(blob, length, opts) {\r\n\tvar o = { Type: blob.read_shift(2) }; /* wEncryptionType */\r\n\tif(o.Type) parse_FilePassHeader(blob, length-2, o);\r\n\telse parse_XORObfuscation(blob, length-2, opts, o);\r\n\treturn o;\r\n}\r\n\r\n\r\nfunction hex2RGB(h) {\r\n\tvar o = h.substr(h[0]===\"#\"?1:0,6);\r\n\treturn [parseInt(o.substr(0,2),16),parseInt(o.substr(2,2),16),parseInt(o.substr(4,2),16)];\r\n}\r\nfunction rgb2Hex(rgb) {\r\n\tfor(var i=0,o=1; i!=3; ++i) o = o*256 + (rgb[i]>255?255:rgb[i]<0?0:rgb[i]);\r\n\treturn o.toString(16).toUpperCase().substr(1);\r\n}\r\n\r\nfunction rgb2HSL(rgb) {\r\n\tvar R = rgb[0]/255, G = rgb[1]/255, B=rgb[2]/255;\r\n\tvar M = Math.max(R, G, B), m = Math.min(R, G, B), C = M - m;\r\n\tif(C === 0) return [0, 0, R];\r\n\r\n\tvar H6 = 0, S = 0, L2 = (M + m);\r\n\tS = C / (L2 > 1 ? 2 - L2 : L2);\r\n\tswitch(M){\r\n\t\tcase R: H6 = ((G - B) / C + 6)%6; break;\r\n\t\tcase G: H6 = ((B - R) / C + 2); break;\r\n\t\tcase B: H6 = ((R - G) / C + 4); break;\r\n\t}\r\n\treturn [H6 / 6, S, L2 / 2];\r\n}\r\n\r\nfunction hsl2RGB(hsl){\r\n\tvar H = hsl[0], S = hsl[1], L = hsl[2];\r\n\tvar C = S * 2 * (L < 0.5 ? L : 1 - L), m = L - C/2;\r\n\tvar rgb = [m,m,m], h6 = 6*H;\r\n\r\n\tvar X;\r\n\tif(S !== 0) switch(h6|0) {\r\n\t\tcase 0: case 6: X = C * h6; rgb[0] += C; rgb[1] += X; break;\r\n\t\tcase 1: X = C * (2 - h6);   rgb[0] += X; rgb[1] += C; break;\r\n\t\tcase 2: X = C * (h6 - 2);   rgb[1] += C; rgb[2] += X; break;\r\n\t\tcase 3: X = C * (4 - h6);   rgb[1] += X; rgb[2] += C; break;\r\n\t\tcase 4: X = C * (h6 - 4);   rgb[2] += C; rgb[0] += X; break;\r\n\t\tcase 5: X = C * (6 - h6);   rgb[2] += X; rgb[0] += C; break;\r\n\t}\r\n\tfor(var i = 0; i != 3; ++i) rgb[i] = Math.round(rgb[i]*255);\r\n\treturn rgb;\r\n}\r\n\r\n/* 18.8.3 bgColor tint algorithm */\r\nfunction rgb_tint(hex, tint) {\r\n\tif(tint == 0) return hex;\r\n\tvar hsl = rgb2HSL(hex2RGB(hex));\r\n\tif (tint < 0) hsl[2] = hsl[2] * (1 + tint);\r\n\telse hsl[2] = 1 - (1 - hsl[2]) * (1 - tint);\r\n  var rev =rgb2Hex(hsl2RGB(hsl))\r\n\treturn rev;\r\n}\r\n\r\n/* 18.3.1.13 width calculations */\r\nvar DEF_MDW = 7, MAX_MDW = 15, MIN_MDW = 1, MDW = DEF_MDW;\r\nfunction width2px(width) { return (( width + ((128/MDW)|0)/256 )* MDW )|0; }\r\nfunction px2char(px) { return (((px - 5)/MDW * 100 + 0.5)|0)/100; }\r\nfunction char2width(chr) { return (((chr * MDW + 5)/MDW*256)|0)/256; }\r\nfunction cycle_width(collw) { return char2width(px2char(width2px(collw))); }\r\nfunction find_mdw(collw, coll) {\r\n\tif(cycle_width(collw) != collw) {\r\n\t\tfor(MDW=DEF_MDW; MDW>MIN_MDW; --MDW) if(cycle_width(collw) === collw) break;\r\n\t\tif(MDW === MIN_MDW) for(MDW=DEF_MDW+1; MDW<MAX_MDW; ++MDW) if(cycle_width(collw) === collw) break;\r\n\t\tif(MDW === MAX_MDW) MDW = DEF_MDW;\r\n\t}\r\n}\r\n\r\n/* [MS-EXSPXML3] 2.4.54 ST_enmPattern */\r\nvar XLMLPatternTypeMap = {\r\n\t\"None\": \"none\",\r\n\t\"Solid\": \"solid\",\r\n\t\"Gray50\": \"mediumGray\",\r\n\t\"Gray75\": \"darkGray\",\r\n\t\"Gray25\": \"lightGray\",\r\n\t\"HorzStripe\": \"darkHorizontal\",\r\n\t\"VertStripe\": \"darkVertical\",\r\n\t\"ReverseDiagStripe\": \"darkDown\",\r\n\t\"DiagStripe\": \"darkUp\",\r\n\t\"DiagCross\": \"darkGrid\",\r\n\t\"ThickDiagCross\": \"darkTrellis\",\r\n\t\"ThinHorzStripe\": \"lightHorizontal\",\r\n\t\"ThinVertStripe\": \"lightVertical\",\r\n\t\"ThinReverseDiagStripe\": \"lightDown\",\r\n\t\"ThinHorzCross\": \"lightGrid\"\r\n};\r\n\r\nvar styles = {}; // shared styles\r\n\r\nvar themes = {}; // shared themes\r\n\r\n/* 18.8.21 fills CT_Fills */\r\nfunction parse_fills(t, opts) {\r\n  styles.Fills = [];\r\n  var fill = {};\r\n  t[0].match(tagregex).forEach(function (x) {\r\n    var y = parsexmltag(x);\r\n    switch (y[0]) {\r\n      case '<fills':\r\n      case '<fills>':\r\n      case '</fills>':\r\n        break;\r\n\r\n      /* 18.8.20 fill CT_Fill */\r\n      case '<fill>':\r\n        break;\r\n      case '</fill>':\r\n        styles.Fills.push(fill);\r\n        fill = {};\r\n        break;\r\n\r\n      /* 18.8.32 patternFill CT_PatternFill */\r\n      case '<patternFill':\r\n        if (y.patternType) fill.patternType = y.patternType;\r\n        break;\r\n      case '<patternFill/>':\r\n      case '</patternFill>':\r\n        break;\r\n\r\n      /* 18.8.3 bgColor CT_Color */\r\n      case '<bgColor':\r\n        if (!fill.bgColor) fill.bgColor = {};\r\n        if (y.indexed) fill.bgColor.indexed = parseInt(y.indexed, 10);\r\n        if (y.theme) fill.bgColor.theme = parseInt(y.theme, 10);\r\n        if (y.tint) fill.bgColor.tint = parseFloat(y.tint);\r\n\r\n\r\n        if (y.theme && themes.themeElements && themes.themeElements.clrScheme) {\r\n          fill.bgColor.rgb = rgb_tint(themes.themeElements.clrScheme[fill.bgColor.theme].rgb, fill.bgColor.tint || 0);\r\n          if (opts.WTF) fill.bgColor.raw_rgb = rgb_tint(themes.themeElements.clrScheme[fill.bgColor.theme].rgb,0);\r\n        }\r\n        /* Excel uses ARGB strings */\r\n        if (y.rgb) fill.bgColor.rgb = y.rgb;//.substring(y.rgb.length - 6);\r\n        break;\r\n      case '<bgColor/>':\r\n      case '</bgColor>':\r\n        break;\r\n\r\n      /* 18.8.19 fgColor CT_Color */\r\n      case '<fgColor':\r\n        if (!fill.fgColor) fill.fgColor = {};\r\n        if (y.theme) fill.fgColor.theme = parseInt(y.theme, 10);\r\n        if (y.tint) fill.fgColor.tint = parseFloat(y.tint);\r\n\r\n        if (y.theme && themes.themeElements && themes.themeElements.clrScheme) {\r\n          fill.fgColor.rgb = rgb_tint(themes.themeElements.clrScheme[fill.fgColor.theme].rgb, fill.fgColor.tint || 0);\r\n          if (opts.WTF) fill.fgColor.raw_rgb = rgb_tint(themes.themeElements.clrScheme[fill.fgColor.theme].rgb,0);\r\n        }\r\n\r\n        /* Excel uses ARGB strings */\r\n        if (y.rgb) fill.fgColor.rgb = y.rgb;//.substring(y.rgb.length - 6);\r\n        break;\r\n      case '<fgColor/>':\r\n      case '</fgColor>':\r\n        break;\r\n\r\n      default:\r\n        if (opts.WTF) throw 'unrecognized ' + y[0] + ' in fills';\r\n    }\r\n  });\r\n}\r\n\r\nfunction parse_fonts(t, opts) {\r\n  styles.Fonts = [];\r\n  var font = {};\r\n  t[0].match(tagregex).forEach(function (x) {\r\n    var y = parsexmltag(x);\r\n    switch (y[0]) {\r\n\r\n      case '<fonts':\r\n      case  '<fonts>':\r\n      case '</fonts>':\r\n        break;\r\n      case '<font':\r\n        break;\r\n      case '</font>':\r\n        styles.Fonts.push(font);\r\n        ;\r\n        font = {};\r\n        break;\r\n\r\n      case '<name':\r\n        if (y.val) font.name = y.val;\r\n        break;\r\n      case '<name/>':\r\n      case '</name>':\r\n        break;\r\n\r\n\r\n      case '<b/>':\r\n        font.bold = true;\r\n        break;\r\n      case '<u/>':\r\n        font.underline = true;\r\n        break;\r\n      case '<i/>':\r\n        font.italic = true;\r\n        break;\r\n      case '<strike/>':\r\n        font.strike = true;\r\n        break;\r\n      case '<outline/>':\r\n        font.outline = true;\r\n        break;\r\n      case '<shadow/>':\r\n        font.shadow = true;\r\n        break;\r\n\r\n\r\n      case '<sz':\r\n        if (y.val) font.sz = y.val;\r\n        break;\r\n      case '<sz/>':\r\n      case '</sz>':\r\n        break;\r\n\r\n      case '<vertAlign':\r\n        if (y.val) font.vertAlign = y.val;\r\n        break;\r\n      case '<vertAlign/>':\r\n      case '</vertAlign>':\r\n        break;\r\n\r\n\r\n      case '<color':\r\n        if (!font.color) font.color = {};\r\n        if (y.theme) font.color.theme = y.theme;\r\n        if (y.tint) font.color.tint = y.tint;\r\n        if (y.theme && themes.themeElements && themes.themeElements.clrScheme) {\r\n          font.color.rgb = rgb_tint(themes.themeElements.clrScheme[font.color.theme].rgb, font.color.tint || 0);\r\n        }\r\n        if (y.rgb) font.color.rgb = y.rgb;\r\n        break;\r\n      case '<color/>':\r\n      case '</color>':\r\n        break;\r\n    }\r\n  });\r\n}\r\n\r\nfunction parse_borders(t, opts) {\r\n  styles.Borders = [];\r\n  var border = {}, sub_border = {};\r\n  t[0].match(tagregex).forEach(function (x) {\r\n    var y = parsexmltag(x);\r\n    switch (y[0]) {\r\n      case '<borders':\r\n      case  '<borders>':\r\n      case '</borders>':\r\n        break;\r\n      case '<border':\r\n      case '<border>':\r\n        border = {};\r\n        if (y.diagonalUp) { border.diagonalUp = y.diagonalUp; }\r\n        if (y.diagonalDown) { border.diagonalDown = y.diagonalDown; }\r\n        styles.Borders.push(border);\r\n\r\n        break;\r\n        break;\r\n      case '</border>':\r\n        break;\r\n\r\n      case '<left':\r\n        sub_border = border.left = {};\r\n        if (y.style) {\r\n          sub_border.style = y.style;\r\n        }\r\n        break;\r\n      case '<right':\r\n        sub_border = border.right = {};\r\n        if (y.style) {\r\n          sub_border.style = y.style;\r\n        }\r\n        break;\r\n      case '<top':\r\n        sub_border = border.top = {};\r\n        if (y.style) {\r\n          sub_border.style = y.style;\r\n        }\r\n        break;\r\n      case '<bottom':\r\n        sub_border = border.bottom = {};\r\n        if (y.style) {\r\n          sub_border.style = y.style;\r\n        }\r\n        break;\r\n      case '<diagonal':\r\n        sub_border = border.diagonal = {};\r\n        if (y.style) {\r\n          sub_border.style = y.style;\r\n        }\r\n        break;\r\n\r\n      case '<color':\r\n        sub_border.color = {};\r\n        if (y.theme) sub_border.color.theme = y.theme;\r\n        if (y.theme && themes.themeElements && themes.themeElements.clrScheme) {\r\n          sub_border.color.rgb = rgb_tint(themes.themeElements.clrScheme[sub_border.color.theme].rgb, sub_border.color.tint || 0);\r\n        }\r\n\r\n        if (y.tint) sub_border.color.tint = y.tint;\r\n        if (y.rgb) sub_border.color.rgb = y.rgb;\r\n        if (y.auto) sub_border.color.auto = y.auto;\r\n        break;\r\n      case '<name/>':\r\n      case '</name>':\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n  });\r\n\r\n}\r\n\r\n/* 18.8.31 numFmts CT_NumFmts */\r\nfunction parse_numFmts(t, opts) {\r\n  styles.NumberFmt = [];\r\n  var k = keys(SSF._table);\r\n  for (var i = 0; i < k.length; ++i) styles.NumberFmt[k[i]] = SSF._table[k[i]];\r\n  var m = t[0].match(tagregex);\r\n  for (i = 0; i < m.length; ++i) {\r\n    var y = parsexmltag(m[i]);\r\n    switch (y[0]) {\r\n      case '<numFmts':\r\n      case '</numFmts>':\r\n      case '<numFmts/>':\r\n      case '<numFmts>':\r\n        break;\r\n      case '<numFmt':\r\n      {\r\n        var f = unescapexml(utf8read(y.formatCode)), j = parseInt(y.numFmtId, 10);\r\n        styles.NumberFmt[j] = f;\r\n        if (j > 0) SSF.load(f, j);\r\n      }\r\n        break;\r\n      default:\r\n        if (opts.WTF) throw 'unrecognized ' + y[0] + ' in numFmts';\r\n    }\r\n  }\r\n}\r\n\r\nfunction write_numFmts(NF, opts) {\r\n  var o = [\"<numFmts>\"];\r\n  [\r\n    [5, 8],\r\n    [23, 26],\r\n    [41, 44],\r\n    [63, 66],\r\n    [164, 392]\r\n  ].forEach(function (r) {\r\n    for (var i = r[0]; i <= r[1]; ++i) if (NF[i] !== undefined) o[o.length] = (writextag('numFmt', null, {numFmtId: i, formatCode: escapexml(NF[i])}));\r\n  });\r\n  if (o.length === 1) return \"\";\r\n  o[o.length] = (\"</numFmts>\");\r\n  o[0] = writextag('numFmts', null, { count: o.length - 2 }).replace(\"/>\", \">\");\r\n  return o.join(\"\");\r\n}\r\n\r\n/* 18.8.10 cellXfs CT_CellXfs */\r\nfunction parse_cellXfs(t, opts) {\r\n  styles.CellXf = [];\r\n  var xf;\r\n  t[0].match(tagregex).forEach(function (x) {\r\n    var y = parsexmltag(x);\r\n    switch (y[0]) {\r\n      case '<cellXfs':\r\n      case '<cellXfs>':\r\n      case '<cellXfs/>':\r\n      case '</cellXfs>':\r\n        break;\r\n\r\n      /* 18.8.45 xf CT_Xf */\r\n      case '<xf':\r\n          xf = y;\r\n          delete xf[0];\r\n        delete y[0];\r\n        if (xf.numFmtId) xf.numFmtId = parseInt(xf.numFmtId, 10);\r\n        if (xf.fillId) xf.fillId = parseInt(xf.fillId, 10);\r\n        styles.CellXf.push(xf);\r\n        break;\r\n      case '</xf>':\r\n        break;\r\n\r\n      /* 18.8.1 alignment CT_CellAlignment */\r\n      case '<alignment':\r\n      case '<alignment/>':\r\n        var alignment = {}\r\n          if (y.vertical) { alignment.vertical = y.vertical;}\r\n          if (y.horizontal) { alignment.horizontal = y.horizontal;}\r\n          if (y.textRotation != undefined) { alignment.textRotation = y.textRotation; }\r\n          if (y.indent) { alignment.indent = y.indent; }\r\n          if (y.wrapText) { alignment.wrapText = y.wrapText; }\r\n          xf.alignment = alignment;\r\n\r\n        break;\r\n\r\n      /* 18.8.33 protection CT_CellProtection */\r\n      case '<protection':\r\n      case '</protection>':\r\n      case '<protection/>':\r\n        break;\r\n\r\n      case '<extLst':\r\n      case '</extLst>':\r\n        break;\r\n      case '<ext':\r\n        break;\r\n      default:\r\n        if (opts.WTF) throw 'unrecognized ' + y[0] + ' in cellXfs';\r\n    }\r\n  });\r\n}\r\n\r\nfunction write_cellXfs(cellXfs) {\r\n  var o = [];\r\n  o[o.length] = (writextag('cellXfs', null));\r\n  cellXfs.forEach(function (c) {\r\n    o[o.length] = (writextag('xf', null, c));\r\n  });\r\n  o[o.length] = (\"</cellXfs>\");\r\n  if (o.length === 2) return \"\";\r\n  o[0] = writextag('cellXfs', null, {count: o.length - 2}).replace(\"/>\", \">\");\r\n  return o.join(\"\");\r\n}\r\n\r\n/* 18.8 Styles CT_Stylesheet*/\r\nvar parse_sty_xml = (function make_pstyx() {\r\n  var numFmtRegex = /<numFmts([^>]*)>.*<\\/numFmts>/;\r\n  var cellXfRegex = /<cellXfs([^>]*)>.*<\\/cellXfs>/;\r\n  var fillsRegex = /<fills([^>]*)>.*<\\/fills>/;\r\n  var bordersRegex = /<borders([^>]*)>.*<\\/borders>/;\r\n\r\n  return function parse_sty_xml(data, opts) {\r\n    /* 18.8.39 styleSheet CT_Stylesheet */\r\n    var t;\r\n\r\n    /* numFmts CT_NumFmts ? */\r\n    if ((t = data.match(numFmtRegex))) parse_numFmts(t, opts);\r\n\r\n    /* fonts CT_Fonts ? */\r\n    if ((t = data.match(/<fonts([^>]*)>.*<\\/fonts>/))) parse_fonts(t, opts)\r\n\r\n    /* fills CT_Fills */\r\n    if ((t = data.match(fillsRegex))) parse_fills(t, opts);\r\n\r\n    /* borders CT_Borders ? */\r\n    if ((t = data.match(bordersRegex))) parse_borders(t, opts);\r\n    /* cellStyleXfs CT_CellStyleXfs ? */\r\n\r\n    /* cellXfs CT_CellXfs ? */\r\n    if ((t = data.match(cellXfRegex))) parse_cellXfs(t, opts);\r\n\r\n    /* dxfs CT_Dxfs ? */\r\n    /* tableStyles CT_TableStyles ? */\r\n    /* colors CT_Colors ? */\r\n    /* extLst CT_ExtensionList ? */\r\n\r\n    return styles;\r\n  };\r\n})();\r\n\r\nvar STYLES_XML_ROOT = writextag('styleSheet', null, {\r\n  'xmlns': XMLNS.main[0],\r\n  'xmlns:vt': XMLNS.vt\r\n});\r\n\r\nRELS.STY = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles\";\r\n\r\nfunction write_sty_xml(wb, opts) {\r\n\r\n  if (typeof style_builder != 'undefined' && typeof 'require' != 'undefined') {\r\n    return style_builder.toXml();\r\n  }\r\n\r\n  var o = [XML_HEADER, STYLES_XML_ROOT], w;\r\n  if ((w = write_numFmts(wb.SSF)) != null) o[o.length] = w;\r\n  o[o.length] = ('<fonts count=\"1\"><font><sz val=\"12\"/><color theme=\"1\"/><name val=\"Calibri\"/><family val=\"2\"/><scheme val=\"minor\"/></font></fonts>');\r\n  o[o.length] = ('<fills count=\"2\"><fill><patternFill patternType=\"none\"/></fill><fill><patternFill patternType=\"gray125\"/></fill></fills>');\r\n  o[o.length] = ('<borders count=\"1\"><border><left/><right/><top/><bottom/><diagonal/></border></borders>');\r\n  o[o.length] = ('<cellStyleXfs count=\"1\"><xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\"/></cellStyleXfs>');\r\n  if ((w = write_cellXfs(opts.cellXfs))) o[o.length] = (w);\r\n  o[o.length] = ('<cellStyles count=\"1\"><cellStyle name=\"Normal\" xfId=\"0\" builtinId=\"0\"/></cellStyles>');\r\n  o[o.length] = ('<dxfs count=\"0\"/>');\r\n  o[o.length] = ('<tableStyles count=\"0\" defaultTableStyle=\"TableStyleMedium9\" defaultPivotStyle=\"PivotStyleMedium4\"/>');\r\n\r\n  if (o.length > 2) {\r\n    o[o.length] = ('</styleSheet>');\r\n    o[1] = o[1].replace(\"/>\", \">\");\r\n  }\r\n  return o.join(\"\");\r\n}\r\n/* [MS-XLSB] 2.4.651 BrtFmt */\r\nfunction parse_BrtFmt(data, length) {\r\n\tvar ifmt = data.read_shift(2);\r\n\tvar stFmtCode = parse_XLWideString(data,length-2);\r\n\treturn [ifmt, stFmtCode];\r\n}\r\n\r\n/* [MS-XLSB] 2.4.653 BrtFont TODO */\r\nfunction parse_BrtFont(data, length) {\r\n\tvar out = {flags:{}};\r\n\tout.dyHeight = data.read_shift(2);\r\n\tout.grbit = parse_FontFlags(data, 2);\r\n\tout.bls = data.read_shift(2);\r\n\tout.sss = data.read_shift(2);\r\n\tout.uls = data.read_shift(1);\r\n\tout.bFamily = data.read_shift(1);\r\n\tout.bCharSet = data.read_shift(1);\r\n\tdata.l++;\r\n\tout.brtColor = parse_BrtColor(data, 8);\r\n\tout.bFontScheme = data.read_shift(1);\r\n\tout.name = parse_XLWideString(data, length - 21);\r\n\r\n\tout.flags.Bold = out.bls === 0x02BC;\r\n\tout.flags.Italic = out.grbit.fItalic;\r\n\tout.flags.Strikeout = out.grbit.fStrikeout;\r\n\tout.flags.Outline = out.grbit.fOutline;\r\n\tout.flags.Shadow = out.grbit.fShadow;\r\n\tout.flags.Condense = out.grbit.fCondense;\r\n\tout.flags.Extend = out.grbit.fExtend;\r\n\tout.flags.Sub = out.sss & 0x2;\r\n\tout.flags.Sup = out.sss & 0x1;\r\n\treturn out;\r\n}\r\n\r\n/* [MS-XLSB] 2.4.816 BrtXF */\r\nfunction parse_BrtXF(data, length) {\r\n\tvar ixfeParent = data.read_shift(2);\r\n\tvar ifmt = data.read_shift(2);\r\n\tparsenoop(data, length-4);\r\n\treturn {ixfe:ixfeParent, ifmt:ifmt };\r\n}\r\n\r\n/* [MS-XLSB] 2.1.7.50 Styles */\r\nfunction parse_sty_bin(data, opts) {\r\n\tstyles.NumberFmt = [];\r\n\tfor(var y in SSF._table) styles.NumberFmt[y] = SSF._table[y];\r\n\r\n\tstyles.CellXf = [];\r\n\tvar state = \"\"; /* TODO: this should be a stack */\r\n\tvar pass = false;\r\n\trecordhopper(data, function hopper_sty(val, R, RT) {\r\n\t\tswitch(R.n) {\r\n\t\t\tcase 'BrtFmt':\r\n\t\t\t\tstyles.NumberFmt[val[0]] = val[1]; SSF.load(val[1], val[0]);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'BrtFont': break; /* TODO */\r\n\t\t\tcase 'BrtKnownFonts': break; /* TODO */\r\n\t\t\tcase 'BrtFill': break; /* TODO */\r\n\t\t\tcase 'BrtBorder': break; /* TODO */\r\n\t\t\tcase 'BrtXF':\r\n\t\t\t\tif(state === \"CELLXFS\") {\r\n\t\t\t\t\tstyles.CellXf.push(val);\r\n\t\t\t\t}\r\n\t\t\t\tbreak; /* TODO */\r\n\t\t\tcase 'BrtStyle': break; /* TODO */\r\n\t\t\tcase 'BrtDXF': break; /* TODO */\r\n\t\t\tcase 'BrtMRUColor': break; /* TODO */\r\n\t\t\tcase 'BrtIndexedColor': break; /* TODO */\r\n\t\t\tcase 'BrtBeginStyleSheet': break;\r\n\t\t\tcase 'BrtEndStyleSheet': break;\r\n\t\t\tcase 'BrtBeginTableStyle': break;\r\n\t\t\tcase 'BrtTableStyleElement': break;\r\n\t\t\tcase 'BrtEndTableStyle': break;\r\n\t\t\tcase 'BrtBeginFmts': state = \"FMTS\"; break;\r\n\t\t\tcase 'BrtEndFmts': state = \"\"; break;\r\n\t\t\tcase 'BrtBeginFonts': state = \"FONTS\"; break;\r\n\t\t\tcase 'BrtEndFonts': state = \"\"; break;\r\n\t\t\tcase 'BrtACBegin': state = \"ACFONTS\"; break;\r\n\t\t\tcase 'BrtACEnd': state = \"\"; break;\r\n\t\t\tcase 'BrtBeginFills': state = \"FILLS\"; break;\r\n\t\t\tcase 'BrtEndFills': state = \"\"; break;\r\n\t\t\tcase 'BrtBeginBorders': state = \"BORDERS\"; break;\r\n\t\t\tcase 'BrtEndBorders': state = \"\"; break;\r\n\t\t\tcase 'BrtBeginCellStyleXFs': state = \"CELLSTYLEXFS\"; break;\r\n\t\t\tcase 'BrtEndCellStyleXFs': state = \"\"; break;\r\n\t\t\tcase 'BrtBeginCellXFs': state = \"CELLXFS\"; break;\r\n\t\t\tcase 'BrtEndCellXFs': state = \"\"; break;\r\n\t\t\tcase 'BrtBeginStyles': state = \"STYLES\"; break;\r\n\t\t\tcase 'BrtEndStyles': state = \"\"; break;\r\n\t\t\tcase 'BrtBeginDXFs': state = \"DXFS\"; break;\r\n\t\t\tcase 'BrtEndDXFs': state = \"\"; break;\r\n\t\t\tcase 'BrtBeginTableStyles': state = \"TABLESTYLES\"; break;\r\n\t\t\tcase 'BrtEndTableStyles': state = \"\"; break;\r\n\t\t\tcase 'BrtBeginColorPalette': state = \"COLORPALETTE\"; break;\r\n\t\t\tcase 'BrtEndColorPalette': state = \"\"; break;\r\n\t\t\tcase 'BrtBeginIndexedColors': state = \"INDEXEDCOLORS\"; break;\r\n\t\t\tcase 'BrtEndIndexedColors': state = \"\"; break;\r\n\t\t\tcase 'BrtBeginMRUColors': state = \"MRUCOLORS\"; break;\r\n\t\t\tcase 'BrtEndMRUColors': state = \"\"; break;\r\n\t\t\tcase 'BrtFRTBegin': pass = true; break;\r\n\t\t\tcase 'BrtFRTEnd': pass = false; break;\r\n\t\t\tcase 'BrtBeginStyleSheetExt14': break;\r\n\t\t\tcase 'BrtBeginSlicerStyles': break;\r\n\t\t\tcase 'BrtEndSlicerStyles': break;\r\n\t\t\tcase 'BrtBeginTimelineStylesheetExt15': break;\r\n\t\t\tcase 'BrtEndTimelineStylesheetExt15': break;\r\n\t\t\tcase 'BrtBeginTimelineStyles': break;\r\n\t\t\tcase 'BrtEndTimelineStyles': break;\r\n\t\t\tcase 'BrtEndStyleSheetExt14': break;\r\n\t\t\tdefault: if(!pass || opts.WTF) throw new Error(\"Unexpected record \" + RT + \" \" + R.n);\r\n\t\t}\r\n\t});\r\n\treturn styles;\r\n}\r\n\r\n/* [MS-XLSB] 2.1.7.50 Styles */\r\nfunction write_sty_bin(data, opts) {\r\n\tvar ba = buf_array();\r\n\twrite_record(ba, \"BrtBeginStyleSheet\");\r\n\t/* [FMTS] */\r\n\t/* [FONTS] */\r\n\t/* [FILLS] */\r\n\t/* [BORDERS] */\r\n\t/* CELLSTYLEXFS */\r\n\t/* CELLXFS*/\r\n\t/* STYLES */\r\n\t/* DXFS */\r\n\t/* TABLESTYLES */\r\n\t/* [COLORPALETTE] */\r\n\t/* FRTSTYLESHEET*/\r\n\twrite_record(ba, \"BrtEndStyleSheet\");\r\n\treturn ba.end();\r\n}\r\nRELS.THEME = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme\";\r\n\r\n/* 20.1.6.2 clrScheme CT_ColorScheme */\r\nfunction parse_clrScheme(t, opts) {\r\n\tthemes.themeElements.clrScheme = [];\r\n\tvar color = {};\r\n\tt[0].match(tagregex).forEach(function(x) {\r\n\t\tvar y = parsexmltag(x);\r\n\t\tswitch(y[0]) {\r\n\t\t\tcase '<a:clrScheme': case '</a:clrScheme>': break;\r\n\r\n\t\t\t/* 20.1.2.3.32 srgbClr CT_SRgbColor */\r\n\t\t\tcase '<a:srgbClr': color.rgb = y.val; break;\r\n\r\n\t\t\t/* 20.1.2.3.33 sysClr CT_SystemColor */\r\n\t\t\tcase '<a:sysClr': color.rgb = y.lastClr; break;\r\n\r\n\t\t\t/* 20.1.4.1.9 dk1 (Dark 1) */\r\n\t\t\tcase '<a:dk1>':\r\n\t\t\tcase '</a:dk1>':\r\n\t\t\t/* 20.1.4.1.10 dk2 (Dark 2) */\r\n\t\t\tcase '<a:dk2>':\r\n\t\t\tcase '</a:dk2>':\r\n\t\t\t/* 20.1.4.1.22 lt1 (Light 1) */\r\n\t\t\tcase '<a:lt1>':\r\n\t\t\tcase '</a:lt1>':\r\n\t\t\t/* 20.1.4.1.23 lt2 (Light 2) */\r\n\t\t\tcase '<a:lt2>':\r\n\t\t\tcase '</a:lt2>':\r\n\t\t\t/* 20.1.4.1.1 accent1 (Accent 1) */\r\n\t\t\tcase '<a:accent1>':\r\n\t\t\tcase '</a:accent1>':\r\n\t\t\t/* 20.1.4.1.2 accent2 (Accent 2) */\r\n\t\t\tcase '<a:accent2>':\r\n\t\t\tcase '</a:accent2>':\r\n\t\t\t/* 20.1.4.1.3 accent3 (Accent 3) */\r\n\t\t\tcase '<a:accent3>':\r\n\t\t\tcase '</a:accent3>':\r\n\t\t\t/* 20.1.4.1.4 accent4 (Accent 4) */\r\n\t\t\tcase '<a:accent4>':\r\n\t\t\tcase '</a:accent4>':\r\n\t\t\t/* 20.1.4.1.5 accent5 (Accent 5) */\r\n\t\t\tcase '<a:accent5>':\r\n\t\t\tcase '</a:accent5>':\r\n\t\t\t/* 20.1.4.1.6 accent6 (Accent 6) */\r\n\t\t\tcase '<a:accent6>':\r\n\t\t\tcase '</a:accent6>':\r\n\t\t\t/* 20.1.4.1.19 hlink (Hyperlink) */\r\n\t\t\tcase '<a:hlink>':\r\n\t\t\tcase '</a:hlink>':\r\n\t\t\t/* 20.1.4.1.15 folHlink (Followed Hyperlink) */\r\n\t\t\tcase '<a:folHlink>':\r\n\t\t\tcase '</a:folHlink>':\r\n\t\t\t\tif (y[0][1] === '/') {\r\n\t\t\t\t\tthemes.themeElements.clrScheme.push(color);\r\n\t\t\t\t\tcolor = {};\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcolor.name = y[0].substring(3, y[0].length - 1);\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tdefault: if(opts.WTF) throw 'unrecognized ' + y[0] + ' in clrScheme';\r\n\t\t}\r\n\t});\r\n}\r\n\r\n/* 20.1.4.1.18 fontScheme CT_FontScheme */\r\nfunction parse_fontScheme(t, opts) { }\r\n\r\n/* 20.1.4.1.15 fmtScheme CT_StyleMatrix */\r\nfunction parse_fmtScheme(t, opts) { }\r\n\r\nvar clrsregex = /<a:clrScheme([^>]*)>[^\\u2603]*<\\/a:clrScheme>/;\r\nvar fntsregex = /<a:fontScheme([^>]*)>[^\\u2603]*<\\/a:fontScheme>/;\r\nvar fmtsregex = /<a:fmtScheme([^>]*)>[^\\u2603]*<\\/a:fmtScheme>/;\r\n\r\n/* 20.1.6.10 themeElements CT_BaseStyles */\r\nfunction parse_themeElements(data, opts) {\r\n\tthemes.themeElements = {};\r\n\r\n\tvar t;\r\n\r\n\t[\r\n\t\t/* clrScheme CT_ColorScheme */\r\n\t\t['clrScheme', clrsregex, parse_clrScheme],\r\n\t\t/* fontScheme CT_FontScheme */\r\n\t\t['fontScheme', fntsregex, parse_fontScheme],\r\n\t\t/* fmtScheme CT_StyleMatrix */\r\n\t\t['fmtScheme', fmtsregex, parse_fmtScheme]\r\n\t].forEach(function(m) {\r\n\t\tif(!(t=data.match(m[1]))) throw m[0] + ' not found in themeElements';\r\n\t\tm[2](t, opts);\r\n\t});\r\n}\r\n\r\nvar themeltregex = /<a:themeElements([^>]*)>[^\\u2603]*<\\/a:themeElements>/;\r\n\r\n/* 14.2.7 Theme Part */\r\nfunction parse_theme_xml(data, opts) {\r\n\t/* 20.1.6.9 theme CT_OfficeStyleSheet */\r\n\tif(!data || data.length === 0) return themes;\r\n\r\n\tvar t;\r\n\r\n\t/* themeElements CT_BaseStyles */\r\n\tif(!(t=data.match(themeltregex))) throw 'themeElements not found in theme';\r\n\tparse_themeElements(t[0], opts);\r\n\r\n\treturn themes;\r\n}\r\n\r\n//function write_theme() { return '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\n<a:theme xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" name=\"Office Theme\"><a:themeElements><a:clrScheme name=\"Office\"><a:dk1><a:sysClr val=\"windowText\" lastClr=\"000000\"/></a:dk1><a:lt1><a:sysClr val=\"window\" lastClr=\"FFFFFF\"/></a:lt1><a:dk2><a:srgbClr val=\"1F497D\"/></a:dk2><a:lt2><a:srgbClr val=\"EEECE1\"/></a:lt2><a:accent1><a:srgbClr val=\"4F81BD\"/></a:accent1><a:accent2><a:srgbClr val=\"C0504D\"/></a:accent2><a:accent3><a:srgbClr val=\"9BBB59\"/></a:accent3><a:accent4><a:srgbClr val=\"8064A2\"/></a:accent4><a:accent5><a:srgbClr val=\"4BACC6\"/></a:accent5><a:accent6><a:srgbClr val=\"F79646\"/></a:accent6><a:hlink><a:srgbClr val=\"0000FF\"/></a:hlink><a:folHlink><a:srgbClr val=\"800080\"/></a:folHlink></a:clrScheme><a:fontScheme name=\"Office\"><a:majorFont><a:latin typeface=\"Cambria\"/><a:ea typeface=\"\"/><a:cs typeface=\"\"/><a:font script=\"Jpan\" typeface=\"ＭＳ Ｐゴシック\"/><a:font script=\"Hang\" typeface=\"맑은 고딕\"/><a:font script=\"Hans\" typeface=\"宋体\"/><a:font script=\"Hant\" typeface=\"新細明體\"/><a:font script=\"Arab\" typeface=\"Times New Roman\"/><a:font script=\"Hebr\" typeface=\"Times New Roman\"/><a:font script=\"Thai\" typeface=\"Tahoma\"/><a:font script=\"Ethi\" typeface=\"Nyala\"/><a:font script=\"Beng\" typeface=\"Vrinda\"/><a:font script=\"Gujr\" typeface=\"Shruti\"/><a:font script=\"Khmr\" typeface=\"MoolBoran\"/><a:font script=\"Knda\" typeface=\"Tunga\"/><a:font script=\"Guru\" typeface=\"Raavi\"/><a:font script=\"Cans\" typeface=\"Euphemia\"/><a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/><a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/><a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/><a:font script=\"Thaa\" typeface=\"MV Boli\"/><a:font script=\"Deva\" typeface=\"Mangal\"/><a:font script=\"Telu\" typeface=\"Gautami\"/><a:font script=\"Taml\" typeface=\"Latha\"/><a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/><a:font script=\"Orya\" typeface=\"Kalinga\"/><a:font script=\"Mlym\" typeface=\"Kartika\"/><a:font script=\"Laoo\" typeface=\"DokChampa\"/><a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/><a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/><a:font script=\"Viet\" typeface=\"Times New Roman\"/><a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/><a:font script=\"Geor\" typeface=\"Sylfaen\"/></a:majorFont><a:minorFont><a:latin typeface=\"Calibri\"/><a:ea typeface=\"\"/><a:cs typeface=\"\"/><a:font script=\"Jpan\" typeface=\"ＭＳ Ｐゴシック\"/><a:font script=\"Hang\" typeface=\"맑은 고딕\"/><a:font script=\"Hans\" typeface=\"宋体\"/><a:font script=\"Hant\" typeface=\"新細明體\"/><a:font script=\"Arab\" typeface=\"Arial\"/><a:font script=\"Hebr\" typeface=\"Arial\"/><a:font script=\"Thai\" typeface=\"Tahoma\"/><a:font script=\"Ethi\" typeface=\"Nyala\"/><a:font script=\"Beng\" typeface=\"Vrinda\"/><a:font script=\"Gujr\" typeface=\"Shruti\"/><a:font script=\"Khmr\" typeface=\"DaunPenh\"/><a:font script=\"Knda\" typeface=\"Tunga\"/><a:font script=\"Guru\" typeface=\"Raavi\"/><a:font script=\"Cans\" typeface=\"Euphemia\"/><a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/><a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/><a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/><a:font script=\"Thaa\" typeface=\"MV Boli\"/><a:font script=\"Deva\" typeface=\"Mangal\"/><a:font script=\"Telu\" typeface=\"Gautami\"/><a:font script=\"Taml\" typeface=\"Latha\"/><a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/><a:font script=\"Orya\" typeface=\"Kalinga\"/><a:font script=\"Mlym\" typeface=\"Kartika\"/><a:font script=\"Laoo\" typeface=\"DokChampa\"/><a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/><a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/><a:font script=\"Viet\" typeface=\"Arial\"/><a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/><a:font script=\"Geor\" typeface=\"Sylfaen\"/></a:minorFont></a:fontScheme><a:fmtScheme name=\"Office\"><a:fillStyleLst><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"50000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"35000\"><a:schemeClr val=\"phClr\"><a:tint val=\"37000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:tint val=\"15000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs></a:gsLst><a:lin ang=\"16200000\" scaled=\"1\"/></a:gradFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"100000\"/><a:shade val=\"100000\"/><a:satMod val=\"130000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:tint val=\"50000\"/><a:shade val=\"100000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs></a:gsLst><a:lin ang=\"16200000\" scaled=\"0\"/></a:gradFill></a:fillStyleLst><a:lnStyleLst><a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"><a:shade val=\"95000\"/><a:satMod val=\"105000\"/></a:schemeClr></a:solidFill><a:prstDash val=\"solid\"/></a:ln><a:ln w=\"25400\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln><a:ln w=\"38100\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln></a:lnStyleLst><a:effectStyleLst><a:effectStyle><a:effectLst><a:outerShdw blurRad=\"40000\" dist=\"20000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"38000\"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad=\"40000\" dist=\"23000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad=\"40000\" dist=\"23000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw></a:effectLst><a:scene3d><a:camera prst=\"orthographicFront\"><a:rot lat=\"0\" lon=\"0\" rev=\"0\"/></a:camera><a:lightRig rig=\"threePt\" dir=\"t\"><a:rot lat=\"0\" lon=\"0\" rev=\"1200000\"/></a:lightRig></a:scene3d><a:sp3d><a:bevelT w=\"63500\" h=\"25400\"/></a:sp3d></a:effectStyle></a:effectStyleLst><a:bgFillStyleLst><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"40000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs><a:gs pos=\"40000\"><a:schemeClr val=\"phClr\"><a:tint val=\"45000\"/><a:shade val=\"99000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"20000\"/><a:satMod val=\"255000\"/></a:schemeClr></a:gs></a:gsLst><a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"-80000\" r=\"50000\" b=\"180000\"/></a:path></a:gradFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"80000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"30000\"/><a:satMod val=\"200000\"/></a:schemeClr></a:gs></a:gsLst><a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"50000\" r=\"50000\" b=\"50000\"/></a:path></a:gradFill></a:bgFillStyleLst></a:fmtScheme></a:themeElements><a:objectDefaults><a:spDef><a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx=\"1\"><a:schemeClr val=\"accent1\"/></a:lnRef><a:fillRef idx=\"3\"><a:schemeClr val=\"accent1\"/></a:fillRef><a:effectRef idx=\"2\"><a:schemeClr val=\"accent1\"/></a:effectRef><a:fontRef idx=\"minor\"><a:schemeClr val=\"lt1\"/></a:fontRef></a:style></a:spDef><a:lnDef><a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx=\"2\"><a:schemeClr val=\"accent1\"/></a:lnRef><a:fillRef idx=\"0\"><a:schemeClr val=\"accent1\"/></a:fillRef><a:effectRef idx=\"1\"><a:schemeClr val=\"accent1\"/></a:effectRef><a:fontRef idx=\"minor\"><a:schemeClr val=\"tx1\"/></a:fontRef></a:style></a:lnDef></a:objectDefaults><a:extraClrSchemeLst/></a:theme>'; }\r\nfunction write_theme(opts) {\r\n  if (opts.themeXml) { return opts.themeXml; }\r\n  return '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\n<a:theme xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" name=\"Office Theme\"><a:themeElements><a:clrScheme name=\"Office\"><a:dk1><a:sysClr val=\"windowText\" lastClr=\"000000\"/></a:dk1><a:lt1><a:sysClr val=\"window\" lastClr=\"FFFFFF\"/></a:lt1><a:dk2><a:srgbClr val=\"1F497D\"/></a:dk2><a:lt2><a:srgbClr val=\"EEECE1\"/></a:lt2><a:accent1><a:srgbClr val=\"4F81BD\"/></a:accent1><a:accent2><a:srgbClr val=\"C0504D\"/></a:accent2><a:accent3><a:srgbClr val=\"9BBB59\"/></a:accent3><a:accent4><a:srgbClr val=\"8064A2\"/></a:accent4><a:accent5><a:srgbClr val=\"4BACC6\"/></a:accent5><a:accent6><a:srgbClr val=\"F79646\"/></a:accent6><a:hlink><a:srgbClr val=\"0000FF\"/></a:hlink><a:folHlink><a:srgbClr val=\"800080\"/></a:folHlink></a:clrScheme><a:fontScheme name=\"Office\"><a:majorFont><a:latin typeface=\"Cambria\"/><a:ea typeface=\"\"/><a:cs typeface=\"\"/><a:font script=\"Jpan\" typeface=\"ＭＳ Ｐゴシック\"/><a:font script=\"Hang\" typeface=\"맑은 고딕\"/><a:font script=\"Hans\" typeface=\"宋体\"/><a:font script=\"Hant\" typeface=\"新細明體\"/><a:font script=\"Arab\" typeface=\"Times New Roman\"/><a:font script=\"Hebr\" typeface=\"Times New Roman\"/><a:font script=\"Thai\" typeface=\"Tahoma\"/><a:font script=\"Ethi\" typeface=\"Nyala\"/><a:font script=\"Beng\" typeface=\"Vrinda\"/><a:font script=\"Gujr\" typeface=\"Shruti\"/><a:font script=\"Khmr\" typeface=\"MoolBoran\"/><a:font script=\"Knda\" typeface=\"Tunga\"/><a:font script=\"Guru\" typeface=\"Raavi\"/><a:font script=\"Cans\" typeface=\"Euphemia\"/><a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/><a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/><a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/><a:font script=\"Thaa\" typeface=\"MV Boli\"/><a:font script=\"Deva\" typeface=\"Mangal\"/><a:font script=\"Telu\" typeface=\"Gautami\"/><a:font script=\"Taml\" typeface=\"Latha\"/><a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/><a:font script=\"Orya\" typeface=\"Kalinga\"/><a:font script=\"Mlym\" typeface=\"Kartika\"/><a:font script=\"Laoo\" typeface=\"DokChampa\"/><a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/><a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/><a:font script=\"Viet\" typeface=\"Times New Roman\"/><a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/><a:font script=\"Geor\" typeface=\"Sylfaen\"/></a:majorFont><a:minorFont><a:latin typeface=\"Calibri\"/><a:ea typeface=\"\"/><a:cs typeface=\"\"/><a:font script=\"Jpan\" typeface=\"ＭＳ Ｐゴシック\"/><a:font script=\"Hang\" typeface=\"맑은 고딕\"/><a:font script=\"Hans\" typeface=\"宋体\"/><a:font script=\"Hant\" typeface=\"新細明體\"/><a:font script=\"Arab\" typeface=\"Arial\"/><a:font script=\"Hebr\" typeface=\"Arial\"/><a:font script=\"Thai\" typeface=\"Tahoma\"/><a:font script=\"Ethi\" typeface=\"Nyala\"/><a:font script=\"Beng\" typeface=\"Vrinda\"/><a:font script=\"Gujr\" typeface=\"Shruti\"/><a:font script=\"Khmr\" typeface=\"DaunPenh\"/><a:font script=\"Knda\" typeface=\"Tunga\"/><a:font script=\"Guru\" typeface=\"Raavi\"/><a:font script=\"Cans\" typeface=\"Euphemia\"/><a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/><a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/><a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/><a:font script=\"Thaa\" typeface=\"MV Boli\"/><a:font script=\"Deva\" typeface=\"Mangal\"/><a:font script=\"Telu\" typeface=\"Gautami\"/><a:font script=\"Taml\" typeface=\"Latha\"/><a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/><a:font script=\"Orya\" typeface=\"Kalinga\"/><a:font script=\"Mlym\" typeface=\"Kartika\"/><a:font script=\"Laoo\" typeface=\"DokChampa\"/><a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/><a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/><a:font script=\"Viet\" typeface=\"Arial\"/><a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/><a:font script=\"Geor\" typeface=\"Sylfaen\"/></a:minorFont></a:fontScheme><a:fmtScheme name=\"Office\"><a:fillStyleLst><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"50000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"35000\"><a:schemeClr val=\"phClr\"><a:tint val=\"37000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:tint val=\"15000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs></a:gsLst><a:lin ang=\"16200000\" scaled=\"1\"/></a:gradFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"100000\"/><a:shade val=\"100000\"/><a:satMod val=\"130000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:tint val=\"50000\"/><a:shade val=\"100000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs></a:gsLst><a:lin ang=\"16200000\" scaled=\"0\"/></a:gradFill></a:fillStyleLst><a:lnStyleLst><a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"><a:shade val=\"95000\"/><a:satMod val=\"105000\"/></a:schemeClr></a:solidFill><a:prstDash val=\"solid\"/></a:ln><a:ln w=\"25400\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln><a:ln w=\"38100\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln></a:lnStyleLst><a:effectStyleLst><a:effectStyle><a:effectLst><a:outerShdw blurRad=\"40000\" dist=\"20000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"38000\"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad=\"40000\" dist=\"23000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad=\"40000\" dist=\"23000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw></a:effectLst><a:scene3d><a:camera prst=\"orthographicFront\"><a:rot lat=\"0\" lon=\"0\" rev=\"0\"/></a:camera><a:lightRig rig=\"threePt\" dir=\"t\"><a:rot lat=\"0\" lon=\"0\" rev=\"1200000\"/></a:lightRig></a:scene3d><a:sp3d><a:bevelT w=\"63500\" h=\"25400\"/></a:sp3d></a:effectStyle></a:effectStyleLst><a:bgFillStyleLst><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"40000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs><a:gs pos=\"40000\"><a:schemeClr val=\"phClr\"><a:tint val=\"45000\"/><a:shade val=\"99000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"20000\"/><a:satMod val=\"255000\"/></a:schemeClr></a:gs></a:gsLst><a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"-80000\" r=\"50000\" b=\"180000\"/></a:path></a:gradFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"80000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"30000\"/><a:satMod val=\"200000\"/></a:schemeClr></a:gs></a:gsLst><a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"50000\" r=\"50000\" b=\"50000\"/></a:path></a:gradFill></a:bgFillStyleLst></a:fmtScheme></a:themeElements><a:objectDefaults><a:spDef><a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx=\"1\"><a:schemeClr val=\"accent1\"/></a:lnRef><a:fillRef idx=\"3\"><a:schemeClr val=\"accent1\"/></a:fillRef><a:effectRef idx=\"2\"><a:schemeClr val=\"accent1\"/></a:effectRef><a:fontRef idx=\"minor\"><a:schemeClr val=\"lt1\"/></a:fontRef></a:style></a:spDef><a:lnDef><a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx=\"2\"><a:schemeClr val=\"accent1\"/></a:lnRef><a:fillRef idx=\"0\"><a:schemeClr val=\"accent1\"/></a:fillRef><a:effectRef idx=\"1\"><a:schemeClr val=\"accent1\"/></a:effectRef><a:fontRef idx=\"minor\"><a:schemeClr val=\"tx1\"/></a:fontRef></a:style></a:lnDef></a:objectDefaults><a:extraClrSchemeLst/></a:theme>';\r\n}/* [MS-XLS] 2.4.326 TODO: payload is a zip file */\r\nfunction parse_Theme(blob, length) {\r\n\tvar dwThemeVersion = blob.read_shift(4);\r\n\tif(dwThemeVersion === 124226) return;\r\n\tblob.l += length-4;\r\n}\r\n\r\n/* 2.5.49 */\r\nfunction parse_ColorTheme(blob, length) { return blob.read_shift(4); }\r\n\r\n/* 2.5.155 */\r\nfunction parse_FullColorExt(blob, length) {\r\n\tvar o = {};\r\n\to.xclrType = blob.read_shift(2);\r\n\to.nTintShade = blob.read_shift(2);\r\n\tswitch(o.xclrType) {\r\n\t\tcase 0: blob.l += 4; break;\r\n\t\tcase 1: o.xclrValue = parse_IcvXF(blob, 4); break;\r\n\t\tcase 2: o.xclrValue = parse_LongRGBA(blob, 4); break;\r\n\t\tcase 3: o.xclrValue = parse_ColorTheme(blob, 4); break;\r\n\t\tcase 4: blob.l += 4; break;\r\n\t}\r\n\tblob.l += 8;\r\n\treturn o;\r\n}\r\n\r\n/* 2.5.164 TODO: read 7 bits*/\r\nfunction parse_IcvXF(blob, length) {\r\n\treturn parsenoop(blob, length);\r\n}\r\n\r\n/* 2.5.280 */\r\nfunction parse_XFExtGradient(blob, length) {\r\n\treturn parsenoop(blob, length);\r\n}\r\n\r\n/* 2.5.108 */\r\nfunction parse_ExtProp(blob, length) {\r\n\tvar extType = blob.read_shift(2);\r\n\tvar cb = blob.read_shift(2);\r\n\tvar o = [extType];\r\n\tswitch(extType) {\r\n\t\tcase 0x04: case 0x05: case 0x07: case 0x08:\r\n\t\tcase 0x09: case 0x0A: case 0x0B: case 0x0D:\r\n\t\t\to[1] = parse_FullColorExt(blob, cb); break;\r\n\t\tcase 0x06: o[1] = parse_XFExtGradient(blob, cb); break;\r\n\t\tcase 0x0E: case 0x0F: o[1] = blob.read_shift(cb === 5 ? 1 : 2); break;\r\n\t\tdefault: throw new Error(\"Unrecognized ExtProp type: \" + extType + \" \" + cb);\r\n\t}\r\n\treturn o;\r\n}\r\n\r\n/* 2.4.355 */\r\nfunction parse_XFExt(blob, length) {\r\n\tvar end = blob.l + length;\r\n\tblob.l += 2;\r\n\tvar ixfe = blob.read_shift(2);\r\n\tblob.l += 2;\r\n\tvar cexts = blob.read_shift(2);\r\n\tvar ext = [];\r\n\twhile(cexts-- > 0) ext.push(parse_ExtProp(blob, end-blob.l));\r\n\treturn {ixfe:ixfe, ext:ext};\r\n}\r\n\r\n/* xf is an XF, see parse_XFExt for xfext */\r\nfunction update_xfext(xf, xfext) {\r\n\txfext.forEach(function(xfe) {\r\n\t\tswitch(xfe[0]) { /* 2.5.108 extPropData */\r\n\t\t\tcase 0x04: break; /* foreground color */\r\n\t\t\tcase 0x05: break; /* background color */\r\n\t\t\tcase 0x07: case 0x08: case 0x09: case 0x0a: break;\r\n\t\t\tcase 0x0d: break; /* text color */\r\n\t\t\tcase 0x0e: break; /* font scheme */\r\n\t\t\tdefault: throw \"bafuq\" + xfe[0].toString(16);\r\n\t\t}\r\n\t});\r\n}\r\n\r\n/* 18.6 Calculation Chain */\r\nfunction parse_cc_xml(data, opts) {\r\n\tvar d = [];\r\n\tvar l = 0, i = 1;\r\n\t(data.match(tagregex)||[]).forEach(function(x) {\r\n\t\tvar y = parsexmltag(x);\r\n\t\tswitch(y[0]) {\r\n\t\t\tcase '<?xml': break;\r\n\t\t\t/* 18.6.2  calcChain CT_CalcChain 1 */\r\n\t\t\tcase '<calcChain': case '<calcChain>': case '</calcChain>': break;\r\n\t\t\t/* 18.6.1  c CT_CalcCell 1 */\r\n\t\t\tcase '<c': delete y[0]; if(y.i) i = y.i; else y.i = i; d.push(y); break;\r\n\t\t}\r\n\t});\r\n\treturn d;\r\n}\r\n\r\nfunction write_cc_xml(data, opts) { }\r\n/* [MS-XLSB] 2.6.4.1 */\r\nfunction parse_BrtCalcChainItem$(data, length) {\r\n\tvar out = {};\r\n\tout.i = data.read_shift(4);\r\n\tvar cell = {};\r\n\tcell.r = data.read_shift(4);\r\n\tcell.c = data.read_shift(4);\r\n\tout.r = encode_cell(cell);\r\n\tvar flags = data.read_shift(1);\r\n\tif(flags & 0x2) out.l = '1';\r\n\tif(flags & 0x8) out.a = '1';\r\n\treturn out;\r\n}\r\n\r\n/* 18.6 Calculation Chain */\r\nfunction parse_cc_bin(data, opts) {\r\n\tvar out = [];\r\n\tvar pass = false;\r\n\trecordhopper(data, function hopper_cc(val, R, RT) {\r\n\t\tswitch(R.n) {\r\n\t\t\tcase 'BrtCalcChainItem$': out.push(val); break;\r\n\t\t\tcase 'BrtBeginCalcChain$': break;\r\n\t\t\tcase 'BrtEndCalcChain$': break;\r\n\t\t\tdefault: if(!pass || opts.WTF) throw new Error(\"Unexpected record \" + RT + \" \" + R.n);\r\n\t\t}\r\n\t});\r\n\treturn out;\r\n}\r\n\r\nfunction write_cc_bin(data, opts) { }\r\n\r\nfunction parse_comments(zip, dirComments, sheets, sheetRels, opts) {\r\n\tfor(var i = 0; i != dirComments.length; ++i) {\r\n\t\tvar canonicalpath=dirComments[i];\r\n\t\tvar comments=parse_cmnt(getzipdata(zip, canonicalpath.replace(/^\\//,''), true), canonicalpath, opts);\r\n\t\tif(!comments || !comments.length) continue;\r\n\t\t// find the sheets targeted by these comments\r\n\t\tvar sheetNames = keys(sheets);\r\n\t\tfor(var j = 0; j != sheetNames.length; ++j) {\r\n\t\t\tvar sheetName = sheetNames[j];\r\n\t\t\tvar rels = sheetRels[sheetName];\r\n\t\t\tif(rels) {\r\n\t\t\t\tvar rel = rels[canonicalpath];\r\n\t\t\t\tif(rel) insertCommentsIntoSheet(sheetName, sheets[sheetName], comments);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction insertCommentsIntoSheet(sheetName, sheet, comments) {\r\n\tcomments.forEach(function(comment) {\r\n\t\tvar cell = sheet[comment.ref];\r\n\t\tif (!cell) {\r\n\t\t\tcell = {};\r\n\t\t\tsheet[comment.ref] = cell;\r\n\t\t\tvar range = safe_decode_range(sheet[\"!ref\"]||\"BDWGO1000001:A1\");\r\n\t\t\tvar thisCell = decode_cell(comment.ref);\r\n\t\t\tif(range.s.r > thisCell.r) range.s.r = thisCell.r;\r\n\t\t\tif(range.e.r < thisCell.r) range.e.r = thisCell.r;\r\n\t\t\tif(range.s.c > thisCell.c) range.s.c = thisCell.c;\r\n\t\t\tif(range.e.c < thisCell.c) range.e.c = thisCell.c;\r\n\t\t\tvar encoded = encode_range(range);\r\n\t\t\tif (encoded !== sheet[\"!ref\"]) sheet[\"!ref\"] = encoded;\r\n\t\t}\r\n\r\n\t\tif (!cell.c) cell.c = [];\r\n\t\tvar o = {a: comment.author, t: comment.t, r: comment.r};\r\n\t\tif(comment.h) o.h = comment.h;\r\n\t\tcell.c.push(o);\r\n\t});\r\n}\r\n\r\n/* 18.7.3 CT_Comment */\r\nfunction parse_comments_xml(data, opts) {\r\n\tif(data.match(/<(?:\\w+:)?comments *\\/>/)) return [];\r\n\tvar authors = [];\r\n\tvar commentList = [];\r\n\tdata.match(/<(?:\\w+:)?authors>([^\\u2603]*)<\\/(?:\\w+:)?authors>/)[1].split(/<\\/\\w*:?author>/).forEach(function(x) {\r\n\t\tif(x === \"\" || x.trim() === \"\") return;\r\n\t\tauthors.push(x.match(/<(?:\\w+:)?author[^>]*>(.*)/)[1]);\r\n\t});\r\n\t(data.match(/<(?:\\w+:)?commentList>([^\\u2603]*)<\\/(?:\\w+:)?commentList>/)||[\"\",\"\"])[1].split(/<\\/\\w*:?comment>/).forEach(function(x, index) {\r\n\t\tif(x === \"\" || x.trim() === \"\") return;\r\n\t\tvar y = parsexmltag(x.match(/<(?:\\w+:)?comment[^>]*>/)[0]);\r\n\t\tvar comment = { author: y.authorId && authors[y.authorId] ? authors[y.authorId] : undefined, ref: y.ref, guid: y.guid };\r\n\t\tvar cell = decode_cell(y.ref);\r\n\t\tif(opts.sheetRows && opts.sheetRows <= cell.r) return;\r\n\t\tvar textMatch = x.match(/<text>([^\\u2603]*)<\\/text>/);\r\n\t\tif (!textMatch || !textMatch[1]) return; // a comment may contain an empty text tag.\r\n\t\tvar rt = parse_si(textMatch[1]);\r\n\t\tcomment.r = rt.r;\r\n\t\tcomment.t = rt.t;\r\n\t\tif(opts.cellHTML) comment.h = rt.h;\r\n\t\tcommentList.push(comment);\r\n\t});\r\n\treturn commentList;\r\n}\r\n\r\nfunction write_comments_xml(data, opts) { }\r\n/* [MS-XLSB] 2.4.28 BrtBeginComment */\r\nfunction parse_BrtBeginComment(data, length) {\r\n\tvar out = {};\r\n\tout.iauthor = data.read_shift(4);\r\n\tvar rfx = parse_UncheckedRfX(data, 16);\r\n\tout.rfx = rfx.s;\r\n\tout.ref = encode_cell(rfx.s);\r\n\tdata.l += 16; /*var guid = parse_GUID(data); */\r\n\treturn out;\r\n}\r\n\r\n/* [MS-XLSB] 2.4.324 BrtCommentAuthor */\r\nvar parse_BrtCommentAuthor = parse_XLWideString;\r\n\r\n/* [MS-XLSB] 2.4.325 BrtCommentText */\r\nvar parse_BrtCommentText = parse_RichStr;\r\n\r\n/* [MS-XLSB] 2.1.7.8 Comments */\r\nfunction parse_comments_bin(data, opts) {\r\n\tvar out = [];\r\n\tvar authors = [];\r\n\tvar c = {};\r\n\tvar pass = false;\r\n\trecordhopper(data, function hopper_cmnt(val, R, RT) {\r\n\t\tswitch(R.n) {\r\n\t\t\tcase 'BrtCommentAuthor': authors.push(val); break;\r\n\t\t\tcase 'BrtBeginComment': c = val; break;\r\n\t\t\tcase 'BrtCommentText': c.t = val.t; c.h = val.h; c.r = val.r; break;\r\n\t\t\tcase 'BrtEndComment':\r\n\t\t\t\tc.author = authors[c.iauthor];\r\n\t\t\t\tdelete c.iauthor;\r\n\t\t\t\tif(opts.sheetRows && opts.sheetRows <= c.rfx.r) break;\r\n\t\t\t\tdelete c.rfx; out.push(c); break;\r\n\t\t\tcase 'BrtBeginComments': break;\r\n\t\t\tcase 'BrtEndComments': break;\r\n\t\t\tcase 'BrtBeginCommentAuthors': break;\r\n\t\t\tcase 'BrtEndCommentAuthors': break;\r\n\t\t\tcase 'BrtBeginCommentList': break;\r\n\t\t\tcase 'BrtEndCommentList': break;\r\n\t\t\tdefault: if(!pass || opts.WTF) throw new Error(\"Unexpected record \" + RT + \" \" + R.n);\r\n\t\t}\r\n\t});\r\n\treturn out;\r\n}\r\n\r\nfunction write_comments_bin(data, opts) { }\r\n/* TODO: it will be useful to parse the function str */\r\nvar rc_to_a1 = (function(){\r\n\tvar rcregex = /(^|[^A-Za-z])R(\\[?)(-?\\d+|)\\]?C(\\[?)(-?\\d+|)\\]?/g;\r\n\tvar rcbase;\r\n\tfunction rcfunc($$,$1,$2,$3,$4,$5) {\r\n\t\tvar R = $3.length>0?parseInt($3,10)|0:0, C = $5.length>0?parseInt($5,10)|0:0;\r\n\t\tif(C<0 && $4.length === 0) C=0;\r\n\t\tif($4.length > 0) C += rcbase.c;\r\n\t\tif($2.length > 0) R += rcbase.r;\r\n\t\treturn $1 + encode_col(C) + encode_row(R);\r\n\t}\r\n\treturn function rc_to_a1(fstr, base) {\r\n\t\trcbase = base;\r\n\t\treturn fstr.replace(rcregex, rcfunc);\r\n\t};\r\n})();\r\n\r\n/* --- formula references point to MS-XLS --- */\r\n/* Small helpers */\r\nfunction parseread(l) { return function(blob, length) { blob.l+=l; return; }; }\r\nfunction parseread1(blob, length) { blob.l+=1; return; }\r\n\r\n/* Rgce Helpers */\r\n\r\n/* 2.5.51 */\r\nfunction parse_ColRelU(blob, length) {\r\n\tvar c = blob.read_shift(2);\r\n\treturn [c & 0x3FFF, (c >> 14) & 1, (c >> 15) & 1];\r\n}\r\n\r\n/* 2.5.198.105 */\r\nfunction parse_RgceArea(blob, length) {\r\n\tvar r=blob.read_shift(2), R=blob.read_shift(2);\r\n\tvar c=parse_ColRelU(blob, 2);\r\n\tvar C=parse_ColRelU(blob, 2);\r\n\treturn { s:{r:r, c:c[0], cRel:c[1], rRel:c[2]}, e:{r:R, c:C[0], cRel:C[1], rRel:C[2]} };\r\n}\r\n\r\n/* 2.5.198.105 TODO */\r\nfunction parse_RgceAreaRel(blob, length) {\r\n\tvar r=blob.read_shift(2), R=blob.read_shift(2);\r\n\tvar c=parse_ColRelU(blob, 2);\r\n\tvar C=parse_ColRelU(blob, 2);\r\n\treturn { s:{r:r, c:c[0], cRel:c[1], rRel:c[2]}, e:{r:R, c:C[0], cRel:C[1], rRel:C[2]} };\r\n}\r\n\r\n/* 2.5.198.109 */\r\nfunction parse_RgceLoc(blob, length) {\r\n\tvar r = blob.read_shift(2);\r\n\tvar c = parse_ColRelU(blob, 2);\r\n\treturn {r:r, c:c[0], cRel:c[1], rRel:c[2]};\r\n}\r\n\r\n/* 2.5.198.111 */\r\nfunction parse_RgceLocRel(blob, length) {\r\n\tvar r = blob.read_shift(2);\r\n\tvar cl = blob.read_shift(2);\r\n\tvar cRel = (cl & 0x8000) >> 15, rRel = (cl & 0x4000) >> 14;\r\n\tcl &= 0x3FFF;\r\n\tif(cRel !== 0) while(cl >= 0x100) cl -= 0x100;\r\n\treturn {r:r,c:cl,cRel:cRel,rRel:rRel};\r\n}\r\n\r\n/* Ptg Tokens */\r\n\r\n/* 2.5.198.27 */\r\nfunction parse_PtgArea(blob, length) {\r\n\tvar type = (blob[blob.l++] & 0x60) >> 5;\r\n\tvar area = parse_RgceArea(blob, 8);\r\n\treturn [type, area];\r\n}\r\n\r\n/* 2.5.198.28 */\r\nfunction parse_PtgArea3d(blob, length) {\r\n\tvar type = (blob[blob.l++] & 0x60) >> 5;\r\n\tvar ixti = blob.read_shift(2);\r\n\tvar area = parse_RgceArea(blob, 8);\r\n\treturn [type, ixti, area];\r\n}\r\n\r\n/* 2.5.198.29 */\r\nfunction parse_PtgAreaErr(blob, length) {\r\n\tvar type = (blob[blob.l++] & 0x60) >> 5;\r\n\tblob.l += 8;\r\n\treturn [type];\r\n}\r\n/* 2.5.198.30 */\r\nfunction parse_PtgAreaErr3d(blob, length) {\r\n\tvar type = (blob[blob.l++] & 0x60) >> 5;\r\n\tvar ixti = blob.read_shift(2);\r\n\tblob.l += 8;\r\n\treturn [type, ixti];\r\n}\r\n\r\n/* 2.5.198.31 */\r\nfunction parse_PtgAreaN(blob, length) {\r\n\tvar type = (blob[blob.l++] & 0x60) >> 5;\r\n\tvar area = parse_RgceAreaRel(blob, 8);\r\n\treturn [type, area];\r\n}\r\n\r\n/* 2.5.198.32 -- ignore this and look in PtgExtraArray for shape + values */\r\nfunction parse_PtgArray(blob, length) {\r\n\tvar type = (blob[blob.l++] & 0x60) >> 5;\r\n\tblob.l += 7;\r\n\treturn [type];\r\n}\r\n\r\n/* 2.5.198.33 */\r\nfunction parse_PtgAttrBaxcel(blob, length) {\r\n\tvar bitSemi = blob[blob.l+1] & 0x01; /* 1 = volatile */\r\n\tvar bitBaxcel = 1;\r\n\tblob.l += 4;\r\n\treturn [bitSemi, bitBaxcel];\r\n}\r\n\r\n/* 2.5.198.34 */\r\nfunction parse_PtgAttrChoose(blob, length) {\r\n\tblob.l +=2;\r\n\tvar offset = blob.read_shift(2);\r\n\tvar o = [];\r\n\t/* offset is 1 less than the number of elements */\r\n\tfor(var i = 0; i <= offset; ++i) o.push(blob.read_shift(2));\r\n\treturn o;\r\n}\r\n\r\n/* 2.5.198.35 */\r\nfunction parse_PtgAttrGoto(blob, length) {\r\n\tvar bitGoto = (blob[blob.l+1] & 0xFF) ? 1 : 0;\r\n\tblob.l += 2;\r\n\treturn [bitGoto, blob.read_shift(2)];\r\n}\r\n\r\n/* 2.5.198.36 */\r\nfunction parse_PtgAttrIf(blob, length) {\r\n\tvar bitIf = (blob[blob.l+1] & 0xFF) ? 1 : 0;\r\n\tblob.l += 2;\r\n\treturn [bitIf, blob.read_shift(2)];\r\n}\r\n\r\n/* 2.5.198.37 */\r\nfunction parse_PtgAttrSemi(blob, length) {\r\n\tvar bitSemi = (blob[blob.l+1] & 0xFF) ? 1 : 0;\r\n\tblob.l += 4;\r\n\treturn [bitSemi];\r\n}\r\n\r\n/* 2.5.198.40 (used by PtgAttrSpace and PtgAttrSpaceSemi) */\r\nfunction parse_PtgAttrSpaceType(blob, length) {\r\n\tvar type = blob.read_shift(1), cch = blob.read_shift(1);\r\n\treturn [type, cch];\r\n}\r\n\r\n/* 2.5.198.38 */\r\nfunction parse_PtgAttrSpace(blob, length) {\r\n\tblob.read_shift(2);\r\n\treturn parse_PtgAttrSpaceType(blob, 2);\r\n}\r\n\r\n/* 2.5.198.39 */\r\nfunction parse_PtgAttrSpaceSemi(blob, length) {\r\n\tblob.read_shift(2);\r\n\treturn parse_PtgAttrSpaceType(blob, 2);\r\n}\r\n\r\n/* 2.5.198.84 TODO */\r\nfunction parse_PtgRef(blob, length) {\r\n\tvar ptg = blob[blob.l] & 0x1F;\r\n\tvar type = (blob[blob.l] & 0x60)>>5;\r\n\tblob.l += 1;\r\n\tvar loc = parse_RgceLoc(blob,4);\r\n\treturn [type, loc];\r\n}\r\n\r\n/* 2.5.198.88 TODO */\r\nfunction parse_PtgRefN(blob, length) {\r\n\tvar ptg = blob[blob.l] & 0x1F;\r\n\tvar type = (blob[blob.l] & 0x60)>>5;\r\n\tblob.l += 1;\r\n\tvar loc = parse_RgceLocRel(blob,4);\r\n\treturn [type, loc];\r\n}\r\n\r\n/* 2.5.198.85 TODO */\r\nfunction parse_PtgRef3d(blob, length) {\r\n\tvar ptg = blob[blob.l] & 0x1F;\r\n\tvar type = (blob[blob.l] & 0x60)>>5;\r\n\tblob.l += 1;\r\n\tvar ixti = blob.read_shift(2); // XtiIndex\r\n\tvar loc = parse_RgceLoc(blob,4);\r\n\treturn [type, ixti, loc];\r\n}\r\n\r\n\r\n/* 2.5.198.62 TODO */\r\nfunction parse_PtgFunc(blob, length) {\r\n\tvar ptg = blob[blob.l] & 0x1F;\r\n\tvar type = (blob[blob.l] & 0x60)>>5;\r\n\tblob.l += 1;\r\n\tvar iftab = blob.read_shift(2);\r\n\treturn [FtabArgc[iftab], Ftab[iftab]];\r\n}\r\n/* 2.5.198.63 TODO */\r\nfunction parse_PtgFuncVar(blob, length) {\r\n\tblob.l++;\r\n\tvar cparams = blob.read_shift(1), tab = parsetab(blob);\r\n\treturn [cparams, (tab[0] === 0 ? Ftab : Cetab)[tab[1]]];\r\n}\r\n\r\nfunction parsetab(blob, length) {\r\n\treturn [blob[blob.l+1]>>7, blob.read_shift(2) & 0x7FFF];\r\n}\r\n\r\n/* 2.5.198.41 */\r\nvar parse_PtgAttrSum = parseread(4);\r\n/* 2.5.198.43 */\r\nvar parse_PtgConcat = parseread1;\r\n\r\n/* 2.5.198.58 */\r\nfunction parse_PtgExp(blob, length) {\r\n\tblob.l++;\r\n\tvar row = blob.read_shift(2);\r\n\tvar col = blob.read_shift(2);\r\n\treturn [row, col];\r\n}\r\n\r\n/* 2.5.198.57 */\r\nfunction parse_PtgErr(blob, length) { blob.l++; return BErr[blob.read_shift(1)]; }\r\n\r\n/* 2.5.198.66 TODO */\r\nfunction parse_PtgInt(blob, length) { blob.l++; return blob.read_shift(2); }\r\n\r\n/* 2.5.198.42 */\r\nfunction parse_PtgBool(blob, length) { blob.l++; return blob.read_shift(1)!==0;}\r\n\r\n/* 2.5.198.79 */\r\nfunction parse_PtgNum(blob, length) { blob.l++; return parse_Xnum(blob, 8); }\r\n\r\n/* 2.5.198.89 */\r\nfunction parse_PtgStr(blob, length) { blob.l++; return parse_ShortXLUnicodeString(blob); }\r\n\r\n/* 2.5.192.112 + 2.5.192.11{3,4,5,6,7} */\r\nfunction parse_SerAr(blob) {\r\n\tvar val = [];\r\n\tswitch((val[0] = blob.read_shift(1))) {\r\n\t\t/* 2.5.192.113 */\r\n\t\tcase 0x04: /* SerBool -- boolean */\r\n\t\t\tval[1] = parsebool(blob, 1) ? 'TRUE' : 'FALSE';\r\n\t\t\tblob.l += 7; break;\r\n\t\t/* 2.5.192.114 */\r\n\t\tcase 0x10: /* SerErr -- error */\r\n\t\t\tval[1] = BErr[blob[blob.l]];\r\n\t\t\tblob.l += 8; break;\r\n\t\t/* 2.5.192.115 */\r\n\t\tcase 0x00: /* SerNil -- honestly, I'm not sure how to reproduce this */\r\n\t\t\tblob.l += 8; break;\r\n\t\t/* 2.5.192.116 */\r\n\t\tcase 0x01: /* SerNum -- Xnum */\r\n\t\t\tval[1] = parse_Xnum(blob, 8); break;\r\n\t\t/* 2.5.192.117 */\r\n\t\tcase 0x02: /* SerStr -- XLUnicodeString (<256 chars) */\r\n\t\t\tval[1] = parse_XLUnicodeString(blob); break;\r\n\t\t// default: throw \"Bad SerAr: \" + val[0]; /* Unreachable */\r\n\t}\r\n\treturn val;\r\n}\r\n\r\n/* 2.5.198.61 */\r\nfunction parse_PtgExtraMem(blob, cce) {\r\n\tvar count = blob.read_shift(2);\r\n\tvar out = [];\r\n\tfor(var i = 0; i != count; ++i) out.push(parse_Ref8U(blob, 8));\r\n\treturn out;\r\n}\r\n\r\n/* 2.5.198.59 */\r\nfunction parse_PtgExtraArray(blob) {\r\n\tvar cols = 1 + blob.read_shift(1); //DColByteU\r\n\tvar rows = 1 + blob.read_shift(2); //DRw\r\n\tfor(var i = 0, o=[]; i != rows && (o[i] = []); ++i)\r\n\t\tfor(var j = 0; j != cols; ++j) o[i][j] = parse_SerAr(blob);\r\n\treturn o;\r\n}\r\n\r\n/* 2.5.198.76 */\r\nfunction parse_PtgName(blob, length) {\r\n\tvar type = (blob.read_shift(1) >>> 5) & 0x03;\r\n\tvar nameindex = blob.read_shift(4);\r\n\treturn [type, 0, nameindex];\r\n}\r\n\r\n/* 2.5.198.77 */\r\nfunction parse_PtgNameX(blob, length) {\r\n\tvar type = (blob.read_shift(1) >>> 5) & 0x03;\r\n\tvar ixti = blob.read_shift(2); // XtiIndex\r\n\tvar nameindex = blob.read_shift(4);\r\n\treturn [type, ixti, nameindex];\r\n}\r\n\r\n/* 2.5.198.70 */\r\nfunction parse_PtgMemArea(blob, length) {\r\n\tvar type = (blob.read_shift(1) >>> 5) & 0x03;\r\n\tblob.l += 4;\r\n\tvar cce = blob.read_shift(2);\r\n\treturn [type, cce];\r\n}\r\n\r\n/* 2.5.198.72 */\r\nfunction parse_PtgMemFunc(blob, length) {\r\n\tvar type = (blob.read_shift(1) >>> 5) & 0x03;\r\n\tvar cce = blob.read_shift(2);\r\n\treturn [type, cce];\r\n}\r\n\r\n\r\n/* 2.5.198.86 */\r\nfunction parse_PtgRefErr(blob, length) {\r\n\tvar type = (blob.read_shift(1) >>> 5) & 0x03;\r\n\tblob.l += 4;\r\n\treturn [type];\r\n}\r\n\r\n/* 2.5.198.26 */\r\nvar parse_PtgAdd = parseread1;\r\n/* 2.5.198.45 */\r\nvar parse_PtgDiv = parseread1;\r\n/* 2.5.198.56 */\r\nvar parse_PtgEq = parseread1;\r\n/* 2.5.198.64 */\r\nvar parse_PtgGe = parseread1;\r\n/* 2.5.198.65 */\r\nvar parse_PtgGt = parseread1;\r\n/* 2.5.198.67 */\r\nvar parse_PtgIsect = parseread1;\r\n/* 2.5.198.68 */\r\nvar parse_PtgLe = parseread1;\r\n/* 2.5.198.69 */\r\nvar parse_PtgLt = parseread1;\r\n/* 2.5.198.74 */\r\nvar parse_PtgMissArg = parseread1;\r\n/* 2.5.198.75 */\r\nvar parse_PtgMul = parseread1;\r\n/* 2.5.198.78 */\r\nvar parse_PtgNe = parseread1;\r\n/* 2.5.198.80 */\r\nvar parse_PtgParen = parseread1;\r\n/* 2.5.198.81 */\r\nvar parse_PtgPercent = parseread1;\r\n/* 2.5.198.82 */\r\nvar parse_PtgPower = parseread1;\r\n/* 2.5.198.83 */\r\nvar parse_PtgRange = parseread1;\r\n/* 2.5.198.90 */\r\nvar parse_PtgSub = parseread1;\r\n/* 2.5.198.93 */\r\nvar parse_PtgUminus = parseread1;\r\n/* 2.5.198.94 */\r\nvar parse_PtgUnion = parseread1;\r\n/* 2.5.198.95 */\r\nvar parse_PtgUplus = parseread1;\r\n\r\n/* 2.5.198.71 */\r\nvar parse_PtgMemErr = parsenoop;\r\n/* 2.5.198.73 */\r\nvar parse_PtgMemNoMem = parsenoop;\r\n/* 2.5.198.87 */\r\nvar parse_PtgRefErr3d = parsenoop;\r\n/* 2.5.198.92 */\r\nvar parse_PtgTbl = parsenoop;\r\n\r\n/* 2.5.198.25 */\r\nvar PtgTypes = {\r\n\t0x01: { n:'PtgExp', f:parse_PtgExp },\r\n\t0x02: { n:'PtgTbl', f:parse_PtgTbl },\r\n\t0x03: { n:'PtgAdd', f:parse_PtgAdd },\r\n\t0x04: { n:'PtgSub', f:parse_PtgSub },\r\n\t0x05: { n:'PtgMul', f:parse_PtgMul },\r\n\t0x06: { n:'PtgDiv', f:parse_PtgDiv },\r\n\t0x07: { n:'PtgPower', f:parse_PtgPower },\r\n\t0x08: { n:'PtgConcat', f:parse_PtgConcat },\r\n\t0x09: { n:'PtgLt', f:parse_PtgLt },\r\n\t0x0A: { n:'PtgLe', f:parse_PtgLe },\r\n\t0x0B: { n:'PtgEq', f:parse_PtgEq },\r\n\t0x0C: { n:'PtgGe', f:parse_PtgGe },\r\n\t0x0D: { n:'PtgGt', f:parse_PtgGt },\r\n\t0x0E: { n:'PtgNe', f:parse_PtgNe },\r\n\t0x0F: { n:'PtgIsect', f:parse_PtgIsect },\r\n\t0x10: { n:'PtgUnion', f:parse_PtgUnion },\r\n\t0x11: { n:'PtgRange', f:parse_PtgRange },\r\n\t0x12: { n:'PtgUplus', f:parse_PtgUplus },\r\n\t0x13: { n:'PtgUminus', f:parse_PtgUminus },\r\n\t0x14: { n:'PtgPercent', f:parse_PtgPercent },\r\n\t0x15: { n:'PtgParen', f:parse_PtgParen },\r\n\t0x16: { n:'PtgMissArg', f:parse_PtgMissArg },\r\n\t0x17: { n:'PtgStr', f:parse_PtgStr },\r\n\t0x1C: { n:'PtgErr', f:parse_PtgErr },\r\n\t0x1D: { n:'PtgBool', f:parse_PtgBool },\r\n\t0x1E: { n:'PtgInt', f:parse_PtgInt },\r\n\t0x1F: { n:'PtgNum', f:parse_PtgNum },\r\n\t0x20: { n:'PtgArray', f:parse_PtgArray },\r\n\t0x21: { n:'PtgFunc', f:parse_PtgFunc },\r\n\t0x22: { n:'PtgFuncVar', f:parse_PtgFuncVar },\r\n\t0x23: { n:'PtgName', f:parse_PtgName },\r\n\t0x24: { n:'PtgRef', f:parse_PtgRef },\r\n\t0x25: { n:'PtgArea', f:parse_PtgArea },\r\n\t0x26: { n:'PtgMemArea', f:parse_PtgMemArea },\r\n\t0x27: { n:'PtgMemErr', f:parse_PtgMemErr },\r\n\t0x28: { n:'PtgMemNoMem', f:parse_PtgMemNoMem },\r\n\t0x29: { n:'PtgMemFunc', f:parse_PtgMemFunc },\r\n\t0x2A: { n:'PtgRefErr', f:parse_PtgRefErr },\r\n\t0x2B: { n:'PtgAreaErr', f:parse_PtgAreaErr },\r\n\t0x2C: { n:'PtgRefN', f:parse_PtgRefN },\r\n\t0x2D: { n:'PtgAreaN', f:parse_PtgAreaN },\r\n\t0x39: { n:'PtgNameX', f:parse_PtgNameX },\r\n\t0x3A: { n:'PtgRef3d', f:parse_PtgRef3d },\r\n\t0x3B: { n:'PtgArea3d', f:parse_PtgArea3d },\r\n\t0x3C: { n:'PtgRefErr3d', f:parse_PtgRefErr3d },\r\n\t0x3D: { n:'PtgAreaErr3d', f:parse_PtgAreaErr3d },\r\n\t0xFF: {}\r\n};\r\n/* These are duplicated in the PtgTypes table */\r\nvar PtgDupes = {\r\n\t0x40: 0x20, 0x60: 0x20,\r\n\t0x41: 0x21, 0x61: 0x21,\r\n\t0x42: 0x22, 0x62: 0x22,\r\n\t0x43: 0x23, 0x63: 0x23,\r\n\t0x44: 0x24, 0x64: 0x24,\r\n\t0x45: 0x25, 0x65: 0x25,\r\n\t0x46: 0x26, 0x66: 0x26,\r\n\t0x47: 0x27, 0x67: 0x27,\r\n\t0x48: 0x28, 0x68: 0x28,\r\n\t0x49: 0x29, 0x69: 0x29,\r\n\t0x4A: 0x2A, 0x6A: 0x2A,\r\n\t0x4B: 0x2B, 0x6B: 0x2B,\r\n\t0x4C: 0x2C, 0x6C: 0x2C,\r\n\t0x4D: 0x2D, 0x6D: 0x2D,\r\n\t0x59: 0x39, 0x79: 0x39,\r\n\t0x5A: 0x3A, 0x7A: 0x3A,\r\n\t0x5B: 0x3B, 0x7B: 0x3B,\r\n\t0x5C: 0x3C, 0x7C: 0x3C,\r\n\t0x5D: 0x3D, 0x7D: 0x3D\r\n};\r\n(function(){for(var y in PtgDupes) PtgTypes[y] = PtgTypes[PtgDupes[y]];})();\r\n\r\nvar Ptg18 = {};\r\nvar Ptg19 = {\r\n\t0x01: { n:'PtgAttrSemi', f:parse_PtgAttrSemi },\r\n\t0x02: { n:'PtgAttrIf', f:parse_PtgAttrIf },\r\n\t0x04: { n:'PtgAttrChoose', f:parse_PtgAttrChoose },\r\n\t0x08: { n:'PtgAttrGoto', f:parse_PtgAttrGoto },\r\n\t0x10: { n:'PtgAttrSum', f:parse_PtgAttrSum },\r\n\t0x20: { n:'PtgAttrBaxcel', f:parse_PtgAttrBaxcel },\r\n\t0x40: { n:'PtgAttrSpace', f:parse_PtgAttrSpace },\r\n\t0x41: { n:'PtgAttrSpaceSemi', f:parse_PtgAttrSpaceSemi },\r\n\t0xFF: {}\r\n};\r\n\r\n/* 2.4.127 TODO */\r\nfunction parse_Formula(blob, length, opts) {\r\n\tvar cell = parse_XLSCell(blob, 6);\r\n\tvar val = parse_FormulaValue(blob,8);\r\n\tvar flags = blob.read_shift(1);\r\n\tblob.read_shift(1);\r\n\tvar chn = blob.read_shift(4);\r\n\tvar cbf = \"\";\r\n\tif(opts.biff === 5) blob.l += length-20;\r\n\telse cbf = parse_XLSCellParsedFormula(blob, length-20, opts);\r\n\treturn {cell:cell, val:val[0], formula:cbf, shared: (flags >> 3) & 1, tt:val[1]};\r\n}\r\n\r\n/* 2.5.133 TODO: how to emit empty strings? */\r\nfunction parse_FormulaValue(blob) {\r\n\tvar b;\r\n\tif(__readUInt16LE(blob,blob.l + 6) !== 0xFFFF) return [parse_Xnum(blob),'n'];\r\n\tswitch(blob[blob.l]) {\r\n\t\tcase 0x00: blob.l += 8; return [\"String\", 's'];\r\n\t\tcase 0x01: b = blob[blob.l+2] === 0x1; blob.l += 8; return [b,'b'];\r\n\t\tcase 0x02: b = blob[blob.l+2]; blob.l += 8; return [b,'e'];\r\n\t\tcase 0x03: blob.l += 8; return [\"\",'s'];\r\n\t}\r\n}\r\n\r\n/* 2.5.198.103 */\r\nfunction parse_RgbExtra(blob, length, rgce, opts) {\r\n\tif(opts.biff < 8) return parsenoop(blob, length);\r\n\tvar target = blob.l + length;\r\n\tvar o = [];\r\n\tfor(var i = 0; i !== rgce.length; ++i) {\r\n\t\tswitch(rgce[i][0]) {\r\n\t\t\tcase 'PtgArray': /* PtgArray -> PtgExtraArray */\r\n\t\t\t\trgce[i][1] = parse_PtgExtraArray(blob);\r\n\t\t\t\to.push(rgce[i][1]);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'PtgMemArea': /* PtgMemArea -> PtgExtraMem */\r\n\t\t\t\trgce[i][2] = parse_PtgExtraMem(blob, rgce[i][1]);\r\n\t\t\t\to.push(rgce[i][2]);\r\n\t\t\t\tbreak;\r\n\t\t\tdefault: break;\r\n\t\t}\r\n\t}\r\n\tlength = target - blob.l;\r\n\tif(length !== 0) o.push(parsenoop(blob, length));\r\n\treturn o;\r\n}\r\n\r\n/* 2.5.198.21 */\r\nfunction parse_NameParsedFormula(blob, length, opts, cce) {\r\n\tvar target = blob.l + length;\r\n\tvar rgce = parse_Rgce(blob, cce);\r\n\tvar rgcb;\r\n\tif(target !== blob.l) rgcb = parse_RgbExtra(blob, target - blob.l, rgce, opts);\r\n\treturn [rgce, rgcb];\r\n}\r\n\r\n/* 2.5.198.3 TODO */\r\nfunction parse_XLSCellParsedFormula(blob, length, opts) {\r\n\tvar target = blob.l + length;\r\n\tvar rgcb, cce = blob.read_shift(2); // length of rgce\r\n\tif(cce == 0xFFFF) return [[],parsenoop(blob, length-2)];\r\n\tvar rgce = parse_Rgce(blob, cce);\r\n\tif(length !== cce + 2) rgcb = parse_RgbExtra(blob, length - cce - 2, rgce, opts);\r\n\treturn [rgce, rgcb];\r\n}\r\n\r\n/* 2.5.198.118 TODO */\r\nfunction parse_SharedParsedFormula(blob, length, opts) {\r\n\tvar target = blob.l + length;\r\n\tvar rgcb, cce = blob.read_shift(2); // length of rgce\r\n\tvar rgce = parse_Rgce(blob, cce);\r\n\tif(cce == 0xFFFF) return [[],parsenoop(blob, length-2)];\r\n\tif(length !== cce + 2) rgcb = parse_RgbExtra(blob, target - cce - 2, rgce, opts);\r\n\treturn [rgce, rgcb];\r\n}\r\n\r\n/* 2.5.198.1 TODO */\r\nfunction parse_ArrayParsedFormula(blob, length, opts, ref) {\r\n\tvar target = blob.l + length;\r\n\tvar rgcb, cce = blob.read_shift(2); // length of rgce\r\n\tif(cce == 0xFFFF) return [[],parsenoop(blob, length-2)];\r\n\tvar rgce = parse_Rgce(blob, cce);\r\n\tif(length !== cce + 2) rgcb = parse_RgbExtra(blob, target - cce - 2, rgce, opts);\r\n\treturn [rgce, rgcb];\r\n}\r\n\r\n/* 2.5.198.104 */\r\nfunction parse_Rgce(blob, length) {\r\n\tvar target = blob.l + length;\r\n\tvar R, id, ptgs = [];\r\n\twhile(target != blob.l) {\r\n\t\tlength = target - blob.l;\r\n\t\tid = blob[blob.l];\r\n\t\tR = PtgTypes[id];\r\n\t\t//console.log(\"ptg\", id, R)\r\n\t\tif(id === 0x18 || id === 0x19) {\r\n\t\t\tid = blob[blob.l + 1];\r\n\t\t\tR = (id === 0x18 ? Ptg18 : Ptg19)[id];\r\n\t\t}\r\n\t\tif(!R || !R.f) { ptgs.push(parsenoop(blob, length)); }\r\n\t\telse { ptgs.push([R.n, R.f(blob, length)]); }\r\n\t}\r\n\treturn ptgs;\r\n}\r\n\r\nfunction mapper(x) { return x.map(function f2(y) { return y[1];}).join(\",\");}\r\n\r\n/* 2.2.2 + Magic TODO */\r\nfunction stringify_formula(formula, range, cell, supbooks, opts) {\r\n\tif(opts !== undefined && opts.biff === 5) return \"BIFF5??\";\r\n\tvar _range = range !== undefined ? range : {s:{c:0, r:0}};\r\n\tvar stack = [], e1, e2, type, c, ixti, nameidx, r;\r\n\tif(!formula[0] || !formula[0][0]) return \"\";\r\n\t//console.log(\"--\",cell,formula[0])\r\n\tfor(var ff = 0, fflen = formula[0].length; ff < fflen; ++ff) {\r\n\t\tvar f = formula[0][ff];\r\n\t\t//console.log(\"++\",f, stack)\r\n\t\tswitch(f[0]) {\r\n\t\t/* 2.2.2.1 Unary Operator Tokens */\r\n\t\t\t/* 2.5.198.93 */\r\n\t\t\tcase 'PtgUminus': stack.push(\"-\" + stack.pop()); break;\r\n\t\t\t/* 2.5.198.95 */\r\n\t\t\tcase 'PtgUplus': stack.push(\"+\" + stack.pop()); break;\r\n\t\t\t/* 2.5.198.81 */\r\n\t\t\tcase 'PtgPercent': stack.push(stack.pop() + \"%\"); break;\r\n\r\n\t\t/* 2.2.2.1 Binary Value Operator Token */\r\n\t\t\t/* 2.5.198.26 */\r\n\t\t\tcase 'PtgAdd':\r\n\t\t\t\te1 = stack.pop(); e2 = stack.pop();\r\n\t\t\t\tstack.push(e2+\"+\"+e1);\r\n\t\t\t\tbreak;\r\n\t\t\t/* 2.5.198.90 */\r\n\t\t\tcase 'PtgSub':\r\n\t\t\t\te1 = stack.pop(); e2 = stack.pop();\r\n\t\t\t\tstack.push(e2+\"-\"+e1);\r\n\t\t\t\tbreak;\r\n\t\t\t/* 2.5.198.75 */\r\n\t\t\tcase 'PtgMul':\r\n\t\t\t\te1 = stack.pop(); e2 = stack.pop();\r\n\t\t\t\tstack.push(e2+\"*\"+e1);\r\n\t\t\t\tbreak;\r\n\t\t\t/* 2.5.198.45 */\r\n\t\t\tcase 'PtgDiv':\r\n\t\t\t\te1 = stack.pop(); e2 = stack.pop();\r\n\t\t\t\tstack.push(e2+\"/\"+e1);\r\n\t\t\t\tbreak;\r\n\t\t\t/* 2.5.198.82 */\r\n\t\t\tcase 'PtgPower':\r\n\t\t\t\te1 = stack.pop(); e2 = stack.pop();\r\n\t\t\t\tstack.push(e2+\"^\"+e1);\r\n\t\t\t\tbreak;\r\n\t\t\t/* 2.5.198.43 */\r\n\t\t\tcase 'PtgConcat':\r\n\t\t\t\te1 = stack.pop(); e2 = stack.pop();\r\n\t\t\t\tstack.push(e2+\"&\"+e1);\r\n\t\t\t\tbreak;\r\n\t\t\t/* 2.5.198.69 */\r\n\t\t\tcase 'PtgLt':\r\n\t\t\t\te1 = stack.pop(); e2 = stack.pop();\r\n\t\t\t\tstack.push(e2+\"<\"+e1);\r\n\t\t\t\tbreak;\r\n\t\t\t/* 2.5.198.68 */\r\n\t\t\tcase 'PtgLe':\r\n\t\t\t\te1 = stack.pop(); e2 = stack.pop();\r\n\t\t\t\tstack.push(e2+\"<=\"+e1);\r\n\t\t\t\tbreak;\r\n\t\t\t/* 2.5.198.56 */\r\n\t\t\tcase 'PtgEq':\r\n\t\t\t\te1 = stack.pop(); e2 = stack.pop();\r\n\t\t\t\tstack.push(e2+\"=\"+e1);\r\n\t\t\t\tbreak;\r\n\t\t\t/* 2.5.198.64 */\r\n\t\t\tcase 'PtgGe':\r\n\t\t\t\te1 = stack.pop(); e2 = stack.pop();\r\n\t\t\t\tstack.push(e2+\">=\"+e1);\r\n\t\t\t\tbreak;\r\n\t\t\t/* 2.5.198.65 */\r\n\t\t\tcase 'PtgGt':\r\n\t\t\t\te1 = stack.pop(); e2 = stack.pop();\r\n\t\t\t\tstack.push(e2+\">\"+e1);\r\n\t\t\t\tbreak;\r\n\t\t\t/* 2.5.198.78 */\r\n\t\t\tcase 'PtgNe':\r\n\t\t\t\te1 = stack.pop(); e2 = stack.pop();\r\n\t\t\t\tstack.push(e2+\"<>\"+e1);\r\n\t\t\t\tbreak;\r\n\r\n\t\t/* 2.2.2.1 Binary Reference Operator Token */\r\n\t\t\t/* 2.5.198.67 */\r\n\t\t\tcase 'PtgIsect':\r\n\t\t\t\te1 = stack.pop(); e2 = stack.pop();\r\n\t\t\t\tstack.push(e2+\" \"+e1);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'PtgUnion':\r\n\t\t\t\te1 = stack.pop(); e2 = stack.pop();\r\n\t\t\t\tstack.push(e2+\",\"+e1);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'PtgRange': break;\r\n\r\n\t\t/* 2.2.2.3 Control Tokens \"can be ignored\" */\r\n\t\t\t/* 2.5.198.34 */\r\n\t\t\tcase 'PtgAttrChoose': break;\r\n\t\t\t/* 2.5.198.35 */\r\n\t\t\tcase 'PtgAttrGoto': break;\r\n\t\t\t/* 2.5.198.36 */\r\n\t\t\tcase 'PtgAttrIf': break;\r\n\r\n\r\n\t\t\t/* 2.5.198.84 */\r\n\t\t\tcase 'PtgRef':\r\n\t\t\t\ttype = f[1][0]; c = shift_cell_xls(decode_cell(encode_cell(f[1][1])), _range);\r\n\t\t\t\tstack.push(encode_cell(c));\r\n\t\t\t\tbreak;\r\n\t\t\t/* 2.5.198.88 */\r\n\t\t\tcase 'PtgRefN':\r\n\t\t\t\ttype = f[1][0]; c = shift_cell_xls(decode_cell(encode_cell(f[1][1])), cell);\r\n\t\t\t\tstack.push(encode_cell(c));\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'PtgRef3d': // TODO: lots of stuff\r\n\t\t\t\ttype = f[1][0]; ixti = f[1][1]; c = shift_cell_xls(f[1][2], _range);\r\n\t\t\t\tstack.push(supbooks[1][ixti+1]+\"!\"+encode_cell(c));\r\n\t\t\t\tbreak;\r\n\r\n\t\t/* Function Call */\r\n\t\t\t/* 2.5.198.62 */\r\n\t\t\tcase 'PtgFunc':\r\n\t\t\t/* 2.5.198.63 */\r\n\t\t\tcase 'PtgFuncVar':\r\n\t\t\t\t/* f[1] = [argc, func] */\r\n\t\t\t\tvar argc = f[1][0], func = f[1][1];\r\n\t\t\t\tif(!argc) argc = 0;\r\n\t\t\t\tvar args = stack.slice(-argc);\r\n\t\t\t\tstack.length -= argc;\r\n\t\t\t\tif(func === 'User') func = args.shift();\r\n\t\t\t\tstack.push(func + \"(\" + args.join(\",\") + \")\");\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t/* 2.5.198.42 */\r\n\t\t\tcase 'PtgBool': stack.push(f[1] ? \"TRUE\" : \"FALSE\"); break;\r\n\t\t\t/* 2.5.198.66 */\r\n\t\t\tcase 'PtgInt': stack.push(f[1]); break;\r\n\t\t\t/* 2.5.198.79 TODO: precision? */\r\n\t\t\tcase 'PtgNum': stack.push(String(f[1])); break;\r\n\t\t\t/* 2.5.198.89 */\r\n\t\t\tcase 'PtgStr': stack.push('\"' + f[1] + '\"'); break;\r\n\t\t\t/* 2.5.198.57 */\r\n\t\t\tcase 'PtgErr': stack.push(f[1]); break;\r\n\t\t\t/* 2.5.198.27 TODO: fixed points */\r\n\t\t\tcase 'PtgArea':\r\n\t\t\t\ttype = f[1][0]; r = shift_range_xls(f[1][1], _range);\r\n\t\t\t\tstack.push(encode_range(r));\r\n\t\t\t\tbreak;\r\n\t\t\t/* 2.5.198.28 */\r\n\t\t\tcase 'PtgArea3d': // TODO: lots of stuff\r\n\t\t\t\ttype = f[1][0]; ixti = f[1][1]; r = f[1][2];\r\n\t\t\t\tstack.push(supbooks[1][ixti+1]+\"!\"+encode_range(r));\r\n\t\t\t\tbreak;\r\n\t\t\t/* 2.5.198.41 */\r\n\t\t\tcase 'PtgAttrSum':\r\n\t\t\t\tstack.push(\"SUM(\" + stack.pop() + \")\");\r\n\t\t\t\tbreak;\r\n\r\n\t\t/* Expression Prefixes */\r\n\t\t\t/* 2.5.198.37 */\r\n\t\t\tcase 'PtgAttrSemi': break;\r\n\r\n\t\t\t/* 2.5.97.60 TODO: do something different for revisions */\r\n\t\t\tcase 'PtgName':\r\n\t\t\t\t/* f[1] = type, 0, nameindex */\r\n\t\t\t\tnameidx = f[1][2];\r\n\t\t\t\tvar lbl = supbooks[0][nameidx];\r\n\t\t\t\tvar name = lbl.Name;\r\n\t\t\t\tif(name in XLSXFutureFunctions) name = XLSXFutureFunctions[name];\r\n\t\t\t\tstack.push(name);\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t/* 2.5.97.61 TODO: do something different for revisions */\r\n\t\t\tcase 'PtgNameX':\r\n\t\t\t\t/* f[1] = type, ixti, nameindex */\r\n\t\t\t\tvar bookidx = f[1][1]; nameidx = f[1][2]; var externbook;\r\n\t\t\t\t/* TODO: Properly handle missing values */\r\n\t\t\t\tif(supbooks[bookidx+1]) externbook = supbooks[bookidx+1][nameidx];\r\n\t\t\t\telse if(supbooks[bookidx-1]) externbook = supbooks[bookidx-1][nameidx];\r\n\t\t\t\tif(!externbook) externbook = {body: \"??NAMEX??\"};\r\n\t\t\t\tstack.push(externbook.body);\r\n\t\t\t\tbreak;\r\n\r\n\t\t/* 2.2.2.4 Display Tokens */\r\n\t\t\t/* 2.5.198.80 */\r\n\t\t\tcase 'PtgParen': stack.push('(' + stack.pop() + ')'); break;\r\n\r\n\t\t\t/* 2.5.198.86 */\r\n\t\t\tcase 'PtgRefErr': stack.push('#REF!'); break;\r\n\r\n\t\t/* */\r\n\t\t\t/* 2.5.198.58 TODO */\r\n\t\t\tcase 'PtgExp':\r\n\t\t\t\tc = {c:f[1][1],r:f[1][0]};\r\n\t\t\t\tvar q = {c: cell.c, r:cell.r};\r\n\t\t\t\tif(supbooks.sharedf[encode_cell(c)]) {\r\n\t\t\t\t\tvar parsedf = (supbooks.sharedf[encode_cell(c)]);\r\n\t\t\t\t\tstack.push(stringify_formula(parsedf, _range, q, supbooks, opts));\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tvar fnd = false;\r\n\t\t\t\t\tfor(e1=0;e1!=supbooks.arrayf.length; ++e1) {\r\n\t\t\t\t\t\t/* TODO: should be something like range_has */\r\n\t\t\t\t\t\te2 = supbooks.arrayf[e1];\r\n\t\t\t\t\t\tif(c.c < e2[0].s.c || c.c > e2[0].e.c) continue;\r\n\t\t\t\t\t\tif(c.r < e2[0].s.r || c.r > e2[0].e.r) continue;\r\n\t\t\t\t\t\tstack.push(stringify_formula(e2[1], _range, q, supbooks, opts));\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(!fnd) stack.push(f[1]);\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t/* 2.5.198.32 TODO */\r\n\t\t\tcase 'PtgArray':\r\n\t\t\t\tstack.push(\"{\" + f[1].map(mapper).join(\";\") + \"}\");\r\n\t\t\t\tbreak;\r\n\r\n\t\t/* 2.2.2.5 Mem Tokens */\r\n\t\t\t/* 2.5.198.70 TODO: confirm this is a non-display */\r\n\t\t\tcase 'PtgMemArea':\r\n\t\t\t\t//stack.push(\"(\" + f[2].map(encode_range).join(\",\") + \")\");\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t/* 2.5.198.38 TODO */\r\n\t\t\tcase 'PtgAttrSpace': break;\r\n\r\n\t\t\t/* 2.5.198.92 TODO */\r\n\t\t\tcase 'PtgTbl': break;\r\n\r\n\t\t\t/* 2.5.198.71 */\r\n\t\t\tcase 'PtgMemErr': break;\r\n\r\n\t\t\t/* 2.5.198.74 */\r\n\t\t\tcase 'PtgMissArg':\r\n\t\t\t\tstack.push(\"\");\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t/* 2.5.198.29 TODO */\r\n\t\t\tcase 'PtgAreaErr': break;\r\n\r\n\t\t\t/* 2.5.198.31 TODO */\r\n\t\t\tcase 'PtgAreaN': stack.push(\"\"); break;\r\n\r\n\t\t\t/* 2.5.198.87 TODO */\r\n\t\t\tcase 'PtgRefErr3d': break;\r\n\r\n\t\t\t/* 2.5.198.72 TODO */\r\n\t\t\tcase 'PtgMemFunc': break;\r\n\r\n\t\t\tdefault: throw 'Unrecognized Formula Token: ' + f;\r\n\t\t}\r\n\t\t//console.log(\"::\",f, stack)\r\n\t}\r\n\t//console.log(\"--\",stack);\r\n\treturn stack[0];\r\n}\r\n\r\n/* [MS-XLSB] 2.5.97.4 CellParsedFormula TODO: use similar logic to js-xls */\r\nfunction parse_XLSBCellParsedFormula(data, length) {\r\n\tvar cce = data.read_shift(4);\r\n\treturn parsenoop(data, length-4);\r\n}\r\n/* [MS-XLS] 2.5.198.44 */\r\nvar PtgDataType = {\r\n\t0x1: \"REFERENCE\", // reference to range\r\n\t0x2: \"VALUE\", // single value\r\n\t0x3: \"ARRAY\" // array of values\r\n};\r\n\r\n/* [MS-XLS] 2.5.198.4 */\r\nvar Cetab = {\r\n\t0x0000: 'BEEP',\r\n\t0x0001: 'OPEN',\r\n\t0x0002: 'OPEN.LINKS',\r\n\t0x0003: 'CLOSE.ALL',\r\n\t0x0004: 'SAVE',\r\n\t0x0005: 'SAVE.AS',\r\n\t0x0006: 'FILE.DELETE',\r\n\t0x0007: 'PAGE.SETUP',\r\n\t0x0008: 'PRINT',\r\n\t0x0009: 'PRINTER.SETUP',\r\n\t0x000A: 'QUIT',\r\n\t0x000B: 'NEW.WINDOW',\r\n\t0x000C: 'ARRANGE.ALL',\r\n\t0x000D: 'WINDOW.SIZE',\r\n\t0x000E: 'WINDOW.MOVE',\r\n\t0x000F: 'FULL',\r\n\t0x0010: 'CLOSE',\r\n\t0x0011: 'RUN',\r\n\t0x0016: 'SET.PRINT.AREA',\r\n\t0x0017: 'SET.PRINT.TITLES',\r\n\t0x0018: 'SET.PAGE.BREAK',\r\n\t0x0019: 'REMOVE.PAGE.BREAK',\r\n\t0x001A: 'FONT',\r\n\t0x001B: 'DISPLAY',\r\n\t0x001C: 'PROTECT.DOCUMENT',\r\n\t0x001D: 'PRECISION',\r\n\t0x001E: 'A1.R1C1',\r\n\t0x001F: 'CALCULATE.NOW',\r\n\t0x0020: 'CALCULATION',\r\n\t0x0022: 'DATA.FIND',\r\n\t0x0023: 'EXTRACT',\r\n\t0x0024: 'DATA.DELETE',\r\n\t0x0025: 'SET.DATABASE',\r\n\t0x0026: 'SET.CRITERIA',\r\n\t0x0027: 'SORT',\r\n\t0x0028: 'DATA.SERIES',\r\n\t0x0029: 'TABLE',\r\n\t0x002A: 'FORMAT.NUMBER',\r\n\t0x002B: 'ALIGNMENT',\r\n\t0x002C: 'STYLE',\r\n\t0x002D: 'BORDER',\r\n\t0x002E: 'CELL.PROTECTION',\r\n\t0x002F: 'COLUMN.WIDTH',\r\n\t0x0030: 'UNDO',\r\n\t0x0031: 'CUT',\r\n\t0x0032: 'COPY',\r\n\t0x0033: 'PASTE',\r\n\t0x0034: 'CLEAR',\r\n\t0x0035: 'PASTE.SPECIAL',\r\n\t0x0036: 'EDIT.DELETE',\r\n\t0x0037: 'INSERT',\r\n\t0x0038: 'FILL.RIGHT',\r\n\t0x0039: 'FILL.DOWN',\r\n\t0x003D: 'DEFINE.NAME',\r\n\t0x003E: 'CREATE.NAMES',\r\n\t0x003F: 'FORMULA.GOTO',\r\n\t0x0040: 'FORMULA.FIND',\r\n\t0x0041: 'SELECT.LAST.CELL',\r\n\t0x0042: 'SHOW.ACTIVE.CELL',\r\n\t0x0043: 'GALLERY.AREA',\r\n\t0x0044: 'GALLERY.BAR',\r\n\t0x0045: 'GALLERY.COLUMN',\r\n\t0x0046: 'GALLERY.LINE',\r\n\t0x0047: 'GALLERY.PIE',\r\n\t0x0048: 'GALLERY.SCATTER',\r\n\t0x0049: 'COMBINATION',\r\n\t0x004A: 'PREFERRED',\r\n\t0x004B: 'ADD.OVERLAY',\r\n\t0x004C: 'GRIDLINES',\r\n\t0x004D: 'SET.PREFERRED',\r\n\t0x004E: 'AXES',\r\n\t0x004F: 'LEGEND',\r\n\t0x0050: 'ATTACH.TEXT',\r\n\t0x0051: 'ADD.ARROW',\r\n\t0x0052: 'SELECT.CHART',\r\n\t0x0053: 'SELECT.PLOT.AREA',\r\n\t0x0054: 'PATTERNS',\r\n\t0x0055: 'MAIN.CHART',\r\n\t0x0056: 'OVERLAY',\r\n\t0x0057: 'SCALE',\r\n\t0x0058: 'FORMAT.LEGEND',\r\n\t0x0059: 'FORMAT.TEXT',\r\n\t0x005A: 'EDIT.REPEAT',\r\n\t0x005B: 'PARSE',\r\n\t0x005C: 'JUSTIFY',\r\n\t0x005D: 'HIDE',\r\n\t0x005E: 'UNHIDE',\r\n\t0x005F: 'WORKSPACE',\r\n\t0x0060: 'FORMULA',\r\n\t0x0061: 'FORMULA.FILL',\r\n\t0x0062: 'FORMULA.ARRAY',\r\n\t0x0063: 'DATA.FIND.NEXT',\r\n\t0x0064: 'DATA.FIND.PREV',\r\n\t0x0065: 'FORMULA.FIND.NEXT',\r\n\t0x0066: 'FORMULA.FIND.PREV',\r\n\t0x0067: 'ACTIVATE',\r\n\t0x0068: 'ACTIVATE.NEXT',\r\n\t0x0069: 'ACTIVATE.PREV',\r\n\t0x006A: 'UNLOCKED.NEXT',\r\n\t0x006B: 'UNLOCKED.PREV',\r\n\t0x006C: 'COPY.PICTURE',\r\n\t0x006D: 'SELECT',\r\n\t0x006E: 'DELETE.NAME',\r\n\t0x006F: 'DELETE.FORMAT',\r\n\t0x0070: 'VLINE',\r\n\t0x0071: 'HLINE',\r\n\t0x0072: 'VPAGE',\r\n\t0x0073: 'HPAGE',\r\n\t0x0074: 'VSCROLL',\r\n\t0x0075: 'HSCROLL',\r\n\t0x0076: 'ALERT',\r\n\t0x0077: 'NEW',\r\n\t0x0078: 'CANCEL.COPY',\r\n\t0x0079: 'SHOW.CLIPBOARD',\r\n\t0x007A: 'MESSAGE',\r\n\t0x007C: 'PASTE.LINK',\r\n\t0x007D: 'APP.ACTIVATE',\r\n\t0x007E: 'DELETE.ARROW',\r\n\t0x007F: 'ROW.HEIGHT',\r\n\t0x0080: 'FORMAT.MOVE',\r\n\t0x0081: 'FORMAT.SIZE',\r\n\t0x0082: 'FORMULA.REPLACE',\r\n\t0x0083: 'SEND.KEYS',\r\n\t0x0084: 'SELECT.SPECIAL',\r\n\t0x0085: 'APPLY.NAMES',\r\n\t0x0086: 'REPLACE.FONT',\r\n\t0x0087: 'FREEZE.PANES',\r\n\t0x0088: 'SHOW.INFO',\r\n\t0x0089: 'SPLIT',\r\n\t0x008A: 'ON.WINDOW',\r\n\t0x008B: 'ON.DATA',\r\n\t0x008C: 'DISABLE.INPUT',\r\n\t0x008E: 'OUTLINE',\r\n\t0x008F: 'LIST.NAMES',\r\n\t0x0090: 'FILE.CLOSE',\r\n\t0x0091: 'SAVE.WORKBOOK',\r\n\t0x0092: 'DATA.FORM',\r\n\t0x0093: 'COPY.CHART',\r\n\t0x0094: 'ON.TIME',\r\n\t0x0095: 'WAIT',\r\n\t0x0096: 'FORMAT.FONT',\r\n\t0x0097: 'FILL.UP',\r\n\t0x0098: 'FILL.LEFT',\r\n\t0x0099: 'DELETE.OVERLAY',\r\n\t0x009B: 'SHORT.MENUS',\r\n\t0x009F: 'SET.UPDATE.STATUS',\r\n\t0x00A1: 'COLOR.PALETTE',\r\n\t0x00A2: 'DELETE.STYLE',\r\n\t0x00A3: 'WINDOW.RESTORE',\r\n\t0x00A4: 'WINDOW.MAXIMIZE',\r\n\t0x00A6: 'CHANGE.LINK',\r\n\t0x00A7: 'CALCULATE.DOCUMENT',\r\n\t0x00A8: 'ON.KEY',\r\n\t0x00A9: 'APP.RESTORE',\r\n\t0x00AA: 'APP.MOVE',\r\n\t0x00AB: 'APP.SIZE',\r\n\t0x00AC: 'APP.MINIMIZE',\r\n\t0x00AD: 'APP.MAXIMIZE',\r\n\t0x00AE: 'BRING.TO.FRONT',\r\n\t0x00AF: 'SEND.TO.BACK',\r\n\t0x00B9: 'MAIN.CHART.TYPE',\r\n\t0x00BA: 'OVERLAY.CHART.TYPE',\r\n\t0x00BB: 'SELECT.END',\r\n\t0x00BC: 'OPEN.MAIL',\r\n\t0x00BD: 'SEND.MAIL',\r\n\t0x00BE: 'STANDARD.FONT',\r\n\t0x00BF: 'CONSOLIDATE',\r\n\t0x00C0: 'SORT.SPECIAL',\r\n\t0x00C1: 'GALLERY.3D.AREA',\r\n\t0x00C2: 'GALLERY.3D.COLUMN',\r\n\t0x00C3: 'GALLERY.3D.LINE',\r\n\t0x00C4: 'GALLERY.3D.PIE',\r\n\t0x00C5: 'VIEW.3D',\r\n\t0x00C6: 'GOAL.SEEK',\r\n\t0x00C7: 'WORKGROUP',\r\n\t0x00C8: 'FILL.GROUP',\r\n\t0x00C9: 'UPDATE.LINK',\r\n\t0x00CA: 'PROMOTE',\r\n\t0x00CB: 'DEMOTE',\r\n\t0x00CC: 'SHOW.DETAIL',\r\n\t0x00CE: 'UNGROUP',\r\n\t0x00CF: 'OBJECT.PROPERTIES',\r\n\t0x00D0: 'SAVE.NEW.OBJECT',\r\n\t0x00D1: 'SHARE',\r\n\t0x00D2: 'SHARE.NAME',\r\n\t0x00D3: 'DUPLICATE',\r\n\t0x00D4: 'APPLY.STYLE',\r\n\t0x00D5: 'ASSIGN.TO.OBJECT',\r\n\t0x00D6: 'OBJECT.PROTECTION',\r\n\t0x00D7: 'HIDE.OBJECT',\r\n\t0x00D8: 'SET.EXTRACT',\r\n\t0x00D9: 'CREATE.PUBLISHER',\r\n\t0x00DA: 'SUBSCRIBE.TO',\r\n\t0x00DB: 'ATTRIBUTES',\r\n\t0x00DC: 'SHOW.TOOLBAR',\r\n\t0x00DE: 'PRINT.PREVIEW',\r\n\t0x00DF: 'EDIT.COLOR',\r\n\t0x00E0: 'SHOW.LEVELS',\r\n\t0x00E1: 'FORMAT.MAIN',\r\n\t0x00E2: 'FORMAT.OVERLAY',\r\n\t0x00E3: 'ON.RECALC',\r\n\t0x00E4: 'EDIT.SERIES',\r\n\t0x00E5: 'DEFINE.STYLE',\r\n\t0x00F0: 'LINE.PRINT',\r\n\t0x00F3: 'ENTER.DATA',\r\n\t0x00F9: 'GALLERY.RADAR',\r\n\t0x00FA: 'MERGE.STYLES',\r\n\t0x00FB: 'EDITION.OPTIONS',\r\n\t0x00FC: 'PASTE.PICTURE',\r\n\t0x00FD: 'PASTE.PICTURE.LINK',\r\n\t0x00FE: 'SPELLING',\r\n\t0x0100: 'ZOOM',\r\n\t0x0103: 'INSERT.OBJECT',\r\n\t0x0104: 'WINDOW.MINIMIZE',\r\n\t0x0109: 'SOUND.NOTE',\r\n\t0x010A: 'SOUND.PLAY',\r\n\t0x010B: 'FORMAT.SHAPE',\r\n\t0x010C: 'EXTEND.POLYGON',\r\n\t0x010D: 'FORMAT.AUTO',\r\n\t0x0110: 'GALLERY.3D.BAR',\r\n\t0x0111: 'GALLERY.3D.SURFACE',\r\n\t0x0112: 'FILL.AUTO',\r\n\t0x0114: 'CUSTOMIZE.TOOLBAR',\r\n\t0x0115: 'ADD.TOOL',\r\n\t0x0116: 'EDIT.OBJECT',\r\n\t0x0117: 'ON.DOUBLECLICK',\r\n\t0x0118: 'ON.ENTRY',\r\n\t0x0119: 'WORKBOOK.ADD',\r\n\t0x011A: 'WORKBOOK.MOVE',\r\n\t0x011B: 'WORKBOOK.COPY',\r\n\t0x011C: 'WORKBOOK.OPTIONS',\r\n\t0x011D: 'SAVE.WORKSPACE',\r\n\t0x0120: 'CHART.WIZARD',\r\n\t0x0121: 'DELETE.TOOL',\r\n\t0x0122: 'MOVE.TOOL',\r\n\t0x0123: 'WORKBOOK.SELECT',\r\n\t0x0124: 'WORKBOOK.ACTIVATE',\r\n\t0x0125: 'ASSIGN.TO.TOOL',\r\n\t0x0127: 'COPY.TOOL',\r\n\t0x0128: 'RESET.TOOL',\r\n\t0x0129: 'CONSTRAIN.NUMERIC',\r\n\t0x012A: 'PASTE.TOOL',\r\n\t0x012E: 'WORKBOOK.NEW',\r\n\t0x0131: 'SCENARIO.CELLS',\r\n\t0x0132: 'SCENARIO.DELETE',\r\n\t0x0133: 'SCENARIO.ADD',\r\n\t0x0134: 'SCENARIO.EDIT',\r\n\t0x0135: 'SCENARIO.SHOW',\r\n\t0x0136: 'SCENARIO.SHOW.NEXT',\r\n\t0x0137: 'SCENARIO.SUMMARY',\r\n\t0x0138: 'PIVOT.TABLE.WIZARD',\r\n\t0x0139: 'PIVOT.FIELD.PROPERTIES',\r\n\t0x013A: 'PIVOT.FIELD',\r\n\t0x013B: 'PIVOT.ITEM',\r\n\t0x013C: 'PIVOT.ADD.FIELDS',\r\n\t0x013E: 'OPTIONS.CALCULATION',\r\n\t0x013F: 'OPTIONS.EDIT',\r\n\t0x0140: 'OPTIONS.VIEW',\r\n\t0x0141: 'ADDIN.MANAGER',\r\n\t0x0142: 'MENU.EDITOR',\r\n\t0x0143: 'ATTACH.TOOLBARS',\r\n\t0x0144: 'VBAActivate',\r\n\t0x0145: 'OPTIONS.CHART',\r\n\t0x0148: 'VBA.INSERT.FILE',\r\n\t0x014A: 'VBA.PROCEDURE.DEFINITION',\r\n\t0x0150: 'ROUTING.SLIP',\r\n\t0x0152: 'ROUTE.DOCUMENT',\r\n\t0x0153: 'MAIL.LOGON',\r\n\t0x0156: 'INSERT.PICTURE',\r\n\t0x0157: 'EDIT.TOOL',\r\n\t0x0158: 'GALLERY.DOUGHNUT',\r\n\t0x015E: 'CHART.TREND',\r\n\t0x0160: 'PIVOT.ITEM.PROPERTIES',\r\n\t0x0162: 'WORKBOOK.INSERT',\r\n\t0x0163: 'OPTIONS.TRANSITION',\r\n\t0x0164: 'OPTIONS.GENERAL',\r\n\t0x0172: 'FILTER.ADVANCED',\r\n\t0x0175: 'MAIL.ADD.MAILER',\r\n\t0x0176: 'MAIL.DELETE.MAILER',\r\n\t0x0177: 'MAIL.REPLY',\r\n\t0x0178: 'MAIL.REPLY.ALL',\r\n\t0x0179: 'MAIL.FORWARD',\r\n\t0x017A: 'MAIL.NEXT.LETTER',\r\n\t0x017B: 'DATA.LABEL',\r\n\t0x017C: 'INSERT.TITLE',\r\n\t0x017D: 'FONT.PROPERTIES',\r\n\t0x017E: 'MACRO.OPTIONS',\r\n\t0x017F: 'WORKBOOK.HIDE',\r\n\t0x0180: 'WORKBOOK.UNHIDE',\r\n\t0x0181: 'WORKBOOK.DELETE',\r\n\t0x0182: 'WORKBOOK.NAME',\r\n\t0x0184: 'GALLERY.CUSTOM',\r\n\t0x0186: 'ADD.CHART.AUTOFORMAT',\r\n\t0x0187: 'DELETE.CHART.AUTOFORMAT',\r\n\t0x0188: 'CHART.ADD.DATA',\r\n\t0x0189: 'AUTO.OUTLINE',\r\n\t0x018A: 'TAB.ORDER',\r\n\t0x018B: 'SHOW.DIALOG',\r\n\t0x018C: 'SELECT.ALL',\r\n\t0x018D: 'UNGROUP.SHEETS',\r\n\t0x018E: 'SUBTOTAL.CREATE',\r\n\t0x018F: 'SUBTOTAL.REMOVE',\r\n\t0x0190: 'RENAME.OBJECT',\r\n\t0x019C: 'WORKBOOK.SCROLL',\r\n\t0x019D: 'WORKBOOK.NEXT',\r\n\t0x019E: 'WORKBOOK.PREV',\r\n\t0x019F: 'WORKBOOK.TAB.SPLIT',\r\n\t0x01A0: 'FULL.SCREEN',\r\n\t0x01A1: 'WORKBOOK.PROTECT',\r\n\t0x01A4: 'SCROLLBAR.PROPERTIES',\r\n\t0x01A5: 'PIVOT.SHOW.PAGES',\r\n\t0x01A6: 'TEXT.TO.COLUMNS',\r\n\t0x01A7: 'FORMAT.CHARTTYPE',\r\n\t0x01A8: 'LINK.FORMAT',\r\n\t0x01A9: 'TRACER.DISPLAY',\r\n\t0x01AE: 'TRACER.NAVIGATE',\r\n\t0x01AF: 'TRACER.CLEAR',\r\n\t0x01B0: 'TRACER.ERROR',\r\n\t0x01B1: 'PIVOT.FIELD.GROUP',\r\n\t0x01B2: 'PIVOT.FIELD.UNGROUP',\r\n\t0x01B3: 'CHECKBOX.PROPERTIES',\r\n\t0x01B4: 'LABEL.PROPERTIES',\r\n\t0x01B5: 'LISTBOX.PROPERTIES',\r\n\t0x01B6: 'EDITBOX.PROPERTIES',\r\n\t0x01B7: 'PIVOT.REFRESH',\r\n\t0x01B8: 'LINK.COMBO',\r\n\t0x01B9: 'OPEN.TEXT',\r\n\t0x01BA: 'HIDE.DIALOG',\r\n\t0x01BB: 'SET.DIALOG.FOCUS',\r\n\t0x01BC: 'ENABLE.OBJECT',\r\n\t0x01BD: 'PUSHBUTTON.PROPERTIES',\r\n\t0x01BE: 'SET.DIALOG.DEFAULT',\r\n\t0x01BF: 'FILTER',\r\n\t0x01C0: 'FILTER.SHOW.ALL',\r\n\t0x01C1: 'CLEAR.OUTLINE',\r\n\t0x01C2: 'FUNCTION.WIZARD',\r\n\t0x01C3: 'ADD.LIST.ITEM',\r\n\t0x01C4: 'SET.LIST.ITEM',\r\n\t0x01C5: 'REMOVE.LIST.ITEM',\r\n\t0x01C6: 'SELECT.LIST.ITEM',\r\n\t0x01C7: 'SET.CONTROL.VALUE',\r\n\t0x01C8: 'SAVE.COPY.AS',\r\n\t0x01CA: 'OPTIONS.LISTS.ADD',\r\n\t0x01CB: 'OPTIONS.LISTS.DELETE',\r\n\t0x01CC: 'SERIES.AXES',\r\n\t0x01CD: 'SERIES.X',\r\n\t0x01CE: 'SERIES.Y',\r\n\t0x01CF: 'ERRORBAR.X',\r\n\t0x01D0: 'ERRORBAR.Y',\r\n\t0x01D1: 'FORMAT.CHART',\r\n\t0x01D2: 'SERIES.ORDER',\r\n\t0x01D3: 'MAIL.LOGOFF',\r\n\t0x01D4: 'CLEAR.ROUTING.SLIP',\r\n\t0x01D5: 'APP.ACTIVATE.MICROSOFT',\r\n\t0x01D6: 'MAIL.EDIT.MAILER',\r\n\t0x01D7: 'ON.SHEET',\r\n\t0x01D8: 'STANDARD.WIDTH',\r\n\t0x01D9: 'SCENARIO.MERGE',\r\n\t0x01DA: 'SUMMARY.INFO',\r\n\t0x01DB: 'FIND.FILE',\r\n\t0x01DC: 'ACTIVE.CELL.FONT',\r\n\t0x01DD: 'ENABLE.TIPWIZARD',\r\n\t0x01DE: 'VBA.MAKE.ADDIN',\r\n\t0x01E0: 'INSERTDATATABLE',\r\n\t0x01E1: 'WORKGROUP.OPTIONS',\r\n\t0x01E2: 'MAIL.SEND.MAILER',\r\n\t0x01E5: 'AUTOCORRECT',\r\n\t0x01E9: 'POST.DOCUMENT',\r\n\t0x01EB: 'PICKLIST',\r\n\t0x01ED: 'VIEW.SHOW',\r\n\t0x01EE: 'VIEW.DEFINE',\r\n\t0x01EF: 'VIEW.DELETE',\r\n\t0x01FD: 'SHEET.BACKGROUND',\r\n\t0x01FE: 'INSERT.MAP.OBJECT',\r\n\t0x01FF: 'OPTIONS.MENONO',\r\n\t0x0205: 'MSOCHECKS',\r\n\t0x0206: 'NORMAL',\r\n\t0x0207: 'LAYOUT',\r\n\t0x0208: 'RM.PRINT.AREA',\r\n\t0x0209: 'CLEAR.PRINT.AREA',\r\n\t0x020A: 'ADD.PRINT.AREA',\r\n\t0x020B: 'MOVE.BRK',\r\n\t0x0221: 'HIDECURR.NOTE',\r\n\t0x0222: 'HIDEALL.NOTES',\r\n\t0x0223: 'DELETE.NOTE',\r\n\t0x0224: 'TRAVERSE.NOTES',\r\n\t0x0225: 'ACTIVATE.NOTES',\r\n\t0x026C: 'PROTECT.REVISIONS',\r\n\t0x026D: 'UNPROTECT.REVISIONS',\r\n\t0x0287: 'OPTIONS.ME',\r\n\t0x028D: 'WEB.PUBLISH',\r\n\t0x029B: 'NEWWEBQUERY',\r\n\t0x02A1: 'PIVOT.TABLE.CHART',\r\n\t0x02F1: 'OPTIONS.SAVE',\r\n\t0x02F3: 'OPTIONS.SPELL',\r\n\t0x0328: 'HIDEALL.INKANNOTS'\r\n};\r\n\r\n/* [MS-XLS] 2.5.198.17 */\r\nvar Ftab = {\r\n\t0x0000: 'COUNT',\r\n\t0x0001: 'IF',\r\n\t0x0002: 'ISNA',\r\n\t0x0003: 'ISERROR',\r\n\t0x0004: 'SUM',\r\n\t0x0005: 'AVERAGE',\r\n\t0x0006: 'MIN',\r\n\t0x0007: 'MAX',\r\n\t0x0008: 'ROW',\r\n\t0x0009: 'COLUMN',\r\n\t0x000A: 'NA',\r\n\t0x000B: 'NPV',\r\n\t0x000C: 'STDEV',\r\n\t0x000D: 'DOLLAR',\r\n\t0x000E: 'FIXED',\r\n\t0x000F: 'SIN',\r\n\t0x0010: 'COS',\r\n\t0x0011: 'TAN',\r\n\t0x0012: 'ATAN',\r\n\t0x0013: 'PI',\r\n\t0x0014: 'SQRT',\r\n\t0x0015: 'EXP',\r\n\t0x0016: 'LN',\r\n\t0x0017: 'LOG10',\r\n\t0x0018: 'ABS',\r\n\t0x0019: 'INT',\r\n\t0x001A: 'SIGN',\r\n\t0x001B: 'ROUND',\r\n\t0x001C: 'LOOKUP',\r\n\t0x001D: 'INDEX',\r\n\t0x001E: 'REPT',\r\n\t0x001F: 'MID',\r\n\t0x0020: 'LEN',\r\n\t0x0021: 'VALUE',\r\n\t0x0022: 'TRUE',\r\n\t0x0023: 'FALSE',\r\n\t0x0024: 'AND',\r\n\t0x0025: 'OR',\r\n\t0x0026: 'NOT',\r\n\t0x0027: 'MOD',\r\n\t0x0028: 'DCOUNT',\r\n\t0x0029: 'DSUM',\r\n\t0x002A: 'DAVERAGE',\r\n\t0x002B: 'DMIN',\r\n\t0x002C: 'DMAX',\r\n\t0x002D: 'DSTDEV',\r\n\t0x002E: 'VAR',\r\n\t0x002F: 'DVAR',\r\n\t0x0030: 'TEXT',\r\n\t0x0031: 'LINEST',\r\n\t0x0032: 'TREND',\r\n\t0x0033: 'LOGEST',\r\n\t0x0034: 'GROWTH',\r\n\t0x0035: 'GOTO',\r\n\t0x0036: 'HALT',\r\n\t0x0037: 'RETURN',\r\n\t0x0038: 'PV',\r\n\t0x0039: 'FV',\r\n\t0x003A: 'NPER',\r\n\t0x003B: 'PMT',\r\n\t0x003C: 'RATE',\r\n\t0x003D: 'MIRR',\r\n\t0x003E: 'IRR',\r\n\t0x003F: 'RAND',\r\n\t0x0040: 'MATCH',\r\n\t0x0041: 'DATE',\r\n\t0x0042: 'TIME',\r\n\t0x0043: 'DAY',\r\n\t0x0044: 'MONTH',\r\n\t0x0045: 'YEAR',\r\n\t0x0046: 'WEEKDAY',\r\n\t0x0047: 'HOUR',\r\n\t0x0048: 'MINUTE',\r\n\t0x0049: 'SECOND',\r\n\t0x004A: 'NOW',\r\n\t0x004B: 'AREAS',\r\n\t0x004C: 'ROWS',\r\n\t0x004D: 'COLUMNS',\r\n\t0x004E: 'OFFSET',\r\n\t0x004F: 'ABSREF',\r\n\t0x0050: 'RELREF',\r\n\t0x0051: 'ARGUMENT',\r\n\t0x0052: 'SEARCH',\r\n\t0x0053: 'TRANSPOSE',\r\n\t0x0054: 'ERROR',\r\n\t0x0055: 'STEP',\r\n\t0x0056: 'TYPE',\r\n\t0x0057: 'ECHO',\r\n\t0x0058: 'SET.NAME',\r\n\t0x0059: 'CALLER',\r\n\t0x005A: 'DEREF',\r\n\t0x005B: 'WINDOWS',\r\n\t0x005C: 'SERIES',\r\n\t0x005D: 'DOCUMENTS',\r\n\t0x005E: 'ACTIVE.CELL',\r\n\t0x005F: 'SELECTION',\r\n\t0x0060: 'RESULT',\r\n\t0x0061: 'ATAN2',\r\n\t0x0062: 'ASIN',\r\n\t0x0063: 'ACOS',\r\n\t0x0064: 'CHOOSE',\r\n\t0x0065: 'HLOOKUP',\r\n\t0x0066: 'VLOOKUP',\r\n\t0x0067: 'LINKS',\r\n\t0x0068: 'INPUT',\r\n\t0x0069: 'ISREF',\r\n\t0x006A: 'GET.FORMULA',\r\n\t0x006B: 'GET.NAME',\r\n\t0x006C: 'SET.VALUE',\r\n\t0x006D: 'LOG',\r\n\t0x006E: 'EXEC',\r\n\t0x006F: 'CHAR',\r\n\t0x0070: 'LOWER',\r\n\t0x0071: 'UPPER',\r\n\t0x0072: 'PROPER',\r\n\t0x0073: 'LEFT',\r\n\t0x0074: 'RIGHT',\r\n\t0x0075: 'EXACT',\r\n\t0x0076: 'TRIM',\r\n\t0x0077: 'REPLACE',\r\n\t0x0078: 'SUBSTITUTE',\r\n\t0x0079: 'CODE',\r\n\t0x007A: 'NAMES',\r\n\t0x007B: 'DIRECTORY',\r\n\t0x007C: 'FIND',\r\n\t0x007D: 'CELL',\r\n\t0x007E: 'ISERR',\r\n\t0x007F: 'ISTEXT',\r\n\t0x0080: 'ISNUMBER',\r\n\t0x0081: 'ISBLANK',\r\n\t0x0082: 'T',\r\n\t0x0083: 'N',\r\n\t0x0084: 'FOPEN',\r\n\t0x0085: 'FCLOSE',\r\n\t0x0086: 'FSIZE',\r\n\t0x0087: 'FREADLN',\r\n\t0x0088: 'FREAD',\r\n\t0x0089: 'FWRITELN',\r\n\t0x008A: 'FWRITE',\r\n\t0x008B: 'FPOS',\r\n\t0x008C: 'DATEVALUE',\r\n\t0x008D: 'TIMEVALUE',\r\n\t0x008E: 'SLN',\r\n\t0x008F: 'SYD',\r\n\t0x0090: 'DDB',\r\n\t0x0091: 'GET.DEF',\r\n\t0x0092: 'REFTEXT',\r\n\t0x0093: 'TEXTREF',\r\n\t0x0094: 'INDIRECT',\r\n\t0x0095: 'REGISTER',\r\n\t0x0096: 'CALL',\r\n\t0x0097: 'ADD.BAR',\r\n\t0x0098: 'ADD.MENU',\r\n\t0x0099: 'ADD.COMMAND',\r\n\t0x009A: 'ENABLE.COMMAND',\r\n\t0x009B: 'CHECK.COMMAND',\r\n\t0x009C: 'RENAME.COMMAND',\r\n\t0x009D: 'SHOW.BAR',\r\n\t0x009E: 'DELETE.MENU',\r\n\t0x009F: 'DELETE.COMMAND',\r\n\t0x00A0: 'GET.CHART.ITEM',\r\n\t0x00A1: 'DIALOG.BOX',\r\n\t0x00A2: 'CLEAN',\r\n\t0x00A3: 'MDETERM',\r\n\t0x00A4: 'MINVERSE',\r\n\t0x00A5: 'MMULT',\r\n\t0x00A6: 'FILES',\r\n\t0x00A7: 'IPMT',\r\n\t0x00A8: 'PPMT',\r\n\t0x00A9: 'COUNTA',\r\n\t0x00AA: 'CANCEL.KEY',\r\n\t0x00AB: 'FOR',\r\n\t0x00AC: 'WHILE',\r\n\t0x00AD: 'BREAK',\r\n\t0x00AE: 'NEXT',\r\n\t0x00AF: 'INITIATE',\r\n\t0x00B0: 'REQUEST',\r\n\t0x00B1: 'POKE',\r\n\t0x00B2: 'EXECUTE',\r\n\t0x00B3: 'TERMINATE',\r\n\t0x00B4: 'RESTART',\r\n\t0x00B5: 'HELP',\r\n\t0x00B6: 'GET.BAR',\r\n\t0x00B7: 'PRODUCT',\r\n\t0x00B8: 'FACT',\r\n\t0x00B9: 'GET.CELL',\r\n\t0x00BA: 'GET.WORKSPACE',\r\n\t0x00BB: 'GET.WINDOW',\r\n\t0x00BC: 'GET.DOCUMENT',\r\n\t0x00BD: 'DPRODUCT',\r\n\t0x00BE: 'ISNONTEXT',\r\n\t0x00BF: 'GET.NOTE',\r\n\t0x00C0: 'NOTE',\r\n\t0x00C1: 'STDEVP',\r\n\t0x00C2: 'VARP',\r\n\t0x00C3: 'DSTDEVP',\r\n\t0x00C4: 'DVARP',\r\n\t0x00C5: 'TRUNC',\r\n\t0x00C6: 'ISLOGICAL',\r\n\t0x00C7: 'DCOUNTA',\r\n\t0x00C8: 'DELETE.BAR',\r\n\t0x00C9: 'UNREGISTER',\r\n\t0x00CC: 'USDOLLAR',\r\n\t0x00CD: 'FINDB',\r\n\t0x00CE: 'SEARCHB',\r\n\t0x00CF: 'REPLACEB',\r\n\t0x00D0: 'LEFTB',\r\n\t0x00D1: 'RIGHTB',\r\n\t0x00D2: 'MIDB',\r\n\t0x00D3: 'LENB',\r\n\t0x00D4: 'ROUNDUP',\r\n\t0x00D5: 'ROUNDDOWN',\r\n\t0x00D6: 'ASC',\r\n\t0x00D7: 'DBCS',\r\n\t0x00D8: 'RANK',\r\n\t0x00DB: 'ADDRESS',\r\n\t0x00DC: 'DAYS360',\r\n\t0x00DD: 'TODAY',\r\n\t0x00DE: 'VDB',\r\n\t0x00DF: 'ELSE',\r\n\t0x00E0: 'ELSE.IF',\r\n\t0x00E1: 'END.IF',\r\n\t0x00E2: 'FOR.CELL',\r\n\t0x00E3: 'MEDIAN',\r\n\t0x00E4: 'SUMPRODUCT',\r\n\t0x00E5: 'SINH',\r\n\t0x00E6: 'COSH',\r\n\t0x00E7: 'TANH',\r\n\t0x00E8: 'ASINH',\r\n\t0x00E9: 'ACOSH',\r\n\t0x00EA: 'ATANH',\r\n\t0x00EB: 'DGET',\r\n\t0x00EC: 'CREATE.OBJECT',\r\n\t0x00ED: 'VOLATILE',\r\n\t0x00EE: 'LAST.ERROR',\r\n\t0x00EF: 'CUSTOM.UNDO',\r\n\t0x00F0: 'CUSTOM.REPEAT',\r\n\t0x00F1: 'FORMULA.CONVERT',\r\n\t0x00F2: 'GET.LINK.INFO',\r\n\t0x00F3: 'TEXT.BOX',\r\n\t0x00F4: 'INFO',\r\n\t0x00F5: 'GROUP',\r\n\t0x00F6: 'GET.OBJECT',\r\n\t0x00F7: 'DB',\r\n\t0x00F8: 'PAUSE',\r\n\t0x00FB: 'RESUME',\r\n\t0x00FC: 'FREQUENCY',\r\n\t0x00FD: 'ADD.TOOLBAR',\r\n\t0x00FE: 'DELETE.TOOLBAR',\r\n\t0x00FF: 'User',\r\n\t0x0100: 'RESET.TOOLBAR',\r\n\t0x0101: 'EVALUATE',\r\n\t0x0102: 'GET.TOOLBAR',\r\n\t0x0103: 'GET.TOOL',\r\n\t0x0104: 'SPELLING.CHECK',\r\n\t0x0105: 'ERROR.TYPE',\r\n\t0x0106: 'APP.TITLE',\r\n\t0x0107: 'WINDOW.TITLE',\r\n\t0x0108: 'SAVE.TOOLBAR',\r\n\t0x0109: 'ENABLE.TOOL',\r\n\t0x010A: 'PRESS.TOOL',\r\n\t0x010B: 'REGISTER.ID',\r\n\t0x010C: 'GET.WORKBOOK',\r\n\t0x010D: 'AVEDEV',\r\n\t0x010E: 'BETADIST',\r\n\t0x010F: 'GAMMALN',\r\n\t0x0110: 'BETAINV',\r\n\t0x0111: 'BINOMDIST',\r\n\t0x0112: 'CHIDIST',\r\n\t0x0113: 'CHIINV',\r\n\t0x0114: 'COMBIN',\r\n\t0x0115: 'CONFIDENCE',\r\n\t0x0116: 'CRITBINOM',\r\n\t0x0117: 'EVEN',\r\n\t0x0118: 'EXPONDIST',\r\n\t0x0119: 'FDIST',\r\n\t0x011A: 'FINV',\r\n\t0x011B: 'FISHER',\r\n\t0x011C: 'FISHERINV',\r\n\t0x011D: 'FLOOR',\r\n\t0x011E: 'GAMMADIST',\r\n\t0x011F: 'GAMMAINV',\r\n\t0x0120: 'CEILING',\r\n\t0x0121: 'HYPGEOMDIST',\r\n\t0x0122: 'LOGNORMDIST',\r\n\t0x0123: 'LOGINV',\r\n\t0x0124: 'NEGBINOMDIST',\r\n\t0x0125: 'NORMDIST',\r\n\t0x0126: 'NORMSDIST',\r\n\t0x0127: 'NORMINV',\r\n\t0x0128: 'NORMSINV',\r\n\t0x0129: 'STANDARDIZE',\r\n\t0x012A: 'ODD',\r\n\t0x012B: 'PERMUT',\r\n\t0x012C: 'POISSON',\r\n\t0x012D: 'TDIST',\r\n\t0x012E: 'WEIBULL',\r\n\t0x012F: 'SUMXMY2',\r\n\t0x0130: 'SUMX2MY2',\r\n\t0x0131: 'SUMX2PY2',\r\n\t0x0132: 'CHITEST',\r\n\t0x0133: 'CORREL',\r\n\t0x0134: 'COVAR',\r\n\t0x0135: 'FORECAST',\r\n\t0x0136: 'FTEST',\r\n\t0x0137: 'INTERCEPT',\r\n\t0x0138: 'PEARSON',\r\n\t0x0139: 'RSQ',\r\n\t0x013A: 'STEYX',\r\n\t0x013B: 'SLOPE',\r\n\t0x013C: 'TTEST',\r\n\t0x013D: 'PROB',\r\n\t0x013E: 'DEVSQ',\r\n\t0x013F: 'GEOMEAN',\r\n\t0x0140: 'HARMEAN',\r\n\t0x0141: 'SUMSQ',\r\n\t0x0142: 'KURT',\r\n\t0x0143: 'SKEW',\r\n\t0x0144: 'ZTEST',\r\n\t0x0145: 'LARGE',\r\n\t0x0146: 'SMALL',\r\n\t0x0147: 'QUARTILE',\r\n\t0x0148: 'PERCENTILE',\r\n\t0x0149: 'PERCENTRANK',\r\n\t0x014A: 'MODE',\r\n\t0x014B: 'TRIMMEAN',\r\n\t0x014C: 'TINV',\r\n\t0x014E: 'MOVIE.COMMAND',\r\n\t0x014F: 'GET.MOVIE',\r\n\t0x0150: 'CONCATENATE',\r\n\t0x0151: 'POWER',\r\n\t0x0152: 'PIVOT.ADD.DATA',\r\n\t0x0153: 'GET.PIVOT.TABLE',\r\n\t0x0154: 'GET.PIVOT.FIELD',\r\n\t0x0155: 'GET.PIVOT.ITEM',\r\n\t0x0156: 'RADIANS',\r\n\t0x0157: 'DEGREES',\r\n\t0x0158: 'SUBTOTAL',\r\n\t0x0159: 'SUMIF',\r\n\t0x015A: 'COUNTIF',\r\n\t0x015B: 'COUNTBLANK',\r\n\t0x015C: 'SCENARIO.GET',\r\n\t0x015D: 'OPTIONS.LISTS.GET',\r\n\t0x015E: 'ISPMT',\r\n\t0x015F: 'DATEDIF',\r\n\t0x0160: 'DATESTRING',\r\n\t0x0161: 'NUMBERSTRING',\r\n\t0x0162: 'ROMAN',\r\n\t0x0163: 'OPEN.DIALOG',\r\n\t0x0164: 'SAVE.DIALOG',\r\n\t0x0165: 'VIEW.GET',\r\n\t0x0166: 'GETPIVOTDATA',\r\n\t0x0167: 'HYPERLINK',\r\n\t0x0168: 'PHONETIC',\r\n\t0x0169: 'AVERAGEA',\r\n\t0x016A: 'MAXA',\r\n\t0x016B: 'MINA',\r\n\t0x016C: 'STDEVPA',\r\n\t0x016D: 'VARPA',\r\n\t0x016E: 'STDEVA',\r\n\t0x016F: 'VARA',\r\n\t0x0170: 'BAHTTEXT',\r\n\t0x0171: 'THAIDAYOFWEEK',\r\n\t0x0172: 'THAIDIGIT',\r\n\t0x0173: 'THAIMONTHOFYEAR',\r\n\t0x0174: 'THAINUMSOUND',\r\n\t0x0175: 'THAINUMSTRING',\r\n\t0x0176: 'THAISTRINGLENGTH',\r\n\t0x0177: 'ISTHAIDIGIT',\r\n\t0x0178: 'ROUNDBAHTDOWN',\r\n\t0x0179: 'ROUNDBAHTUP',\r\n\t0x017A: 'THAIYEAR',\r\n\t0x017B: 'RTD'\r\n};\r\nvar FtabArgc = {\r\n\t0x0002: 1, /* ISNA */\r\n\t0x0003: 1, /* ISERROR */\r\n\t0x000F: 1, /* SIN */\r\n\t0x0010: 1, /* COS */\r\n\t0x0011: 1, /* TAN */\r\n\t0x0012: 1, /* ATAN */\r\n\t0x0014: 1, /* SQRT */\r\n\t0x0015: 1, /* EXP */\r\n\t0x0016: 1, /* LN */\r\n\t0x0017: 1, /* LOG10 */\r\n\t0x0018: 1, /* ABS */\r\n\t0x0019: 1, /* INT */\r\n\t0x001A: 1, /* SIGN */\r\n\t0x001B: 2, /* ROUND */\r\n\t0x001E: 2, /* REPT */\r\n\t0x001F: 3, /* MID */\r\n\t0x0020: 1, /* LEN */\r\n\t0x0021: 1, /* VALUE */\r\n\t0x0026: 1, /* NOT */\r\n\t0x0027: 2, /* MOD */\r\n\t0x0028: 3, /* DCOUNT */\r\n\t0x0029: 3, /* DSUM */\r\n\t0x002A: 3, /* DAVERAGE */\r\n\t0x002B: 3, /* DMIN */\r\n\t0x002C: 3, /* DMAX */\r\n\t0x002D: 3, /* DSTDEV */\r\n\t0x002F: 3, /* DVAR */\r\n\t0x0030: 2, /* TEXT */\r\n\t0x0035: 1, /* GOTO */\r\n\t0x003D: 3, /* MIRR */\r\n\t0x0041: 3, /* DATE */\r\n\t0x0042: 3, /* TIME */\r\n\t0x0043: 1, /* DAY */\r\n\t0x0044: 1, /* MONTH */\r\n\t0x0045: 1, /* YEAR */\r\n\t0x0047: 1, /* HOUR */\r\n\t0x0048: 1, /* MINUTE */\r\n\t0x0049: 1, /* SECOND */\r\n\t0x004B: 1, /* AREAS */\r\n\t0x004C: 1, /* ROWS */\r\n\t0x004D: 1, /* COLUMNS */\r\n\t0x004F: 2, /* ABSREF */\r\n\t0x0050: 2, /* RELREF */\r\n\t0x0053: 1, /* TRANSPOSE */\r\n\t0x0056: 1, /* TYPE */\r\n\t0x005A: 1, /* DEREF */\r\n\t0x0061: 2, /* ATAN2 */\r\n\t0x0062: 1, /* ASIN */\r\n\t0x0063: 1, /* ACOS */\r\n\t0x0069: 1, /* ISREF */\r\n\t0x006F: 1, /* CHAR */\r\n\t0x0070: 1, /* LOWER */\r\n\t0x0071: 1, /* UPPER */\r\n\t0x0072: 1, /* PROPER */\r\n\t0x0075: 2, /* EXACT */\r\n\t0x0076: 1, /* TRIM */\r\n\t0x0077: 4, /* REPLACE */\r\n\t0x0079: 1, /* CODE */\r\n\t0x007E: 1, /* ISERR */\r\n\t0x007F: 1, /* ISTEXT */\r\n\t0x0080: 1, /* ISNUMBER */\r\n\t0x0081: 1, /* ISBLANK */\r\n\t0x0082: 1, /* T */\r\n\t0x0083: 1, /* N */\r\n\t0x0085: 1, /* FCLOSE */\r\n\t0x0086: 1, /* FSIZE */\r\n\t0x0087: 1, /* FREADLN */\r\n\t0x0088: 2, /* FREAD */\r\n\t0x0089: 2, /* FWRITELN */\r\n\t0x008A: 2, /* FWRITE */\r\n\t0x008C: 1, /* DATEVALUE */\r\n\t0x008D: 1, /* TIMEVALUE */\r\n\t0x008E: 3, /* SLN */\r\n\t0x008F: 4, /* SYD */\r\n\t0x00A2: 1, /* CLEAN */\r\n\t0x00A3: 1, /* MDETERM */\r\n\t0x00A4: 1, /* MINVERSE */\r\n\t0x00A5: 2, /* MMULT */\r\n\t0x00AC: 1, /* WHILE */\r\n\t0x00AF: 2, /* INITIATE */\r\n\t0x00B0: 2, /* REQUEST */\r\n\t0x00B1: 3, /* POKE */\r\n\t0x00B2: 2, /* EXECUTE */\r\n\t0x00B3: 1, /* TERMINATE */\r\n\t0x00B8: 1, /* FACT */\r\n\t0x00BD: 3, /* DPRODUCT */\r\n\t0x00BE: 1, /* ISNONTEXT */\r\n\t0x00C3: 3, /* DSTDEVP */\r\n\t0x00C4: 3, /* DVARP */\r\n\t0x00C6: 1, /* ISLOGICAL */\r\n\t0x00C7: 3, /* DCOUNTA */\r\n\t0x00C9: 1, /* UNREGISTER */\r\n\t0x00CF: 4, /* REPLACEB */\r\n\t0x00D2: 3, /* MIDB */\r\n\t0x00D3: 1, /* LENB */\r\n\t0x00D4: 2, /* ROUNDUP */\r\n\t0x00D5: 2, /* ROUNDDOWN */\r\n\t0x00D6: 1, /* ASC */\r\n\t0x00D7: 1, /* DBCS */\r\n\t0x00E5: 1, /* SINH */\r\n\t0x00E6: 1, /* COSH */\r\n\t0x00E7: 1, /* TANH */\r\n\t0x00E8: 1, /* ASINH */\r\n\t0x00E9: 1, /* ACOSH */\r\n\t0x00EA: 1, /* ATANH */\r\n\t0x00EB: 3, /* DGET */\r\n\t0x00F4: 1, /* INFO */\r\n\t0x00FC: 2, /* FREQUENCY */\r\n\t0x0101: 1, /* EVALUATE */\r\n\t0x0105: 1, /* ERROR.TYPE */\r\n\t0x010F: 1, /* GAMMALN */\r\n\t0x0111: 4, /* BINOMDIST */\r\n\t0x0112: 2, /* CHIDIST */\r\n\t0x0113: 2, /* CHIINV */\r\n\t0x0114: 2, /* COMBIN */\r\n\t0x0115: 3, /* CONFIDENCE */\r\n\t0x0116: 3, /* CRITBINOM */\r\n\t0x0117: 1, /* EVEN */\r\n\t0x0118: 3, /* EXPONDIST */\r\n\t0x0119: 3, /* FDIST */\r\n\t0x011A: 3, /* FINV */\r\n\t0x011B: 1, /* FISHER */\r\n\t0x011C: 1, /* FISHERINV */\r\n\t0x011D: 2, /* FLOOR */\r\n\t0x011E: 4, /* GAMMADIST */\r\n\t0x011F: 3, /* GAMMAINV */\r\n\t0x0120: 2, /* CEILING */\r\n\t0x0121: 4, /* HYPGEOMDIST */\r\n\t0x0122: 3, /* LOGNORMDIST */\r\n\t0x0123: 3, /* LOGINV */\r\n\t0x0124: 3, /* NEGBINOMDIST */\r\n\t0x0125: 4, /* NORMDIST */\r\n\t0x0126: 1, /* NORMSDIST */\r\n\t0x0127: 3, /* NORMINV */\r\n\t0x0128: 1, /* NORMSINV */\r\n\t0x0129: 3, /* STANDARDIZE */\r\n\t0x012A: 1, /* ODD */\r\n\t0x012B: 2, /* PERMUT */\r\n\t0x012C: 3, /* POISSON */\r\n\t0x012D: 3, /* TDIST */\r\n\t0x012E: 4, /* WEIBULL */\r\n\t0x012F: 2, /* SUMXMY2 */\r\n\t0x0130: 2, /* SUMX2MY2 */\r\n\t0x0131: 2, /* SUMX2PY2 */\r\n\t0x0132: 2, /* CHITEST */\r\n\t0x0133: 2, /* CORREL */\r\n\t0x0134: 2, /* COVAR */\r\n\t0x0135: 3, /* FORECAST */\r\n\t0x0136: 2, /* FTEST */\r\n\t0x0137: 2, /* INTERCEPT */\r\n\t0x0138: 2, /* PEARSON */\r\n\t0x0139: 2, /* RSQ */\r\n\t0x013A: 2, /* STEYX */\r\n\t0x013B: 2, /* SLOPE */\r\n\t0x013C: 4, /* TTEST */\r\n\t0x0145: 2, /* LARGE */\r\n\t0x0146: 2, /* SMALL */\r\n\t0x0147: 2, /* QUARTILE */\r\n\t0x0148: 2, /* PERCENTILE */\r\n\t0x014B: 2, /* TRIMMEAN */\r\n\t0x014C: 2, /* TINV */\r\n\t0x0151: 2, /* POWER */\r\n\t0x0156: 1, /* RADIANS */\r\n\t0x0157: 1, /* DEGREES */\r\n\t0x015A: 2, /* COUNTIF */\r\n\t0x015B: 1, /* COUNTBLANK */\r\n\t0x015E: 4, /* ISPMT */\r\n\t0x015F: 3, /* DATEDIF */\r\n\t0x0160: 1, /* DATESTRING */\r\n\t0x0161: 2, /* NUMBERSTRING */\r\n\t0x0168: 1, /* PHONETIC */\r\n\t0x0170: 1, /* BAHTTEXT */\r\n\t0x0171: 1, /* THAIDAYOFWEEK */\r\n\t0x0172: 1, /* THAIDIGIT */\r\n\t0x0173: 1, /* THAIMONTHOFYEAR */\r\n\t0x0174: 1, /* THAINUMSOUND */\r\n\t0x0175: 1, /* THAINUMSTRING */\r\n\t0x0176: 1, /* THAISTRINGLENGTH */\r\n\t0x0177: 1, /* ISTHAIDIGIT */\r\n\t0x0178: 1, /* ROUNDBAHTDOWN */\r\n\t0x0179: 1, /* ROUNDBAHTUP */\r\n\t0x017A: 1, /* THAIYEAR */\r\n\t0xFFFF: 0\r\n};\r\n/* [MS-XLSX] 2.2.3 Functions */\r\nvar XLSXFutureFunctions = {\r\n\t\"_xlfn.ACOT\": \"ACOT\",\r\n\t\"_xlfn.ACOTH\": \"ACOTH\",\r\n\t\"_xlfn.AGGREGATE\": \"AGGREGATE\",\r\n\t\"_xlfn.ARABIC\": \"ARABIC\",\r\n\t\"_xlfn.AVERAGEIF\": \"AVERAGEIF\",\r\n\t\"_xlfn.AVERAGEIFS\": \"AVERAGEIFS\",\r\n\t\"_xlfn.BASE\": \"BASE\",\r\n\t\"_xlfn.BETA.DIST\": \"BETA.DIST\",\r\n\t\"_xlfn.BETA.INV\": \"BETA.INV\",\r\n\t\"_xlfn.BINOM.DIST\": \"BINOM.DIST\",\r\n\t\"_xlfn.BINOM.DIST.RANGE\": \"BINOM.DIST.RANGE\",\r\n\t\"_xlfn.BINOM.INV\": \"BINOM.INV\",\r\n\t\"_xlfn.BITAND\": \"BITAND\",\r\n\t\"_xlfn.BITLSHIFT\": \"BITLSHIFT\",\r\n\t\"_xlfn.BITOR\": \"BITOR\",\r\n\t\"_xlfn.BITRSHIFT\": \"BITRSHIFT\",\r\n\t\"_xlfn.BITXOR\": \"BITXOR\",\r\n\t\"_xlfn.CEILING.MATH\": \"CEILING.MATH\",\r\n\t\"_xlfn.CEILING.PRECISE\": \"CEILING.PRECISE\",\r\n\t\"_xlfn.CHISQ.DIST\": \"CHISQ.DIST\",\r\n\t\"_xlfn.CHISQ.DIST.RT\": \"CHISQ.DIST.RT\",\r\n\t\"_xlfn.CHISQ.INV\": \"CHISQ.INV\",\r\n\t\"_xlfn.CHISQ.INV.RT\": \"CHISQ.INV.RT\",\r\n\t\"_xlfn.CHISQ.TEST\": \"CHISQ.TEST\",\r\n\t\"_xlfn.COMBINA\": \"COMBINA\",\r\n\t\"_xlfn.CONFIDENCE.NORM\": \"CONFIDENCE.NORM\",\r\n\t\"_xlfn.CONFIDENCE.T\": \"CONFIDENCE.T\",\r\n\t\"_xlfn.COT\": \"COT\",\r\n\t\"_xlfn.COTH\": \"COTH\",\r\n\t\"_xlfn.COUNTIFS\": \"COUNTIFS\",\r\n\t\"_xlfn.COVARIANCE.P\": \"COVARIANCE.P\",\r\n\t\"_xlfn.COVARIANCE.S\": \"COVARIANCE.S\",\r\n\t\"_xlfn.CSC\": \"CSC\",\r\n\t\"_xlfn.CSCH\": \"CSCH\",\r\n\t\"_xlfn.DAYS\": \"DAYS\",\r\n\t\"_xlfn.DECIMAL\": \"DECIMAL\",\r\n\t\"_xlfn.ECMA.CEILING\": \"ECMA.CEILING\",\r\n\t\"_xlfn.ERF.PRECISE\": \"ERF.PRECISE\",\r\n\t\"_xlfn.ERFC.PRECISE\": \"ERFC.PRECISE\",\r\n\t\"_xlfn.EXPON.DIST\": \"EXPON.DIST\",\r\n\t\"_xlfn.F.DIST\": \"F.DIST\",\r\n\t\"_xlfn.F.DIST.RT\": \"F.DIST.RT\",\r\n\t\"_xlfn.F.INV\": \"F.INV\",\r\n\t\"_xlfn.F.INV.RT\": \"F.INV.RT\",\r\n\t\"_xlfn.F.TEST\": \"F.TEST\",\r\n\t\"_xlfn.FILTERXML\": \"FILTERXML\",\r\n\t\"_xlfn.FLOOR.MATH\": \"FLOOR.MATH\",\r\n\t\"_xlfn.FLOOR.PRECISE\": \"FLOOR.PRECISE\",\r\n\t\"_xlfn.FORMULATEXT\": \"FORMULATEXT\",\r\n\t\"_xlfn.GAMMA\": \"GAMMA\",\r\n\t\"_xlfn.GAMMA.DIST\": \"GAMMA.DIST\",\r\n\t\"_xlfn.GAMMA.INV\": \"GAMMA.INV\",\r\n\t\"_xlfn.GAMMALN.PRECISE\": \"GAMMALN.PRECISE\",\r\n\t\"_xlfn.GAUSS\": \"GAUSS\",\r\n\t\"_xlfn.HYPGEOM.DIST\": \"HYPGEOM.DIST\",\r\n\t\"_xlfn.IFNA\": \"IFNA\",\r\n\t\"_xlfn.IFERROR\": \"IFERROR\",\r\n\t\"_xlfn.IMCOSH\": \"IMCOSH\",\r\n\t\"_xlfn.IMCOT\": \"IMCOT\",\r\n\t\"_xlfn.IMCSC\": \"IMCSC\",\r\n\t\"_xlfn.IMCSCH\": \"IMCSCH\",\r\n\t\"_xlfn.IMSEC\": \"IMSEC\",\r\n\t\"_xlfn.IMSECH\": \"IMSECH\",\r\n\t\"_xlfn.IMSINH\": \"IMSINH\",\r\n\t\"_xlfn.IMTAN\": \"IMTAN\",\r\n\t\"_xlfn.ISFORMULA\": \"ISFORMULA\",\r\n\t\"_xlfn.ISO.CEILING\": \"ISO.CEILING\",\r\n\t\"_xlfn.ISOWEEKNUM\": \"ISOWEEKNUM\",\r\n\t\"_xlfn.LOGNORM.DIST\": \"LOGNORM.DIST\",\r\n\t\"_xlfn.LOGNORM.INV\": \"LOGNORM.INV\",\r\n\t\"_xlfn.MODE.MULT\": \"MODE.MULT\",\r\n\t\"_xlfn.MODE.SNGL\": \"MODE.SNGL\",\r\n\t\"_xlfn.MUNIT\": \"MUNIT\",\r\n\t\"_xlfn.NEGBINOM.DIST\": \"NEGBINOM.DIST\",\r\n\t\"_xlfn.NETWORKDAYS.INTL\": \"NETWORKDAYS.INTL\",\r\n\t\"_xlfn.NIGBINOM\": \"NIGBINOM\",\r\n\t\"_xlfn.NORM.DIST\": \"NORM.DIST\",\r\n\t\"_xlfn.NORM.INV\": \"NORM.INV\",\r\n\t\"_xlfn.NORM.S.DIST\": \"NORM.S.DIST\",\r\n\t\"_xlfn.NORM.S.INV\": \"NORM.S.INV\",\r\n\t\"_xlfn.NUMBERVALUE\": \"NUMBERVALUE\",\r\n\t\"_xlfn.PDURATION\": \"PDURATION\",\r\n\t\"_xlfn.PERCENTILE.EXC\": \"PERCENTILE.EXC\",\r\n\t\"_xlfn.PERCENTILE.INC\": \"PERCENTILE.INC\",\r\n\t\"_xlfn.PERCENTRANK.EXC\": \"PERCENTRANK.EXC\",\r\n\t\"_xlfn.PERCENTRANK.INC\": \"PERCENTRANK.INC\",\r\n\t\"_xlfn.PERMUTATIONA\": \"PERMUTATIONA\",\r\n\t\"_xlfn.PHI\": \"PHI\",\r\n\t\"_xlfn.POISSON.DIST\": \"POISSON.DIST\",\r\n\t\"_xlfn.QUARTILE.EXC\": \"QUARTILE.EXC\",\r\n\t\"_xlfn.QUARTILE.INC\": \"QUARTILE.INC\",\r\n\t\"_xlfn.QUERYSTRING\": \"QUERYSTRING\",\r\n\t\"_xlfn.RANK.AVG\": \"RANK.AVG\",\r\n\t\"_xlfn.RANK.EQ\": \"RANK.EQ\",\r\n\t\"_xlfn.RRI\": \"RRI\",\r\n\t\"_xlfn.SEC\": \"SEC\",\r\n\t\"_xlfn.SECH\": \"SECH\",\r\n\t\"_xlfn.SHEET\": \"SHEET\",\r\n\t\"_xlfn.SHEETS\": \"SHEETS\",\r\n\t\"_xlfn.SKEW.P\": \"SKEW.P\",\r\n\t\"_xlfn.STDEV.P\": \"STDEV.P\",\r\n\t\"_xlfn.STDEV.S\": \"STDEV.S\",\r\n\t\"_xlfn.SUMIFS\": \"SUMIFS\",\r\n\t\"_xlfn.T.DIST\": \"T.DIST\",\r\n\t\"_xlfn.T.DIST.2T\": \"T.DIST.2T\",\r\n\t\"_xlfn.T.DIST.RT\": \"T.DIST.RT\",\r\n\t\"_xlfn.T.INV\": \"T.INV\",\r\n\t\"_xlfn.T.INV.2T\": \"T.INV.2T\",\r\n\t\"_xlfn.T.TEST\": \"T.TEST\",\r\n\t\"_xlfn.UNICHAR\": \"UNICHAR\",\r\n\t\"_xlfn.UNICODE\": \"UNICODE\",\r\n\t\"_xlfn.VAR.P\": \"VAR.P\",\r\n\t\"_xlfn.VAR.S\": \"VAR.S\",\r\n\t\"_xlfn.WEBSERVICE\": \"WEBSERVICE\",\r\n\t\"_xlfn.WEIBULL.DIST\": \"WEIBULL.DIST\",\r\n\t\"_xlfn.WORKDAY.INTL\": \"WORKDAY.INTL\",\r\n\t\"_xlfn.XOR\": \"XOR\",\r\n\t\"_xlfn.Z.TEST\": \"Z.TEST\"\r\n};\r\n\r\nvar strs = {}; // shared strings\r\nvar _ssfopts = {}; // spreadsheet formatting options\r\n\r\nRELS.WS = \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet\";\r\n\r\nfunction get_sst_id(sst, str) {\r\n\tfor(var i = 0, len = sst.length; i < len; ++i) if(sst[i].t === str) { sst.Count ++; return i; }\r\n\tsst[len] = {t:str}; sst.Count ++; sst.Unique ++; return len;\r\n}\r\n\r\nfunction get_cell_style(styles, cell, opts) {\r\n  if (typeof style_builder != 'undefined') {\r\n    if (/^\\d+$/.exec(cell.s)) { return cell.s}  // if its already an integer index, let it be\r\n    if (cell.s && (cell.s == +cell.s)) { return cell.s}  // if its already an integer index, let it be\r\n    var s = cell.s || {};\r\n    if (cell.z) s.numFmt = cell.z;\r\n    return style_builder.addStyle(s);\r\n  }\r\n  else {\r\n    var z = opts.revssf[cell.z != null ? cell.z : \"General\"];\r\n    for(var i = 0, len = styles.length; i != len; ++i) if(styles[i].numFmtId === z) return i;\r\n    styles[len] = {\r\n      numFmtId:z,\r\n      fontId:0,\r\n      fillId:0,\r\n      borderId:0,\r\n      xfId:0,\r\n      applyNumberFormat:1\r\n    };\r\n    return len;\r\n  }\r\n}\r\n\r\nfunction get_cell_style_csf(cellXf) {\r\n\r\n  if (cellXf) {\r\n\r\n    var s = {}\r\n\r\n    if (typeof cellXf.numFmtId != undefined)  {\r\n      s.numFmt = SSF._table[cellXf.numFmtId];\r\n    }\r\n\r\n    if(cellXf.fillId)  {\r\n      s.fill =  styles.Fills[cellXf.fillId];\r\n    }\r\n\r\n    if (cellXf.fontId) {\r\n      s.font = styles.Fonts[cellXf.fontId];\r\n    }\r\n    if (cellXf.borderId) {\r\n      s.border = styles.Borders[cellXf.borderId];\r\n    }\r\n    if (cellXf.applyAlignment==1) {\r\n      s.alignment = cellXf.alignment;\r\n    }\r\n\r\n\r\n    return JSON.parse(JSON.stringify(s));\r\n  }\r\n  return null;\r\n}\r\n\r\nfunction safe_format(p, fmtid, fillid, opts) {\r\n\ttry {\r\n\t\tif(p.t === 'e') p.w = p.w || BErr[p.v];\r\n\t\telse if(fmtid === 0) {\r\n\t\t\tif(p.t === 'n') {\r\n\t\t\t\tif((p.v|0) === p.v) p.w = SSF._general_int(p.v,_ssfopts);\r\n\t\t\t\telse p.w = SSF._general_num(p.v,_ssfopts);\r\n\t\t\t}\r\n\t\t\telse if(p.t === 'd') {\r\n\t\t\t\tvar dd = datenum(p.v);\r\n\t\t\t\tif((dd|0) === dd) p.w = SSF._general_int(dd,_ssfopts);\r\n\t\t\t\telse p.w = SSF._general_num(dd,_ssfopts);\r\n\t\t\t}\r\n\t\t\telse if(p.v === undefined) return \"\";\r\n\t\t\telse p.w = SSF._general(p.v,_ssfopts);\r\n\t\t}\r\n\t\telse if(p.t === 'd') p.w = SSF.format(fmtid,datenum(p.v),_ssfopts);\r\n\t\telse p.w = SSF.format(fmtid,p.v,_ssfopts);\r\n\t\tif(opts.cellNF) p.z = SSF._table[fmtid];\r\n\t} catch(e) { if(opts.WTF) throw e; }\r\n}\r\nfunction parse_ws_xml_dim(ws, s) {\r\n  var d = safe_decode_range(s);\r\n  if (d.s.r <= d.e.r && d.s.c <= d.e.c && d.s.r >= 0 && d.s.c >= 0) ws[\"!ref\"] = encode_range(d);\r\n}\r\nvar mergecregex = /<mergeCell ref=\"[A-Z0-9:]+\"\\s*\\/>/g;\r\nvar sheetdataregex = /<(?:\\w+:)?sheetData>([^\\u2603]*)<\\/(?:\\w+:)?sheetData>/;\r\nvar hlinkregex = /<hyperlink[^>]*\\/>/g;\r\nvar dimregex = /\"(\\w*:\\w*)\"/;\r\nvar colregex = /<col[^>]*\\/>/g;\r\n/* 18.3 Worksheets */\r\nfunction parse_ws_xml(data, opts, rels) {\r\n  if (!data) return data;\r\n  /* 18.3.1.99 worksheet CT_Worksheet */\r\n  var s = {};\r\n\r\n  /* 18.3.1.35 dimension CT_SheetDimension ? */\r\n  var ridx = data.indexOf(\"<dimension\");\r\n  if (ridx > 0) {\r\n    var ref = data.substr(ridx, 50).match(dimregex);\r\n    if (ref != null) parse_ws_xml_dim(s, ref[1]);\r\n  }\r\n\r\n  /* 18.3.1.55 mergeCells CT_MergeCells */\r\n  var mergecells = [];\r\n  if (data.indexOf(\"</mergeCells>\") !== -1) {\r\n    var merges = data.match(mergecregex);\r\n    for (ridx = 0; ridx != merges.length; ++ridx)\r\n      mergecells[ridx] = safe_decode_range(merges[ridx].substr(merges[ridx].indexOf(\"\\\"\") + 1));\r\n  }\r\n\r\n  /* 18.3.1.17 cols CT_Cols */\r\n  var columns = [];\r\n  if (opts.cellStyles && data.indexOf(\"</cols>\") !== -1) {\r\n    /* 18.3.1.13 col CT_Col */\r\n    var cols = data.match(colregex);\r\n    parse_ws_xml_cols(columns, cols);\r\n  }\r\n\r\n  var refguess = {s: {r: 1000000, c: 1000000}, e: {r: 0, c: 0}};\r\n\r\n  /* 18.3.1.80 sheetData CT_SheetData ? */\r\n  var mtch = data.match(sheetdataregex);\r\n  if (mtch) parse_ws_xml_data(mtch[1], s, opts, refguess);\r\n\r\n  /* 18.3.1.48 hyperlinks CT_Hyperlinks */\r\n  if (data.indexOf(\"</hyperlinks>\") !== -1) parse_ws_xml_hlinks(s, data.match(hlinkregex), rels);\r\n\r\n  if (!s[\"!ref\"] && refguess.e.c >= refguess.s.c && refguess.e.r >= refguess.s.r) s[\"!ref\"] = encode_range(refguess);\r\n  if (opts.sheetRows > 0 && s[\"!ref\"]) {\r\n    var tmpref = safe_decode_range(s[\"!ref\"]);\r\n    if (opts.sheetRows < +tmpref.e.r) {\r\n      tmpref.e.r = opts.sheetRows - 1;\r\n      if (tmpref.e.r > refguess.e.r) tmpref.e.r = refguess.e.r;\r\n      if (tmpref.e.r < tmpref.s.r) tmpref.s.r = tmpref.e.r;\r\n      if (tmpref.e.c > refguess.e.c) tmpref.e.c = refguess.e.c;\r\n      if (tmpref.e.c < tmpref.s.c) tmpref.s.c = tmpref.e.c;\r\n      s[\"!fullref\"] = s[\"!ref\"];\r\n      s[\"!ref\"] = encode_range(tmpref);\r\n    }\r\n  }\r\n  if (mergecells.length > 0) s[\"!merges\"] = mergecells;\r\n  if (columns.length > 0) s[\"!cols\"] = columns;\r\n  return s;\r\n}\r\n\r\nfunction write_ws_xml_merges(merges) {\r\n  if (merges.length == 0) return \"\";\r\n  var o = '<mergeCells count=\"' + merges.length + '\">';\r\n  for (var i = 0; i != merges.length; ++i) o += '<mergeCell ref=\"' + encode_range(merges[i]) + '\"/>';\r\n  return o + '</mergeCells>';\r\n}\r\n\r\nfunction write_ws_xml_pagesetup(setup) {\r\n  var pageSetup = writextag('pageSetup', null, {\r\n    scale: setup.scale || '100',\r\n    orientation: setup.orientation || 'portrait',\r\n    horizontalDpi: setup.horizontalDpi || '4294967292',\r\n    verticalDpi: setup.verticalDpi || '4294967292'\r\n  })\r\n  return pageSetup;\r\n}\r\n\r\n\r\nfunction parse_ws_xml_hlinks(s, data, rels) {\r\n  for (var i = 0; i != data.length; ++i) {\r\n    var val = parsexmltag(data[i], true);\r\n    if (!val.ref) return;\r\n    var rel = rels ? rels['!id'][val.id] : null;\r\n    if (rel) {\r\n      val.Target = rel.Target;\r\n      if (val.location) val.Target += \"#\" + val.location;\r\n      val.Rel = rel;\r\n    } else {\r\n      val.Target = val.location;\r\n      rel = {Target: val.location, TargetMode: 'Internal'};\r\n      val.Rel = rel;\r\n    }\r\n    var rng = safe_decode_range(val.ref);\r\n    for (var R = rng.s.r; R <= rng.e.r; ++R) for (var C = rng.s.c; C <= rng.e.c; ++C) {\r\n      var addr = encode_cell({c: C, r: R});\r\n      if (!s[addr]) s[addr] = {t: \"stub\", v: undefined};\r\n      s[addr].l = val;\r\n    }\r\n  }\r\n}\r\n\r\nfunction parse_ws_xml_cols(columns, cols) {\r\n  var seencol = false;\r\n  for (var coli = 0; coli != cols.length; ++coli) {\r\n    var coll = parsexmltag(cols[coli], true);\r\n    var colm = parseInt(coll.min, 10) - 1, colM = parseInt(coll.max, 10) - 1;\r\n    delete coll.min;\r\n    delete coll.max;\r\n    if (!seencol && coll.width) {\r\n      seencol = true;\r\n      find_mdw(+coll.width, coll);\r\n    }\r\n    if (coll.width) {\r\n      coll.wpx = width2px(+coll.width);\r\n      coll.wch = px2char(coll.wpx);\r\n      coll.MDW = MDW;\r\n    }\r\n    while (colm <= colM) columns[colm++] = coll;\r\n  }\r\n}\r\n\r\nfunction write_ws_xml_cols(ws, cols) {\r\n  var o = [\"<cols>\"], col, width;\r\n  for (var i = 0; i != cols.length; ++i) {\r\n    if (!(col = cols[i])) continue;\r\n    var p = {min: i + 1, max: i + 1};\r\n    /* wch (chars), wpx (pixels) */\r\n    width = -1;\r\n    if (col.wpx) width = px2char(col.wpx);\r\n    else if (col.wch) width = col.wch;\r\n    if (width > -1) {\r\n      p.width = char2width(width);\r\n      p.customWidth = 1;\r\n    }\r\n    o[o.length] = (writextag('col', null, p));\r\n  }\r\n  o[o.length] = \"</cols>\";\r\n  return o.join(\"\");\r\n}\r\n\r\nfunction write_ws_xml_cell(cell, ref, ws, opts, idx, wb) {\r\n  if (cell.v === undefined && cell.s === undefined) return \"\";\r\n  var vv = \"\";\r\n  var oldt = cell.t, oldv = cell.v;\r\n  switch (cell.t) {\r\n    case 'b':\r\n      vv = cell.v ? \"1\" : \"0\";\r\n      break;\r\n    case 'n':\r\n      vv = '' + cell.v;\r\n      break;\r\n    case 'e':\r\n      vv = BErr[cell.v];\r\n      break;\r\n    case 'd':\r\n      if (opts.cellDates) vv = new Date(cell.v).toISOString();\r\n      else {\r\n        cell.t = 'n';\r\n        vv = '' + (cell.v = datenum(cell.v));\r\n        if (typeof cell.z === 'undefined') cell.z = SSF._table[14];\r\n      }\r\n      break;\r\n    default:\r\n      vv = cell.v;\r\n      break;\r\n  }\r\n  var v = writetag('v', escapexml(vv)), o = {r: ref};\r\n  /* TODO: cell style */\r\n  var os = get_cell_style(opts.cellXfs, cell, opts);\r\n  if (os !== 0) o.s = os;\r\n  switch (cell.t) {\r\n    case 'n':\r\n      break;\r\n    case 'd':\r\n      o.t = \"d\";\r\n      break;\r\n    case 'b':\r\n      o.t = \"b\";\r\n      break;\r\n    case 'e':\r\n      o.t = \"e\";\r\n      break;\r\n    default:\r\n      if (opts.bookSST) {\r\n        v = writetag('v', '' + get_sst_id(opts.Strings, cell.v));\r\n        o.t = \"s\";\r\n        break;\r\n      }\r\n      o.t = \"str\";\r\n      break;\r\n  }\r\n  if (cell.t != oldt) {\r\n    cell.t = oldt;\r\n    cell.v = oldv;\r\n  }\r\n  return writextag('c', v, o);\r\n}\r\n\r\nvar parse_ws_xml_data = (function parse_ws_xml_data_factory() {\r\n  var cellregex = /<(?:\\w+:)?c[ >]/, rowregex = /<\\/(?:\\w+:)?row>/;\r\n  var rregex = /r=[\"']([^\"']*)[\"']/, isregex = /<is>([\\S\\s]*?)<\\/is>/;\r\n  var match_v = matchtag(\"v\"), match_f = matchtag(\"f\");\r\n\r\n  return function parse_ws_xml_data(sdata, s, opts, guess) {\r\n    var ri = 0, x = \"\", cells = [], cref = [], idx = 0, i = 0, cc = 0, d = \"\", p;\r\n    var tag, tagr = 0, tagc = 0;\r\n    var sstr;\r\n    var fmtid = 0, fillid = 0, do_format = Array.isArray(styles.CellXf), cf;\r\n    for (var marr = sdata.split(rowregex), mt = 0, marrlen = marr.length; mt != marrlen; ++mt) {\r\n      x = marr[mt].trim();\r\n      var xlen = x.length;\r\n      if (xlen === 0) continue;\r\n\r\n      /* 18.3.1.73 row CT_Row */\r\n      for (ri = 0; ri < xlen; ++ri) if (x.charCodeAt(ri) === 62) break;\r\n      ++ri;\r\n      tag = parsexmltag(x.substr(0, ri), true);\r\n      /* SpreadSheetGear uses implicit r/c */\r\n      tagr = typeof tag.r !== 'undefined' ? parseInt(tag.r, 10) : tagr + 1;\r\n      tagc = -1;\r\n      if (opts.sheetRows && opts.sheetRows < tagr) continue;\r\n      if (guess.s.r > tagr - 1) guess.s.r = tagr - 1;\r\n      if (guess.e.r < tagr - 1) guess.e.r = tagr - 1;\r\n\r\n      /* 18.3.1.4 c CT_Cell */\r\n      cells = x.substr(ri).split(cellregex);\r\n      for (ri = typeof tag.r === 'undefined' ? 0 : 1; ri != cells.length; ++ri) {\r\n        x = cells[ri].trim();\r\n        if (x.length === 0) continue;\r\n        cref = x.match(rregex);\r\n        idx = ri;\r\n        i = 0;\r\n        cc = 0;\r\n        x = \"<c \" + (x.substr(0, 1) == \"<\" ? \">\" : \"\") + x;\r\n        if (cref !== null && cref.length === 2) {\r\n          idx = 0;\r\n          d = cref[1];\r\n          for (i = 0; i != d.length; ++i) {\r\n            if ((cc = d.charCodeAt(i) - 64) < 1 || cc > 26) break;\r\n            idx = 26 * idx + cc;\r\n          }\r\n          --idx;\r\n          tagc = idx;\r\n        } else ++tagc;\r\n        for (i = 0; i != x.length; ++i) if (x.charCodeAt(i) === 62) break;\r\n        ++i;\r\n        tag = parsexmltag(x.substr(0, i), true);\r\n        if (!tag.r) tag.r = utils.encode_cell({r: tagr - 1, c: tagc});\r\n        d = x.substr(i);\r\n        p = {t: \"\"};\r\n\r\n        if ((cref = d.match(match_v)) !== null && cref[1] !== '') p.v = unescapexml(cref[1]);\r\n        if (opts.cellFormula && (cref = d.match(match_f)) !== null) p.f = unescapexml(cref[1]);\r\n\r\n        /* SCHEMA IS ACTUALLY INCORRECT HERE.  IF A CELL HAS NO T, EMIT \"\" */\r\n        if (tag.t === undefined && tag.s === undefined && p.v === undefined) {\r\n          if (!opts.sheetStubs) continue;\r\n          p.t = \"stub\";\r\n        }\r\n        else p.t = tag.t || \"n\";\r\n        if (guess.s.c > idx) guess.s.c = idx;\r\n        if (guess.e.c < idx) guess.e.c = idx;\r\n        /* 18.18.11 t ST_CellType */\r\n        switch (p.t) {\r\n          case 'n':\r\n            p.v = parseFloat(p.v);\r\n            if (isNaN(p.v)) p.v = \"\" // we don't want NaN if p.v is null\r\n            break;\r\n          case 's':\r\n            // if (!p.hasOwnProperty('v')) continue;\r\n            sstr = strs[parseInt(p.v, 10)];\r\n            p.v = sstr.t;\r\n            p.r = sstr.r;\r\n            if (opts.cellHTML) p.h = sstr.h;\r\n            break;\r\n          case 'str':\r\n            p.t = \"s\";\r\n            p.v = (p.v != null) ? utf8read(p.v) : '';\r\n            if (opts.cellHTML) p.h = p.v;\r\n            break;\r\n          case 'inlineStr':\r\n            cref = d.match(isregex);\r\n            p.t = 's';\r\n            if (cref !== null) {\r\n              sstr = parse_si(cref[1]);\r\n              p.v = sstr.t;\r\n            } else p.v = \"\";\r\n            break; // inline string\r\n          case 'b':\r\n            p.v = parsexmlbool(p.v);\r\n            break;\r\n          case 'd':\r\n            if (!opts.cellDates) {\r\n              p.v = datenum(p.v);\r\n              p.t = 'n';\r\n            }\r\n            break;\r\n            /* error string in .v, number in .v */\r\n          case 'e':\r\n            p.w = p.v;\r\n            p.v = RBErr[p.v];\r\n            break;\r\n        }\r\n        /* formatting */\r\n        fmtid = fillid = 0;\r\n        if (do_format && tag.s !== undefined) {\r\n          cf = styles.CellXf[tag.s];\r\n          if (opts.cellStyles) {\r\n            p.s = get_cell_style_csf(cf)\r\n          }\r\n          if (cf != null) {\r\n            if (cf.numFmtId != null) fmtid = cf.numFmtId;\r\n            if (opts.cellStyles && cf.fillId != null) fillid = cf.fillId;\r\n          }\r\n        }\r\n        safe_format(p, fmtid, fillid, opts);\r\n        s[tag.r] = p;\r\n      }\r\n    }\r\n  };\r\n})();\r\n\r\nfunction write_ws_xml_data(ws, opts, idx, wb) {\r\n  var o = [], r = [], range = safe_decode_range(ws['!ref']), cell, ref, rr = \"\", cols = [], R, C;\r\n  for (C = range.s.c; C <= range.e.c; ++C) cols[C] = encode_col(C);\r\n  for (R = range.s.r; R <= range.e.r; ++R) {\r\n    r = [];\r\n    rr = encode_row(R);\r\n    for (C = range.s.c; C <= range.e.c; ++C) {\r\n      ref = cols[C] + rr;\r\n      if (ws[ref] === undefined) continue;\r\n      if ((cell = write_ws_xml_cell(ws[ref], ref, ws, opts, idx, wb)) != null) r.push(cell);\r\n    }\r\n    if (r.length > 0) o[o.length] = (writextag('row', r.join(\"\"), {r: rr}));\r\n  }\r\n  return o.join(\"\");\r\n}\r\n\r\nvar WS_XML_ROOT = writextag('worksheet', null, {\r\n  'xmlns': XMLNS.main[0],\r\n  'xmlns:r': XMLNS.r\r\n});\r\n\r\nfunction write_ws_xml(idx, opts, wb) {\r\n  var o = [XML_HEADER, WS_XML_ROOT];\r\n  var s = wb.SheetNames[idx], sidx = 0, rdata = \"\";\r\n  var ws = wb.Sheets[s];\r\n  if (ws === undefined) ws = {};\r\n  var ref = ws['!ref'];\r\n  if (ref === undefined) ref = 'A1';\r\n  o[o.length] = (writextag('dimension', null, {'ref': ref}));\r\n\r\n  var kids = [];\r\n  if (ws['!freeze']) {\r\n    var pane = '';\r\n    pane = writextag('pane', null, ws['!freeze'])\r\n    kids.push(pane)\r\n\r\n    var selection = writextag('selection', null, {\r\n      pane: \"topLeft\"\r\n    })\r\n    kids.push(selection)\r\n\r\n    var selection = writextag('selection', null, {\r\n      pane: \"bottomLeft\"\r\n    })\r\n    kids.push(selection)\r\n\r\n    var selection = writextag('selection', null, {\r\n      pane: \"bottomRight\",\r\n      activeCell: ws['!freeze'],\r\n      sqref: ws['!freeze']\r\n    })\r\n    kids.push(selection)\r\n  }\r\n\r\n\r\n//<selection pane=\"bottomRight\" activeCell=\"A4\" sqref=\"A4\"/>\r\n\r\n  var sheetView = writextag('sheetView', kids.join('') || undefined, {\r\n    showGridLines: opts.showGridLines == false ? '0' : '1',\r\n    tabSelected: opts.tabSelected === undefined ? '0' : opts.tabSelected,  // see issue #26, need to set WorkbookViews if this is set\r\n    workbookViewId: opts.workbookViewId === undefined ? '0' : opts.workbookViewId\r\n  });\r\n  o[o.length] = writextag('sheetViews', sheetView);\r\n\r\n  if (ws['!cols'] !== undefined && ws['!cols'].length > 0) o[o.length] = (write_ws_xml_cols(ws, ws['!cols']));\r\n  o[sidx = o.length] = '<sheetData/>';\r\n  if (ws['!ref'] !== undefined) {\r\n    rdata = write_ws_xml_data(ws, opts, idx, wb);\r\n    if (rdata.length > 0) o[o.length] = (rdata);\r\n  }\r\n  if (o.length > sidx + 1) {\r\n    o[o.length] = ('</sheetData>');\r\n    o[sidx] = o[sidx].replace(\"/>\", \">\");\r\n  }\r\n\r\n  if (ws['!merges'] !== undefined && ws['!merges'].length > 0) o[o.length] = (write_ws_xml_merges(ws['!merges']));\r\n\r\n  if (ws['!pageSetup'] !== undefined) o[o.length] = write_ws_xml_pagesetup(ws['!pageSetup']);\r\n  if (ws['!rowBreaks'] !== undefined) o[o.length] = write_ws_xml_row_breaks(ws['!rowBreaks']);\r\n  if (ws['!colBreaks'] !== undefined) o[o.length] = write_ws_xml_col_breaks(ws['!colBreaks']);\r\n\r\n  if (o.length > 2) {\r\n    o[o.length] = ('</worksheet>');\r\n    o[1] = o[1].replace(\"/>\", \">\");\r\n  }\r\n  return o.join(\"\");\r\n}\r\n\r\nfunction write_ws_xml_row_breaks(breaks) {\r\n  var brk = [];\r\n  for (var i = 0; i < breaks.length; i++) {\r\n    var thisBreak = '' + (breaks[i]);\r\n    var nextBreak = '' + (breaks[i + 1] || '16383');\r\n    brk.push(writextag('brk', null, {id: thisBreak, max: nextBreak, man: '1'}))\r\n  }\r\n  return writextag('rowBreaks', brk.join(' '), {count: brk.length, manualBreakCount: brk.length})\r\n}\r\nfunction write_ws_xml_col_breaks(breaks) {\r\n  var brk = [];\r\n  for (var i = 0; i < breaks.length; i++) {\r\n    var thisBreak = '' + (breaks[i]);\r\n    var nextBreak = '' + (breaks[i + 1] || '1048575');\r\n    brk.push(writextag('brk', null, {id: thisBreak, max: nextBreak, man: '1'}))\r\n  }\r\n  return writextag('colBreaks', brk.join(' '), {count: brk.length, manualBreakCount: brk.length})\r\n}\r\n\r\n/* [MS-XLSB] 2.4.718 BrtRowHdr */\r\nfunction parse_BrtRowHdr(data, length) {\r\n\tvar z = [];\r\n\tz.r = data.read_shift(4);\r\n\tdata.l += length-4;\r\n\treturn z;\r\n}\r\n\r\n/* [MS-XLSB] 2.4.812 BrtWsDim */\r\nvar parse_BrtWsDim = parse_UncheckedRfX;\r\nvar write_BrtWsDim = write_UncheckedRfX;\r\n\r\n/* [MS-XLSB] 2.4.815 BrtWsProp */\r\nfunction parse_BrtWsProp(data, length) {\r\n\tvar z = {};\r\n\t/* TODO: pull flags */\r\n\tdata.l += 19;\r\n\tz.name = parse_XLSBCodeName(data, length - 19);\r\n\treturn z;\r\n}\r\n\r\n/* [MS-XLSB] 2.4.303 BrtCellBlank */\r\nfunction parse_BrtCellBlank(data, length) {\r\n\tvar cell = parse_XLSBCell(data);\r\n\treturn [cell];\r\n}\r\nfunction write_BrtCellBlank(cell, val, o) {\r\n\tif(o == null) o = new_buf(8);\r\n\treturn write_XLSBCell(val, o);\r\n}\r\n\r\n\r\n/* [MS-XLSB] 2.4.304 BrtCellBool */\r\nfunction parse_BrtCellBool(data, length) {\r\n\tvar cell = parse_XLSBCell(data);\r\n\tvar fBool = data.read_shift(1);\r\n\treturn [cell, fBool, 'b'];\r\n}\r\n\r\n/* [MS-XLSB] 2.4.305 BrtCellError */\r\nfunction parse_BrtCellError(data, length) {\r\n\tvar cell = parse_XLSBCell(data);\r\n\tvar fBool = data.read_shift(1);\r\n\treturn [cell, fBool, 'e'];\r\n}\r\n\r\n/* [MS-XLSB] 2.4.308 BrtCellIsst */\r\nfunction parse_BrtCellIsst(data, length) {\r\n\tvar cell = parse_XLSBCell(data);\r\n\tvar isst = data.read_shift(4);\r\n\treturn [cell, isst, 's'];\r\n}\r\n\r\n/* [MS-XLSB] 2.4.310 BrtCellReal */\r\nfunction parse_BrtCellReal(data, length) {\r\n\tvar cell = parse_XLSBCell(data);\r\n\tvar value = parse_Xnum(data);\r\n\treturn [cell, value, 'n'];\r\n}\r\n\r\n/* [MS-XLSB] 2.4.311 BrtCellRk */\r\nfunction parse_BrtCellRk(data, length) {\r\n\tvar cell = parse_XLSBCell(data);\r\n\tvar value = parse_RkNumber(data);\r\n\treturn [cell, value, 'n'];\r\n}\r\n\r\n/* [MS-XLSB] 2.4.314 BrtCellSt */\r\nfunction parse_BrtCellSt(data, length) {\r\n\tvar cell = parse_XLSBCell(data);\r\n\tvar value = parse_XLWideString(data);\r\n\treturn [cell, value, 'str'];\r\n}\r\n\r\n/* [MS-XLSB] 2.4.647 BrtFmlaBool */\r\nfunction parse_BrtFmlaBool(data, length, opts) {\r\n\tvar cell = parse_XLSBCell(data);\r\n\tvar value = data.read_shift(1);\r\n\tvar o = [cell, value, 'b'];\r\n\tif(opts.cellFormula) {\r\n\t\tvar formula = parse_XLSBCellParsedFormula(data, length-9);\r\n\t\to[3] = \"\"; /* TODO */\r\n\t}\r\n\telse data.l += length-9;\r\n\treturn o;\r\n}\r\n\r\n/* [MS-XLSB] 2.4.648 BrtFmlaError */\r\nfunction parse_BrtFmlaError(data, length, opts) {\r\n\tvar cell = parse_XLSBCell(data);\r\n\tvar value = data.read_shift(1);\r\n\tvar o = [cell, value, 'e'];\r\n\tif(opts.cellFormula) {\r\n\t\tvar formula = parse_XLSBCellParsedFormula(data, length-9);\r\n\t\to[3] = \"\"; /* TODO */\r\n\t}\r\n\telse data.l += length-9;\r\n\treturn o;\r\n}\r\n\r\n/* [MS-XLSB] 2.4.649 BrtFmlaNum */\r\nfunction parse_BrtFmlaNum(data, length, opts) {\r\n\tvar cell = parse_XLSBCell(data);\r\n\tvar value = parse_Xnum(data);\r\n\tvar o = [cell, value, 'n'];\r\n\tif(opts.cellFormula) {\r\n\t\tvar formula = parse_XLSBCellParsedFormula(data, length - 16);\r\n\t\to[3] = \"\"; /* TODO */\r\n\t}\r\n\telse data.l += length-16;\r\n\treturn o;\r\n}\r\n\r\n/* [MS-XLSB] 2.4.650 BrtFmlaString */\r\nfunction parse_BrtFmlaString(data, length, opts) {\r\n\tvar start = data.l;\r\n\tvar cell = parse_XLSBCell(data);\r\n\tvar value = parse_XLWideString(data);\r\n\tvar o = [cell, value, 'str'];\r\n\tif(opts.cellFormula) {\r\n\t\tvar formula = parse_XLSBCellParsedFormula(data, start + length - data.l);\r\n\t}\r\n\telse data.l = start + length;\r\n\treturn o;\r\n}\r\n\r\n/* [MS-XLSB] 2.4.676 BrtMergeCell */\r\nvar parse_BrtMergeCell = parse_UncheckedRfX;\r\n\r\n/* [MS-XLSB] 2.4.656 BrtHLink */\r\nfunction parse_BrtHLink(data, length, opts) {\r\n\tvar end = data.l + length;\r\n\tvar rfx = parse_UncheckedRfX(data, 16);\r\n\tvar relId = parse_XLNullableWideString(data);\r\n\tvar loc = parse_XLWideString(data);\r\n\tvar tooltip = parse_XLWideString(data);\r\n\tvar display = parse_XLWideString(data);\r\n\tdata.l = end;\r\n\treturn {rfx:rfx, relId:relId, loc:loc, tooltip:tooltip, display:display};\r\n}\r\n\r\n/* [MS-XLSB] 2.1.7.61 Worksheet */\r\nfunction parse_ws_bin(data, opts, rels) {\r\n\tif(!data) return data;\r\n\tif(!rels) rels = {'!id':{}};\r\n\tvar s = {};\r\n\r\n\tvar ref;\r\n\tvar refguess = {s: {r:1000000, c:1000000}, e: {r:0, c:0} };\r\n\r\n\tvar pass = false, end = false;\r\n\tvar row, p, cf, R, C, addr, sstr, rr;\r\n\tvar mergecells = [];\r\n\trecordhopper(data, function ws_parse(val, R) {\r\n\t\tif(end) return;\r\n\t\tswitch(R.n) {\r\n\t\t\tcase 'BrtWsDim': ref = val; break;\r\n\t\t\tcase 'BrtRowHdr':\r\n\t\t\t\trow = val;\r\n\t\t\t\tif(opts.sheetRows && opts.sheetRows <= row.r) end=true;\r\n\t\t\t\trr = encode_row(row.r);\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 'BrtFmlaBool':\r\n\t\t\tcase 'BrtFmlaError':\r\n\t\t\tcase 'BrtFmlaNum':\r\n\t\t\tcase 'BrtFmlaString':\r\n\t\t\tcase 'BrtCellBool':\r\n\t\t\tcase 'BrtCellError':\r\n\t\t\tcase 'BrtCellIsst':\r\n\t\t\tcase 'BrtCellReal':\r\n\t\t\tcase 'BrtCellRk':\r\n\t\t\tcase 'BrtCellSt':\r\n\t\t\t\tp = {t:val[2]};\r\n\t\t\t\tswitch(val[2]) {\r\n\t\t\t\t\tcase 'n': p.v = val[1]; break;\r\n\t\t\t\t\tcase 's': sstr = strs[val[1]]; p.v = sstr.t; p.r = sstr.r; break;\r\n\t\t\t\t\tcase 'b': p.v = val[1] ? true : false; break;\r\n\t\t\t\t\tcase 'e': p.v = val[1]; p.w = BErr[p.v]; break;\r\n\t\t\t\t\tcase 'str': p.t = 's'; p.v = utf8read(val[1]); break;\r\n\t\t\t\t}\r\n\t\t\t\tif(opts.cellFormula && val.length > 3) p.f = val[3];\r\n\t\t\t\tif((cf = styles.CellXf[val[0].iStyleRef])) safe_format(p,cf.ifmt,null,opts);\r\n\t\t\t\ts[encode_col(C=val[0].c) + rr] = p;\r\n\t\t\t\tif(refguess.s.r > row.r) refguess.s.r = row.r;\r\n\t\t\t\tif(refguess.s.c > C) refguess.s.c = C;\r\n\t\t\t\tif(refguess.e.r < row.r) refguess.e.r = row.r;\r\n\t\t\t\tif(refguess.e.c < C) refguess.e.c = C;\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 'BrtCellBlank': if(!opts.sheetStubs) break;\r\n\t\t\t\tp = {t:'s',v:undefined};\r\n\t\t\t\ts[encode_col(C=val[0].c) + rr] = p;\r\n\t\t\t\tif(refguess.s.r > row.r) refguess.s.r = row.r;\r\n\t\t\t\tif(refguess.s.c > C) refguess.s.c = C;\r\n\t\t\t\tif(refguess.e.r < row.r) refguess.e.r = row.r;\r\n\t\t\t\tif(refguess.e.c < C) refguess.e.c = C;\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t/* Merge Cells */\r\n\t\t\tcase 'BrtBeginMergeCells': break;\r\n\t\t\tcase 'BrtEndMergeCells': break;\r\n\t\t\tcase 'BrtMergeCell': mergecells.push(val); break;\r\n\r\n\t\t\tcase 'BrtHLink':\r\n\t\t\t\tvar rel = rels['!id'][val.relId];\r\n\t\t\t\tif(rel) {\r\n\t\t\t\t\tval.Target = rel.Target;\r\n\t\t\t\t\tif(val.loc) val.Target += \"#\"+val.loc;\r\n\t\t\t\t\tval.Rel = rel;\r\n\t\t\t\t}\r\n\t\t\t\tfor(R=val.rfx.s.r;R<=val.rfx.e.r;++R) for(C=val.rfx.s.c;C<=val.rfx.e.c;++C) {\r\n\t\t\t\t\taddr = encode_cell({c:C,r:R});\r\n\t\t\t\t\tif(!s[addr]) s[addr] = {t:'s',v:undefined};\r\n\t\t\t\t\ts[addr].l = val;\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 'BrtArrFmla': break; // TODO\r\n\t\t\tcase 'BrtShrFmla': break; // TODO\r\n\t\t\tcase 'BrtBeginSheet': break;\r\n\t\t\tcase 'BrtWsProp': break; // TODO\r\n\t\t\tcase 'BrtSheetCalcProp': break; // TODO\r\n\t\t\tcase 'BrtBeginWsViews': break; // TODO\r\n\t\t\tcase 'BrtBeginWsView': break; // TODO\r\n\t\t\tcase 'BrtPane': break; // TODO\r\n\t\t\tcase 'BrtSel': break; // TODO\r\n\t\t\tcase 'BrtEndWsView': break; // TODO\r\n\t\t\tcase 'BrtEndWsViews': break; // TODO\r\n\t\t\tcase 'BrtACBegin': break; // TODO\r\n\t\t\tcase 'BrtRwDescent': break; // TODO\r\n\t\t\tcase 'BrtACEnd': break; // TODO\r\n\t\t\tcase 'BrtWsFmtInfoEx14': break; // TODO\r\n\t\t\tcase 'BrtWsFmtInfo': break; // TODO\r\n\t\t\tcase 'BrtBeginColInfos': break; // TODO\r\n\t\t\tcase 'BrtColInfo': break; // TODO\r\n\t\t\tcase 'BrtEndColInfos': break; // TODO\r\n\t\t\tcase 'BrtBeginSheetData': break; // TODO\r\n\t\t\tcase 'BrtEndSheetData': break; // TODO\r\n\t\t\tcase 'BrtSheetProtection': break; // TODO\r\n\t\t\tcase 'BrtPrintOptions': break; // TODO\r\n\t\t\tcase 'BrtMargins': break; // TODO\r\n\t\t\tcase 'BrtPageSetup': break; // TODO\r\n\t\t\tcase 'BrtFRTBegin': pass = true; break;\r\n\t\t\tcase 'BrtFRTEnd': pass = false; break;\r\n\t\t\tcase 'BrtEndSheet': break; // TODO\r\n\t\t\tcase 'BrtDrawing': break; // TODO\r\n\t\t\tcase 'BrtLegacyDrawing': break; // TODO\r\n\t\t\tcase 'BrtLegacyDrawingHF': break; // TODO\r\n\t\t\tcase 'BrtPhoneticInfo': break; // TODO\r\n\t\t\tcase 'BrtBeginHeaderFooter': break; // TODO\r\n\t\t\tcase 'BrtEndHeaderFooter': break; // TODO\r\n\t\t\tcase 'BrtBrk': break; // TODO\r\n\t\t\tcase 'BrtBeginRwBrk': break; // TODO\r\n\t\t\tcase 'BrtEndRwBrk': break; // TODO\r\n\t\t\tcase 'BrtBeginColBrk': break; // TODO\r\n\t\t\tcase 'BrtEndColBrk': break; // TODO\r\n\t\t\tcase 'BrtBeginUserShViews': break; // TODO\r\n\t\t\tcase 'BrtBeginUserShView': break; // TODO\r\n\t\t\tcase 'BrtEndUserShView': break; // TODO\r\n\t\t\tcase 'BrtEndUserShViews': break; // TODO\r\n\t\t\tcase 'BrtBkHim': break; // TODO\r\n\t\t\tcase 'BrtBeginOleObjects': break; // TODO\r\n\t\t\tcase 'BrtOleObject': break; // TODO\r\n\t\t\tcase 'BrtEndOleObjects': break; // TODO\r\n\t\t\tcase 'BrtBeginListParts': break; // TODO\r\n\t\t\tcase 'BrtListPart': break; // TODO\r\n\t\t\tcase 'BrtEndListParts': break; // TODO\r\n\t\t\tcase 'BrtBeginSortState': break; // TODO\r\n\t\t\tcase 'BrtBeginSortCond': break; // TODO\r\n\t\t\tcase 'BrtEndSortCond': break; // TODO\r\n\t\t\tcase 'BrtEndSortState': break; // TODO\r\n\t\t\tcase 'BrtBeginConditionalFormatting': break; // TODO\r\n\t\t\tcase 'BrtEndConditionalFormatting': break; // TODO\r\n\t\t\tcase 'BrtBeginCFRule': break; // TODO\r\n\t\t\tcase 'BrtEndCFRule': break; // TODO\r\n\t\t\tcase 'BrtBeginDVals': break; // TODO\r\n\t\t\tcase 'BrtDVal': break; // TODO\r\n\t\t\tcase 'BrtEndDVals': break; // TODO\r\n\t\t\tcase 'BrtRangeProtection': break; // TODO\r\n\t\t\tcase 'BrtBeginDCon': break; // TODO\r\n\t\t\tcase 'BrtEndDCon': break; // TODO\r\n\t\t\tcase 'BrtBeginDRefs': break;\r\n\t\t\tcase 'BrtDRef': break;\r\n\t\t\tcase 'BrtEndDRefs': break;\r\n\r\n\t\t\t/* ActiveX */\r\n\t\t\tcase 'BrtBeginActiveXControls': break;\r\n\t\t\tcase 'BrtActiveX': break;\r\n\t\t\tcase 'BrtEndActiveXControls': break;\r\n\r\n\t\t\t/* AutoFilter */\r\n\t\t\tcase 'BrtBeginAFilter': break;\r\n\t\t\tcase 'BrtEndAFilter': break;\r\n\t\t\tcase 'BrtBeginFilterColumn': break;\r\n\t\t\tcase 'BrtBeginFilters': break;\r\n\t\t\tcase 'BrtFilter': break;\r\n\t\t\tcase 'BrtEndFilters': break;\r\n\t\t\tcase 'BrtEndFilterColumn': break;\r\n\t\t\tcase 'BrtDynamicFilter': break;\r\n\t\t\tcase 'BrtTop10Filter': break;\r\n\t\t\tcase 'BrtBeginCustomFilters': break;\r\n\t\t\tcase 'BrtCustomFilter': break;\r\n\t\t\tcase 'BrtEndCustomFilters': break;\r\n\r\n\t\t\t/* Smart Tags */\r\n\t\t\tcase 'BrtBeginSmartTags': break;\r\n\t\t\tcase 'BrtBeginCellSmartTags': break;\r\n\t\t\tcase 'BrtBeginCellSmartTag': break;\r\n\t\t\tcase 'BrtCellSmartTagProperty': break;\r\n\t\t\tcase 'BrtEndCellSmartTag': break;\r\n\t\t\tcase 'BrtEndCellSmartTags': break;\r\n\t\t\tcase 'BrtEndSmartTags': break;\r\n\r\n\t\t\t/* Cell Watch */\r\n\t\t\tcase 'BrtBeginCellWatches': break;\r\n\t\t\tcase 'BrtCellWatch': break;\r\n\t\t\tcase 'BrtEndCellWatches': break;\r\n\r\n\t\t\t/* Table */\r\n\t\t\tcase 'BrtTable': break;\r\n\r\n\t\t\t/* Ignore Cell Errors */\r\n\t\t\tcase 'BrtBeginCellIgnoreECs': break;\r\n\t\t\tcase 'BrtCellIgnoreEC': break;\r\n\t\t\tcase 'BrtEndCellIgnoreECs': break;\r\n\r\n\t\t\tdefault: if(!pass || opts.WTF) throw new Error(\"Unexpected record \" + R.n);\r\n\t\t}\r\n\t}, opts);\r\n\tif(!s[\"!ref\"] && (refguess.s.r < 1000000 || ref.e.r > 0 || ref.e.c > 0 || ref.s.r > 0 || ref.s.c > 0)) s[\"!ref\"] = encode_range(ref);\r\n\tif(opts.sheetRows && s[\"!ref\"]) {\r\n\t\tvar tmpref = safe_decode_range(s[\"!ref\"]);\r\n\t\tif(opts.sheetRows < +tmpref.e.r) {\r\n\t\t\ttmpref.e.r = opts.sheetRows - 1;\r\n\t\t\tif(tmpref.e.r > refguess.e.r) tmpref.e.r = refguess.e.r;\r\n\t\t\tif(tmpref.e.r < tmpref.s.r) tmpref.s.r = tmpref.e.r;\r\n\t\t\tif(tmpref.e.c > refguess.e.c) tmpref.e.c = refguess.e.c;\r\n\t\t\tif(tmpref.e.c < tmpref.s.c) tmpref.s.c = tmpref.e.c;\r\n\t\t\ts[\"!fullref\"] = s[\"!ref\"];\r\n\t\t\ts[\"!ref\"] = encode_range(tmpref);\r\n\t\t}\r\n\t}\r\n\tif(mergecells.length > 0) s[\"!merges\"] = mergecells;\r\n\treturn s;\r\n}\r\n\r\n/* TODO: something useful -- this is a stub */\r\nfunction write_ws_bin_cell(ba, cell, R, C, opts) {\r\n\tif(cell.v === undefined) return \"\";\r\n\tvar vv = \"\";\r\n\tswitch(cell.t) {\r\n\t\tcase 'b': vv = cell.v ? \"1\" : \"0\"; break;\r\n\t\tcase 'n': case 'e': vv = ''+cell.v; break;\r\n\t\tdefault: vv = cell.v; break;\r\n\t}\r\n\tvar o = {r:R, c:C};\r\n\t/* TODO: cell style */\r\n\to.s = get_cell_style(opts.cellXfs, cell, opts);\r\n\tswitch(cell.t) {\r\n\t\tcase 's': case 'str':\r\n\t\t\tif(opts.bookSST) {\r\n\t\t\t\tvv = get_sst_id(opts.Strings, cell.v);\r\n\t\t\t\to.t = \"s\"; break;\r\n\t\t\t}\r\n\t\t\to.t = \"str\"; break;\r\n\t\tcase 'n': break;\r\n\t\tcase 'b': o.t = \"b\"; break;\r\n\t\tcase 'e': o.t = \"e\"; break;\r\n\t}\r\n\twrite_record(ba, \"BrtCellBlank\", write_BrtCellBlank(cell, o));\r\n}\r\n\r\nfunction write_CELLTABLE(ba, ws, idx, opts, wb) {\r\n\tvar range = safe_decode_range(ws['!ref'] || \"A1\"), ref, rr = \"\", cols = [];\r\n\twrite_record(ba, 'BrtBeginSheetData');\r\n\tfor(var R = range.s.r; R <= range.e.r; ++R) {\r\n\t\trr = encode_row(R);\r\n\t\t/* [ACCELLTABLE] */\r\n\t\t/* BrtRowHdr */\r\n\t\tfor(var C = range.s.c; C <= range.e.c; ++C) {\r\n\t\t\t/* *16384CELL */\r\n\t\t\tif(R === range.s.r) cols[C] = encode_col(C);\r\n\t\t\tref = cols[C] + rr;\r\n\t\t\tif(!ws[ref]) continue;\r\n\t\t\t/* write cell */\r\n\t\t\twrite_ws_bin_cell(ba, ws[ref], R, C, opts);\r\n\t\t}\r\n\t}\r\n\twrite_record(ba, 'BrtEndSheetData');\r\n}\r\n\r\nfunction write_ws_bin(idx, opts, wb) {\r\n\tvar ba = buf_array();\r\n\tvar s = wb.SheetNames[idx], ws = wb.Sheets[s] || {};\r\n\tvar r = safe_decode_range(ws['!ref'] || \"A1\");\r\n\twrite_record(ba, \"BrtBeginSheet\");\r\n\t/* [BrtWsProp] */\r\n\twrite_record(ba, \"BrtWsDim\", write_BrtWsDim(r));\r\n\t/* [WSVIEWS2] */\r\n\t/* [WSFMTINFO] */\r\n\t/* *COLINFOS */\r\n\twrite_CELLTABLE(ba, ws, idx, opts, wb);\r\n\t/* [BrtSheetCalcProp] */\r\n\t/* [[BrtSheetProtectionIso] BrtSheetProtection] */\r\n\t/* *([BrtRangeProtectionIso] BrtRangeProtection) */\r\n\t/* [SCENMAN] */\r\n\t/* [AUTOFILTER] */\r\n\t/* [SORTSTATE] */\r\n\t/* [DCON] */\r\n\t/* [USERSHVIEWS] */\r\n\t/* [MERGECELLS] */\r\n\t/* [BrtPhoneticInfo] */\r\n\t/* *CONDITIONALFORMATTING */\r\n\t/* [DVALS] */\r\n\t/* *BrtHLink */\r\n\t/* [BrtPrintOptions] */\r\n\t/* [BrtMargins] */\r\n\t/* [BrtPageSetup] */\r\n\t/* [HEADERFOOTER] */\r\n\t/* [RWBRK] */\r\n\t/* [COLBRK] */\r\n\t/* *BrtBigName */\r\n\t/* [CELLWATCHES] */\r\n\t/* [IGNOREECS] */\r\n\t/* [SMARTTAGS] */\r\n\t/* [BrtDrawing] */\r\n\t/* [BrtLegacyDrawing] */\r\n\t/* [BrtLegacyDrawingHF] */\r\n\t/* [BrtBkHim] */\r\n\t/* [OLEOBJECTS] */\r\n\t/* [ACTIVEXCONTROLS] */\r\n\t/* [WEBPUBITEMS] */\r\n\t/* [LISTPARTS] */\r\n\t/* FRTWORKSHEET */\r\n\twrite_record(ba, \"BrtEndSheet\");\r\n\treturn ba.end();\r\n}\r\n/* 18.2.28 (CT_WorkbookProtection) Defaults */\r\nvar WBPropsDef = [\r\n\t['allowRefreshQuery', '0'],\r\n\t['autoCompressPictures', '1'],\r\n\t['backupFile', '0'],\r\n\t['checkCompatibility', '0'],\r\n\t['codeName', ''],\r\n\t['date1904', '0'],\r\n\t['dateCompatibility', '1'],\r\n\t//['defaultThemeVersion', '0'],\r\n\t['filterPrivacy', '0'],\r\n\t['hidePivotFieldList', '0'],\r\n\t['promptedSolutions', '0'],\r\n\t['publishItems', '0'],\r\n\t['refreshAllConnections', false],\r\n\t['saveExternalLinkValues', '1'],\r\n\t['showBorderUnselectedTables', '1'],\r\n\t['showInkAnnotation', '1'],\r\n\t['showObjects', 'all'],\r\n\t['showPivotChartFilter', '0']\r\n\t//['updateLinks', 'userSet']\r\n];\r\n\r\n/* 18.2.30 (CT_BookView) Defaults */\r\nvar WBViewDef = [\r\n\t['activeTab', '0'],\r\n\t['autoFilterDateGrouping', '1'],\r\n\t['firstSheet', '0'],\r\n\t['minimized', '0'],\r\n\t['showHorizontalScroll', '1'],\r\n\t['showSheetTabs', '1'],\r\n\t['showVerticalScroll', '1'],\r\n\t['tabRatio', '600'],\r\n\t['visibility', 'visible']\r\n\t//window{Height,Width}, {x,y}Window\r\n];\r\n\r\n/* 18.2.19 (CT_Sheet) Defaults */\r\nvar SheetDef = [\r\n\t['state', 'visible']\r\n];\r\n\r\n/* 18.2.2  (CT_CalcPr) Defaults */\r\nvar CalcPrDef = [\r\n\t['calcCompleted', 'true'],\r\n\t['calcMode', 'auto'],\r\n\t['calcOnSave', 'true'],\r\n\t['concurrentCalc', 'true'],\r\n\t['fullCalcOnLoad', 'false'],\r\n\t['fullPrecision', 'true'],\r\n\t['iterate', 'false'],\r\n\t['iterateCount', '100'],\r\n\t['iterateDelta', '0.001'],\r\n\t['refMode', 'A1']\r\n];\r\n\r\n/* 18.2.3 (CT_CustomWorkbookView) Defaults */\r\nvar CustomWBViewDef = [\r\n\t['autoUpdate', 'false'],\r\n\t['changesSavedWin', 'false'],\r\n\t['includeHiddenRowCol', 'true'],\r\n\t['includePrintSettings', 'true'],\r\n\t['maximized', 'false'],\r\n\t['minimized', 'false'],\r\n\t['onlySync', 'false'],\r\n\t['personalView', 'false'],\r\n\t['showComments', 'commIndicator'],\r\n\t['showFormulaBar', 'true'],\r\n\t['showHorizontalScroll', 'true'],\r\n\t['showObjects', 'all'],\r\n\t['showSheetTabs', 'true'],\r\n\t['showStatusbar', 'true'],\r\n\t['showVerticalScroll', 'true'],\r\n\t['tabRatio', '600'],\r\n\t['xWindow', '0'],\r\n\t['yWindow', '0']\r\n];\r\n\r\nfunction push_defaults_array(target, defaults) {\r\n\tfor(var j = 0; j != target.length; ++j) { var w = target[j];\r\n\t\tfor(var i=0; i != defaults.length; ++i) { var z = defaults[i];\r\n\t\t\tif(w[z[0]] == null) w[z[0]] = z[1];\r\n\t\t}\r\n\t}\r\n}\r\nfunction push_defaults(target, defaults) {\r\n\tfor(var i = 0; i != defaults.length; ++i) { var z = defaults[i];\r\n\t\tif(target[z[0]] == null) target[z[0]] = z[1];\r\n\t}\r\n}\r\n\r\nfunction parse_wb_defaults(wb) {\r\n\tpush_defaults(wb.WBProps, WBPropsDef);\r\n\tpush_defaults(wb.CalcPr, CalcPrDef);\r\n\r\n\tpush_defaults_array(wb.WBView, WBViewDef);\r\n\tpush_defaults_array(wb.Sheets, SheetDef);\r\n\r\n\t_ssfopts.date1904 = parsexmlbool(wb.WBProps.date1904, 'date1904');\r\n}\r\n/* 18.2 Workbook */\r\nvar wbnsregex = /<\\w+:workbook/;\r\nfunction parse_wb_xml(data, opts) {\r\n\tvar wb = { AppVersion:{}, WBProps:{}, WBView:[], Sheets:[], CalcPr:{}, xmlns: \"\" };\r\n\tvar pass = false, xmlns = \"xmlns\";\r\n\tdata.match(tagregex).forEach(function xml_wb(x) {\r\n\t\tvar y = parsexmltag(x);\r\n\t\tswitch(strip_ns(y[0])) {\r\n\t\t\tcase '<?xml': break;\r\n\r\n\t\t\t/* 18.2.27 workbook CT_Workbook 1 */\r\n\t\t\tcase '<workbook':\r\n\t\t\t\tif(x.match(wbnsregex)) xmlns = \"xmlns\" + x.match(/<(\\w+):/)[1];\r\n\t\t\t\twb.xmlns = y[xmlns];\r\n\t\t\t\tbreak;\r\n\t\t\tcase '</workbook>': break;\r\n\r\n\t\t\t/* 18.2.13 fileVersion CT_FileVersion ? */\r\n\t\t\tcase '<fileVersion': delete y[0]; wb.AppVersion = y; break;\r\n\t\t\tcase '<fileVersion/>': break;\r\n\r\n\t\t\t/* 18.2.12 fileSharing CT_FileSharing ? */\r\n\t\t\tcase '<fileSharing': case '<fileSharing/>': break;\r\n\r\n\t\t\t/* 18.2.28 workbookPr CT_WorkbookPr ? */\r\n\t\t\tcase '<workbookPr': delete y[0]; wb.WBProps = y; break;\r\n\t\t\tcase '<workbookPr/>': delete y[0]; wb.WBProps = y; break;\r\n\r\n\t\t\t/* 18.2.29 workbookProtection CT_WorkbookProtection ? */\r\n\t\t\tcase '<workbookProtection': break;\r\n\t\t\tcase '<workbookProtection/>': break;\r\n\r\n\t\t\t/* 18.2.1  bookViews CT_BookViews ? */\r\n\t\t\tcase '<bookViews>': case '</bookViews>': break;\r\n\t\t\t/* 18.2.30   workbookView CT_BookView + */\r\n\t\t\tcase '<workbookView': delete y[0]; wb.WBView.push(y); break;\r\n\r\n\t\t\t/* 18.2.20 sheets CT_Sheets 1 */\r\n\t\t\tcase '<sheets>': case '</sheets>': break; // aggregate sheet\r\n\t\t\t/* 18.2.19   sheet CT_Sheet + */\r\n\t\t\tcase '<sheet': delete y[0]; y.name = utf8read(y.name); wb.Sheets.push(y); break;\r\n\r\n\t\t\t/* 18.2.15 functionGroups CT_FunctionGroups ? */\r\n\t\t\tcase '<functionGroups': case '<functionGroups/>': break;\r\n\t\t\t/* 18.2.14   functionGroup CT_FunctionGroup + */\r\n\t\t\tcase '<functionGroup': break;\r\n\r\n\t\t\t/* 18.2.9  externalReferences CT_ExternalReferences ? */\r\n\t\t\tcase '<externalReferences': case '</externalReferences>': case '<externalReferences>': break;\r\n\t\t\t/* 18.2.8    externalReference CT_ExternalReference + */\r\n\t\t\tcase '<externalReference': break;\r\n\r\n\t\t\t/* 18.2.6  definedNames CT_DefinedNames ? */\r\n\t\t\tcase '<definedNames/>': break;\r\n\t\t\tcase '<definedNames>': case '<definedNames': pass=true; break;\r\n\t\t\tcase '</definedNames>': pass=false; break;\r\n\t\t\t/* 18.2.5    definedName CT_DefinedName + */\r\n\t\t\tcase '<definedName': case '<definedName/>': case '</definedName>': break;\r\n\r\n\t\t\t/* 18.2.2  calcPr CT_CalcPr ? */\r\n\t\t\tcase '<calcPr': delete y[0]; wb.CalcPr = y; break;\r\n\t\t\tcase '<calcPr/>': delete y[0]; wb.CalcPr = y; break;\r\n\r\n\t\t\t/* 18.2.16 oleSize CT_OleSize ? (ref required) */\r\n\t\t\tcase '<oleSize': break;\r\n\r\n\t\t\t/* 18.2.4  customWorkbookViews CT_CustomWorkbookViews ? */\r\n\t\t\tcase '<customWorkbookViews>': case '</customWorkbookViews>': case '<customWorkbookViews': break;\r\n\t\t\t/* 18.2.3    customWorkbookView CT_CustomWorkbookView + */\r\n\t\t\tcase '<customWorkbookView': case '</customWorkbookView>': break;\r\n\r\n\t\t\t/* 18.2.18 pivotCaches CT_PivotCaches ? */\r\n\t\t\tcase '<pivotCaches>': case '</pivotCaches>': case '<pivotCaches': break;\r\n\t\t\t/* 18.2.17 pivotCache CT_PivotCache ? */\r\n\t\t\tcase '<pivotCache': break;\r\n\r\n\t\t\t/* 18.2.21 smartTagPr CT_SmartTagPr ? */\r\n\t\t\tcase '<smartTagPr': case '<smartTagPr/>': break;\r\n\r\n\t\t\t/* 18.2.23 smartTagTypes CT_SmartTagTypes ? */\r\n\t\t\tcase '<smartTagTypes': case '<smartTagTypes>': case '</smartTagTypes>': break;\r\n\t\t\t/* 18.2.22   smartTagType CT_SmartTagType ? */\r\n\t\t\tcase '<smartTagType': break;\r\n\r\n\t\t\t/* 18.2.24 webPublishing CT_WebPublishing ? */\r\n\t\t\tcase '<webPublishing': case '<webPublishing/>': break;\r\n\r\n\t\t\t/* 18.2.11 fileRecoveryPr CT_FileRecoveryPr ? */\r\n\t\t\tcase '<fileRecoveryPr': case '<fileRecoveryPr/>': break;\r\n\r\n\t\t\t/* 18.2.26 webPublishObjects CT_WebPublishObjects ? */\r\n\t\t\tcase '<webPublishObjects>': case '<webPublishObjects': case '</webPublishObjects>': break;\r\n\t\t\t/* 18.2.25 webPublishObject CT_WebPublishObject ? */\r\n\t\t\tcase '<webPublishObject': break;\r\n\r\n\t\t\t/* 18.2.10 extLst CT_ExtensionList ? */\r\n\t\t\tcase '<extLst>': case '</extLst>': case '<extLst/>': break;\r\n\t\t\t/* 18.2.7    ext CT_Extension + */\r\n\t\t\tcase '<ext': pass=true; break; //TODO: check with versions of excel\r\n\t\t\tcase '</ext>': pass=false; break;\r\n\r\n\t\t\t/* Others */\r\n\t\t\tcase '<ArchID': break;\r\n\t\t\tcase '<AlternateContent': pass=true; break;\r\n\t\t\tcase '</AlternateContent>': pass=false; break;\r\n\r\n\t\t\tdefault: if(!pass && opts.WTF) throw 'unrecognized ' + y[0] + ' in workbook';\r\n\t\t}\r\n\t});\r\n\tif(XMLNS.main.indexOf(wb.xmlns) === -1) throw new Error(\"Unknown Namespace: \" + wb.xmlns);\r\n\r\n\tparse_wb_defaults(wb);\r\n\r\n\treturn wb;\r\n}\r\n\r\nvar WB_XML_ROOT = writextag('workbook', null, {\r\n\t'xmlns': XMLNS.main[0],\r\n\t//'xmlns:mx': XMLNS.mx,\r\n\t//'xmlns:s': XMLNS.main[0],\r\n\t'xmlns:r': XMLNS.r\r\n});\r\n\r\nfunction safe1904(wb) {\r\n\t/* TODO: store date1904 somewhere else */\r\n\ttry { return parsexmlbool(wb.Workbook.WBProps.date1904) ? \"true\" : \"false\"; } catch(e) { return \"false\"; }\r\n}\r\n\r\nfunction write_wb_xml(wb, opts) {\r\n\tvar o = [XML_HEADER];\r\n\to[o.length] = WB_XML_ROOT;\r\n\to[o.length] = (writextag('workbookPr', null, {date1904:safe1904(wb)}));\r\n\to[o.length] = \"<sheets>\";\r\n\tfor(var i = 0; i != wb.SheetNames.length; ++i)\r\n\t\to[o.length] = (writextag('sheet',null,{name:wb.SheetNames[i].substr(0,31), sheetId:\"\"+(i+1), \"r:id\":\"rId\"+(i+1)}));\r\n\to[o.length] = \"</sheets>\";\r\n\r\n  var hasPrintHeaders = false;\r\n  for(var i = 0; i != wb.SheetNames.length; ++i) {\r\n    var sheetName = wb.SheetNames[i];\r\n    var sheet = wb.Sheets[sheetName]\r\n    if (sheet['!printHeader']) {\r\n      if (sheet['!printHeader'].length !== 2) {\r\n        throw \"!printHeaders must be an array of length 2: \"+sheet['!printHeader'];\r\n\r\n      }\r\n      hasPrintHeaders = true;\r\n    }\r\n\r\n  }\r\n\r\n  if (hasPrintHeaders) {\r\n    o[o.length] = '<definedNames>';\r\n    for(var i = 0; i != wb.SheetNames.length; ++i) {\r\n      var sheetName = wb.SheetNames[i];\r\n      var sheet = wb.Sheets[sheetName]\r\n      if (sheet['!printHeader'] || sheet['!printColumns']) {\r\n          var printHeader = sheet['!printHeader'];\r\n          var printColumns = sheet['!printColumns'];\r\n\r\n        //Sheet1!$A:$C,Sheet1!$1:$1\r\n        var range = \"\";\r\n\r\n        if (printColumns)  range += (\"'\" + sheetName + \"'!\")  + (\"$\" + printColumns[0] + \":$\" + printColumns[1]);\r\n        if (printColumns && printHeader)  range += \",\"\r\n        if (printHeader) range += (\"'\" + sheetName + \"'!\" ) +  (\"$\" + printHeader[0] + \":$\" + printHeader[1]);\r\n\r\n        console.log(\"-----------------------------\")\r\n        console.log(range)\r\n        o[o.length] = (writextag('definedName', range, {\r\n          \"name\":\"_xlnm.Print_Titles\",\r\n          localSheetId : ''+i\r\n        }))\r\n      }\r\n    }\r\n    o[o.length] = '</definedNames>';\r\n  }\r\n\r\n\tif(o.length>2){ o[o.length] = '</workbook>'; o[1]=o[1].replace(\"/>\",\">\"); }\r\n\treturn o.join(\"\");\r\n}\r\n/* [MS-XLSB] 2.4.301 BrtBundleSh */\r\nfunction parse_BrtBundleSh(data, length) {\r\n\tvar z = {};\r\n\tz.hsState = data.read_shift(4); //ST_SheetState\r\n\tz.iTabID = data.read_shift(4);\r\n\tz.strRelID = parse_RelID(data,length-8);\r\n\tz.name = parse_XLWideString(data);\r\n\treturn z;\r\n}\r\nfunction write_BrtBundleSh(data, o) {\r\n\tif(!o) o = new_buf(127);\r\n\to.write_shift(4, data.hsState);\r\n\to.write_shift(4, data.iTabID);\r\n\twrite_RelID(data.strRelID, o);\r\n\twrite_XLWideString(data.name.substr(0,31), o);\r\n\treturn o;\r\n}\r\n\r\n/* [MS-XLSB] 2.4.807 BrtWbProp */\r\nfunction parse_BrtWbProp(data, length) {\r\n\tdata.read_shift(4);\r\n\tvar dwThemeVersion = data.read_shift(4);\r\n\tvar strName = (length > 8) ? parse_XLWideString(data) : \"\";\r\n\treturn [dwThemeVersion, strName];\r\n}\r\nfunction write_BrtWbProp(data, o) {\r\n\tif(!o) o = new_buf(8);\r\n\to.write_shift(4, 0);\r\n\to.write_shift(4, 0);\r\n\treturn o;\r\n}\r\n\r\nfunction parse_BrtFRTArchID$(data, length) {\r\n\tvar o = {};\r\n\tdata.read_shift(4);\r\n\to.ArchID = data.read_shift(4);\r\n\tdata.l += length - 8;\r\n\treturn o;\r\n}\r\n\r\n/* [MS-XLSB] 2.1.7.60 Workbook */\r\nfunction parse_wb_bin(data, opts) {\r\n\tvar wb = { AppVersion:{}, WBProps:{}, WBView:[], Sheets:[], CalcPr:{}, xmlns: \"\" };\r\n\tvar pass = false, z;\r\n\r\n\trecordhopper(data, function hopper_wb(val, R) {\r\n\t\tswitch(R.n) {\r\n\t\t\tcase 'BrtBundleSh': wb.Sheets.push(val); break;\r\n\r\n\t\t\tcase 'BrtBeginBook': break;\r\n\t\t\tcase 'BrtFileVersion': break;\r\n\t\t\tcase 'BrtWbProp': break;\r\n\t\t\tcase 'BrtACBegin': break;\r\n\t\t\tcase 'BrtAbsPath15': break;\r\n\t\t\tcase 'BrtACEnd': break;\r\n\t\t\tcase 'BrtWbFactoid': break;\r\n\t\t\t/*case 'BrtBookProtectionIso': break;*/\r\n\t\t\tcase 'BrtBookProtection': break;\r\n\t\t\tcase 'BrtBeginBookViews': break;\r\n\t\t\tcase 'BrtBookView': break;\r\n\t\t\tcase 'BrtEndBookViews': break;\r\n\t\t\tcase 'BrtBeginBundleShs': break;\r\n\t\t\tcase 'BrtEndBundleShs': break;\r\n\t\t\tcase 'BrtBeginFnGroup': break;\r\n\t\t\tcase 'BrtEndFnGroup': break;\r\n\t\t\tcase 'BrtBeginExternals': break;\r\n\t\t\tcase 'BrtSupSelf': break;\r\n\t\t\tcase 'BrtSupBookSrc': break;\r\n\t\t\tcase 'BrtExternSheet': break;\r\n\t\t\tcase 'BrtEndExternals': break;\r\n\t\t\tcase 'BrtName': break;\r\n\t\t\tcase 'BrtCalcProp': break;\r\n\t\t\tcase 'BrtUserBookView': break;\r\n\t\t\tcase 'BrtBeginPivotCacheIDs': break;\r\n\t\t\tcase 'BrtBeginPivotCacheID': break;\r\n\t\t\tcase 'BrtEndPivotCacheID': break;\r\n\t\t\tcase 'BrtEndPivotCacheIDs': break;\r\n\t\t\tcase 'BrtWebOpt': break;\r\n\t\t\tcase 'BrtFileRecover': break;\r\n\t\t\tcase 'BrtFileSharing': break;\r\n\t\t\t/*case 'BrtBeginWebPubItems': break;\r\n\t\t\tcase 'BrtBeginWebPubItem': break;\r\n\t\t\tcase 'BrtEndWebPubItem': break;\r\n\t\t\tcase 'BrtEndWebPubItems': break;*/\r\n\r\n\t\t\t/* Smart Tags */\r\n\t\t\tcase 'BrtBeginSmartTagTypes': break;\r\n\t\t\tcase 'BrtSmartTagType': break;\r\n\t\t\tcase 'BrtEndSmartTagTypes': break;\r\n\r\n\t\t\tcase 'BrtFRTBegin': pass = true; break;\r\n\t\t\tcase 'BrtFRTArchID$': break;\r\n\t\t\tcase 'BrtWorkBookPr15': break;\r\n\t\t\tcase 'BrtFRTEnd': pass = false; break;\r\n\t\t\tcase 'BrtEndBook': break;\r\n\t\t\tdefault: if(!pass || opts.WTF) throw new Error(\"Unexpected record \" + R.n);\r\n\t\t}\r\n\t});\r\n\r\n\tparse_wb_defaults(wb);\r\n\r\n\treturn wb;\r\n}\r\n\r\n/* [MS-XLSB] 2.1.7.60 Workbook */\r\nfunction write_BUNDLESHS(ba, wb, opts) {\r\n\twrite_record(ba, \"BrtBeginBundleShs\");\r\n\tfor(var idx = 0; idx != wb.SheetNames.length; ++idx) {\r\n\t\tvar d = { hsState: 0, iTabID: idx+1, strRelID: 'rId' + (idx+1), name: wb.SheetNames[idx] };\r\n\t\twrite_record(ba, \"BrtBundleSh\", write_BrtBundleSh(d));\r\n\t}\r\n\twrite_record(ba, \"BrtEndBundleShs\");\r\n}\r\n\r\n/* [MS-XLSB] 2.4.643 BrtFileVersion */\r\nfunction write_BrtFileVersion(data, o) {\r\n\tif(!o) o = new_buf(127);\r\n\tfor(var i = 0; i != 4; ++i) o.write_shift(4, 0);\r\n\twrite_XLWideString(\"SheetJS\", o);\r\n\twrite_XLWideString(XLSX.version, o);\r\n\twrite_XLWideString(XLSX.version, o);\r\n\twrite_XLWideString(\"7262\", o);\r\n\to.length = o.l;\r\n\treturn o;\r\n}\r\n\r\n/* [MS-XLSB] 2.1.7.60 Workbook */\r\nfunction write_BOOKVIEWS(ba, wb, opts) {\r\n\twrite_record(ba, \"BrtBeginBookViews\");\r\n\t/* 1*(BrtBookView *FRT) */\r\n\twrite_record(ba, \"BrtEndBookViews\");\r\n}\r\n\r\n/* [MS-XLSB] 2.4.302 BrtCalcProp */\r\nfunction write_BrtCalcProp(data, o) {\r\n\tif(!o) o = new_buf(26);\r\n\to.write_shift(4,0); /* force recalc */\r\n\to.write_shift(4,1);\r\n\to.write_shift(4,0);\r\n\twrite_Xnum(0, o);\r\n\to.write_shift(-4, 1023);\r\n\to.write_shift(1, 0x33);\r\n\to.write_shift(1, 0x00);\r\n\treturn o;\r\n}\r\n\r\nfunction write_BrtFileRecover(data, o) {\r\n\tif(!o) o = new_buf(1);\r\n\to.write_shift(1,0);\r\n\treturn o;\r\n}\r\n\r\n/* [MS-XLSB] 2.1.7.60 Workbook */\r\nfunction write_wb_bin(wb, opts) {\r\n\tvar ba = buf_array();\r\n\twrite_record(ba, \"BrtBeginBook\");\r\n\twrite_record(ba, \"BrtFileVersion\", write_BrtFileVersion());\r\n\t/* [[BrtFileSharingIso] BrtFileSharing] */\r\n\twrite_record(ba, \"BrtWbProp\", write_BrtWbProp());\r\n\t/* [ACABSPATH] */\r\n\t/* [[BrtBookProtectionIso] BrtBookProtection] */\r\n\twrite_BOOKVIEWS(ba, wb, opts);\r\n\twrite_BUNDLESHS(ba, wb, opts);\r\n\t/* [FNGROUP] */\r\n\t/* [EXTERNALS] */\r\n\t/* *BrtName */\r\n\twrite_record(ba, \"BrtCalcProp\", write_BrtCalcProp());\r\n\t/* [BrtOleSize] */\r\n\t/* *(BrtUserBookView *FRT) */\r\n\t/* [PIVOTCACHEIDS] */\r\n\t/* [BrtWbFactoid] */\r\n\t/* [SMARTTAGTYPES] */\r\n\t/* [BrtWebOpt] */\r\n\twrite_record(ba, \"BrtFileRecover\", write_BrtFileRecover());\r\n\t/* [WEBPUBITEMS] */\r\n\t/* [CRERRS] */\r\n\t/* FRTWORKBOOK */\r\n\twrite_record(ba, \"BrtEndBook\");\r\n\r\n\treturn ba.end();\r\n}\r\nfunction parse_wb(data, name, opts) {\r\n\treturn (name.substr(-4)===\".bin\" ? parse_wb_bin : parse_wb_xml)(data, opts);\r\n}\r\n\r\nfunction parse_ws(data, name, opts, rels) {\r\n\treturn (name.substr(-4)===\".bin\" ? parse_ws_bin : parse_ws_xml)(data, opts, rels);\r\n}\r\n\r\nfunction parse_sty(data, name, opts) {\r\n\treturn (name.substr(-4)===\".bin\" ? parse_sty_bin : parse_sty_xml)(data, opts);\r\n}\r\n\r\nfunction parse_theme(data, name, opts) {\r\n\treturn parse_theme_xml(data, opts);\r\n}\r\n\r\nfunction parse_sst(data, name, opts) {\r\n\treturn (name.substr(-4)===\".bin\" ? parse_sst_bin : parse_sst_xml)(data, opts);\r\n}\r\n\r\nfunction parse_cmnt(data, name, opts) {\r\n\treturn (name.substr(-4)===\".bin\" ? parse_comments_bin : parse_comments_xml)(data, opts);\r\n}\r\n\r\nfunction parse_cc(data, name, opts) {\r\n\treturn (name.substr(-4)===\".bin\" ? parse_cc_bin : parse_cc_xml)(data, opts);\r\n}\r\n\r\nfunction write_wb(wb, name, opts) {\r\n\treturn (name.substr(-4)===\".bin\" ? write_wb_bin : write_wb_xml)(wb, opts);\r\n}\r\n\r\nfunction write_ws(data, name, opts, wb) {\r\n\treturn (name.substr(-4)===\".bin\" ? write_ws_bin : write_ws_xml)(data, opts, wb);\r\n}\r\n\r\nfunction write_sty(data, name, opts) {\r\n\treturn (name.substr(-4)===\".bin\" ? write_sty_bin : write_sty_xml)(data, opts);\r\n}\r\n\r\nfunction write_sst(data, name, opts) {\r\n\treturn (name.substr(-4)===\".bin\" ? write_sst_bin : write_sst_xml)(data, opts);\r\n}\r\n/*\r\nfunction write_cmnt(data, name, opts) {\r\n\treturn (name.substr(-4)===\".bin\" ? write_comments_bin : write_comments_xml)(data, opts);\r\n}\r\n\r\nfunction write_cc(data, name, opts) {\r\n\treturn (name.substr(-4)===\".bin\" ? write_cc_bin : write_cc_xml)(data, opts);\r\n}\r\n*/\r\nvar attregexg2=/([\\w:]+)=((?:\")([^\"]*)(?:\")|(?:')([^']*)(?:'))/g;\r\nvar attregex2=/([\\w:]+)=((?:\")(?:[^\"]*)(?:\")|(?:')(?:[^']*)(?:'))/;\r\nvar _chr = function(c) { return String.fromCharCode(c); };\r\nfunction xlml_parsexmltag(tag, skip_root) {\r\n\tvar words = tag.split(/\\s+/);\r\n\tvar z = []; if(!skip_root) z[0] = words[0];\r\n\tif(words.length === 1) return z;\r\n\tvar m = tag.match(attregexg2), y, j, w, i;\r\n\tif(m) for(i = 0; i != m.length; ++i) {\r\n\t\ty = m[i].match(attregex2);\r\n\t\tif((j=y[1].indexOf(\":\")) === -1) z[y[1]] = y[2].substr(1,y[2].length-2);\r\n\t\telse {\r\n\t\t\tif(y[1].substr(0,6) === \"xmlns:\") w = \"xmlns\"+y[1].substr(6);\r\n\t\t\telse w = y[1].substr(j+1);\r\n\t\t\tz[w] = y[2].substr(1,y[2].length-2);\r\n\t\t}\r\n\t}\r\n\treturn z;\r\n}\r\nfunction xlml_parsexmltagobj(tag) {\r\n\tvar words = tag.split(/\\s+/);\r\n\tvar z = {};\r\n\tif(words.length === 1) return z;\r\n\tvar m = tag.match(attregexg2), y, j, w, i;\r\n\tif(m) for(i = 0; i != m.length; ++i) {\r\n\t\ty = m[i].match(attregex2);\r\n\t\tif((j=y[1].indexOf(\":\")) === -1) z[y[1]] = y[2].substr(1,y[2].length-2);\r\n\t\telse {\r\n\t\t\tif(y[1].substr(0,6) === \"xmlns:\") w = \"xmlns\"+y[1].substr(6);\r\n\t\t\telse w = y[1].substr(j+1);\r\n\t\t\tz[w] = y[2].substr(1,y[2].length-2);\r\n\t\t}\r\n\t}\r\n\treturn z;\r\n}\r\n\r\n// ----\r\n\r\nfunction xlml_format(format, value) {\r\n\tvar fmt = XLMLFormatMap[format] || unescapexml(format);\r\n\tif(fmt === \"General\") return SSF._general(value);\r\n\treturn SSF.format(fmt, value);\r\n}\r\n\r\nfunction xlml_set_custprop(Custprops, Rn, cp, val) {\r\n\tswitch((cp[0].match(/dt:dt=\"([\\w.]+)\"/)||[\"\",\"\"])[1]) {\r\n\t\tcase \"boolean\": val = parsexmlbool(val); break;\r\n\t\tcase \"i2\": case \"int\": val = parseInt(val, 10); break;\r\n\t\tcase \"r4\": case \"float\": val = parseFloat(val); break;\r\n\t\tcase \"date\": case \"dateTime.tz\": val = new Date(val); break;\r\n\t\tcase \"i8\": case \"string\": case \"fixed\": case \"uuid\": case \"bin.base64\": break;\r\n\t\tdefault: throw \"bad custprop:\" + cp[0];\r\n\t}\r\n\tCustprops[unescapexml(Rn[3])] = val;\r\n}\r\n\r\nfunction safe_format_xlml(cell, nf, o) {\r\n\ttry {\r\n\t\tif(cell.t === 'e') { cell.w = cell.w || BErr[cell.v]; }\r\n\t\telse if(nf === \"General\") {\r\n\t\t\tif(cell.t === 'n') {\r\n\t\t\t\tif((cell.v|0) === cell.v) cell.w = SSF._general_int(cell.v);\r\n\t\t\t\telse cell.w = SSF._general_num(cell.v);\r\n\t\t\t}\r\n\t\t\telse cell.w = SSF._general(cell.v);\r\n\t\t}\r\n\t\telse cell.w = xlml_format(nf||\"General\", cell.v);\r\n\t\tif(o.cellNF) cell.z = XLMLFormatMap[nf]||nf||\"General\";\r\n\t} catch(e) { if(o.WTF) throw e; }\r\n}\r\n\r\nfunction process_style_xlml(styles, stag, opts) {\r\n\tif(opts.cellStyles) {\r\n\t\tif(stag.Interior) {\r\n\t\t\tvar I = stag.Interior;\r\n\t\t\tif(I.Pattern) I.patternType = XLMLPatternTypeMap[I.Pattern] || I.Pattern;\r\n\t\t}\r\n\t}\r\n\tstyles[stag.ID] = stag;\r\n}\r\n\r\n/* TODO: there must exist some form of OSP-blessed spec */\r\nfunction parse_xlml_data(xml, ss, data, cell, base, styles, csty, row, o) {\r\n\tvar nf = \"General\", sid = cell.StyleID, S = {}; o = o || {};\r\n\tvar interiors = [];\r\n\tif(sid === undefined && row) sid = row.StyleID;\r\n\tif(sid === undefined && csty) sid = csty.StyleID;\r\n\twhile(styles[sid] !== undefined) {\r\n\t\tif(styles[sid].nf) nf = styles[sid].nf;\r\n\t\tif(styles[sid].Interior) interiors.push(styles[sid].Interior);\r\n\t\tif(!styles[sid].Parent) break;\r\n\t\tsid = styles[sid].Parent;\r\n\t}\r\n\tswitch(data.Type) {\r\n\t\tcase 'Boolean':\r\n\t\t\tcell.t = 'b';\r\n\t\t\tcell.v = parsexmlbool(xml);\r\n\t\t\tbreak;\r\n\t\tcase 'String':\r\n\t\t\tcell.t = 's'; cell.r = xlml_fixstr(unescapexml(xml));\r\n\t\t\tcell.v = xml.indexOf(\"<\") > -1 ? ss : cell.r;\r\n\t\t\tbreak;\r\n\t\tcase 'DateTime':\r\n\t\t\tcell.v = (Date.parse(xml) - new Date(Date.UTC(1899, 11, 30))) / (24 * 60 * 60 * 1000);\r\n\t\t\tif(cell.v !== cell.v) cell.v = unescapexml(xml);\r\n\t\t\telse if(cell.v >= 1 && cell.v<60) cell.v = cell.v -1;\r\n\t\t\tif(!nf || nf == \"General\") nf = \"yyyy-mm-dd\";\r\n\t\t\t/* falls through */\r\n\t\tcase 'Number':\r\n\t\t\tif(cell.v === undefined) cell.v=+xml;\r\n\t\t\tif(!cell.t) cell.t = 'n';\r\n\t\t\tbreak;\r\n\t\tcase 'Error': cell.t = 'e'; cell.v = RBErr[xml]; cell.w = xml; break;\r\n\t\tdefault: cell.t = 's'; cell.v = xlml_fixstr(ss); break;\r\n\t}\r\n\tsafe_format_xlml(cell, nf, o);\r\n\tif(o.cellFormula != null && cell.Formula) {\r\n\t\tcell.f = rc_to_a1(unescapexml(cell.Formula), base);\r\n\t\tcell.Formula = undefined;\r\n\t}\r\n\tif(o.cellStyles) {\r\n\t\tinteriors.forEach(function(x) {\r\n\t\t\tif(!S.patternType && x.patternType) S.patternType = x.patternType;\r\n\t\t});\r\n\t\tcell.s = S;\r\n\t}\r\n\tcell.ixfe = cell.StyleID !== undefined ? cell.StyleID : 'Default';\r\n}\r\n\r\nfunction xlml_clean_comment(comment) {\r\n\tcomment.t = comment.v;\r\n\tcomment.v = comment.w = comment.ixfe = undefined;\r\n}\r\n\r\nfunction xlml_normalize(d) {\r\n\tif(has_buf && Buffer.isBuffer(d)) return d.toString('utf8');\r\n\tif(typeof d === 'string') return d;\r\n\tthrow \"badf\";\r\n}\r\n\r\n/* TODO: Everything */\r\nvar xlmlregex = /<(\\/?)([a-z0-9]*:|)(\\w+)[^>]*>/mg;\r\nfunction parse_xlml_xml(d, opts) {\r\n\tvar str = xlml_normalize(d);\r\n\tvar Rn;\r\n\tvar state = [], tmp;\r\n\tvar sheets = {}, sheetnames = [], cursheet = {}, sheetname = \"\";\r\n\tvar table = {}, cell = {}, row = {}, dtag, didx;\r\n\tvar c = 0, r = 0;\r\n\tvar refguess = {s: {r:1000000, c:1000000}, e: {r:0, c:0} };\r\n\tvar styles = {}, stag = {};\r\n\tvar ss = \"\", fidx = 0;\r\n\tvar mergecells = [];\r\n\tvar Props = {}, Custprops = {}, pidx = 0, cp = {};\r\n\tvar comments = [], comment = {};\r\n\tvar cstys = [], csty;\r\n\txlmlregex.lastIndex = 0;\r\n\twhile((Rn = xlmlregex.exec(str))) switch(Rn[3]) {\r\n\t\tcase 'Data':\r\n\t\t\tif(state[state.length-1][1]) break;\r\n\t\t\tif(Rn[1]==='/') parse_xlml_data(str.slice(didx, Rn.index), ss, dtag, state[state.length-1][0]==\"Comment\"?comment:cell, {c:c,r:r}, styles, cstys[c], row, opts);\r\n\t\t\telse { ss = \"\"; dtag = xlml_parsexmltag(Rn[0]); didx = Rn.index + Rn[0].length; }\r\n\t\t\tbreak;\r\n\t\tcase 'Cell':\r\n\t\t\tif(Rn[1]==='/'){\r\n\t\t\t\tif(comments.length > 0) cell.c = comments;\r\n\t\t\t\tif((!opts.sheetRows || opts.sheetRows > r) && cell.v !== undefined) cursheet[encode_col(c) + encode_row(r)] = cell;\r\n\t\t\t\tif(cell.HRef) {\r\n\t\t\t\t\tcell.l = {Target:cell.HRef, tooltip:cell.HRefScreenTip};\r\n\t\t\t\t\tcell.HRef = cell.HRefScreenTip = undefined;\r\n\t\t\t\t}\r\n\t\t\t\tif(cell.MergeAcross || cell.MergeDown) {\r\n\t\t\t\t\tvar cc = c + (parseInt(cell.MergeAcross,10)|0);\r\n\t\t\t\t\tvar rr = r + (parseInt(cell.MergeDown,10)|0);\r\n\t\t\t\t\tmergecells.push({s:{c:c,r:r},e:{c:cc,r:rr}});\r\n\t\t\t\t}\r\n\t\t\t\t++c;\r\n\t\t\t\tif(cell.MergeAcross) c += +cell.MergeAcross;\r\n\t\t\t} else {\r\n\t\t\t\tcell = xlml_parsexmltagobj(Rn[0]);\r\n\t\t\t\tif(cell.Index) c = +cell.Index - 1;\r\n\t\t\t\tif(c < refguess.s.c) refguess.s.c = c;\r\n\t\t\t\tif(c > refguess.e.c) refguess.e.c = c;\r\n\t\t\t\tif(Rn[0].substr(-2) === \"/>\") ++c;\r\n\t\t\t\tcomments = [];\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\t\tcase 'Row':\r\n\t\t\tif(Rn[1]==='/' || Rn[0].substr(-2) === \"/>\") {\r\n\t\t\t\tif(r < refguess.s.r) refguess.s.r = r;\r\n\t\t\t\tif(r > refguess.e.r) refguess.e.r = r;\r\n\t\t\t\tif(Rn[0].substr(-2) === \"/>\") {\r\n\t\t\t\t\trow = xlml_parsexmltag(Rn[0]);\r\n\t\t\t\t\tif(row.Index) r = +row.Index - 1;\r\n\t\t\t\t}\r\n\t\t\t\tc = 0; ++r;\r\n\t\t\t} else {\r\n\t\t\t\trow = xlml_parsexmltag(Rn[0]);\r\n\t\t\t\tif(row.Index) r = +row.Index - 1;\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\t\tcase 'Worksheet': /* TODO: read range from FullRows/FullColumns */\r\n\t\t\tif(Rn[1]==='/'){\r\n\t\t\t\tif((tmp=state.pop())[0]!==Rn[3]) throw \"Bad state: \"+tmp;\r\n\t\t\t\tsheetnames.push(sheetname);\r\n\t\t\t\tif(refguess.s.r <= refguess.e.r && refguess.s.c <= refguess.e.c) cursheet[\"!ref\"] = encode_range(refguess);\r\n\t\t\t\tif(mergecells.length) cursheet[\"!merges\"] = mergecells;\r\n\t\t\t\tsheets[sheetname] = cursheet;\r\n\t\t\t} else {\r\n\t\t\t\trefguess = {s: {r:1000000, c:1000000}, e: {r:0, c:0} };\r\n\t\t\t\tr = c = 0;\r\n\t\t\t\tstate.push([Rn[3], false]);\r\n\t\t\t\ttmp = xlml_parsexmltag(Rn[0]);\r\n\t\t\t\tsheetname = tmp.Name;\r\n\t\t\t\tcursheet = {};\r\n\t\t\t\tmergecells = [];\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\t\tcase 'Table':\r\n\t\t\tif(Rn[1]==='/'){if((tmp=state.pop())[0]!==Rn[3]) throw \"Bad state: \"+tmp;}\r\n\t\t\telse if(Rn[0].slice(-2) == \"/>\") break;\r\n\t\t\telse {\r\n\t\t\t\ttable = xlml_parsexmltag(Rn[0]);\r\n\t\t\t\tstate.push([Rn[3], false]);\r\n\t\t\t\tcstys = [];\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\r\n\t\tcase 'Style':\r\n\t\t\tif(Rn[1]==='/') process_style_xlml(styles, stag, opts);\r\n\t\t\telse stag = xlml_parsexmltag(Rn[0]);\r\n\t\t\tbreak;\r\n\r\n\t\tcase 'NumberFormat':\r\n\t\t\tstag.nf = xlml_parsexmltag(Rn[0]).Format || \"General\";\r\n\t\t\tbreak;\r\n\r\n\t\tcase 'Column':\r\n\t\t\tif(state[state.length-1][0] !== 'Table') break;\r\n\t\t\tcsty = xlml_parsexmltag(Rn[0]);\r\n\t\t\tcstys[(csty.Index-1||cstys.length)] = csty;\r\n\t\t\tfor(var i = 0; i < +csty.Span; ++i) cstys[cstys.length] = csty;\r\n\t\t\tbreak;\r\n\r\n\t\tcase 'NamedRange': break;\r\n\t\tcase 'NamedCell': break;\r\n\t\tcase 'B': break;\r\n\t\tcase 'I': break;\r\n\t\tcase 'U': break;\r\n\t\tcase 'S': break;\r\n\t\tcase 'Sub': break;\r\n\t\tcase 'Sup': break;\r\n\t\tcase 'Span': break;\r\n\t\tcase 'Border': break;\r\n\t\tcase 'Alignment': break;\r\n\t\tcase 'Borders': break;\r\n\t\tcase 'Font':\r\n\t\t\tif(Rn[0].substr(-2) === \"/>\") break;\r\n\t\t\telse if(Rn[1]===\"/\") ss += str.slice(fidx, Rn.index);\r\n\t\t\telse fidx = Rn.index + Rn[0].length;\r\n\t\t\tbreak;\r\n\t\tcase 'Interior':\r\n\t\t\tif(!opts.cellStyles) break;\r\n\t\t\tstag.Interior = xlml_parsexmltag(Rn[0]);\r\n\t\t\tbreak;\r\n\t\tcase 'Protection': break;\r\n\r\n\t\tcase 'Author':\r\n\t\tcase 'Title':\r\n\t\tcase 'Description':\r\n\t\tcase 'Created':\r\n\t\tcase 'Keywords':\r\n\t\tcase 'Subject':\r\n\t\tcase 'Category':\r\n\t\tcase 'Company':\r\n\t\tcase 'LastAuthor':\r\n\t\tcase 'LastSaved':\r\n\t\tcase 'LastPrinted':\r\n\t\tcase 'Version':\r\n\t\tcase 'Revision':\r\n\t\tcase 'TotalTime':\r\n\t\tcase 'HyperlinkBase':\r\n\t\tcase 'Manager':\r\n\t\t\tif(Rn[0].substr(-2) === \"/>\") break;\r\n\t\t\telse if(Rn[1]===\"/\") xlml_set_prop(Props, Rn[3], str.slice(pidx, Rn.index));\r\n\t\t\telse pidx = Rn.index + Rn[0].length;\r\n\t\t\tbreak;\r\n\t\tcase 'Paragraphs': break;\r\n\r\n\t\tcase 'Styles':\r\n\t\tcase 'Workbook':\r\n\t\t\tif(Rn[1]==='/'){if((tmp=state.pop())[0]!==Rn[3]) throw \"Bad state: \"+tmp;}\r\n\t\t\telse state.push([Rn[3], false]);\r\n\t\t\tbreak;\r\n\r\n\t\tcase 'Comment':\r\n\t\t\tif(Rn[1]==='/'){\r\n\t\t\t\tif((tmp=state.pop())[0]!==Rn[3]) throw \"Bad state: \"+tmp;\r\n\t\t\t\txlml_clean_comment(comment);\r\n\t\t\t\tcomments.push(comment);\r\n\t\t\t} else {\r\n\t\t\t\tstate.push([Rn[3], false]);\r\n\t\t\t\ttmp = xlml_parsexmltag(Rn[0]);\r\n\t\t\t\tcomment = {a:tmp.Author};\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\r\n\t\tcase 'Name': break;\r\n\r\n\t\tcase 'ComponentOptions':\r\n\t\tcase 'DocumentProperties':\r\n\t\tcase 'CustomDocumentProperties':\r\n\t\tcase 'OfficeDocumentSettings':\r\n\t\tcase 'PivotTable':\r\n\t\tcase 'PivotCache':\r\n\t\tcase 'Names':\r\n\t\tcase 'MapInfo':\r\n\t\tcase 'PageBreaks':\r\n\t\tcase 'QueryTable':\r\n\t\tcase 'DataValidation':\r\n\t\tcase 'AutoFilter':\r\n\t\tcase 'Sorting':\r\n\t\tcase 'Schema':\r\n\t\tcase 'data':\r\n\t\tcase 'ConditionalFormatting':\r\n\t\tcase 'SmartTagType':\r\n\t\tcase 'SmartTags':\r\n\t\tcase 'ExcelWorkbook':\r\n\t\tcase 'WorkbookOptions':\r\n\t\tcase 'WorksheetOptions':\r\n\t\t\tif(Rn[1]==='/'){if((tmp=state.pop())[0]!==Rn[3]) throw \"Bad state: \"+tmp;}\r\n\t\t\telse if(Rn[0].charAt(Rn[0].length-2) !== '/') state.push([Rn[3], true]);\r\n\t\t\tbreak;\r\n\r\n\t\tdefault:\r\n\t\t\tvar seen = true;\r\n\t\t\tswitch(state[state.length-1][0]) {\r\n\t\t\t\t/* OfficeDocumentSettings */\r\n\t\t\t\tcase 'OfficeDocumentSettings': switch(Rn[3]) {\r\n\t\t\t\t\tcase 'AllowPNG': break;\r\n\t\t\t\t\tcase 'RemovePersonalInformation': break;\r\n\t\t\t\t\tcase 'DownloadComponents': break;\r\n\t\t\t\t\tcase 'LocationOfComponents': break;\r\n\t\t\t\t\tcase 'Colors': break;\r\n\t\t\t\t\tcase 'Color': break;\r\n\t\t\t\t\tcase 'Index': break;\r\n\t\t\t\t\tcase 'RGB': break;\r\n\t\t\t\t\tcase 'PixelsPerInch': break;\r\n\t\t\t\t\tcase 'TargetScreenSize': break;\r\n\t\t\t\t\tcase 'ReadOnlyRecommended': break;\r\n\t\t\t\t\tdefault: seen = false;\r\n\t\t\t\t} break;\r\n\r\n\t\t\t\t/* ComponentOptions */\r\n\t\t\t\tcase 'ComponentOptions': switch(Rn[3]) {\r\n\t\t\t\t\tcase 'Toolbar': break;\r\n\t\t\t\t\tcase 'HideOfficeLogo': break;\r\n\t\t\t\t\tcase 'SpreadsheetAutoFit': break;\r\n\t\t\t\t\tcase 'Label': break;\r\n\t\t\t\t\tcase 'Caption': break;\r\n\t\t\t\t\tcase 'MaxHeight': break;\r\n\t\t\t\t\tcase 'MaxWidth': break;\r\n\t\t\t\t\tcase 'NextSheetNumber': break;\r\n\t\t\t\t\tdefault: seen = false;\r\n\t\t\t\t} break;\r\n\r\n\t\t\t\t/* ExcelWorkbook */\r\n\t\t\t\tcase 'ExcelWorkbook': switch(Rn[3]) {\r\n\t\t\t\t\tcase 'WindowHeight': break;\r\n\t\t\t\t\tcase 'WindowWidth': break;\r\n\t\t\t\t\tcase 'WindowTopX': break;\r\n\t\t\t\t\tcase 'WindowTopY': break;\r\n\t\t\t\t\tcase 'TabRatio': break;\r\n\t\t\t\t\tcase 'ProtectStructure': break;\r\n\t\t\t\t\tcase 'ProtectWindows': break;\r\n\t\t\t\t\tcase 'ActiveSheet': break;\r\n\t\t\t\t\tcase 'DisplayInkNotes': break;\r\n\t\t\t\t\tcase 'FirstVisibleSheet': break;\r\n\t\t\t\t\tcase 'SupBook': break;\r\n\t\t\t\t\tcase 'SheetName': break;\r\n\t\t\t\t\tcase 'SheetIndex': break;\r\n\t\t\t\t\tcase 'SheetIndexFirst': break;\r\n\t\t\t\t\tcase 'SheetIndexLast': break;\r\n\t\t\t\t\tcase 'Dll': break;\r\n\t\t\t\t\tcase 'AcceptLabelsInFormulas': break;\r\n\t\t\t\t\tcase 'DoNotSaveLinkValues': break;\r\n\t\t\t\t\tcase 'Date1904': break;\r\n\t\t\t\t\tcase 'Iteration': break;\r\n\t\t\t\t\tcase 'MaxIterations': break;\r\n\t\t\t\t\tcase 'MaxChange': break;\r\n\t\t\t\t\tcase 'Path': break;\r\n\t\t\t\t\tcase 'Xct': break;\r\n\t\t\t\t\tcase 'Count': break;\r\n\t\t\t\t\tcase 'SelectedSheets': break;\r\n\t\t\t\t\tcase 'Calculation': break;\r\n\t\t\t\t\tcase 'Uncalced': break;\r\n\t\t\t\t\tcase 'StartupPrompt': break;\r\n\t\t\t\t\tcase 'Crn': break;\r\n\t\t\t\t\tcase 'ExternName': break;\r\n\t\t\t\t\tcase 'Formula': break;\r\n\t\t\t\t\tcase 'ColFirst': break;\r\n\t\t\t\t\tcase 'ColLast': break;\r\n\t\t\t\t\tcase 'WantAdvise': break;\r\n\t\t\t\t\tcase 'Boolean': break;\r\n\t\t\t\t\tcase 'Error': break;\r\n\t\t\t\t\tcase 'Text': break;\r\n\t\t\t\t\tcase 'OLE': break;\r\n\t\t\t\t\tcase 'NoAutoRecover': break;\r\n\t\t\t\t\tcase 'PublishObjects': break;\r\n\t\t\t\t\tcase 'DoNotCalculateBeforeSave': break;\r\n\t\t\t\t\tcase 'Number': break;\r\n\t\t\t\t\tcase 'RefModeR1C1': break;\r\n\t\t\t\t\tcase 'EmbedSaveSmartTags': break;\r\n\t\t\t\t\tdefault: seen = false;\r\n\t\t\t\t} break;\r\n\r\n\t\t\t\t/* WorkbookOptions */\r\n\t\t\t\tcase 'WorkbookOptions': switch(Rn[3]) {\r\n\t\t\t\t\tcase 'OWCVersion': break;\r\n\t\t\t\t\tcase 'Height': break;\r\n\t\t\t\t\tcase 'Width': break;\r\n\t\t\t\t\tdefault: seen = false;\r\n\t\t\t\t} break;\r\n\r\n\t\t\t\t/* WorksheetOptions */\r\n\t\t\t\tcase 'WorksheetOptions': switch(Rn[3]) {\r\n\t\t\t\t\tcase 'Unsynced': break;\r\n\t\t\t\t\tcase 'Visible': break;\r\n\t\t\t\t\tcase 'Print': break;\r\n\t\t\t\t\tcase 'Panes': break;\r\n\t\t\t\t\tcase 'Scale': break;\r\n\t\t\t\t\tcase 'Pane': break;\r\n\t\t\t\t\tcase 'Number': break;\r\n\t\t\t\t\tcase 'Layout': break;\r\n\t\t\t\t\tcase 'Header': break;\r\n\t\t\t\t\tcase 'Footer': break;\r\n\t\t\t\t\tcase 'PageSetup': break;\r\n\t\t\t\t\tcase 'PageMargins': break;\r\n\t\t\t\t\tcase 'Selected': break;\r\n\t\t\t\t\tcase 'ProtectObjects': break;\r\n\t\t\t\t\tcase 'EnableSelection': break;\r\n\t\t\t\t\tcase 'ProtectScenarios': break;\r\n\t\t\t\t\tcase 'ValidPrinterInfo': break;\r\n\t\t\t\t\tcase 'HorizontalResolution': break;\r\n\t\t\t\t\tcase 'VerticalResolution': break;\r\n\t\t\t\t\tcase 'NumberofCopies': break;\r\n\t\t\t\t\tcase 'ActiveRow': break;\r\n\t\t\t\t\tcase 'ActiveCol': break;\r\n\t\t\t\t\tcase 'ActivePane': break;\r\n\t\t\t\t\tcase 'TopRowVisible': break;\r\n\t\t\t\t\tcase 'TopRowBottomPane': break;\r\n\t\t\t\t\tcase 'LeftColumnVisible': break;\r\n\t\t\t\t\tcase 'LeftColumnRightPane': break;\r\n\t\t\t\t\tcase 'FitToPage': break;\r\n\t\t\t\t\tcase 'RangeSelection': break;\r\n\t\t\t\t\tcase 'PaperSizeIndex': break;\r\n\t\t\t\t\tcase 'PageLayoutZoom': break;\r\n\t\t\t\t\tcase 'PageBreakZoom': break;\r\n\t\t\t\t\tcase 'FilterOn': break;\r\n\t\t\t\t\tcase 'DoNotDisplayGridlines': break;\r\n\t\t\t\t\tcase 'SplitHorizontal': break;\r\n\t\t\t\t\tcase 'SplitVertical': break;\r\n\t\t\t\t\tcase 'FreezePanes': break;\r\n\t\t\t\t\tcase 'FrozenNoSplit': break;\r\n\t\t\t\t\tcase 'FitWidth': break;\r\n\t\t\t\t\tcase 'FitHeight': break;\r\n\t\t\t\t\tcase 'CommentsLayout': break;\r\n\t\t\t\t\tcase 'Zoom': break;\r\n\t\t\t\t\tcase 'LeftToRight': break;\r\n\t\t\t\t\tcase 'Gridlines': break;\r\n\t\t\t\t\tcase 'AllowSort': break;\r\n\t\t\t\t\tcase 'AllowFilter': break;\r\n\t\t\t\t\tcase 'AllowInsertRows': break;\r\n\t\t\t\t\tcase 'AllowDeleteRows': break;\r\n\t\t\t\t\tcase 'AllowInsertCols': break;\r\n\t\t\t\t\tcase 'AllowDeleteCols': break;\r\n\t\t\t\t\tcase 'AllowInsertHyperlinks': break;\r\n\t\t\t\t\tcase 'AllowFormatCells': break;\r\n\t\t\t\t\tcase 'AllowSizeCols': break;\r\n\t\t\t\t\tcase 'AllowSizeRows': break;\r\n\t\t\t\t\tcase 'NoSummaryRowsBelowDetail': break;\r\n\t\t\t\t\tcase 'TabColorIndex': break;\r\n\t\t\t\t\tcase 'DoNotDisplayHeadings': break;\r\n\t\t\t\t\tcase 'ShowPageLayoutZoom': break;\r\n\t\t\t\t\tcase 'NoSummaryColumnsRightDetail': break;\r\n\t\t\t\t\tcase 'BlackAndWhite': break;\r\n\t\t\t\t\tcase 'DoNotDisplayZeros': break;\r\n\t\t\t\t\tcase 'DisplayPageBreak': break;\r\n\t\t\t\t\tcase 'RowColHeadings': break;\r\n\t\t\t\t\tcase 'DoNotDisplayOutline': break;\r\n\t\t\t\t\tcase 'NoOrientation': break;\r\n\t\t\t\t\tcase 'AllowUsePivotTables': break;\r\n\t\t\t\t\tcase 'ZeroHeight': break;\r\n\t\t\t\t\tcase 'ViewableRange': break;\r\n\t\t\t\t\tcase 'Selection': break;\r\n\t\t\t\t\tcase 'ProtectContents': break;\r\n\t\t\t\t\tdefault: seen = false;\r\n\t\t\t\t} break;\r\n\r\n\t\t\t\t/* PivotTable */\r\n\t\t\t\tcase 'PivotTable': case 'PivotCache': switch(Rn[3]) {\r\n\t\t\t\t\tcase 'ImmediateItemsOnDrop': break;\r\n\t\t\t\t\tcase 'ShowPageMultipleItemLabel': break;\r\n\t\t\t\t\tcase 'CompactRowIndent': break;\r\n\t\t\t\t\tcase 'Location': break;\r\n\t\t\t\t\tcase 'PivotField': break;\r\n\t\t\t\t\tcase 'Orientation': break;\r\n\t\t\t\t\tcase 'LayoutForm': break;\r\n\t\t\t\t\tcase 'LayoutSubtotalLocation': break;\r\n\t\t\t\t\tcase 'LayoutCompactRow': break;\r\n\t\t\t\t\tcase 'Position': break;\r\n\t\t\t\t\tcase 'PivotItem': break;\r\n\t\t\t\t\tcase 'DataType': break;\r\n\t\t\t\t\tcase 'DataField': break;\r\n\t\t\t\t\tcase 'SourceName': break;\r\n\t\t\t\t\tcase 'ParentField': break;\r\n\t\t\t\t\tcase 'PTLineItems': break;\r\n\t\t\t\t\tcase 'PTLineItem': break;\r\n\t\t\t\t\tcase 'CountOfSameItems': break;\r\n\t\t\t\t\tcase 'Item': break;\r\n\t\t\t\t\tcase 'ItemType': break;\r\n\t\t\t\t\tcase 'PTSource': break;\r\n\t\t\t\t\tcase 'CacheIndex': break;\r\n\t\t\t\t\tcase 'ConsolidationReference': break;\r\n\t\t\t\t\tcase 'FileName': break;\r\n\t\t\t\t\tcase 'Reference': break;\r\n\t\t\t\t\tcase 'NoColumnGrand': break;\r\n\t\t\t\t\tcase 'NoRowGrand': break;\r\n\t\t\t\t\tcase 'BlankLineAfterItems': break;\r\n\t\t\t\t\tcase 'Hidden': break;\r\n\t\t\t\t\tcase 'Subtotal': break;\r\n\t\t\t\t\tcase 'BaseField': break;\r\n\t\t\t\t\tcase 'MapChildItems': break;\r\n\t\t\t\t\tcase 'Function': break;\r\n\t\t\t\t\tcase 'RefreshOnFileOpen': break;\r\n\t\t\t\t\tcase 'PrintSetTitles': break;\r\n\t\t\t\t\tcase 'MergeLabels': break;\r\n\t\t\t\t\tcase 'DefaultVersion': break;\r\n\t\t\t\t\tcase 'RefreshName': break;\r\n\t\t\t\t\tcase 'RefreshDate': break;\r\n\t\t\t\t\tcase 'RefreshDateCopy': break;\r\n\t\t\t\t\tcase 'VersionLastRefresh': break;\r\n\t\t\t\t\tcase 'VersionLastUpdate': break;\r\n\t\t\t\t\tcase 'VersionUpdateableMin': break;\r\n\t\t\t\t\tcase 'VersionRefreshableMin': break;\r\n\t\t\t\t\tcase 'Calculation': break;\r\n\t\t\t\t\tdefault: seen = false;\r\n\t\t\t\t} break;\r\n\r\n\t\t\t\t/* PageBreaks */\r\n\t\t\t\tcase 'PageBreaks': switch(Rn[3]) {\r\n\t\t\t\t\tcase 'ColBreaks': break;\r\n\t\t\t\t\tcase 'ColBreak': break;\r\n\t\t\t\t\tcase 'RowBreaks': break;\r\n\t\t\t\t\tcase 'RowBreak': break;\r\n\t\t\t\t\tcase 'ColStart': break;\r\n\t\t\t\t\tcase 'ColEnd': break;\r\n\t\t\t\t\tcase 'RowEnd': break;\r\n\t\t\t\t\tdefault: seen = false;\r\n\t\t\t\t} break;\r\n\r\n\t\t\t\t/* AutoFilter */\r\n\t\t\t\tcase 'AutoFilter': switch(Rn[3]) {\r\n\t\t\t\t\tcase 'AutoFilterColumn': break;\r\n\t\t\t\t\tcase 'AutoFilterCondition': break;\r\n\t\t\t\t\tcase 'AutoFilterAnd': break;\r\n\t\t\t\t\tcase 'AutoFilterOr': break;\r\n\t\t\t\t\tdefault: seen = false;\r\n\t\t\t\t} break;\r\n\r\n\t\t\t\t/* QueryTable */\r\n\t\t\t\tcase 'QueryTable': switch(Rn[3]) {\r\n\t\t\t\t\tcase 'Id': break;\r\n\t\t\t\t\tcase 'AutoFormatFont': break;\r\n\t\t\t\t\tcase 'AutoFormatPattern': break;\r\n\t\t\t\t\tcase 'QuerySource': break;\r\n\t\t\t\t\tcase 'QueryType': break;\r\n\t\t\t\t\tcase 'EnableRedirections': break;\r\n\t\t\t\t\tcase 'RefreshedInXl9': break;\r\n\t\t\t\t\tcase 'URLString': break;\r\n\t\t\t\t\tcase 'HTMLTables': break;\r\n\t\t\t\t\tcase 'Connection': break;\r\n\t\t\t\t\tcase 'CommandText': break;\r\n\t\t\t\t\tcase 'RefreshInfo': break;\r\n\t\t\t\t\tcase 'NoTitles': break;\r\n\t\t\t\t\tcase 'NextId': break;\r\n\t\t\t\t\tcase 'ColumnInfo': break;\r\n\t\t\t\t\tcase 'OverwriteCells': break;\r\n\t\t\t\t\tcase 'DoNotPromptForFile': break;\r\n\t\t\t\t\tcase 'TextWizardSettings': break;\r\n\t\t\t\t\tcase 'Source': break;\r\n\t\t\t\t\tcase 'Number': break;\r\n\t\t\t\t\tcase 'Decimal': break;\r\n\t\t\t\t\tcase 'ThousandSeparator': break;\r\n\t\t\t\t\tcase 'TrailingMinusNumbers': break;\r\n\t\t\t\t\tcase 'FormatSettings': break;\r\n\t\t\t\t\tcase 'FieldType': break;\r\n\t\t\t\t\tcase 'Delimiters': break;\r\n\t\t\t\t\tcase 'Tab': break;\r\n\t\t\t\t\tcase 'Comma': break;\r\n\t\t\t\t\tcase 'AutoFormatName': break;\r\n\t\t\t\t\tcase 'VersionLastEdit': break;\r\n\t\t\t\t\tcase 'VersionLastRefresh': break;\r\n\t\t\t\t\tdefault: seen = false;\r\n\t\t\t\t} break;\r\n\r\n\t\t\t\t/* Sorting */\r\n\t\t\t\tcase 'Sorting':\r\n\t\t\t\t/* ConditionalFormatting */\r\n\t\t\t\tcase 'ConditionalFormatting':\r\n\t\t\t\t/* DataValidation */\r\n\t\t\t\tcase 'DataValidation': switch(Rn[3]) {\r\n\t\t\t\t\tcase 'Range': break;\r\n\t\t\t\t\tcase 'Type': break;\r\n\t\t\t\t\tcase 'Min': break;\r\n\t\t\t\t\tcase 'Max': break;\r\n\t\t\t\t\tcase 'Sort': break;\r\n\t\t\t\t\tcase 'Descending': break;\r\n\t\t\t\t\tcase 'Order': break;\r\n\t\t\t\t\tcase 'CaseSensitive': break;\r\n\t\t\t\t\tcase 'Value': break;\r\n\t\t\t\t\tcase 'ErrorStyle': break;\r\n\t\t\t\t\tcase 'ErrorMessage': break;\r\n\t\t\t\t\tcase 'ErrorTitle': break;\r\n\t\t\t\t\tcase 'CellRangeList': break;\r\n\t\t\t\t\tcase 'InputMessage': break;\r\n\t\t\t\t\tcase 'InputTitle': break;\r\n\t\t\t\t\tcase 'ComboHide': break;\r\n\t\t\t\t\tcase 'InputHide': break;\r\n\t\t\t\t\tcase 'Condition': break;\r\n\t\t\t\t\tcase 'Qualifier': break;\r\n\t\t\t\t\tcase 'UseBlank': break;\r\n\t\t\t\t\tcase 'Value1': break;\r\n\t\t\t\t\tcase 'Value2': break;\r\n\t\t\t\t\tcase 'Format': break;\r\n\t\t\t\t\tdefault: seen = false;\r\n\t\t\t\t} break;\r\n\r\n\t\t\t\t/* MapInfo (schema) */\r\n\t\t\t\tcase 'MapInfo': case 'Schema': case 'data': switch(Rn[3]) {\r\n\t\t\t\t\tcase 'Map': break;\r\n\t\t\t\t\tcase 'Entry': break;\r\n\t\t\t\t\tcase 'Range': break;\r\n\t\t\t\t\tcase 'XPath': break;\r\n\t\t\t\t\tcase 'Field': break;\r\n\t\t\t\t\tcase 'XSDType': break;\r\n\t\t\t\t\tcase 'FilterOn': break;\r\n\t\t\t\t\tcase 'Aggregate': break;\r\n\t\t\t\t\tcase 'ElementType': break;\r\n\t\t\t\t\tcase 'AttributeType': break;\r\n\t\t\t\t/* These are from xsd (XML Schema Definition) */\r\n\t\t\t\t\tcase 'schema':\r\n\t\t\t\t\tcase 'element':\r\n\t\t\t\t\tcase 'complexType':\r\n\t\t\t\t\tcase 'datatype':\r\n\t\t\t\t\tcase 'all':\r\n\t\t\t\t\tcase 'attribute':\r\n\t\t\t\t\tcase 'extends': break;\r\n\r\n\t\t\t\t\tcase 'row': break;\r\n\t\t\t\t\tdefault: seen = false;\r\n\t\t\t\t} break;\r\n\r\n\t\t\t\t/* SmartTags (can be anything) */\r\n\t\t\t\tcase 'SmartTags': break;\r\n\r\n\t\t\t\tdefault: seen = false; break;\r\n\t\t\t}\r\n\t\t\tif(seen) break;\r\n\t\t\t/* CustomDocumentProperties */\r\n\t\t\tif(!state[state.length-1][1]) throw 'Unrecognized tag: ' + Rn[3] + \"|\" + state.join(\"|\");\r\n\t\t\tif(state[state.length-1][0]==='CustomDocumentProperties') {\r\n\t\t\t\tif(Rn[0].substr(-2) === \"/>\") break;\r\n\t\t\t\telse if(Rn[1]===\"/\") xlml_set_custprop(Custprops, Rn, cp, str.slice(pidx, Rn.index));\r\n\t\t\t\telse { cp = Rn; pidx = Rn.index + Rn[0].length; }\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tif(opts.WTF) throw 'Unrecognized tag: ' + Rn[3] + \"|\" + state.join(\"|\");\r\n\t}\r\n\tvar out = {};\r\n\tif(!opts.bookSheets && !opts.bookProps) out.Sheets = sheets;\r\n\tout.SheetNames = sheetnames;\r\n\tout.SSF = SSF.get_table();\r\n\tout.Props = Props;\r\n\tout.Custprops = Custprops;\r\n\treturn out;\r\n}\r\n\r\nfunction parse_xlml(data, opts) {\r\n\tfix_read_opts(opts=opts||{});\r\n\tswitch(opts.type||\"base64\") {\r\n\t\tcase \"base64\": return parse_xlml_xml(Base64.decode(data), opts);\r\n\t\tcase \"binary\": case \"buffer\": case \"file\": return parse_xlml_xml(data, opts);\r\n\t\tcase \"array\": return parse_xlml_xml(data.map(_chr).join(\"\"), opts);\r\n\t}\r\n}\r\n\r\nfunction write_xlml(wb, opts) { }\r\n\r\n/* [MS-OLEDS] 2.3.8 CompObjStream */\r\nfunction parse_compobj(obj) {\r\n\tvar v = {};\r\n\tvar o = obj.content;\r\n\r\n\t/* [MS-OLEDS] 2.3.7 CompObjHeader -- All fields MUST be ignored */\r\n\tvar l = 28, m;\r\n\tm = __lpstr(o, l);\r\n\tl += 4 + __readUInt32LE(o,l);\r\n\tv.UserType = m;\r\n\r\n\t/* [MS-OLEDS] 2.3.1 ClipboardFormatOrAnsiString */\r\n\tm = __readUInt32LE(o,l); l+= 4;\r\n\tswitch(m) {\r\n\t\tcase 0x00000000: break;\r\n\t\tcase 0xffffffff: case 0xfffffffe: l+=4; break;\r\n\t\tdefault:\r\n\t\t\tif(m > 0x190) throw new Error(\"Unsupported Clipboard: \" + m.toString(16));\r\n\t\t\tl += m;\r\n\t}\r\n\r\n\tm = __lpstr(o, l); l += m.length === 0 ? 0 : 5 + m.length; v.Reserved1 = m;\r\n\r\n\tif((m = __readUInt32LE(o,l)) !== 0x71b2e9f4) return v;\r\n\tthrow \"Unsupported Unicode Extension\";\r\n}\r\n\r\n/* 2.4.58 Continue logic */\r\nfunction slurp(R, blob, length, opts) {\r\n\tvar l = length;\r\n\tvar bufs = [];\r\n\tvar d = blob.slice(blob.l,blob.l+l);\r\n\tif(opts && opts.enc && opts.enc.insitu_decrypt) switch(R.n) {\r\n\tcase 'BOF': case 'FilePass': case 'FileLock': case 'InterfaceHdr': case 'RRDInfo': case 'RRDHead': case 'UsrExcl': break;\r\n\tdefault:\r\n\t\tif(d.length === 0) break;\r\n\t\topts.enc.insitu_decrypt(d);\r\n\t}\r\n\tbufs.push(d);\r\n\tblob.l += l;\r\n\tvar next = (XLSRecordEnum[__readUInt16LE(blob,blob.l)]);\r\n\twhile(next != null && next.n === 'Continue') {\r\n\t\tl = __readUInt16LE(blob,blob.l+2);\r\n\t\tbufs.push(blob.slice(blob.l+4,blob.l+4+l));\r\n\t\tblob.l += 4+l;\r\n\t\tnext = (XLSRecordEnum[__readUInt16LE(blob, blob.l)]);\r\n\t}\r\n\tvar b = bconcat(bufs);\r\n\tprep_blob(b, 0);\r\n\tvar ll = 0; b.lens = [];\r\n\tfor(var j = 0; j < bufs.length; ++j) { b.lens.push(ll); ll += bufs[j].length; }\r\n\treturn R.f(b, b.length, opts);\r\n}\r\n\r\nfunction safe_format_xf(p, opts, date1904) {\r\n\tif(!p.XF) return;\r\n\ttry {\r\n\t\tvar fmtid = p.XF.ifmt||0;\r\n\t\tif(p.t === 'e') { p.w = p.w || BErr[p.v]; }\r\n\t\telse if(fmtid === 0) {\r\n\t\t\tif(p.t === 'n') {\r\n\t\t\t\tif((p.v|0) === p.v) p.w = SSF._general_int(p.v);\r\n\t\t\t\telse p.w = SSF._general_num(p.v);\r\n\t\t\t}\r\n\t\t\telse p.w = SSF._general(p.v);\r\n\t\t}\r\n\t\telse p.w = SSF.format(fmtid,p.v, {date1904:date1904||false});\r\n\t\tif(opts.cellNF) p.z = SSF._table[fmtid];\r\n\t} catch(e) { if(opts.WTF) throw e; }\r\n}\r\n\r\nfunction make_cell(val, ixfe, t) {\r\n\treturn {v:val, ixfe:ixfe, t:t};\r\n}\r\n\r\n// 2.3.2\r\nfunction parse_workbook(blob, options) {\r\n\tvar wb = {opts:{}};\r\n\tvar Sheets = {};\r\n\tvar out = {};\r\n\tvar Directory = {};\r\n\tvar found_sheet = false;\r\n\tvar range = {};\r\n\tvar last_formula = null;\r\n\tvar sst = [];\r\n\tvar cur_sheet = \"\";\r\n\tvar Preamble = {};\r\n\tvar lastcell, last_cell, cc, cmnt, rng, rngC, rngR;\r\n\tvar shared_formulae = {};\r\n\tvar array_formulae = []; /* TODO: something more clever */\r\n\tvar temp_val;\r\n\tvar country;\r\n\tvar cell_valid = true;\r\n\tvar XFs = []; /* XF records */\r\n\tvar palette = [];\r\n\tvar get_rgb = function getrgb(icv) {\r\n\t\tif(icv < 8) return XLSIcv[icv];\r\n\t\tif(icv < 64) return palette[icv-8] || XLSIcv[icv];\r\n\t\treturn XLSIcv[icv];\r\n\t};\r\n\tvar process_cell_style = function pcs(cell, line) {\r\n\t\tvar xfd = line.XF.data;\r\n\t\tif(!xfd || !xfd.patternType) return;\r\n\t\tline.s = {};\r\n\t\tline.s.patternType = xfd.patternType;\r\n\t\tvar t;\r\n\t\tif((t = rgb2Hex(get_rgb(xfd.icvFore)))) { line.s.fgColor = {rgb:t}; }\r\n\t\tif((t = rgb2Hex(get_rgb(xfd.icvBack)))) { line.s.bgColor = {rgb:t}; }\r\n\t};\r\n\tvar addcell = function addcell(cell, line, options) {\r\n\t\tif(!cell_valid) return;\r\n\t\tif(options.cellStyles && line.XF && line.XF.data) process_cell_style(cell, line);\r\n\t\tlastcell = cell;\r\n\t\tlast_cell = encode_cell(cell);\r\n\t\tif(range.s) {\r\n\t\t\tif(cell.r < range.s.r) range.s.r = cell.r;\r\n\t\t\tif(cell.c < range.s.c) range.s.c = cell.c;\r\n\t\t}\r\n\t\tif(range.e) {\r\n\t\t\tif(cell.r + 1 > range.e.r) range.e.r = cell.r + 1;\r\n\t\t\tif(cell.c + 1 > range.e.c) range.e.c = cell.c + 1;\r\n\t\t}\r\n\t\tif(options.sheetRows && lastcell.r >= options.sheetRows) cell_valid = false;\r\n\t\telse out[last_cell] = line;\r\n\t};\r\n\tvar opts = {\r\n\t\tenc: false, // encrypted\r\n\t\tsbcch: 0, // cch in the preceding SupBook\r\n\t\tsnames: [], // sheetnames\r\n\t\tsharedf: shared_formulae, // shared formulae by address\r\n\t\tarrayf: array_formulae, // array formulae array\r\n\t\trrtabid: [], // RRTabId\r\n\t\tlastuser: \"\", // Last User from WriteAccess\r\n\t\tbiff: 8, // BIFF version\r\n\t\tcodepage: 0, // CP from CodePage record\r\n\t\twinlocked: 0, // fLockWn from WinProtect\r\n\t\twtf: false\r\n\t};\r\n\tif(options.password) opts.password = options.password;\r\n\tvar mergecells = [];\r\n\tvar objects = [];\r\n\tvar supbooks = [[]]; // 1-indexed, will hold extern names\r\n\tvar sbc = 0, sbci = 0, sbcli = 0;\r\n\tsupbooks.SheetNames = opts.snames;\r\n\tsupbooks.sharedf = opts.sharedf;\r\n\tsupbooks.arrayf = opts.arrayf;\r\n\tvar last_Rn = '';\r\n\tvar file_depth = 0; /* TODO: make a real stack */\r\n\r\n\t/* explicit override for some broken writers */\r\n\topts.codepage = 1200;\r\n\tset_cp(1200);\r\n\r\n\twhile(blob.l < blob.length - 1) {\r\n\t\tvar s = blob.l;\r\n\t\tvar RecordType = blob.read_shift(2);\r\n\t\tif(RecordType === 0 && last_Rn === 'EOF') break;\r\n\t\tvar length = (blob.l === blob.length ? 0 : blob.read_shift(2)), y;\r\n\t\tvar R = XLSRecordEnum[RecordType];\r\n\t\tif(R && R.f) {\r\n\t\t\tif(options.bookSheets) {\r\n\t\t\t\tif(last_Rn === 'BoundSheet8' && R.n !== 'BoundSheet8') break;\r\n\t\t\t}\r\n\t\t\tlast_Rn = R.n;\r\n\t\t\tif(R.r === 2 || R.r == 12) {\r\n\t\t\t\tvar rt = blob.read_shift(2); length -= 2;\r\n\t\t\t\tif(!opts.enc && rt !== RecordType) throw \"rt mismatch\";\r\n\t\t\t\tif(R.r == 12){ blob.l += 10; length -= 10; } // skip FRT\r\n\t\t\t}\r\n\t\t\t//console.error(R,blob.l,length,blob.length);\r\n\t\t\tvar val;\r\n\t\t\tif(R.n === 'EOF') val = R.f(blob, length, opts);\r\n\t\t\telse val = slurp(R, blob, length, opts);\r\n\t\t\tvar Rn = R.n;\r\n\t\t\t/* BIFF5 overrides */\r\n\t\t\tif(opts.biff === 5 || opts.biff === 2) switch(Rn) {\r\n\t\t\t\tcase 'Lbl': Rn = 'Label'; break;\r\n\t\t\t}\r\n\t\t\t/* nested switch statements to workaround V8 128 limit */\r\n\t\t\tswitch(Rn) {\r\n\t\t\t\t/* Workbook Options */\r\n\t\t\t\tcase 'Date1904': wb.opts.Date1904 = val; break;\r\n\t\t\t\tcase 'WriteProtect': wb.opts.WriteProtect = true; break;\r\n\t\t\t\tcase 'FilePass':\r\n\t\t\t\t\tif(!opts.enc) blob.l = 0;\r\n\t\t\t\t\topts.enc = val;\r\n\t\t\t\t\tif(opts.WTF) console.error(val);\r\n\t\t\t\t\tif(!options.password) throw new Error(\"File is password-protected\");\r\n\t\t\t\t\tif(val.Type !== 0) throw new Error(\"Encryption scheme unsupported\");\r\n\t\t\t\t\tif(!val.valid) throw new Error(\"Password is incorrect\");\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'WriteAccess': opts.lastuser = val; break;\r\n\t\t\t\tcase 'FileSharing': break; //TODO\r\n\t\t\t\tcase 'CodePage':\r\n\t\t\t\t\t/* overrides based on test cases */\r\n\t\t\t\t\tif(val === 0x5212) val = 1200;\r\n\t\t\t\t\telse if(val === 0x8001) val = 1252;\r\n\t\t\t\t\topts.codepage = val;\r\n\t\t\t\t\tset_cp(val);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'RRTabId': opts.rrtabid = val; break;\r\n\t\t\t\tcase 'WinProtect': opts.winlocked = val; break;\r\n\t\t\t\tcase 'Template': break; // TODO\r\n\t\t\t\tcase 'RefreshAll': wb.opts.RefreshAll = val; break;\r\n\t\t\t\tcase 'BookBool': break; // TODO\r\n\t\t\t\tcase 'UsesELFs': /* if(val) console.error(\"Unsupported ELFs\"); */ break;\r\n\t\t\t\tcase 'MTRSettings': {\r\n\t\t\t\t\tif(val[0] && val[1]) throw \"Unsupported threads: \" + val;\r\n\t\t\t\t} break; // TODO: actually support threads\r\n\t\t\t\tcase 'CalcCount': wb.opts.CalcCount = val; break;\r\n\t\t\t\tcase 'CalcDelta': wb.opts.CalcDelta = val; break;\r\n\t\t\t\tcase 'CalcIter': wb.opts.CalcIter = val; break;\r\n\t\t\t\tcase 'CalcMode': wb.opts.CalcMode = val; break;\r\n\t\t\t\tcase 'CalcPrecision': wb.opts.CalcPrecision = val; break;\r\n\t\t\t\tcase 'CalcSaveRecalc': wb.opts.CalcSaveRecalc = val; break;\r\n\t\t\t\tcase 'CalcRefMode': opts.CalcRefMode = val; break; // TODO: implement R1C1\r\n\t\t\t\tcase 'Uncalced': break;\r\n\t\t\t\tcase 'ForceFullCalculation': wb.opts.FullCalc = val; break;\r\n\t\t\t\tcase 'WsBool': break; // TODO\r\n\t\t\t\tcase 'XF': XFs.push(val); break;\r\n\t\t\t\tcase 'ExtSST': break; // TODO\r\n\t\t\t\tcase 'BookExt': break; // TODO\r\n\t\t\t\tcase 'RichTextStream': break;\r\n\t\t\t\tcase 'BkHim': break;\r\n\r\n\t\t\t\tcase 'SupBook': supbooks[++sbc] = [val]; sbci = 0; break;\r\n\t\t\t\tcase 'ExternName': supbooks[sbc][++sbci] = val; break;\r\n\t\t\t\tcase 'Index': break; // TODO\r\n\t\t\t\tcase 'Lbl': supbooks[0][++sbcli] = val; break;\r\n\t\t\t\tcase 'ExternSheet': supbooks[sbc] = supbooks[sbc].concat(val); sbci += val.length; break;\r\n\r\n\t\t\t\tcase 'Protect': out[\"!protect\"] = val; break; /* for sheet or book */\r\n\t\t\t\tcase 'Password': if(val !== 0 && opts.WTF) console.error(\"Password verifier: \" + val); break;\r\n\t\t\t\tcase 'Prot4Rev': case 'Prot4RevPass': break; /*TODO: Revision Control*/\r\n\r\n\t\t\t\tcase 'BoundSheet8': {\r\n\t\t\t\t\tDirectory[val.pos] = val;\r\n\t\t\t\t\topts.snames.push(val.name);\r\n\t\t\t\t} break;\r\n\t\t\t\tcase 'EOF': {\r\n\t\t\t\t\tif(--file_depth) break;\r\n\t\t\t\t\tif(range.e) {\r\n\t\t\t\t\t\tout[\"!range\"] = range;\r\n\t\t\t\t\t\tif(range.e.r > 0 && range.e.c > 0) {\r\n\t\t\t\t\t\t\trange.e.r--; range.e.c--;\r\n\t\t\t\t\t\t\tout[\"!ref\"] = encode_range(range);\r\n\t\t\t\t\t\t\trange.e.r++; range.e.c++;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(mergecells.length > 0) out[\"!merges\"] = mergecells;\r\n\t\t\t\t\t\tif(objects.length > 0) out[\"!objects\"] = objects;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(cur_sheet === \"\") Preamble = out; else Sheets[cur_sheet] = out;\r\n\t\t\t\t\tout = {};\r\n\t\t\t\t} break;\r\n\t\t\t\tcase 'BOF': {\r\n\t\t\t\t\tif(opts.biff !== 8);\r\n\t\t\t\t\telse if(val.BIFFVer === 0x0500) opts.biff = 5;\r\n\t\t\t\t\telse if(val.BIFFVer === 0x0002) opts.biff = 2;\r\n\t\t\t\t\telse if(val.BIFFVer === 0x0007) opts.biff = 2;\r\n\t\t\t\t\tif(file_depth++) break;\r\n\t\t\t\t\tcell_valid = true;\r\n\t\t\t\t\tout = {};\r\n\t\t\t\t\tif(opts.biff === 2) {\r\n\t\t\t\t\t\tif(cur_sheet === \"\") cur_sheet = \"Sheet1\";\r\n\t\t\t\t\t\trange = {s:{r:0,c:0},e:{r:0,c:0}};\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse cur_sheet = (Directory[s] || {name:\"\"}).name;\r\n\t\t\t\t\tmergecells = [];\r\n\t\t\t\t\tobjects = [];\r\n\t\t\t\t} break;\r\n\t\t\t\tcase 'Number': case 'BIFF2NUM': {\r\n\t\t\t\t\ttemp_val = {ixfe: val.ixfe, XF: XFs[val.ixfe], v:val.val, t:'n'};\r\n\t\t\t\t\tif(temp_val.XF) safe_format_xf(temp_val, options, wb.opts.Date1904);\r\n\t\t\t\t\taddcell({c:val.c, r:val.r}, temp_val, options);\r\n\t\t\t\t} break;\r\n\t\t\t\tcase 'BoolErr': {\r\n\t\t\t\t\ttemp_val = {ixfe: val.ixfe, XF: XFs[val.ixfe], v:val.val, t:val.t};\r\n\t\t\t\t\tif(temp_val.XF) safe_format_xf(temp_val, options, wb.opts.Date1904);\r\n\t\t\t\t\taddcell({c:val.c, r:val.r}, temp_val, options);\r\n\t\t\t\t} break;\r\n\t\t\t\tcase 'RK': {\r\n\t\t\t\t\ttemp_val = {ixfe: val.ixfe, XF: XFs[val.ixfe], v:val.rknum, t:'n'};\r\n\t\t\t\t\tif(temp_val.XF) safe_format_xf(temp_val, options, wb.opts.Date1904);\r\n\t\t\t\t\taddcell({c:val.c, r:val.r}, temp_val, options);\r\n\t\t\t\t} break;\r\n\t\t\t\tcase 'MulRk': {\r\n\t\t\t\t\tfor(var j = val.c; j <= val.C; ++j) {\r\n\t\t\t\t\t\tvar ixfe = val.rkrec[j-val.c][0];\r\n\t\t\t\t\t\ttemp_val= {ixfe:ixfe, XF:XFs[ixfe], v:val.rkrec[j-val.c][1], t:'n'};\r\n\t\t\t\t\t\tif(temp_val.XF) safe_format_xf(temp_val, options, wb.opts.Date1904);\r\n\t\t\t\t\t\taddcell({c:j, r:val.r}, temp_val, options);\r\n\t\t\t\t\t}\r\n\t\t\t\t} break;\r\n\t\t\t\tcase 'Formula': {\r\n\t\t\t\t\tswitch(val.val) {\r\n\t\t\t\t\t\tcase 'String': last_formula = val; break;\r\n\t\t\t\t\t\tcase 'Array Formula': throw \"Array Formula unsupported\";\r\n\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\ttemp_val = {v:val.val, ixfe:val.cell.ixfe, t:val.tt};\r\n\t\t\t\t\t\t\ttemp_val.XF = XFs[temp_val.ixfe];\r\n\t\t\t\t\t\t\tif(options.cellFormula) temp_val.f = \"=\"+stringify_formula(val.formula,range,val.cell,supbooks, opts);\r\n\t\t\t\t\t\t\tif(temp_val.XF) safe_format_xf(temp_val, options, wb.opts.Date1904);\r\n\t\t\t\t\t\t\taddcell(val.cell, temp_val, options);\r\n\t\t\t\t\t\t\tlast_formula = val;\r\n\t\t\t\t\t}\r\n\t\t\t\t} break;\r\n\t\t\t\tcase 'String': {\r\n\t\t\t\t\tif(last_formula) {\r\n\t\t\t\t\t\tlast_formula.val = val;\r\n\t\t\t\t\t\ttemp_val = {v:last_formula.val, ixfe:last_formula.cell.ixfe, t:'s'};\r\n\t\t\t\t\t\ttemp_val.XF = XFs[temp_val.ixfe];\r\n\t\t\t\t\t\tif(options.cellFormula) temp_val.f = \"=\"+stringify_formula(last_formula.formula, range, last_formula.cell, supbooks, opts);\r\n\t\t\t\t\t\tif(temp_val.XF) safe_format_xf(temp_val, options, wb.opts.Date1904);\r\n\t\t\t\t\t\taddcell(last_formula.cell, temp_val, options);\r\n\t\t\t\t\t\tlast_formula = null;\r\n\t\t\t\t\t}\r\n\t\t\t\t} break;\r\n\t\t\t\tcase 'Array': {\r\n\t\t\t\t\tarray_formulae.push(val);\r\n\t\t\t\t} break;\r\n\t\t\t\tcase 'ShrFmla': {\r\n\t\t\t\t\tif(!cell_valid) break;\r\n\t\t\t\t\t//if(options.cellFormula) out[last_cell].f = stringify_formula(val[0], range, lastcell, supbooks, opts);\r\n\t\t\t\t\t/* TODO: capture range */\r\n\t\t\t\t\tshared_formulae[encode_cell(last_formula.cell)]= val[0];\r\n\t\t\t\t} break;\r\n\t\t\t\tcase 'LabelSst':\r\n\t\t\t\t\t//temp_val={v:sst[val.isst].t, ixfe:val.ixfe, t:'s'};\r\n\t\t\t\t\ttemp_val=make_cell(sst[val.isst].t, val.ixfe, 's');\r\n\t\t\t\t\ttemp_val.XF = XFs[temp_val.ixfe];\r\n\t\t\t\t\tif(temp_val.XF) safe_format_xf(temp_val, options, wb.opts.Date1904);\r\n\t\t\t\t\taddcell({c:val.c, r:val.r}, temp_val, options);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'Label': case 'BIFF2STR':\r\n\t\t\t\t\t/* Some writers erroneously write Label */\r\n\t\t\t\t\ttemp_val=make_cell(val.val, val.ixfe, 's');\r\n\t\t\t\t\ttemp_val.XF = XFs[temp_val.ixfe];\r\n\t\t\t\t\tif(temp_val.XF) safe_format_xf(temp_val, options, wb.opts.Date1904);\r\n\t\t\t\t\taddcell({c:val.c, r:val.r}, temp_val, options);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'Dimensions': {\r\n\t\t\t\t\tif(file_depth === 1) range = val; /* TODO: stack */\r\n\t\t\t\t} break;\r\n\t\t\t\tcase 'SST': {\r\n\t\t\t\t\tsst = val;\r\n\t\t\t\t} break;\r\n\t\t\t\tcase 'Format': { /* val = [id, fmt] */\r\n\t\t\t\t\tSSF.load(val[1], val[0]);\r\n\t\t\t\t} break;\r\n\r\n\t\t\t\tcase 'MergeCells': mergecells = mergecells.concat(val); break;\r\n\r\n\t\t\t\tcase 'Obj': objects[val.cmo[0]] = opts.lastobj = val; break;\r\n\t\t\t\tcase 'TxO': opts.lastobj.TxO = val; break;\r\n\r\n\t\t\t\tcase 'HLink': {\r\n\t\t\t\t\tfor(rngR = val[0].s.r; rngR <= val[0].e.r; ++rngR)\r\n\t\t\t\t\t\tfor(rngC = val[0].s.c; rngC <= val[0].e.c; ++rngC)\r\n\t\t\t\t\t\t\tif(out[encode_cell({c:rngC,r:rngR})])\r\n\t\t\t\t\t\t\t\tout[encode_cell({c:rngC,r:rngR})].l = val[1];\r\n\t\t\t\t} break;\r\n\t\t\t\tcase 'HLinkTooltip': {\r\n\t\t\t\t\tfor(rngR = val[0].s.r; rngR <= val[0].e.r; ++rngR)\r\n\t\t\t\t\t\tfor(rngC = val[0].s.c; rngC <= val[0].e.c; ++rngC)\r\n\t\t\t\t\t\t\tif(out[encode_cell({c:rngC,r:rngR})])\r\n\t\t\t\t\t\t\t\tout[encode_cell({c:rngC,r:rngR})].l.tooltip = val[1];\r\n\t\t\t\t} break;\r\n\r\n\t\t\t\t/* Comments */\r\n\t\t\t\tcase 'Note': {\r\n\t\t\t\t\tif(opts.biff <= 5 && opts.biff >= 2) break; /* TODO: BIFF5 */\r\n\t\t\t\t\tcc = out[encode_cell(val[0])];\r\n\t\t\t\t\tvar noteobj = objects[val[2]];\r\n\t\t\t\t\tif(!cc) break;\r\n\t\t\t\t\tif(!cc.c) cc.c = [];\r\n\t\t\t\t\tcmnt = {a:val[1],t:noteobj.TxO.t};\r\n\t\t\t\t\tcc.c.push(cmnt);\r\n\t\t\t\t} break;\r\n\r\n\t\t\t\tdefault: switch(R.n) { /* nested */\r\n\t\t\t\tcase 'ClrtClient': break;\r\n\t\t\t\tcase 'XFExt': update_xfext(XFs[val.ixfe], val.ext); break;\r\n\r\n\t\t\t\tcase 'NameCmt': break;\r\n\t\t\t\tcase 'Header': break; // TODO\r\n\t\t\t\tcase 'Footer': break; // TODO\r\n\t\t\t\tcase 'HCenter': break; // TODO\r\n\t\t\t\tcase 'VCenter': break; // TODO\r\n\t\t\t\tcase 'Pls': break; // TODO\r\n\t\t\t\tcase 'Setup': break; // TODO\r\n\t\t\t\tcase 'DefColWidth': break; // TODO\r\n\t\t\t\tcase 'GCW': break;\r\n\t\t\t\tcase 'LHRecord': break;\r\n\t\t\t\tcase 'ColInfo': break; // TODO\r\n\t\t\t\tcase 'Row': break; // TODO\r\n\t\t\t\tcase 'DBCell': break; // TODO\r\n\t\t\t\tcase 'MulBlank': break; // TODO\r\n\t\t\t\tcase 'EntExU2': break; // TODO\r\n\t\t\t\tcase 'SxView': break; // TODO\r\n\t\t\t\tcase 'Sxvd': break; // TODO\r\n\t\t\t\tcase 'SXVI': break; // TODO\r\n\t\t\t\tcase 'SXVDEx': break; // TODO\r\n\t\t\t\tcase 'SxIvd': break; // TODO\r\n\t\t\t\tcase 'SXDI': break; // TODO\r\n\t\t\t\tcase 'SXLI': break; // TODO\r\n\t\t\t\tcase 'SXEx': break; // TODO\r\n\t\t\t\tcase 'QsiSXTag': break; // TODO\r\n\t\t\t\tcase 'Selection': break;\r\n\t\t\t\tcase 'Feat': break;\r\n\t\t\t\tcase 'FeatHdr': case 'FeatHdr11': break;\r\n\t\t\t\tcase 'Feature11': case 'Feature12': case 'List12': break;\r\n\t\t\t\tcase 'Blank': break;\r\n\t\t\t\tcase 'Country': country = val; break;\r\n\t\t\t\tcase 'RecalcId': break;\r\n\t\t\t\tcase 'DefaultRowHeight': case 'DxGCol': break; // TODO: htmlify\r\n\t\t\t\tcase 'Fbi': case 'Fbi2': case 'GelFrame': break;\r\n\t\t\t\tcase 'Font': break; // TODO\r\n\t\t\t\tcase 'XFCRC': break; // TODO\r\n\t\t\t\tcase 'Style': break; // TODO\r\n\t\t\t\tcase 'StyleExt': break; // TODO\r\n\t\t\t\tcase 'Palette': palette = val; break; // TODO\r\n\t\t\t\tcase 'Theme': break; // TODO\r\n\t\t\t\t/* Protection */\r\n\t\t\t\tcase 'ScenarioProtect': break;\r\n\t\t\t\tcase 'ObjProtect': break;\r\n\r\n\t\t\t\t/* Conditional Formatting */\r\n\t\t\t\tcase 'CondFmt12': break;\r\n\r\n\t\t\t\t/* Table */\r\n\t\t\t\tcase 'Table': break; // TODO\r\n\t\t\t\tcase 'TableStyles': break; // TODO\r\n\t\t\t\tcase 'TableStyle': break; // TODO\r\n\t\t\t\tcase 'TableStyleElement': break; // TODO\r\n\r\n\t\t\t\t/* PivotTable */\r\n\t\t\t\tcase 'SXStreamID': break; // TODO\r\n\t\t\t\tcase 'SXVS': break; // TODO\r\n\t\t\t\tcase 'DConRef': break; // TODO\r\n\t\t\t\tcase 'SXAddl': break; // TODO\r\n\t\t\t\tcase 'DConBin': break; // TODO\r\n\t\t\t\tcase 'DConName': break; // TODO\r\n\t\t\t\tcase 'SXPI': break; // TODO\r\n\t\t\t\tcase 'SxFormat': break; // TODO\r\n\t\t\t\tcase 'SxSelect': break; // TODO\r\n\t\t\t\tcase 'SxRule': break; // TODO\r\n\t\t\t\tcase 'SxFilt': break; // TODO\r\n\t\t\t\tcase 'SxItm': break; // TODO\r\n\t\t\t\tcase 'SxDXF': break; // TODO\r\n\r\n\t\t\t\t/* Scenario Manager */\r\n\t\t\t\tcase 'ScenMan': break;\r\n\r\n\t\t\t\t/* Data Consolidation */\r\n\t\t\t\tcase 'DCon': break;\r\n\r\n\t\t\t\t/* Watched Cell */\r\n\t\t\t\tcase 'CellWatch': break;\r\n\r\n\t\t\t\t/* Print Settings */\r\n\t\t\t\tcase 'PrintRowCol': break;\r\n\t\t\t\tcase 'PrintGrid': break;\r\n\t\t\t\tcase 'PrintSize': break;\r\n\r\n\t\t\t\tcase 'XCT': break;\r\n\t\t\t\tcase 'CRN': break;\r\n\r\n\t\t\t\tcase 'Scl': {\r\n\t\t\t\t\t//console.log(\"Zoom Level:\", val[0]/val[1],val);\r\n\t\t\t\t} break;\r\n\t\t\t\tcase 'SheetExt': {\r\n\r\n\t\t\t\t} break;\r\n\t\t\t\tcase 'SheetExtOptional': {\r\n\r\n\t\t\t\t} break;\r\n\r\n\t\t\t\t/* VBA */\r\n\t\t\t\tcase 'ObNoMacros': {\r\n\r\n\t\t\t\t} break;\r\n\t\t\t\tcase 'ObProj': {\r\n\r\n\t\t\t\t} break;\r\n\t\t\t\tcase 'CodeName': {\r\n\r\n\t\t\t\t} break;\r\n\t\t\t\tcase 'GUIDTypeLib': {\r\n\r\n\t\t\t\t} break;\r\n\r\n\t\t\t\tcase 'WOpt': break; // TODO: WTF?\r\n\t\t\t\tcase 'PhoneticInfo': break;\r\n\r\n\t\t\t\tcase 'OleObjectSize': break;\r\n\r\n\t\t\t\t/* Differential Formatting */\r\n\t\t\t\tcase 'DXF': case 'DXFN': case 'DXFN12': case 'DXFN12List': case 'DXFN12NoCB': break;\r\n\r\n\t\t\t\t/* Data Validation */\r\n\t\t\t\tcase 'Dv': case 'DVal': break;\r\n\r\n\t\t\t\t/* Data Series */\r\n\t\t\t\tcase 'BRAI': case 'Series': case 'SeriesText': break;\r\n\r\n\t\t\t\t/* Data Connection */\r\n\t\t\t\tcase 'DConn': break;\r\n\t\t\t\tcase 'DbOrParamQry': break;\r\n\t\t\t\tcase 'DBQueryExt': break;\r\n\r\n\t\t\t\t/* Formatting */\r\n\t\t\t\tcase 'IFmtRecord': break;\r\n\t\t\t\tcase 'CondFmt': case 'CF': case 'CF12': case 'CFEx': break;\r\n\r\n\t\t\t\t/* Explicitly Ignored */\r\n\t\t\t\tcase 'Excel9File': break;\r\n\t\t\t\tcase 'Units': break;\r\n\t\t\t\tcase 'InterfaceHdr': case 'Mms': case 'InterfaceEnd': case 'DSF': case 'BuiltInFnGroupCount':\r\n\t\t\t\t/* View Stuff */\r\n\t\t\t\tcase 'Window1': case 'Window2': case 'HideObj': case 'GridSet': case 'Guts':\r\n\t\t\t\tcase 'UserBView': case 'UserSViewBegin': case 'UserSViewEnd':\r\n\t\t\t\tcase 'Pane': break;\r\n\t\t\t\tdefault: switch(R.n) { /* nested */\r\n\t\t\t\t/* Chart */\r\n\t\t\t\tcase 'Dat':\r\n\t\t\t\tcase 'Begin': case 'End':\r\n\t\t\t\tcase 'StartBlock': case 'EndBlock':\r\n\t\t\t\tcase 'Frame': case 'Area':\r\n\t\t\t\tcase 'Axis': case 'AxisLine': case 'Tick': break;\r\n\t\t\t\tcase 'AxesUsed':\r\n\t\t\t\tcase 'CrtLayout12': case 'CrtLayout12A': case 'CrtLink': case 'CrtLine': case 'CrtMlFrt': case 'CrtMlFrtContinue': break;\r\n\t\t\t\tcase 'LineFormat': case 'AreaFormat':\r\n\t\t\t\tcase 'Chart': case 'Chart3d': case 'Chart3DBarShape': case 'ChartFormat': case 'ChartFrtInfo': break;\r\n\t\t\t\tcase 'PlotArea': case 'PlotGrowth': break;\r\n\t\t\t\tcase 'SeriesList': case 'SerParent': case 'SerAuxTrend': break;\r\n\t\t\t\tcase 'DataFormat': case 'SerToCrt': case 'FontX': break;\r\n\t\t\t\tcase 'CatSerRange': case 'AxcExt': case 'SerFmt': break;\r\n\t\t\t\tcase 'ShtProps': break;\r\n\t\t\t\tcase 'DefaultText': case 'Text': case 'CatLab': break;\r\n\t\t\t\tcase 'DataLabExtContents': break;\r\n\t\t\t\tcase 'Legend': case 'LegendException': break;\r\n\t\t\t\tcase 'Pie': case 'Scatter': break;\r\n\t\t\t\tcase 'PieFormat': case 'MarkerFormat': break;\r\n\t\t\t\tcase 'StartObject': case 'EndObject': break;\r\n\t\t\t\tcase 'AlRuns': case 'ObjectLink': break;\r\n\t\t\t\tcase 'SIIndex': break;\r\n\t\t\t\tcase 'AttachedLabel': case 'YMult': break;\r\n\r\n\t\t\t\t/* Chart Group */\r\n\t\t\t\tcase 'Line': case 'Bar': break;\r\n\t\t\t\tcase 'Surf': break;\r\n\r\n\t\t\t\t/* Axis Group */\r\n\t\t\t\tcase 'AxisParent': break;\r\n\t\t\t\tcase 'Pos': break;\r\n\t\t\t\tcase 'ValueRange': break;\r\n\r\n\t\t\t\t/* Pivot Chart */\r\n\t\t\t\tcase 'SXViewEx9': break; // TODO\r\n\t\t\t\tcase 'SXViewLink': break;\r\n\t\t\t\tcase 'PivotChartBits': break;\r\n\t\t\t\tcase 'SBaseRef': break;\r\n\t\t\t\tcase 'TextPropsStream': break;\r\n\r\n\t\t\t\t/* Chart Misc */\r\n\t\t\t\tcase 'LnExt': break;\r\n\t\t\t\tcase 'MkrExt': break;\r\n\t\t\t\tcase 'CrtCoopt': break;\r\n\r\n\t\t\t\t/* Query Table */\r\n\t\t\t\tcase 'Qsi': case 'Qsif': case 'Qsir': case 'QsiSXTag': break;\r\n\t\t\t\tcase 'TxtQry': break;\r\n\r\n\t\t\t\t/* Filter */\r\n\t\t\t\tcase 'FilterMode': break;\r\n\t\t\t\tcase 'AutoFilter': case 'AutoFilterInfo': break;\r\n\t\t\t\tcase 'AutoFilter12': break;\r\n\t\t\t\tcase 'DropDownObjIds': break;\r\n\t\t\t\tcase 'Sort': break;\r\n\t\t\t\tcase 'SortData': break;\r\n\r\n\t\t\t\t/* Drawing */\r\n\t\t\t\tcase 'ShapePropsStream': break;\r\n\t\t\t\tcase 'MsoDrawing': case 'MsoDrawingGroup': case 'MsoDrawingSelection': break;\r\n\t\t\t\tcase 'ImData': break;\r\n\t\t\t\t/* Pub Stuff */\r\n\t\t\t\tcase 'WebPub': case 'AutoWebPub':\r\n\r\n\t\t\t\t/* Print Stuff */\r\n\t\t\t\tcase 'RightMargin': case 'LeftMargin': case 'TopMargin': case 'BottomMargin':\r\n\t\t\t\tcase 'HeaderFooter': case 'HFPicture': case 'PLV':\r\n\t\t\t\tcase 'HorizontalPageBreaks': case 'VerticalPageBreaks':\r\n\t\t\t\t/* Behavioral */\r\n\t\t\t\tcase 'Backup': case 'CompressPictures': case 'Compat12': break;\r\n\r\n\t\t\t\t/* Should not Happen */\r\n\t\t\t\tcase 'Continue': case 'ContinueFrt12': break;\r\n\r\n\t\t\t\t/* Future Records */\r\n\t\t\t\tcase 'FrtFontList': case 'FrtWrapper': break;\r\n\r\n\t\t\t\t/* BIFF5 records */\r\n\t\t\t\tcase 'ExternCount': break;\r\n\t\t\t\tcase 'RString': break;\r\n\t\t\t\tcase 'TabIdConf': case 'Radar': case 'RadarArea': case 'DropBar': case 'Intl': case 'CoordList': case 'SerAuxErrBar': break;\r\n\r\n\t\t\t\tdefault: switch(R.n) { /* nested */\r\n\t\t\t\t/* Miscellaneous */\r\n\t\t\t\tcase 'SCENARIO': case 'DConBin': case 'PicF': case 'DataLabExt':\r\n\t\t\t\tcase 'Lel': case 'BopPop': case 'BopPopCustom': case 'RealTimeData':\r\n\t\t\t\tcase 'Name': break;\r\n\t\t\t\tdefault: if(options.WTF) throw 'Unrecognized Record ' + R.n;\r\n\t\t\t}}}}\r\n\t\t} else blob.l += length;\r\n\t}\r\n\tvar sheetnamesraw = opts.biff === 2 ? ['Sheet1'] : Object.keys(Directory).sort(function(a,b) { return Number(a) - Number(b); }).map(function(x){return Directory[x].name;});\r\n\tvar sheetnames = sheetnamesraw.slice();\r\n\twb.Directory=sheetnamesraw;\r\n\twb.SheetNames=sheetnamesraw;\r\n\tif(!options.bookSheets) wb.Sheets=Sheets;\r\n\twb.Preamble=Preamble;\r\n\twb.Strings = sst;\r\n\twb.SSF = SSF.get_table();\r\n\tif(opts.enc) wb.Encryption = opts.enc;\r\n\twb.Metadata = {};\r\n\tif(country !== undefined) wb.Metadata.Country = country;\r\n\treturn wb;\r\n}\r\n\r\nfunction parse_xlscfb(cfb, options) {\r\nif(!options) options = {};\r\nfix_read_opts(options);\r\nreset_cp();\r\nvar CompObj, Summary, Workbook;\r\nif(cfb.find) {\r\n\tCompObj = cfb.find('!CompObj');\r\n\tSummary = cfb.find('!SummaryInformation');\r\n\tWorkbook = cfb.find('/Workbook');\r\n} else {\r\n\tprep_blob(cfb, 0);\r\n\tWorkbook = {content: cfb};\r\n}\r\n\r\nif(!Workbook) Workbook = cfb.find('/Book');\r\nvar CompObjP, SummaryP, WorkbookP;\r\n\r\nif(CompObj) CompObjP = parse_compobj(CompObj);\r\nif(options.bookProps && !options.bookSheets) WorkbookP = {};\r\nelse {\r\n\tif(Workbook) WorkbookP = parse_workbook(Workbook.content, options, !!Workbook.find);\r\n\telse throw new Error(\"Cannot find Workbook stream\");\r\n}\r\n\r\nif(cfb.find) parse_props(cfb);\r\n\r\nvar props = {};\r\nfor(var y in cfb.Summary) props[y] = cfb.Summary[y];\r\nfor(y in cfb.DocSummary) props[y] = cfb.DocSummary[y];\r\nWorkbookP.Props = WorkbookP.Custprops = props; /* TODO: split up properties */\r\nif(options.bookFiles) WorkbookP.cfb = cfb;\r\nWorkbookP.CompObjP = CompObjP;\r\nreturn WorkbookP;\r\n}\r\n\r\n/* TODO: WTF */\r\nfunction parse_props(cfb) {\r\n\t/* [MS-OSHARED] 2.3.3.2.2 Document Summary Information Property Set */\r\n\tvar DSI = cfb.find('!DocumentSummaryInformation');\r\n\tif(DSI) try { cfb.DocSummary = parse_PropertySetStream(DSI, DocSummaryPIDDSI); } catch(e) {}\r\n\r\n\t/* [MS-OSHARED] 2.3.3.2.1 Summary Information Property Set*/\r\n\tvar SI = cfb.find('!SummaryInformation');\r\n\tif(SI) try { cfb.Summary = parse_PropertySetStream(SI, SummaryPIDSI); } catch(e) {}\r\n}\r\n\r\n/* [MS-XLSB] 2.3 Record Enumeration */\r\nvar XLSBRecordEnum = {\r\n\t0x0000: { n:\"BrtRowHdr\", f:parse_BrtRowHdr },\r\n\t0x0001: { n:\"BrtCellBlank\", f:parse_BrtCellBlank },\r\n\t0x0002: { n:\"BrtCellRk\", f:parse_BrtCellRk },\r\n\t0x0003: { n:\"BrtCellError\", f:parse_BrtCellError },\r\n\t0x0004: { n:\"BrtCellBool\", f:parse_BrtCellBool },\r\n\t0x0005: { n:\"BrtCellReal\", f:parse_BrtCellReal },\r\n\t0x0006: { n:\"BrtCellSt\", f:parse_BrtCellSt },\r\n\t0x0007: { n:\"BrtCellIsst\", f:parse_BrtCellIsst },\r\n\t0x0008: { n:\"BrtFmlaString\", f:parse_BrtFmlaString },\r\n\t0x0009: { n:\"BrtFmlaNum\", f:parse_BrtFmlaNum },\r\n\t0x000A: { n:\"BrtFmlaBool\", f:parse_BrtFmlaBool },\r\n\t0x000B: { n:\"BrtFmlaError\", f:parse_BrtFmlaError },\r\n\t0x0010: { n:\"BrtFRTArchID$\", f:parse_BrtFRTArchID$ },\r\n\t0x0013: { n:\"BrtSSTItem\", f:parse_RichStr },\r\n\t0x0014: { n:\"BrtPCDIMissing\", f:parsenoop },\r\n\t0x0015: { n:\"BrtPCDINumber\", f:parsenoop },\r\n\t0x0016: { n:\"BrtPCDIBoolean\", f:parsenoop },\r\n\t0x0017: { n:\"BrtPCDIError\", f:parsenoop },\r\n\t0x0018: { n:\"BrtPCDIString\", f:parsenoop },\r\n\t0x0019: { n:\"BrtPCDIDatetime\", f:parsenoop },\r\n\t0x001A: { n:\"BrtPCDIIndex\", f:parsenoop },\r\n\t0x001B: { n:\"BrtPCDIAMissing\", f:parsenoop },\r\n\t0x001C: { n:\"BrtPCDIANumber\", f:parsenoop },\r\n\t0x001D: { n:\"BrtPCDIABoolean\", f:parsenoop },\r\n\t0x001E: { n:\"BrtPCDIAError\", f:parsenoop },\r\n\t0x001F: { n:\"BrtPCDIAString\", f:parsenoop },\r\n\t0x0020: { n:\"BrtPCDIADatetime\", f:parsenoop },\r\n\t0x0021: { n:\"BrtPCRRecord\", f:parsenoop },\r\n\t0x0022: { n:\"BrtPCRRecordDt\", f:parsenoop },\r\n\t0x0023: { n:\"BrtFRTBegin\", f:parsenoop },\r\n\t0x0024: { n:\"BrtFRTEnd\", f:parsenoop },\r\n\t0x0025: { n:\"BrtACBegin\", f:parsenoop },\r\n\t0x0026: { n:\"BrtACEnd\", f:parsenoop },\r\n\t0x0027: { n:\"BrtName\", f:parsenoop },\r\n\t0x0028: { n:\"BrtIndexRowBlock\", f:parsenoop },\r\n\t0x002A: { n:\"BrtIndexBlock\", f:parsenoop },\r\n\t0x002B: { n:\"BrtFont\", f:parse_BrtFont },\r\n\t0x002C: { n:\"BrtFmt\", f:parse_BrtFmt },\r\n\t0x002D: { n:\"BrtFill\", f:parsenoop },\r\n\t0x002E: { n:\"BrtBorder\", f:parsenoop },\r\n\t0x002F: { n:\"BrtXF\", f:parse_BrtXF },\r\n\t0x0030: { n:\"BrtStyle\", f:parsenoop },\r\n\t0x0031: { n:\"BrtCellMeta\", f:parsenoop },\r\n\t0x0032: { n:\"BrtValueMeta\", f:parsenoop },\r\n\t0x0033: { n:\"BrtMdb\", f:parsenoop },\r\n\t0x0034: { n:\"BrtBeginFmd\", f:parsenoop },\r\n\t0x0035: { n:\"BrtEndFmd\", f:parsenoop },\r\n\t0x0036: { n:\"BrtBeginMdx\", f:parsenoop },\r\n\t0x0037: { n:\"BrtEndMdx\", f:parsenoop },\r\n\t0x0038: { n:\"BrtBeginMdxTuple\", f:parsenoop },\r\n\t0x0039: { n:\"BrtEndMdxTuple\", f:parsenoop },\r\n\t0x003A: { n:\"BrtMdxMbrIstr\", f:parsenoop },\r\n\t0x003B: { n:\"BrtStr\", f:parsenoop },\r\n\t0x003C: { n:\"BrtColInfo\", f:parsenoop },\r\n\t0x003E: { n:\"BrtCellRString\", f:parsenoop },\r\n\t0x003F: { n:\"BrtCalcChainItem$\", f:parse_BrtCalcChainItem$ },\r\n\t0x0040: { n:\"BrtDVal\", f:parsenoop },\r\n\t0x0041: { n:\"BrtSxvcellNum\", f:parsenoop },\r\n\t0x0042: { n:\"BrtSxvcellStr\", f:parsenoop },\r\n\t0x0043: { n:\"BrtSxvcellBool\", f:parsenoop },\r\n\t0x0044: { n:\"BrtSxvcellErr\", f:parsenoop },\r\n\t0x0045: { n:\"BrtSxvcellDate\", f:parsenoop },\r\n\t0x0046: { n:\"BrtSxvcellNil\", f:parsenoop },\r\n\t0x0080: { n:\"BrtFileVersion\", f:parsenoop },\r\n\t0x0081: { n:\"BrtBeginSheet\", f:parsenoop },\r\n\t0x0082: { n:\"BrtEndSheet\", f:parsenoop },\r\n\t0x0083: { n:\"BrtBeginBook\", f:parsenoop, p:0 },\r\n\t0x0084: { n:\"BrtEndBook\", f:parsenoop },\r\n\t0x0085: { n:\"BrtBeginWsViews\", f:parsenoop },\r\n\t0x0086: { n:\"BrtEndWsViews\", f:parsenoop },\r\n\t0x0087: { n:\"BrtBeginBookViews\", f:parsenoop },\r\n\t0x0088: { n:\"BrtEndBookViews\", f:parsenoop },\r\n\t0x0089: { n:\"BrtBeginWsView\", f:parsenoop },\r\n\t0x008A: { n:\"BrtEndWsView\", f:parsenoop },\r\n\t0x008B: { n:\"BrtBeginCsViews\", f:parsenoop },\r\n\t0x008C: { n:\"BrtEndCsViews\", f:parsenoop },\r\n\t0x008D: { n:\"BrtBeginCsView\", f:parsenoop },\r\n\t0x008E: { n:\"BrtEndCsView\", f:parsenoop },\r\n\t0x008F: { n:\"BrtBeginBundleShs\", f:parsenoop },\r\n\t0x0090: { n:\"BrtEndBundleShs\", f:parsenoop },\r\n\t0x0091: { n:\"BrtBeginSheetData\", f:parsenoop },\r\n\t0x0092: { n:\"BrtEndSheetData\", f:parsenoop },\r\n\t0x0093: { n:\"BrtWsProp\", f:parse_BrtWsProp },\r\n\t0x0094: { n:\"BrtWsDim\", f:parse_BrtWsDim, p:16 },\r\n\t0x0097: { n:\"BrtPane\", f:parsenoop },\r\n\t0x0098: { n:\"BrtSel\", f:parsenoop },\r\n\t0x0099: { n:\"BrtWbProp\", f:parse_BrtWbProp },\r\n\t0x009A: { n:\"BrtWbFactoid\", f:parsenoop },\r\n\t0x009B: { n:\"BrtFileRecover\", f:parsenoop },\r\n\t0x009C: { n:\"BrtBundleSh\", f:parse_BrtBundleSh },\r\n\t0x009D: { n:\"BrtCalcProp\", f:parsenoop },\r\n\t0x009E: { n:\"BrtBookView\", f:parsenoop },\r\n\t0x009F: { n:\"BrtBeginSst\", f:parse_BrtBeginSst },\r\n\t0x00A0: { n:\"BrtEndSst\", f:parsenoop },\r\n\t0x00A1: { n:\"BrtBeginAFilter\", f:parsenoop },\r\n\t0x00A2: { n:\"BrtEndAFilter\", f:parsenoop },\r\n\t0x00A3: { n:\"BrtBeginFilterColumn\", f:parsenoop },\r\n\t0x00A4: { n:\"BrtEndFilterColumn\", f:parsenoop },\r\n\t0x00A5: { n:\"BrtBeginFilters\", f:parsenoop },\r\n\t0x00A6: { n:\"BrtEndFilters\", f:parsenoop },\r\n\t0x00A7: { n:\"BrtFilter\", f:parsenoop },\r\n\t0x00A8: { n:\"BrtColorFilter\", f:parsenoop },\r\n\t0x00A9: { n:\"BrtIconFilter\", f:parsenoop },\r\n\t0x00AA: { n:\"BrtTop10Filter\", f:parsenoop },\r\n\t0x00AB: { n:\"BrtDynamicFilter\", f:parsenoop },\r\n\t0x00AC: { n:\"BrtBeginCustomFilters\", f:parsenoop },\r\n\t0x00AD: { n:\"BrtEndCustomFilters\", f:parsenoop },\r\n\t0x00AE: { n:\"BrtCustomFilter\", f:parsenoop },\r\n\t0x00AF: { n:\"BrtAFilterDateGroupItem\", f:parsenoop },\r\n\t0x00B0: { n:\"BrtMergeCell\", f:parse_BrtMergeCell },\r\n\t0x00B1: { n:\"BrtBeginMergeCells\", f:parsenoop },\r\n\t0x00B2: { n:\"BrtEndMergeCells\", f:parsenoop },\r\n\t0x00B3: { n:\"BrtBeginPivotCacheDef\", f:parsenoop },\r\n\t0x00B4: { n:\"BrtEndPivotCacheDef\", f:parsenoop },\r\n\t0x00B5: { n:\"BrtBeginPCDFields\", f:parsenoop },\r\n\t0x00B6: { n:\"BrtEndPCDFields\", f:parsenoop },\r\n\t0x00B7: { n:\"BrtBeginPCDField\", f:parsenoop },\r\n\t0x00B8: { n:\"BrtEndPCDField\", f:parsenoop },\r\n\t0x00B9: { n:\"BrtBeginPCDSource\", f:parsenoop },\r\n\t0x00BA: { n:\"BrtEndPCDSource\", f:parsenoop },\r\n\t0x00BB: { n:\"BrtBeginPCDSRange\", f:parsenoop },\r\n\t0x00BC: { n:\"BrtEndPCDSRange\", f:parsenoop },\r\n\t0x00BD: { n:\"BrtBeginPCDFAtbl\", f:parsenoop },\r\n\t0x00BE: { n:\"BrtEndPCDFAtbl\", f:parsenoop },\r\n\t0x00BF: { n:\"BrtBeginPCDIRun\", f:parsenoop },\r\n\t0x00C0: { n:\"BrtEndPCDIRun\", f:parsenoop },\r\n\t0x00C1: { n:\"BrtBeginPivotCacheRecords\", f:parsenoop },\r\n\t0x00C2: { n:\"BrtEndPivotCacheRecords\", f:parsenoop },\r\n\t0x00C3: { n:\"BrtBeginPCDHierarchies\", f:parsenoop },\r\n\t0x00C4: { n:\"BrtEndPCDHierarchies\", f:parsenoop },\r\n\t0x00C5: { n:\"BrtBeginPCDHierarchy\", f:parsenoop },\r\n\t0x00C6: { n:\"BrtEndPCDHierarchy\", f:parsenoop },\r\n\t0x00C7: { n:\"BrtBeginPCDHFieldsUsage\", f:parsenoop },\r\n\t0x00C8: { n:\"BrtEndPCDHFieldsUsage\", f:parsenoop },\r\n\t0x00C9: { n:\"BrtBeginExtConnection\", f:parsenoop },\r\n\t0x00CA: { n:\"BrtEndExtConnection\", f:parsenoop },\r\n\t0x00CB: { n:\"BrtBeginECDbProps\", f:parsenoop },\r\n\t0x00CC: { n:\"BrtEndECDbProps\", f:parsenoop },\r\n\t0x00CD: { n:\"BrtBeginECOlapProps\", f:parsenoop },\r\n\t0x00CE: { n:\"BrtEndECOlapProps\", f:parsenoop },\r\n\t0x00CF: { n:\"BrtBeginPCDSConsol\", f:parsenoop },\r\n\t0x00D0: { n:\"BrtEndPCDSConsol\", f:parsenoop },\r\n\t0x00D1: { n:\"BrtBeginPCDSCPages\", f:parsenoop },\r\n\t0x00D2: { n:\"BrtEndPCDSCPages\", f:parsenoop },\r\n\t0x00D3: { n:\"BrtBeginPCDSCPage\", f:parsenoop },\r\n\t0x00D4: { n:\"BrtEndPCDSCPage\", f:parsenoop },\r\n\t0x00D5: { n:\"BrtBeginPCDSCPItem\", f:parsenoop },\r\n\t0x00D6: { n:\"BrtEndPCDSCPItem\", f:parsenoop },\r\n\t0x00D7: { n:\"BrtBeginPCDSCSets\", f:parsenoop },\r\n\t0x00D8: { n:\"BrtEndPCDSCSets\", f:parsenoop },\r\n\t0x00D9: { n:\"BrtBeginPCDSCSet\", f:parsenoop },\r\n\t0x00DA: { n:\"BrtEndPCDSCSet\", f:parsenoop },\r\n\t0x00DB: { n:\"BrtBeginPCDFGroup\", f:parsenoop },\r\n\t0x00DC: { n:\"BrtEndPCDFGroup\", f:parsenoop },\r\n\t0x00DD: { n:\"BrtBeginPCDFGItems\", f:parsenoop },\r\n\t0x00DE: { n:\"BrtEndPCDFGItems\", f:parsenoop },\r\n\t0x00DF: { n:\"BrtBeginPCDFGRange\", f:parsenoop },\r\n\t0x00E0: { n:\"BrtEndPCDFGRange\", f:parsenoop },\r\n\t0x00E1: { n:\"BrtBeginPCDFGDiscrete\", f:parsenoop },\r\n\t0x00E2: { n:\"BrtEndPCDFGDiscrete\", f:parsenoop },\r\n\t0x00E3: { n:\"BrtBeginPCDSDTupleCache\", f:parsenoop },\r\n\t0x00E4: { n:\"BrtEndPCDSDTupleCache\", f:parsenoop },\r\n\t0x00E5: { n:\"BrtBeginPCDSDTCEntries\", f:parsenoop },\r\n\t0x00E6: { n:\"BrtEndPCDSDTCEntries\", f:parsenoop },\r\n\t0x00E7: { n:\"BrtBeginPCDSDTCEMembers\", f:parsenoop },\r\n\t0x00E8: { n:\"BrtEndPCDSDTCEMembers\", f:parsenoop },\r\n\t0x00E9: { n:\"BrtBeginPCDSDTCEMember\", f:parsenoop },\r\n\t0x00EA: { n:\"BrtEndPCDSDTCEMember\", f:parsenoop },\r\n\t0x00EB: { n:\"BrtBeginPCDSDTCQueries\", f:parsenoop },\r\n\t0x00EC: { n:\"BrtEndPCDSDTCQueries\", f:parsenoop },\r\n\t0x00ED: { n:\"BrtBeginPCDSDTCQuery\", f:parsenoop },\r\n\t0x00EE: { n:\"BrtEndPCDSDTCQuery\", f:parsenoop },\r\n\t0x00EF: { n:\"BrtBeginPCDSDTCSets\", f:parsenoop },\r\n\t0x00F0: { n:\"BrtEndPCDSDTCSets\", f:parsenoop },\r\n\t0x00F1: { n:\"BrtBeginPCDSDTCSet\", f:parsenoop },\r\n\t0x00F2: { n:\"BrtEndPCDSDTCSet\", f:parsenoop },\r\n\t0x00F3: { n:\"BrtBeginPCDCalcItems\", f:parsenoop },\r\n\t0x00F4: { n:\"BrtEndPCDCalcItems\", f:parsenoop },\r\n\t0x00F5: { n:\"BrtBeginPCDCalcItem\", f:parsenoop },\r\n\t0x00F6: { n:\"BrtEndPCDCalcItem\", f:parsenoop },\r\n\t0x00F7: { n:\"BrtBeginPRule\", f:parsenoop },\r\n\t0x00F8: { n:\"BrtEndPRule\", f:parsenoop },\r\n\t0x00F9: { n:\"BrtBeginPRFilters\", f:parsenoop },\r\n\t0x00FA: { n:\"BrtEndPRFilters\", f:parsenoop },\r\n\t0x00FB: { n:\"BrtBeginPRFilter\", f:parsenoop },\r\n\t0x00FC: { n:\"BrtEndPRFilter\", f:parsenoop },\r\n\t0x00FD: { n:\"BrtBeginPNames\", f:parsenoop },\r\n\t0x00FE: { n:\"BrtEndPNames\", f:parsenoop },\r\n\t0x00FF: { n:\"BrtBeginPName\", f:parsenoop },\r\n\t0x0100: { n:\"BrtEndPName\", f:parsenoop },\r\n\t0x0101: { n:\"BrtBeginPNPairs\", f:parsenoop },\r\n\t0x0102: { n:\"BrtEndPNPairs\", f:parsenoop },\r\n\t0x0103: { n:\"BrtBeginPNPair\", f:parsenoop },\r\n\t0x0104: { n:\"BrtEndPNPair\", f:parsenoop },\r\n\t0x0105: { n:\"BrtBeginECWebProps\", f:parsenoop },\r\n\t0x0106: { n:\"BrtEndECWebProps\", f:parsenoop },\r\n\t0x0107: { n:\"BrtBeginEcWpTables\", f:parsenoop },\r\n\t0x0108: { n:\"BrtEndECWPTables\", f:parsenoop },\r\n\t0x0109: { n:\"BrtBeginECParams\", f:parsenoop },\r\n\t0x010A: { n:\"BrtEndECParams\", f:parsenoop },\r\n\t0x010B: { n:\"BrtBeginECParam\", f:parsenoop },\r\n\t0x010C: { n:\"BrtEndECParam\", f:parsenoop },\r\n\t0x010D: { n:\"BrtBeginPCDKPIs\", f:parsenoop },\r\n\t0x010E: { n:\"BrtEndPCDKPIs\", f:parsenoop },\r\n\t0x010F: { n:\"BrtBeginPCDKPI\", f:parsenoop },\r\n\t0x0110: { n:\"BrtEndPCDKPI\", f:parsenoop },\r\n\t0x0111: { n:\"BrtBeginDims\", f:parsenoop },\r\n\t0x0112: { n:\"BrtEndDims\", f:parsenoop },\r\n\t0x0113: { n:\"BrtBeginDim\", f:parsenoop },\r\n\t0x0114: { n:\"BrtEndDim\", f:parsenoop },\r\n\t0x0115: { n:\"BrtIndexPartEnd\", f:parsenoop },\r\n\t0x0116: { n:\"BrtBeginStyleSheet\", f:parsenoop },\r\n\t0x0117: { n:\"BrtEndStyleSheet\", f:parsenoop },\r\n\t0x0118: { n:\"BrtBeginSXView\", f:parsenoop },\r\n\t0x0119: { n:\"BrtEndSXVI\", f:parsenoop },\r\n\t0x011A: { n:\"BrtBeginSXVI\", f:parsenoop },\r\n\t0x011B: { n:\"BrtBeginSXVIs\", f:parsenoop },\r\n\t0x011C: { n:\"BrtEndSXVIs\", f:parsenoop },\r\n\t0x011D: { n:\"BrtBeginSXVD\", f:parsenoop },\r\n\t0x011E: { n:\"BrtEndSXVD\", f:parsenoop },\r\n\t0x011F: { n:\"BrtBeginSXVDs\", f:parsenoop },\r\n\t0x0120: { n:\"BrtEndSXVDs\", f:parsenoop },\r\n\t0x0121: { n:\"BrtBeginSXPI\", f:parsenoop },\r\n\t0x0122: { n:\"BrtEndSXPI\", f:parsenoop },\r\n\t0x0123: { n:\"BrtBeginSXPIs\", f:parsenoop },\r\n\t0x0124: { n:\"BrtEndSXPIs\", f:parsenoop },\r\n\t0x0125: { n:\"BrtBeginSXDI\", f:parsenoop },\r\n\t0x0126: { n:\"BrtEndSXDI\", f:parsenoop },\r\n\t0x0127: { n:\"BrtBeginSXDIs\", f:parsenoop },\r\n\t0x0128: { n:\"BrtEndSXDIs\", f:parsenoop },\r\n\t0x0129: { n:\"BrtBeginSXLI\", f:parsenoop },\r\n\t0x012A: { n:\"BrtEndSXLI\", f:parsenoop },\r\n\t0x012B: { n:\"BrtBeginSXLIRws\", f:parsenoop },\r\n\t0x012C: { n:\"BrtEndSXLIRws\", f:parsenoop },\r\n\t0x012D: { n:\"BrtBeginSXLICols\", f:parsenoop },\r\n\t0x012E: { n:\"BrtEndSXLICols\", f:parsenoop },\r\n\t0x012F: { n:\"BrtBeginSXFormat\", f:parsenoop },\r\n\t0x0130: { n:\"BrtEndSXFormat\", f:parsenoop },\r\n\t0x0131: { n:\"BrtBeginSXFormats\", f:parsenoop },\r\n\t0x0132: { n:\"BrtEndSxFormats\", f:parsenoop },\r\n\t0x0133: { n:\"BrtBeginSxSelect\", f:parsenoop },\r\n\t0x0134: { n:\"BrtEndSxSelect\", f:parsenoop },\r\n\t0x0135: { n:\"BrtBeginISXVDRws\", f:parsenoop },\r\n\t0x0136: { n:\"BrtEndISXVDRws\", f:parsenoop },\r\n\t0x0137: { n:\"BrtBeginISXVDCols\", f:parsenoop },\r\n\t0x0138: { n:\"BrtEndISXVDCols\", f:parsenoop },\r\n\t0x0139: { n:\"BrtEndSXLocation\", f:parsenoop },\r\n\t0x013A: { n:\"BrtBeginSXLocation\", f:parsenoop },\r\n\t0x013B: { n:\"BrtEndSXView\", f:parsenoop },\r\n\t0x013C: { n:\"BrtBeginSXTHs\", f:parsenoop },\r\n\t0x013D: { n:\"BrtEndSXTHs\", f:parsenoop },\r\n\t0x013E: { n:\"BrtBeginSXTH\", f:parsenoop },\r\n\t0x013F: { n:\"BrtEndSXTH\", f:parsenoop },\r\n\t0x0140: { n:\"BrtBeginISXTHRws\", f:parsenoop },\r\n\t0x0141: { n:\"BrtEndISXTHRws\", f:parsenoop },\r\n\t0x0142: { n:\"BrtBeginISXTHCols\", f:parsenoop },\r\n\t0x0143: { n:\"BrtEndISXTHCols\", f:parsenoop },\r\n\t0x0144: { n:\"BrtBeginSXTDMPS\", f:parsenoop },\r\n\t0x0145: { n:\"BrtEndSXTDMPs\", f:parsenoop },\r\n\t0x0146: { n:\"BrtBeginSXTDMP\", f:parsenoop },\r\n\t0x0147: { n:\"BrtEndSXTDMP\", f:parsenoop },\r\n\t0x0148: { n:\"BrtBeginSXTHItems\", f:parsenoop },\r\n\t0x0149: { n:\"BrtEndSXTHItems\", f:parsenoop },\r\n\t0x014A: { n:\"BrtBeginSXTHItem\", f:parsenoop },\r\n\t0x014B: { n:\"BrtEndSXTHItem\", f:parsenoop },\r\n\t0x014C: { n:\"BrtBeginMetadata\", f:parsenoop },\r\n\t0x014D: { n:\"BrtEndMetadata\", f:parsenoop },\r\n\t0x014E: { n:\"BrtBeginEsmdtinfo\", f:parsenoop },\r\n\t0x014F: { n:\"BrtMdtinfo\", f:parsenoop },\r\n\t0x0150: { n:\"BrtEndEsmdtinfo\", f:parsenoop },\r\n\t0x0151: { n:\"BrtBeginEsmdb\", f:parsenoop },\r\n\t0x0152: { n:\"BrtEndEsmdb\", f:parsenoop },\r\n\t0x0153: { n:\"BrtBeginEsfmd\", f:parsenoop },\r\n\t0x0154: { n:\"BrtEndEsfmd\", f:parsenoop },\r\n\t0x0155: { n:\"BrtBeginSingleCells\", f:parsenoop },\r\n\t0x0156: { n:\"BrtEndSingleCells\", f:parsenoop },\r\n\t0x0157: { n:\"BrtBeginList\", f:parsenoop },\r\n\t0x0158: { n:\"BrtEndList\", f:parsenoop },\r\n\t0x0159: { n:\"BrtBeginListCols\", f:parsenoop },\r\n\t0x015A: { n:\"BrtEndListCols\", f:parsenoop },\r\n\t0x015B: { n:\"BrtBeginListCol\", f:parsenoop },\r\n\t0x015C: { n:\"BrtEndListCol\", f:parsenoop },\r\n\t0x015D: { n:\"BrtBeginListXmlCPr\", f:parsenoop },\r\n\t0x015E: { n:\"BrtEndListXmlCPr\", f:parsenoop },\r\n\t0x015F: { n:\"BrtListCCFmla\", f:parsenoop },\r\n\t0x0160: { n:\"BrtListTrFmla\", f:parsenoop },\r\n\t0x0161: { n:\"BrtBeginExternals\", f:parsenoop },\r\n\t0x0162: { n:\"BrtEndExternals\", f:parsenoop },\r\n\t0x0163: { n:\"BrtSupBookSrc\", f:parsenoop },\r\n\t0x0165: { n:\"BrtSupSelf\", f:parsenoop },\r\n\t0x0166: { n:\"BrtSupSame\", f:parsenoop },\r\n\t0x0167: { n:\"BrtSupTabs\", f:parsenoop },\r\n\t0x0168: { n:\"BrtBeginSupBook\", f:parsenoop },\r\n\t0x0169: { n:\"BrtPlaceholderName\", f:parsenoop },\r\n\t0x016A: { n:\"BrtExternSheet\", f:parsenoop },\r\n\t0x016B: { n:\"BrtExternTableStart\", f:parsenoop },\r\n\t0x016C: { n:\"BrtExternTableEnd\", f:parsenoop },\r\n\t0x016E: { n:\"BrtExternRowHdr\", f:parsenoop },\r\n\t0x016F: { n:\"BrtExternCellBlank\", f:parsenoop },\r\n\t0x0170: { n:\"BrtExternCellReal\", f:parsenoop },\r\n\t0x0171: { n:\"BrtExternCellBool\", f:parsenoop },\r\n\t0x0172: { n:\"BrtExternCellError\", f:parsenoop },\r\n\t0x0173: { n:\"BrtExternCellString\", f:parsenoop },\r\n\t0x0174: { n:\"BrtBeginEsmdx\", f:parsenoop },\r\n\t0x0175: { n:\"BrtEndEsmdx\", f:parsenoop },\r\n\t0x0176: { n:\"BrtBeginMdxSet\", f:parsenoop },\r\n\t0x0177: { n:\"BrtEndMdxSet\", f:parsenoop },\r\n\t0x0178: { n:\"BrtBeginMdxMbrProp\", f:parsenoop },\r\n\t0x0179: { n:\"BrtEndMdxMbrProp\", f:parsenoop },\r\n\t0x017A: { n:\"BrtBeginMdxKPI\", f:parsenoop },\r\n\t0x017B: { n:\"BrtEndMdxKPI\", f:parsenoop },\r\n\t0x017C: { n:\"BrtBeginEsstr\", f:parsenoop },\r\n\t0x017D: { n:\"BrtEndEsstr\", f:parsenoop },\r\n\t0x017E: { n:\"BrtBeginPRFItem\", f:parsenoop },\r\n\t0x017F: { n:\"BrtEndPRFItem\", f:parsenoop },\r\n\t0x0180: { n:\"BrtBeginPivotCacheIDs\", f:parsenoop },\r\n\t0x0181: { n:\"BrtEndPivotCacheIDs\", f:parsenoop },\r\n\t0x0182: { n:\"BrtBeginPivotCacheID\", f:parsenoop },\r\n\t0x0183: { n:\"BrtEndPivotCacheID\", f:parsenoop },\r\n\t0x0184: { n:\"BrtBeginISXVIs\", f:parsenoop },\r\n\t0x0185: { n:\"BrtEndISXVIs\", f:parsenoop },\r\n\t0x0186: { n:\"BrtBeginColInfos\", f:parsenoop },\r\n\t0x0187: { n:\"BrtEndColInfos\", f:parsenoop },\r\n\t0x0188: { n:\"BrtBeginRwBrk\", f:parsenoop },\r\n\t0x0189: { n:\"BrtEndRwBrk\", f:parsenoop },\r\n\t0x018A: { n:\"BrtBeginColBrk\", f:parsenoop },\r\n\t0x018B: { n:\"BrtEndColBrk\", f:parsenoop },\r\n\t0x018C: { n:\"BrtBrk\", f:parsenoop },\r\n\t0x018D: { n:\"BrtUserBookView\", f:parsenoop },\r\n\t0x018E: { n:\"BrtInfo\", f:parsenoop },\r\n\t0x018F: { n:\"BrtCUsr\", f:parsenoop },\r\n\t0x0190: { n:\"BrtUsr\", f:parsenoop },\r\n\t0x0191: { n:\"BrtBeginUsers\", f:parsenoop },\r\n\t0x0193: { n:\"BrtEOF\", f:parsenoop },\r\n\t0x0194: { n:\"BrtUCR\", f:parsenoop },\r\n\t0x0195: { n:\"BrtRRInsDel\", f:parsenoop },\r\n\t0x0196: { n:\"BrtRREndInsDel\", f:parsenoop },\r\n\t0x0197: { n:\"BrtRRMove\", f:parsenoop },\r\n\t0x0198: { n:\"BrtRREndMove\", f:parsenoop },\r\n\t0x0199: { n:\"BrtRRChgCell\", f:parsenoop },\r\n\t0x019A: { n:\"BrtRREndChgCell\", f:parsenoop },\r\n\t0x019B: { n:\"BrtRRHeader\", f:parsenoop },\r\n\t0x019C: { n:\"BrtRRUserView\", f:parsenoop },\r\n\t0x019D: { n:\"BrtRRRenSheet\", f:parsenoop },\r\n\t0x019E: { n:\"BrtRRInsertSh\", f:parsenoop },\r\n\t0x019F: { n:\"BrtRRDefName\", f:parsenoop },\r\n\t0x01A0: { n:\"BrtRRNote\", f:parsenoop },\r\n\t0x01A1: { n:\"BrtRRConflict\", f:parsenoop },\r\n\t0x01A2: { n:\"BrtRRTQSIF\", f:parsenoop },\r\n\t0x01A3: { n:\"BrtRRFormat\", f:parsenoop },\r\n\t0x01A4: { n:\"BrtRREndFormat\", f:parsenoop },\r\n\t0x01A5: { n:\"BrtRRAutoFmt\", f:parsenoop },\r\n\t0x01A6: { n:\"BrtBeginUserShViews\", f:parsenoop },\r\n\t0x01A7: { n:\"BrtBeginUserShView\", f:parsenoop },\r\n\t0x01A8: { n:\"BrtEndUserShView\", f:parsenoop },\r\n\t0x01A9: { n:\"BrtEndUserShViews\", f:parsenoop },\r\n\t0x01AA: { n:\"BrtArrFmla\", f:parsenoop },\r\n\t0x01AB: { n:\"BrtShrFmla\", f:parsenoop },\r\n\t0x01AC: { n:\"BrtTable\", f:parsenoop },\r\n\t0x01AD: { n:\"BrtBeginExtConnections\", f:parsenoop },\r\n\t0x01AE: { n:\"BrtEndExtConnections\", f:parsenoop },\r\n\t0x01AF: { n:\"BrtBeginPCDCalcMems\", f:parsenoop },\r\n\t0x01B0: { n:\"BrtEndPCDCalcMems\", f:parsenoop },\r\n\t0x01B1: { n:\"BrtBeginPCDCalcMem\", f:parsenoop },\r\n\t0x01B2: { n:\"BrtEndPCDCalcMem\", f:parsenoop },\r\n\t0x01B3: { n:\"BrtBeginPCDHGLevels\", f:parsenoop },\r\n\t0x01B4: { n:\"BrtEndPCDHGLevels\", f:parsenoop },\r\n\t0x01B5: { n:\"BrtBeginPCDHGLevel\", f:parsenoop },\r\n\t0x01B6: { n:\"BrtEndPCDHGLevel\", f:parsenoop },\r\n\t0x01B7: { n:\"BrtBeginPCDHGLGroups\", f:parsenoop },\r\n\t0x01B8: { n:\"BrtEndPCDHGLGroups\", f:parsenoop },\r\n\t0x01B9: { n:\"BrtBeginPCDHGLGroup\", f:parsenoop },\r\n\t0x01BA: { n:\"BrtEndPCDHGLGroup\", f:parsenoop },\r\n\t0x01BB: { n:\"BrtBeginPCDHGLGMembers\", f:parsenoop },\r\n\t0x01BC: { n:\"BrtEndPCDHGLGMembers\", f:parsenoop },\r\n\t0x01BD: { n:\"BrtBeginPCDHGLGMember\", f:parsenoop },\r\n\t0x01BE: { n:\"BrtEndPCDHGLGMember\", f:parsenoop },\r\n\t0x01BF: { n:\"BrtBeginQSI\", f:parsenoop },\r\n\t0x01C0: { n:\"BrtEndQSI\", f:parsenoop },\r\n\t0x01C1: { n:\"BrtBeginQSIR\", f:parsenoop },\r\n\t0x01C2: { n:\"BrtEndQSIR\", f:parsenoop },\r\n\t0x01C3: { n:\"BrtBeginDeletedNames\", f:parsenoop },\r\n\t0x01C4: { n:\"BrtEndDeletedNames\", f:parsenoop },\r\n\t0x01C5: { n:\"BrtBeginDeletedName\", f:parsenoop },\r\n\t0x01C6: { n:\"BrtEndDeletedName\", f:parsenoop },\r\n\t0x01C7: { n:\"BrtBeginQSIFs\", f:parsenoop },\r\n\t0x01C8: { n:\"BrtEndQSIFs\", f:parsenoop },\r\n\t0x01C9: { n:\"BrtBeginQSIF\", f:parsenoop },\r\n\t0x01CA: { n:\"BrtEndQSIF\", f:parsenoop },\r\n\t0x01CB: { n:\"BrtBeginAutoSortScope\", f:parsenoop },\r\n\t0x01CC: { n:\"BrtEndAutoSortScope\", f:parsenoop },\r\n\t0x01CD: { n:\"BrtBeginConditionalFormatting\", f:parsenoop },\r\n\t0x01CE: { n:\"BrtEndConditionalFormatting\", f:parsenoop },\r\n\t0x01CF: { n:\"BrtBeginCFRule\", f:parsenoop },\r\n\t0x01D0: { n:\"BrtEndCFRule\", f:parsenoop },\r\n\t0x01D1: { n:\"BrtBeginIconSet\", f:parsenoop },\r\n\t0x01D2: { n:\"BrtEndIconSet\", f:parsenoop },\r\n\t0x01D3: { n:\"BrtBeginDatabar\", f:parsenoop },\r\n\t0x01D4: { n:\"BrtEndDatabar\", f:parsenoop },\r\n\t0x01D5: { n:\"BrtBeginColorScale\", f:parsenoop },\r\n\t0x01D6: { n:\"BrtEndColorScale\", f:parsenoop },\r\n\t0x01D7: { n:\"BrtCFVO\", f:parsenoop },\r\n\t0x01D8: { n:\"BrtExternValueMeta\", f:parsenoop },\r\n\t0x01D9: { n:\"BrtBeginColorPalette\", f:parsenoop },\r\n\t0x01DA: { n:\"BrtEndColorPalette\", f:parsenoop },\r\n\t0x01DB: { n:\"BrtIndexedColor\", f:parsenoop },\r\n\t0x01DC: { n:\"BrtMargins\", f:parsenoop },\r\n\t0x01DD: { n:\"BrtPrintOptions\", f:parsenoop },\r\n\t0x01DE: { n:\"BrtPageSetup\", f:parsenoop },\r\n\t0x01DF: { n:\"BrtBeginHeaderFooter\", f:parsenoop },\r\n\t0x01E0: { n:\"BrtEndHeaderFooter\", f:parsenoop },\r\n\t0x01E1: { n:\"BrtBeginSXCrtFormat\", f:parsenoop },\r\n\t0x01E2: { n:\"BrtEndSXCrtFormat\", f:parsenoop },\r\n\t0x01E3: { n:\"BrtBeginSXCrtFormats\", f:parsenoop },\r\n\t0x01E4: { n:\"BrtEndSXCrtFormats\", f:parsenoop },\r\n\t0x01E5: { n:\"BrtWsFmtInfo\", f:parsenoop },\r\n\t0x01E6: { n:\"BrtBeginMgs\", f:parsenoop },\r\n\t0x01E7: { n:\"BrtEndMGs\", f:parsenoop },\r\n\t0x01E8: { n:\"BrtBeginMGMaps\", f:parsenoop },\r\n\t0x01E9: { n:\"BrtEndMGMaps\", f:parsenoop },\r\n\t0x01EA: { n:\"BrtBeginMG\", f:parsenoop },\r\n\t0x01EB: { n:\"BrtEndMG\", f:parsenoop },\r\n\t0x01EC: { n:\"BrtBeginMap\", f:parsenoop },\r\n\t0x01ED: { n:\"BrtEndMap\", f:parsenoop },\r\n\t0x01EE: { n:\"BrtHLink\", f:parse_BrtHLink },\r\n\t0x01EF: { n:\"BrtBeginDCon\", f:parsenoop },\r\n\t0x01F0: { n:\"BrtEndDCon\", f:parsenoop },\r\n\t0x01F1: { n:\"BrtBeginDRefs\", f:parsenoop },\r\n\t0x01F2: { n:\"BrtEndDRefs\", f:parsenoop },\r\n\t0x01F3: { n:\"BrtDRef\", f:parsenoop },\r\n\t0x01F4: { n:\"BrtBeginScenMan\", f:parsenoop },\r\n\t0x01F5: { n:\"BrtEndScenMan\", f:parsenoop },\r\n\t0x01F6: { n:\"BrtBeginSct\", f:parsenoop },\r\n\t0x01F7: { n:\"BrtEndSct\", f:parsenoop },\r\n\t0x01F8: { n:\"BrtSlc\", f:parsenoop },\r\n\t0x01F9: { n:\"BrtBeginDXFs\", f:parsenoop },\r\n\t0x01FA: { n:\"BrtEndDXFs\", f:parsenoop },\r\n\t0x01FB: { n:\"BrtDXF\", f:parsenoop },\r\n\t0x01FC: { n:\"BrtBeginTableStyles\", f:parsenoop },\r\n\t0x01FD: { n:\"BrtEndTableStyles\", f:parsenoop },\r\n\t0x01FE: { n:\"BrtBeginTableStyle\", f:parsenoop },\r\n\t0x01FF: { n:\"BrtEndTableStyle\", f:parsenoop },\r\n\t0x0200: { n:\"BrtTableStyleElement\", f:parsenoop },\r\n\t0x0201: { n:\"BrtTableStyleClient\", f:parsenoop },\r\n\t0x0202: { n:\"BrtBeginVolDeps\", f:parsenoop },\r\n\t0x0203: { n:\"BrtEndVolDeps\", f:parsenoop },\r\n\t0x0204: { n:\"BrtBeginVolType\", f:parsenoop },\r\n\t0x0205: { n:\"BrtEndVolType\", f:parsenoop },\r\n\t0x0206: { n:\"BrtBeginVolMain\", f:parsenoop },\r\n\t0x0207: { n:\"BrtEndVolMain\", f:parsenoop },\r\n\t0x0208: { n:\"BrtBeginVolTopic\", f:parsenoop },\r\n\t0x0209: { n:\"BrtEndVolTopic\", f:parsenoop },\r\n\t0x020A: { n:\"BrtVolSubtopic\", f:parsenoop },\r\n\t0x020B: { n:\"BrtVolRef\", f:parsenoop },\r\n\t0x020C: { n:\"BrtVolNum\", f:parsenoop },\r\n\t0x020D: { n:\"BrtVolErr\", f:parsenoop },\r\n\t0x020E: { n:\"BrtVolStr\", f:parsenoop },\r\n\t0x020F: { n:\"BrtVolBool\", f:parsenoop },\r\n\t0x0210: { n:\"BrtBeginCalcChain$\", f:parsenoop },\r\n\t0x0211: { n:\"BrtEndCalcChain$\", f:parsenoop },\r\n\t0x0212: { n:\"BrtBeginSortState\", f:parsenoop },\r\n\t0x0213: { n:\"BrtEndSortState\", f:parsenoop },\r\n\t0x0214: { n:\"BrtBeginSortCond\", f:parsenoop },\r\n\t0x0215: { n:\"BrtEndSortCond\", f:parsenoop },\r\n\t0x0216: { n:\"BrtBookProtection\", f:parsenoop },\r\n\t0x0217: { n:\"BrtSheetProtection\", f:parsenoop },\r\n\t0x0218: { n:\"BrtRangeProtection\", f:parsenoop },\r\n\t0x0219: { n:\"BrtPhoneticInfo\", f:parsenoop },\r\n\t0x021A: { n:\"BrtBeginECTxtWiz\", f:parsenoop },\r\n\t0x021B: { n:\"BrtEndECTxtWiz\", f:parsenoop },\r\n\t0x021C: { n:\"BrtBeginECTWFldInfoLst\", f:parsenoop },\r\n\t0x021D: { n:\"BrtEndECTWFldInfoLst\", f:parsenoop },\r\n\t0x021E: { n:\"BrtBeginECTwFldInfo\", f:parsenoop },\r\n\t0x0224: { n:\"BrtFileSharing\", f:parsenoop },\r\n\t0x0225: { n:\"BrtOleSize\", f:parsenoop },\r\n\t0x0226: { n:\"BrtDrawing\", f:parsenoop },\r\n\t0x0227: { n:\"BrtLegacyDrawing\", f:parsenoop },\r\n\t0x0228: { n:\"BrtLegacyDrawingHF\", f:parsenoop },\r\n\t0x0229: { n:\"BrtWebOpt\", f:parsenoop },\r\n\t0x022A: { n:\"BrtBeginWebPubItems\", f:parsenoop },\r\n\t0x022B: { n:\"BrtEndWebPubItems\", f:parsenoop },\r\n\t0x022C: { n:\"BrtBeginWebPubItem\", f:parsenoop },\r\n\t0x022D: { n:\"BrtEndWebPubItem\", f:parsenoop },\r\n\t0x022E: { n:\"BrtBeginSXCondFmt\", f:parsenoop },\r\n\t0x022F: { n:\"BrtEndSXCondFmt\", f:parsenoop },\r\n\t0x0230: { n:\"BrtBeginSXCondFmts\", f:parsenoop },\r\n\t0x0231: { n:\"BrtEndSXCondFmts\", f:parsenoop },\r\n\t0x0232: { n:\"BrtBkHim\", f:parsenoop },\r\n\t0x0234: { n:\"BrtColor\", f:parsenoop },\r\n\t0x0235: { n:\"BrtBeginIndexedColors\", f:parsenoop },\r\n\t0x0236: { n:\"BrtEndIndexedColors\", f:parsenoop },\r\n\t0x0239: { n:\"BrtBeginMRUColors\", f:parsenoop },\r\n\t0x023A: { n:\"BrtEndMRUColors\", f:parsenoop },\r\n\t0x023C: { n:\"BrtMRUColor\", f:parsenoop },\r\n\t0x023D: { n:\"BrtBeginDVals\", f:parsenoop },\r\n\t0x023E: { n:\"BrtEndDVals\", f:parsenoop },\r\n\t0x0241: { n:\"BrtSupNameStart\", f:parsenoop },\r\n\t0x0242: { n:\"BrtSupNameValueStart\", f:parsenoop },\r\n\t0x0243: { n:\"BrtSupNameValueEnd\", f:parsenoop },\r\n\t0x0244: { n:\"BrtSupNameNum\", f:parsenoop },\r\n\t0x0245: { n:\"BrtSupNameErr\", f:parsenoop },\r\n\t0x0246: { n:\"BrtSupNameSt\", f:parsenoop },\r\n\t0x0247: { n:\"BrtSupNameNil\", f:parsenoop },\r\n\t0x0248: { n:\"BrtSupNameBool\", f:parsenoop },\r\n\t0x0249: { n:\"BrtSupNameFmla\", f:parsenoop },\r\n\t0x024A: { n:\"BrtSupNameBits\", f:parsenoop },\r\n\t0x024B: { n:\"BrtSupNameEnd\", f:parsenoop },\r\n\t0x024C: { n:\"BrtEndSupBook\", f:parsenoop },\r\n\t0x024D: { n:\"BrtCellSmartTagProperty\", f:parsenoop },\r\n\t0x024E: { n:\"BrtBeginCellSmartTag\", f:parsenoop },\r\n\t0x024F: { n:\"BrtEndCellSmartTag\", f:parsenoop },\r\n\t0x0250: { n:\"BrtBeginCellSmartTags\", f:parsenoop },\r\n\t0x0251: { n:\"BrtEndCellSmartTags\", f:parsenoop },\r\n\t0x0252: { n:\"BrtBeginSmartTags\", f:parsenoop },\r\n\t0x0253: { n:\"BrtEndSmartTags\", f:parsenoop },\r\n\t0x0254: { n:\"BrtSmartTagType\", f:parsenoop },\r\n\t0x0255: { n:\"BrtBeginSmartTagTypes\", f:parsenoop },\r\n\t0x0256: { n:\"BrtEndSmartTagTypes\", f:parsenoop },\r\n\t0x0257: { n:\"BrtBeginSXFilters\", f:parsenoop },\r\n\t0x0258: { n:\"BrtEndSXFilters\", f:parsenoop },\r\n\t0x0259: { n:\"BrtBeginSXFILTER\", f:parsenoop },\r\n\t0x025A: { n:\"BrtEndSXFilter\", f:parsenoop },\r\n\t0x025B: { n:\"BrtBeginFills\", f:parsenoop },\r\n\t0x025C: { n:\"BrtEndFills\", f:parsenoop },\r\n\t0x025D: { n:\"BrtBeginCellWatches\", f:parsenoop },\r\n\t0x025E: { n:\"BrtEndCellWatches\", f:parsenoop },\r\n\t0x025F: { n:\"BrtCellWatch\", f:parsenoop },\r\n\t0x0260: { n:\"BrtBeginCRErrs\", f:parsenoop },\r\n\t0x0261: { n:\"BrtEndCRErrs\", f:parsenoop },\r\n\t0x0262: { n:\"BrtCrashRecErr\", f:parsenoop },\r\n\t0x0263: { n:\"BrtBeginFonts\", f:parsenoop },\r\n\t0x0264: { n:\"BrtEndFonts\", f:parsenoop },\r\n\t0x0265: { n:\"BrtBeginBorders\", f:parsenoop },\r\n\t0x0266: { n:\"BrtEndBorders\", f:parsenoop },\r\n\t0x0267: { n:\"BrtBeginFmts\", f:parsenoop },\r\n\t0x0268: { n:\"BrtEndFmts\", f:parsenoop },\r\n\t0x0269: { n:\"BrtBeginCellXFs\", f:parsenoop },\r\n\t0x026A: { n:\"BrtEndCellXFs\", f:parsenoop },\r\n\t0x026B: { n:\"BrtBeginStyles\", f:parsenoop },\r\n\t0x026C: { n:\"BrtEndStyles\", f:parsenoop },\r\n\t0x0271: { n:\"BrtBigName\", f:parsenoop },\r\n\t0x0272: { n:\"BrtBeginCellStyleXFs\", f:parsenoop },\r\n\t0x0273: { n:\"BrtEndCellStyleXFs\", f:parsenoop },\r\n\t0x0274: { n:\"BrtBeginComments\", f:parsenoop },\r\n\t0x0275: { n:\"BrtEndComments\", f:parsenoop },\r\n\t0x0276: { n:\"BrtBeginCommentAuthors\", f:parsenoop },\r\n\t0x0277: { n:\"BrtEndCommentAuthors\", f:parsenoop },\r\n\t0x0278: { n:\"BrtCommentAuthor\", f:parse_BrtCommentAuthor },\r\n\t0x0279: { n:\"BrtBeginCommentList\", f:parsenoop },\r\n\t0x027A: { n:\"BrtEndCommentList\", f:parsenoop },\r\n\t0x027B: { n:\"BrtBeginComment\", f:parse_BrtBeginComment},\r\n\t0x027C: { n:\"BrtEndComment\", f:parsenoop },\r\n\t0x027D: { n:\"BrtCommentText\", f:parse_BrtCommentText },\r\n\t0x027E: { n:\"BrtBeginOleObjects\", f:parsenoop },\r\n\t0x027F: { n:\"BrtOleObject\", f:parsenoop },\r\n\t0x0280: { n:\"BrtEndOleObjects\", f:parsenoop },\r\n\t0x0281: { n:\"BrtBeginSxrules\", f:parsenoop },\r\n\t0x0282: { n:\"BrtEndSxRules\", f:parsenoop },\r\n\t0x0283: { n:\"BrtBeginActiveXControls\", f:parsenoop },\r\n\t0x0284: { n:\"BrtActiveX\", f:parsenoop },\r\n\t0x0285: { n:\"BrtEndActiveXControls\", f:parsenoop },\r\n\t0x0286: { n:\"BrtBeginPCDSDTCEMembersSortBy\", f:parsenoop },\r\n\t0x0288: { n:\"BrtBeginCellIgnoreECs\", f:parsenoop },\r\n\t0x0289: { n:\"BrtCellIgnoreEC\", f:parsenoop },\r\n\t0x028A: { n:\"BrtEndCellIgnoreECs\", f:parsenoop },\r\n\t0x028B: { n:\"BrtCsProp\", f:parsenoop },\r\n\t0x028C: { n:\"BrtCsPageSetup\", f:parsenoop },\r\n\t0x028D: { n:\"BrtBeginUserCsViews\", f:parsenoop },\r\n\t0x028E: { n:\"BrtEndUserCsViews\", f:parsenoop },\r\n\t0x028F: { n:\"BrtBeginUserCsView\", f:parsenoop },\r\n\t0x0290: { n:\"BrtEndUserCsView\", f:parsenoop },\r\n\t0x0291: { n:\"BrtBeginPcdSFCIEntries\", f:parsenoop },\r\n\t0x0292: { n:\"BrtEndPCDSFCIEntries\", f:parsenoop },\r\n\t0x0293: { n:\"BrtPCDSFCIEntry\", f:parsenoop },\r\n\t0x0294: { n:\"BrtBeginListParts\", f:parsenoop },\r\n\t0x0295: { n:\"BrtListPart\", f:parsenoop },\r\n\t0x0296: { n:\"BrtEndListParts\", f:parsenoop },\r\n\t0x0297: { n:\"BrtSheetCalcProp\", f:parsenoop },\r\n\t0x0298: { n:\"BrtBeginFnGroup\", f:parsenoop },\r\n\t0x0299: { n:\"BrtFnGroup\", f:parsenoop },\r\n\t0x029A: { n:\"BrtEndFnGroup\", f:parsenoop },\r\n\t0x029B: { n:\"BrtSupAddin\", f:parsenoop },\r\n\t0x029C: { n:\"BrtSXTDMPOrder\", f:parsenoop },\r\n\t0x029D: { n:\"BrtCsProtection\", f:parsenoop },\r\n\t0x029F: { n:\"BrtBeginWsSortMap\", f:parsenoop },\r\n\t0x02A0: { n:\"BrtEndWsSortMap\", f:parsenoop },\r\n\t0x02A1: { n:\"BrtBeginRRSort\", f:parsenoop },\r\n\t0x02A2: { n:\"BrtEndRRSort\", f:parsenoop },\r\n\t0x02A3: { n:\"BrtRRSortItem\", f:parsenoop },\r\n\t0x02A4: { n:\"BrtFileSharingIso\", f:parsenoop },\r\n\t0x02A5: { n:\"BrtBookProtectionIso\", f:parsenoop },\r\n\t0x02A6: { n:\"BrtSheetProtectionIso\", f:parsenoop },\r\n\t0x02A7: { n:\"BrtCsProtectionIso\", f:parsenoop },\r\n\t0x02A8: { n:\"BrtRangeProtectionIso\", f:parsenoop },\r\n\t0x0400: { n:\"BrtRwDescent\", f:parsenoop },\r\n\t0x0401: { n:\"BrtKnownFonts\", f:parsenoop },\r\n\t0x0402: { n:\"BrtBeginSXTupleSet\", f:parsenoop },\r\n\t0x0403: { n:\"BrtEndSXTupleSet\", f:parsenoop },\r\n\t0x0404: { n:\"BrtBeginSXTupleSetHeader\", f:parsenoop },\r\n\t0x0405: { n:\"BrtEndSXTupleSetHeader\", f:parsenoop },\r\n\t0x0406: { n:\"BrtSXTupleSetHeaderItem\", f:parsenoop },\r\n\t0x0407: { n:\"BrtBeginSXTupleSetData\", f:parsenoop },\r\n\t0x0408: { n:\"BrtEndSXTupleSetData\", f:parsenoop },\r\n\t0x0409: { n:\"BrtBeginSXTupleSetRow\", f:parsenoop },\r\n\t0x040A: { n:\"BrtEndSXTupleSetRow\", f:parsenoop },\r\n\t0x040B: { n:\"BrtSXTupleSetRowItem\", f:parsenoop },\r\n\t0x040C: { n:\"BrtNameExt\", f:parsenoop },\r\n\t0x040D: { n:\"BrtPCDH14\", f:parsenoop },\r\n\t0x040E: { n:\"BrtBeginPCDCalcMem14\", f:parsenoop },\r\n\t0x040F: { n:\"BrtEndPCDCalcMem14\", f:parsenoop },\r\n\t0x0410: { n:\"BrtSXTH14\", f:parsenoop },\r\n\t0x0411: { n:\"BrtBeginSparklineGroup\", f:parsenoop },\r\n\t0x0412: { n:\"BrtEndSparklineGroup\", f:parsenoop },\r\n\t0x0413: { n:\"BrtSparkline\", f:parsenoop },\r\n\t0x0414: { n:\"BrtSXDI14\", f:parsenoop },\r\n\t0x0415: { n:\"BrtWsFmtInfoEx14\", f:parsenoop },\r\n\t0x0416: { n:\"BrtBeginConditionalFormatting14\", f:parsenoop },\r\n\t0x0417: { n:\"BrtEndConditionalFormatting14\", f:parsenoop },\r\n\t0x0418: { n:\"BrtBeginCFRule14\", f:parsenoop },\r\n\t0x0419: { n:\"BrtEndCFRule14\", f:parsenoop },\r\n\t0x041A: { n:\"BrtCFVO14\", f:parsenoop },\r\n\t0x041B: { n:\"BrtBeginDatabar14\", f:parsenoop },\r\n\t0x041C: { n:\"BrtBeginIconSet14\", f:parsenoop },\r\n\t0x041D: { n:\"BrtDVal14\", f:parsenoop },\r\n\t0x041E: { n:\"BrtBeginDVals14\", f:parsenoop },\r\n\t0x041F: { n:\"BrtColor14\", f:parsenoop },\r\n\t0x0420: { n:\"BrtBeginSparklines\", f:parsenoop },\r\n\t0x0421: { n:\"BrtEndSparklines\", f:parsenoop },\r\n\t0x0422: { n:\"BrtBeginSparklineGroups\", f:parsenoop },\r\n\t0x0423: { n:\"BrtEndSparklineGroups\", f:parsenoop },\r\n\t0x0425: { n:\"BrtSXVD14\", f:parsenoop },\r\n\t0x0426: { n:\"BrtBeginSxview14\", f:parsenoop },\r\n\t0x0427: { n:\"BrtEndSxview14\", f:parsenoop },\r\n\t0x042A: { n:\"BrtBeginPCD14\", f:parsenoop },\r\n\t0x042B: { n:\"BrtEndPCD14\", f:parsenoop },\r\n\t0x042C: { n:\"BrtBeginExtConn14\", f:parsenoop },\r\n\t0x042D: { n:\"BrtEndExtConn14\", f:parsenoop },\r\n\t0x042E: { n:\"BrtBeginSlicerCacheIDs\", f:parsenoop },\r\n\t0x042F: { n:\"BrtEndSlicerCacheIDs\", f:parsenoop },\r\n\t0x0430: { n:\"BrtBeginSlicerCacheID\", f:parsenoop },\r\n\t0x0431: { n:\"BrtEndSlicerCacheID\", f:parsenoop },\r\n\t0x0433: { n:\"BrtBeginSlicerCache\", f:parsenoop },\r\n\t0x0434: { n:\"BrtEndSlicerCache\", f:parsenoop },\r\n\t0x0435: { n:\"BrtBeginSlicerCacheDef\", f:parsenoop },\r\n\t0x0436: { n:\"BrtEndSlicerCacheDef\", f:parsenoop },\r\n\t0x0437: { n:\"BrtBeginSlicersEx\", f:parsenoop },\r\n\t0x0438: { n:\"BrtEndSlicersEx\", f:parsenoop },\r\n\t0x0439: { n:\"BrtBeginSlicerEx\", f:parsenoop },\r\n\t0x043A: { n:\"BrtEndSlicerEx\", f:parsenoop },\r\n\t0x043B: { n:\"BrtBeginSlicer\", f:parsenoop },\r\n\t0x043C: { n:\"BrtEndSlicer\", f:parsenoop },\r\n\t0x043D: { n:\"BrtSlicerCachePivotTables\", f:parsenoop },\r\n\t0x043E: { n:\"BrtBeginSlicerCacheOlapImpl\", f:parsenoop },\r\n\t0x043F: { n:\"BrtEndSlicerCacheOlapImpl\", f:parsenoop },\r\n\t0x0440: { n:\"BrtBeginSlicerCacheLevelsData\", f:parsenoop },\r\n\t0x0441: { n:\"BrtEndSlicerCacheLevelsData\", f:parsenoop },\r\n\t0x0442: { n:\"BrtBeginSlicerCacheLevelData\", f:parsenoop },\r\n\t0x0443: { n:\"BrtEndSlicerCacheLevelData\", f:parsenoop },\r\n\t0x0444: { n:\"BrtBeginSlicerCacheSiRanges\", f:parsenoop },\r\n\t0x0445: { n:\"BrtEndSlicerCacheSiRanges\", f:parsenoop },\r\n\t0x0446: { n:\"BrtBeginSlicerCacheSiRange\", f:parsenoop },\r\n\t0x0447: { n:\"BrtEndSlicerCacheSiRange\", f:parsenoop },\r\n\t0x0448: { n:\"BrtSlicerCacheOlapItem\", f:parsenoop },\r\n\t0x0449: { n:\"BrtBeginSlicerCacheSelections\", f:parsenoop },\r\n\t0x044A: { n:\"BrtSlicerCacheSelection\", f:parsenoop },\r\n\t0x044B: { n:\"BrtEndSlicerCacheSelections\", f:parsenoop },\r\n\t0x044C: { n:\"BrtBeginSlicerCacheNative\", f:parsenoop },\r\n\t0x044D: { n:\"BrtEndSlicerCacheNative\", f:parsenoop },\r\n\t0x044E: { n:\"BrtSlicerCacheNativeItem\", f:parsenoop },\r\n\t0x044F: { n:\"BrtRangeProtection14\", f:parsenoop },\r\n\t0x0450: { n:\"BrtRangeProtectionIso14\", f:parsenoop },\r\n\t0x0451: { n:\"BrtCellIgnoreEC14\", f:parsenoop },\r\n\t0x0457: { n:\"BrtList14\", f:parsenoop },\r\n\t0x0458: { n:\"BrtCFIcon\", f:parsenoop },\r\n\t0x0459: { n:\"BrtBeginSlicerCachesPivotCacheIDs\", f:parsenoop },\r\n\t0x045A: { n:\"BrtEndSlicerCachesPivotCacheIDs\", f:parsenoop },\r\n\t0x045B: { n:\"BrtBeginSlicers\", f:parsenoop },\r\n\t0x045C: { n:\"BrtEndSlicers\", f:parsenoop },\r\n\t0x045D: { n:\"BrtWbProp14\", f:parsenoop },\r\n\t0x045E: { n:\"BrtBeginSXEdit\", f:parsenoop },\r\n\t0x045F: { n:\"BrtEndSXEdit\", f:parsenoop },\r\n\t0x0460: { n:\"BrtBeginSXEdits\", f:parsenoop },\r\n\t0x0461: { n:\"BrtEndSXEdits\", f:parsenoop },\r\n\t0x0462: { n:\"BrtBeginSXChange\", f:parsenoop },\r\n\t0x0463: { n:\"BrtEndSXChange\", f:parsenoop },\r\n\t0x0464: { n:\"BrtBeginSXChanges\", f:parsenoop },\r\n\t0x0465: { n:\"BrtEndSXChanges\", f:parsenoop },\r\n\t0x0466: { n:\"BrtSXTupleItems\", f:parsenoop },\r\n\t0x0468: { n:\"BrtBeginSlicerStyle\", f:parsenoop },\r\n\t0x0469: { n:\"BrtEndSlicerStyle\", f:parsenoop },\r\n\t0x046A: { n:\"BrtSlicerStyleElement\", f:parsenoop },\r\n\t0x046B: { n:\"BrtBeginStyleSheetExt14\", f:parsenoop },\r\n\t0x046C: { n:\"BrtEndStyleSheetExt14\", f:parsenoop },\r\n\t0x046D: { n:\"BrtBeginSlicerCachesPivotCacheID\", f:parsenoop },\r\n\t0x046E: { n:\"BrtEndSlicerCachesPivotCacheID\", f:parsenoop },\r\n\t0x046F: { n:\"BrtBeginConditionalFormattings\", f:parsenoop },\r\n\t0x0470: { n:\"BrtEndConditionalFormattings\", f:parsenoop },\r\n\t0x0471: { n:\"BrtBeginPCDCalcMemExt\", f:parsenoop },\r\n\t0x0472: { n:\"BrtEndPCDCalcMemExt\", f:parsenoop },\r\n\t0x0473: { n:\"BrtBeginPCDCalcMemsExt\", f:parsenoop },\r\n\t0x0474: { n:\"BrtEndPCDCalcMemsExt\", f:parsenoop },\r\n\t0x0475: { n:\"BrtPCDField14\", f:parsenoop },\r\n\t0x0476: { n:\"BrtBeginSlicerStyles\", f:parsenoop },\r\n\t0x0477: { n:\"BrtEndSlicerStyles\", f:parsenoop },\r\n\t0x0478: { n:\"BrtBeginSlicerStyleElements\", f:parsenoop },\r\n\t0x0479: { n:\"BrtEndSlicerStyleElements\", f:parsenoop },\r\n\t0x047A: { n:\"BrtCFRuleExt\", f:parsenoop },\r\n\t0x047B: { n:\"BrtBeginSXCondFmt14\", f:parsenoop },\r\n\t0x047C: { n:\"BrtEndSXCondFmt14\", f:parsenoop },\r\n\t0x047D: { n:\"BrtBeginSXCondFmts14\", f:parsenoop },\r\n\t0x047E: { n:\"BrtEndSXCondFmts14\", f:parsenoop },\r\n\t0x0480: { n:\"BrtBeginSortCond14\", f:parsenoop },\r\n\t0x0481: { n:\"BrtEndSortCond14\", f:parsenoop },\r\n\t0x0482: { n:\"BrtEndDVals14\", f:parsenoop },\r\n\t0x0483: { n:\"BrtEndIconSet14\", f:parsenoop },\r\n\t0x0484: { n:\"BrtEndDatabar14\", f:parsenoop },\r\n\t0x0485: { n:\"BrtBeginColorScale14\", f:parsenoop },\r\n\t0x0486: { n:\"BrtEndColorScale14\", f:parsenoop },\r\n\t0x0487: { n:\"BrtBeginSxrules14\", f:parsenoop },\r\n\t0x0488: { n:\"BrtEndSxrules14\", f:parsenoop },\r\n\t0x0489: { n:\"BrtBeginPRule14\", f:parsenoop },\r\n\t0x048A: { n:\"BrtEndPRule14\", f:parsenoop },\r\n\t0x048B: { n:\"BrtBeginPRFilters14\", f:parsenoop },\r\n\t0x048C: { n:\"BrtEndPRFilters14\", f:parsenoop },\r\n\t0x048D: { n:\"BrtBeginPRFilter14\", f:parsenoop },\r\n\t0x048E: { n:\"BrtEndPRFilter14\", f:parsenoop },\r\n\t0x048F: { n:\"BrtBeginPRFItem14\", f:parsenoop },\r\n\t0x0490: { n:\"BrtEndPRFItem14\", f:parsenoop },\r\n\t0x0491: { n:\"BrtBeginCellIgnoreECs14\", f:parsenoop },\r\n\t0x0492: { n:\"BrtEndCellIgnoreECs14\", f:parsenoop },\r\n\t0x0493: { n:\"BrtDxf14\", f:parsenoop },\r\n\t0x0494: { n:\"BrtBeginDxF14s\", f:parsenoop },\r\n\t0x0495: { n:\"BrtEndDxf14s\", f:parsenoop },\r\n\t0x0499: { n:\"BrtFilter14\", f:parsenoop },\r\n\t0x049A: { n:\"BrtBeginCustomFilters14\", f:parsenoop },\r\n\t0x049C: { n:\"BrtCustomFilter14\", f:parsenoop },\r\n\t0x049D: { n:\"BrtIconFilter14\", f:parsenoop },\r\n\t0x049E: { n:\"BrtPivotCacheConnectionName\", f:parsenoop },\r\n\t0x0800: { n:\"BrtBeginDecoupledPivotCacheIDs\", f:parsenoop },\r\n\t0x0801: { n:\"BrtEndDecoupledPivotCacheIDs\", f:parsenoop },\r\n\t0x0802: { n:\"BrtDecoupledPivotCacheID\", f:parsenoop },\r\n\t0x0803: { n:\"BrtBeginPivotTableRefs\", f:parsenoop },\r\n\t0x0804: { n:\"BrtEndPivotTableRefs\", f:parsenoop },\r\n\t0x0805: { n:\"BrtPivotTableRef\", f:parsenoop },\r\n\t0x0806: { n:\"BrtSlicerCacheBookPivotTables\", f:parsenoop },\r\n\t0x0807: { n:\"BrtBeginSxvcells\", f:parsenoop },\r\n\t0x0808: { n:\"BrtEndSxvcells\", f:parsenoop },\r\n\t0x0809: { n:\"BrtBeginSxRow\", f:parsenoop },\r\n\t0x080A: { n:\"BrtEndSxRow\", f:parsenoop },\r\n\t0x080C: { n:\"BrtPcdCalcMem15\", f:parsenoop },\r\n\t0x0813: { n:\"BrtQsi15\", f:parsenoop },\r\n\t0x0814: { n:\"BrtBeginWebExtensions\", f:parsenoop },\r\n\t0x0815: { n:\"BrtEndWebExtensions\", f:parsenoop },\r\n\t0x0816: { n:\"BrtWebExtension\", f:parsenoop },\r\n\t0x0817: { n:\"BrtAbsPath15\", f:parsenoop },\r\n\t0x0818: { n:\"BrtBeginPivotTableUISettings\", f:parsenoop },\r\n\t0x0819: { n:\"BrtEndPivotTableUISettings\", f:parsenoop },\r\n\t0x081B: { n:\"BrtTableSlicerCacheIDs\", f:parsenoop },\r\n\t0x081C: { n:\"BrtTableSlicerCacheID\", f:parsenoop },\r\n\t0x081D: { n:\"BrtBeginTableSlicerCache\", f:parsenoop },\r\n\t0x081E: { n:\"BrtEndTableSlicerCache\", f:parsenoop },\r\n\t0x081F: { n:\"BrtSxFilter15\", f:parsenoop },\r\n\t0x0820: { n:\"BrtBeginTimelineCachePivotCacheIDs\", f:parsenoop },\r\n\t0x0821: { n:\"BrtEndTimelineCachePivotCacheIDs\", f:parsenoop },\r\n\t0x0822: { n:\"BrtTimelineCachePivotCacheID\", f:parsenoop },\r\n\t0x0823: { n:\"BrtBeginTimelineCacheIDs\", f:parsenoop },\r\n\t0x0824: { n:\"BrtEndTimelineCacheIDs\", f:parsenoop },\r\n\t0x0825: { n:\"BrtBeginTimelineCacheID\", f:parsenoop },\r\n\t0x0826: { n:\"BrtEndTimelineCacheID\", f:parsenoop },\r\n\t0x0827: { n:\"BrtBeginTimelinesEx\", f:parsenoop },\r\n\t0x0828: { n:\"BrtEndTimelinesEx\", f:parsenoop },\r\n\t0x0829: { n:\"BrtBeginTimelineEx\", f:parsenoop },\r\n\t0x082A: { n:\"BrtEndTimelineEx\", f:parsenoop },\r\n\t0x082B: { n:\"BrtWorkBookPr15\", f:parsenoop },\r\n\t0x082C: { n:\"BrtPCDH15\", f:parsenoop },\r\n\t0x082D: { n:\"BrtBeginTimelineStyle\", f:parsenoop },\r\n\t0x082E: { n:\"BrtEndTimelineStyle\", f:parsenoop },\r\n\t0x082F: { n:\"BrtTimelineStyleElement\", f:parsenoop },\r\n\t0x0830: { n:\"BrtBeginTimelineStylesheetExt15\", f:parsenoop },\r\n\t0x0831: { n:\"BrtEndTimelineStylesheetExt15\", f:parsenoop },\r\n\t0x0832: { n:\"BrtBeginTimelineStyles\", f:parsenoop },\r\n\t0x0833: { n:\"BrtEndTimelineStyles\", f:parsenoop },\r\n\t0x0834: { n:\"BrtBeginTimelineStyleElements\", f:parsenoop },\r\n\t0x0835: { n:\"BrtEndTimelineStyleElements\", f:parsenoop },\r\n\t0x0836: { n:\"BrtDxf15\", f:parsenoop },\r\n\t0x0837: { n:\"BrtBeginDxfs15\", f:parsenoop },\r\n\t0x0838: { n:\"brtEndDxfs15\", f:parsenoop },\r\n\t0x0839: { n:\"BrtSlicerCacheHideItemsWithNoData\", f:parsenoop },\r\n\t0x083A: { n:\"BrtBeginItemUniqueNames\", f:parsenoop },\r\n\t0x083B: { n:\"BrtEndItemUniqueNames\", f:parsenoop },\r\n\t0x083C: { n:\"BrtItemUniqueName\", f:parsenoop },\r\n\t0x083D: { n:\"BrtBeginExtConn15\", f:parsenoop },\r\n\t0x083E: { n:\"BrtEndExtConn15\", f:parsenoop },\r\n\t0x083F: { n:\"BrtBeginOledbPr15\", f:parsenoop },\r\n\t0x0840: { n:\"BrtEndOledbPr15\", f:parsenoop },\r\n\t0x0841: { n:\"BrtBeginDataFeedPr15\", f:parsenoop },\r\n\t0x0842: { n:\"BrtEndDataFeedPr15\", f:parsenoop },\r\n\t0x0843: { n:\"BrtTextPr15\", f:parsenoop },\r\n\t0x0844: { n:\"BrtRangePr15\", f:parsenoop },\r\n\t0x0845: { n:\"BrtDbCommand15\", f:parsenoop },\r\n\t0x0846: { n:\"BrtBeginDbTables15\", f:parsenoop },\r\n\t0x0847: { n:\"BrtEndDbTables15\", f:parsenoop },\r\n\t0x0848: { n:\"BrtDbTable15\", f:parsenoop },\r\n\t0x0849: { n:\"BrtBeginDataModel\", f:parsenoop },\r\n\t0x084A: { n:\"BrtEndDataModel\", f:parsenoop },\r\n\t0x084B: { n:\"BrtBeginModelTables\", f:parsenoop },\r\n\t0x084C: { n:\"BrtEndModelTables\", f:parsenoop },\r\n\t0x084D: { n:\"BrtModelTable\", f:parsenoop },\r\n\t0x084E: { n:\"BrtBeginModelRelationships\", f:parsenoop },\r\n\t0x084F: { n:\"BrtEndModelRelationships\", f:parsenoop },\r\n\t0x0850: { n:\"BrtModelRelationship\", f:parsenoop },\r\n\t0x0851: { n:\"BrtBeginECTxtWiz15\", f:parsenoop },\r\n\t0x0852: { n:\"BrtEndECTxtWiz15\", f:parsenoop },\r\n\t0x0853: { n:\"BrtBeginECTWFldInfoLst15\", f:parsenoop },\r\n\t0x0854: { n:\"BrtEndECTWFldInfoLst15\", f:parsenoop },\r\n\t0x0855: { n:\"BrtBeginECTWFldInfo15\", f:parsenoop },\r\n\t0x0856: { n:\"BrtFieldListActiveItem\", f:parsenoop },\r\n\t0x0857: { n:\"BrtPivotCacheIdVersion\", f:parsenoop },\r\n\t0x0858: { n:\"BrtSXDI15\", f:parsenoop },\r\n\t0xFFFF: { n:\"\", f:parsenoop }\r\n};\r\n\r\nvar evert_RE = evert_key(XLSBRecordEnum, 'n');\r\n\r\n/* [MS-XLS] 2.3 Record Enumeration */\r\nvar XLSRecordEnum = {\r\n\t0x0003: { n:\"BIFF2NUM\", f:parse_BIFF2NUM },\r\n\t0x0004: { n:\"BIFF2STR\", f:parse_BIFF2STR },\r\n\t0x0006: { n:\"Formula\", f:parse_Formula },\r\n\t0x0009: { n:'BOF', f:parse_BOF },\r\n\t0x000a: { n:'EOF', f:parse_EOF },\r\n\t0x000c: { n:\"CalcCount\", f:parse_CalcCount },\r\n\t0x000d: { n:\"CalcMode\", f:parse_CalcMode },\r\n\t0x000e: { n:\"CalcPrecision\", f:parse_CalcPrecision },\r\n\t0x000f: { n:\"CalcRefMode\", f:parse_CalcRefMode },\r\n\t0x0010: { n:\"CalcDelta\", f:parse_CalcDelta },\r\n\t0x0011: { n:\"CalcIter\", f:parse_CalcIter },\r\n\t0x0012: { n:\"Protect\", f:parse_Protect },\r\n\t0x0013: { n:\"Password\", f:parse_Password },\r\n\t0x0014: { n:\"Header\", f:parse_Header },\r\n\t0x0015: { n:\"Footer\", f:parse_Footer },\r\n\t0x0017: { n:\"ExternSheet\", f:parse_ExternSheet },\r\n\t0x0018: { n:\"Lbl\", f:parse_Lbl },\r\n\t0x0019: { n:\"WinProtect\", f:parse_WinProtect },\r\n\t0x001a: { n:\"VerticalPageBreaks\", f:parse_VerticalPageBreaks },\r\n\t0x001b: { n:\"HorizontalPageBreaks\", f:parse_HorizontalPageBreaks },\r\n\t0x001c: { n:\"Note\", f:parse_Note },\r\n\t0x001d: { n:\"Selection\", f:parse_Selection },\r\n\t0x0022: { n:\"Date1904\", f:parse_Date1904 },\r\n\t0x0023: { n:\"ExternName\", f:parse_ExternName },\r\n\t0x0026: { n:\"LeftMargin\", f:parse_LeftMargin },\r\n\t0x0027: { n:\"RightMargin\", f:parse_RightMargin },\r\n\t0x0028: { n:\"TopMargin\", f:parse_TopMargin },\r\n\t0x0029: { n:\"BottomMargin\", f:parse_BottomMargin },\r\n\t0x002a: { n:\"PrintRowCol\", f:parse_PrintRowCol },\r\n\t0x002b: { n:\"PrintGrid\", f:parse_PrintGrid },\r\n\t0x002f: { n:\"FilePass\", f:parse_FilePass },\r\n\t0x0031: { n:\"Font\", f:parse_Font },\r\n\t0x0033: { n:\"PrintSize\", f:parse_PrintSize },\r\n\t0x003c: { n:\"Continue\", f:parse_Continue },\r\n\t0x003d: { n:\"Window1\", f:parse_Window1 },\r\n\t0x0040: { n:\"Backup\", f:parse_Backup },\r\n\t0x0041: { n:\"Pane\", f:parse_Pane },\r\n\t0x0042: { n:'CodePage', f:parse_CodePage },\r\n\t0x004d: { n:\"Pls\", f:parse_Pls },\r\n\t0x0050: { n:\"DCon\", f:parse_DCon },\r\n\t0x0051: { n:\"DConRef\", f:parse_DConRef },\r\n\t0x0052: { n:\"DConName\", f:parse_DConName },\r\n\t0x0055: { n:\"DefColWidth\", f:parse_DefColWidth },\r\n\t0x0059: { n:\"XCT\", f:parse_XCT },\r\n\t0x005a: { n:\"CRN\", f:parse_CRN },\r\n\t0x005b: { n:\"FileSharing\", f:parse_FileSharing },\r\n\t0x005c: { n:'WriteAccess', f:parse_WriteAccess },\r\n\t0x005d: { n:\"Obj\", f:parse_Obj },\r\n\t0x005e: { n:\"Uncalced\", f:parse_Uncalced },\r\n\t0x005f: { n:\"CalcSaveRecalc\", f:parse_CalcSaveRecalc },\r\n\t0x0060: { n:\"Template\", f:parse_Template },\r\n\t0x0061: { n:\"Intl\", f:parse_Intl },\r\n\t0x0063: { n:\"ObjProtect\", f:parse_ObjProtect },\r\n\t0x007d: { n:\"ColInfo\", f:parse_ColInfo },\r\n\t0x0080: { n:\"Guts\", f:parse_Guts },\r\n\t0x0081: { n:\"WsBool\", f:parse_WsBool },\r\n\t0x0082: { n:\"GridSet\", f:parse_GridSet },\r\n\t0x0083: { n:\"HCenter\", f:parse_HCenter },\r\n\t0x0084: { n:\"VCenter\", f:parse_VCenter },\r\n\t0x0085: { n:'BoundSheet8', f:parse_BoundSheet8 },\r\n\t0x0086: { n:\"WriteProtect\", f:parse_WriteProtect },\r\n\t0x008c: { n:\"Country\", f:parse_Country },\r\n\t0x008d: { n:\"HideObj\", f:parse_HideObj },\r\n\t0x0090: { n:\"Sort\", f:parse_Sort },\r\n\t0x0092: { n:\"Palette\", f:parse_Palette },\r\n\t0x0097: { n:\"Sync\", f:parse_Sync },\r\n\t0x0098: { n:\"LPr\", f:parse_LPr },\r\n\t0x0099: { n:\"DxGCol\", f:parse_DxGCol },\r\n\t0x009a: { n:\"FnGroupName\", f:parse_FnGroupName },\r\n\t0x009b: { n:\"FilterMode\", f:parse_FilterMode },\r\n\t0x009c: { n:\"BuiltInFnGroupCount\", f:parse_BuiltInFnGroupCount },\r\n\t0x009d: { n:\"AutoFilterInfo\", f:parse_AutoFilterInfo },\r\n\t0x009e: { n:\"AutoFilter\", f:parse_AutoFilter },\r\n\t0x00a0: { n:\"Scl\", f:parse_Scl },\r\n\t0x00a1: { n:\"Setup\", f:parse_Setup },\r\n\t0x00ae: { n:\"ScenMan\", f:parse_ScenMan },\r\n\t0x00af: { n:\"SCENARIO\", f:parse_SCENARIO },\r\n\t0x00b0: { n:\"SxView\", f:parse_SxView },\r\n\t0x00b1: { n:\"Sxvd\", f:parse_Sxvd },\r\n\t0x00b2: { n:\"SXVI\", f:parse_SXVI },\r\n\t0x00b4: { n:\"SxIvd\", f:parse_SxIvd },\r\n\t0x00b5: { n:\"SXLI\", f:parse_SXLI },\r\n\t0x00b6: { n:\"SXPI\", f:parse_SXPI },\r\n\t0x00b8: { n:\"DocRoute\", f:parse_DocRoute },\r\n\t0x00b9: { n:\"RecipName\", f:parse_RecipName },\r\n\t0x00bd: { n:\"MulRk\", f:parse_MulRk },\r\n\t0x00be: { n:\"MulBlank\", f:parse_MulBlank },\r\n\t0x00c1: { n:'Mms', f:parse_Mms },\r\n\t0x00c5: { n:\"SXDI\", f:parse_SXDI },\r\n\t0x00c6: { n:\"SXDB\", f:parse_SXDB },\r\n\t0x00c7: { n:\"SXFDB\", f:parse_SXFDB },\r\n\t0x00c8: { n:\"SXDBB\", f:parse_SXDBB },\r\n\t0x00c9: { n:\"SXNum\", f:parse_SXNum },\r\n\t0x00ca: { n:\"SxBool\", f:parse_SxBool },\r\n\t0x00cb: { n:\"SxErr\", f:parse_SxErr },\r\n\t0x00cc: { n:\"SXInt\", f:parse_SXInt },\r\n\t0x00cd: { n:\"SXString\", f:parse_SXString },\r\n\t0x00ce: { n:\"SXDtr\", f:parse_SXDtr },\r\n\t0x00cf: { n:\"SxNil\", f:parse_SxNil },\r\n\t0x00d0: { n:\"SXTbl\", f:parse_SXTbl },\r\n\t0x00d1: { n:\"SXTBRGIITM\", f:parse_SXTBRGIITM },\r\n\t0x00d2: { n:\"SxTbpg\", f:parse_SxTbpg },\r\n\t0x00d3: { n:\"ObProj\", f:parse_ObProj },\r\n\t0x00d5: { n:\"SXStreamID\", f:parse_SXStreamID },\r\n\t0x00d7: { n:\"DBCell\", f:parse_DBCell },\r\n\t0x00d8: { n:\"SXRng\", f:parse_SXRng },\r\n\t0x00d9: { n:\"SxIsxoper\", f:parse_SxIsxoper },\r\n\t0x00da: { n:\"BookBool\", f:parse_BookBool },\r\n\t0x00dc: { n:\"DbOrParamQry\", f:parse_DbOrParamQry },\r\n\t0x00dd: { n:\"ScenarioProtect\", f:parse_ScenarioProtect },\r\n\t0x00de: { n:\"OleObjectSize\", f:parse_OleObjectSize },\r\n\t0x00e0: { n:\"XF\", f:parse_XF },\r\n\t0x00e1: { n:'InterfaceHdr', f:parse_InterfaceHdr },\r\n\t0x00e2: { n:'InterfaceEnd', f:parse_InterfaceEnd },\r\n\t0x00e3: { n:\"SXVS\", f:parse_SXVS },\r\n\t0x00e5: { n:\"MergeCells\", f:parse_MergeCells },\r\n\t0x00e9: { n:\"BkHim\", f:parse_BkHim },\r\n\t0x00eb: { n:\"MsoDrawingGroup\", f:parse_MsoDrawingGroup },\r\n\t0x00ec: { n:\"MsoDrawing\", f:parse_MsoDrawing },\r\n\t0x00ed: { n:\"MsoDrawingSelection\", f:parse_MsoDrawingSelection },\r\n\t0x00ef: { n:\"PhoneticInfo\", f:parse_PhoneticInfo },\r\n\t0x00f0: { n:\"SxRule\", f:parse_SxRule },\r\n\t0x00f1: { n:\"SXEx\", f:parse_SXEx },\r\n\t0x00f2: { n:\"SxFilt\", f:parse_SxFilt },\r\n\t0x00f4: { n:\"SxDXF\", f:parse_SxDXF },\r\n\t0x00f5: { n:\"SxItm\", f:parse_SxItm },\r\n\t0x00f6: { n:\"SxName\", f:parse_SxName },\r\n\t0x00f7: { n:\"SxSelect\", f:parse_SxSelect },\r\n\t0x00f8: { n:\"SXPair\", f:parse_SXPair },\r\n\t0x00f9: { n:\"SxFmla\", f:parse_SxFmla },\r\n\t0x00fb: { n:\"SxFormat\", f:parse_SxFormat },\r\n\t0x00fc: { n:\"SST\", f:parse_SST },\r\n\t0x00fd: { n:\"LabelSst\", f:parse_LabelSst },\r\n\t0x00ff: { n:\"ExtSST\", f:parse_ExtSST },\r\n\t0x0100: { n:\"SXVDEx\", f:parse_SXVDEx },\r\n\t0x0103: { n:\"SXFormula\", f:parse_SXFormula },\r\n\t0x0122: { n:\"SXDBEx\", f:parse_SXDBEx },\r\n\t0x0137: { n:\"RRDInsDel\", f:parse_RRDInsDel },\r\n\t0x0138: { n:\"RRDHead\", f:parse_RRDHead },\r\n\t0x013b: { n:\"RRDChgCell\", f:parse_RRDChgCell },\r\n\t0x013d: { n:\"RRTabId\", f:parse_RRTabId },\r\n\t0x013e: { n:\"RRDRenSheet\", f:parse_RRDRenSheet },\r\n\t0x013f: { n:\"RRSort\", f:parse_RRSort },\r\n\t0x0140: { n:\"RRDMove\", f:parse_RRDMove },\r\n\t0x014a: { n:\"RRFormat\", f:parse_RRFormat },\r\n\t0x014b: { n:\"RRAutoFmt\", f:parse_RRAutoFmt },\r\n\t0x014d: { n:\"RRInsertSh\", f:parse_RRInsertSh },\r\n\t0x014e: { n:\"RRDMoveBegin\", f:parse_RRDMoveBegin },\r\n\t0x014f: { n:\"RRDMoveEnd\", f:parse_RRDMoveEnd },\r\n\t0x0150: { n:\"RRDInsDelBegin\", f:parse_RRDInsDelBegin },\r\n\t0x0151: { n:\"RRDInsDelEnd\", f:parse_RRDInsDelEnd },\r\n\t0x0152: { n:\"RRDConflict\", f:parse_RRDConflict },\r\n\t0x0153: { n:\"RRDDefName\", f:parse_RRDDefName },\r\n\t0x0154: { n:\"RRDRstEtxp\", f:parse_RRDRstEtxp },\r\n\t0x015f: { n:\"LRng\", f:parse_LRng },\r\n\t0x0160: { n:\"UsesELFs\", f:parse_UsesELFs },\r\n\t0x0161: { n:\"DSF\", f:parse_DSF },\r\n\t0x0191: { n:\"CUsr\", f:parse_CUsr },\r\n\t0x0192: { n:\"CbUsr\", f:parse_CbUsr },\r\n\t0x0193: { n:\"UsrInfo\", f:parse_UsrInfo },\r\n\t0x0194: { n:\"UsrExcl\", f:parse_UsrExcl },\r\n\t0x0195: { n:\"FileLock\", f:parse_FileLock },\r\n\t0x0196: { n:\"RRDInfo\", f:parse_RRDInfo },\r\n\t0x0197: { n:\"BCUsrs\", f:parse_BCUsrs },\r\n\t0x0198: { n:\"UsrChk\", f:parse_UsrChk },\r\n\t0x01a9: { n:\"UserBView\", f:parse_UserBView },\r\n\t0x01aa: { n:\"UserSViewBegin\", f:parse_UserSViewBegin },\r\n\t0x01ab: { n:\"UserSViewEnd\", f:parse_UserSViewEnd },\r\n\t0x01ac: { n:\"RRDUserView\", f:parse_RRDUserView },\r\n\t0x01ad: { n:\"Qsi\", f:parse_Qsi },\r\n\t0x01ae: { n:\"SupBook\", f:parse_SupBook },\r\n\t0x01af: { n:\"Prot4Rev\", f:parse_Prot4Rev },\r\n\t0x01b0: { n:\"CondFmt\", f:parse_CondFmt },\r\n\t0x01b1: { n:\"CF\", f:parse_CF },\r\n\t0x01b2: { n:\"DVal\", f:parse_DVal },\r\n\t0x01b5: { n:\"DConBin\", f:parse_DConBin },\r\n\t0x01b6: { n:\"TxO\", f:parse_TxO },\r\n\t0x01b7: { n:\"RefreshAll\", f:parse_RefreshAll },\r\n\t0x01b8: { n:\"HLink\", f:parse_HLink },\r\n\t0x01b9: { n:\"Lel\", f:parse_Lel },\r\n\t0x01ba: { n:\"CodeName\", f:parse_XLSCodeName },\r\n\t0x01bb: { n:\"SXFDBType\", f:parse_SXFDBType },\r\n\t0x01bc: { n:\"Prot4RevPass\", f:parse_Prot4RevPass },\r\n\t0x01bd: { n:\"ObNoMacros\", f:parse_ObNoMacros },\r\n\t0x01be: { n:\"Dv\", f:parse_Dv },\r\n\t0x01c0: { n:\"Excel9File\", f:parse_Excel9File },\r\n\t0x01c1: { n:\"RecalcId\", f:parse_RecalcId, r:2},\r\n\t0x01c2: { n:\"EntExU2\", f:parse_EntExU2 },\r\n\t0x0200: { n:\"Dimensions\", f:parse_Dimensions },\r\n\t0x0201: { n:\"Blank\", f:parse_Blank },\r\n\t0x0203: { n:\"Number\", f:parse_Number },\r\n\t0x0204: { n:\"Label\", f:parse_Label },\r\n\t0x0205: { n:\"BoolErr\", f:parse_BoolErr },\r\n\t0x0207: { n:\"String\", f:parse_String },\r\n\t0x0208: { n:'Row', f:parse_Row },\r\n\t0x020b: { n:\"Index\", f:parse_Index },\r\n\t0x0221: { n:\"Array\", f:parse_Array },\r\n\t0x0225: { n:\"DefaultRowHeight\", f:parse_DefaultRowHeight },\r\n\t0x0236: { n:\"Table\", f:parse_Table },\r\n\t0x023e: { n:\"Window2\", f:parse_Window2 },\r\n\t0x027e: { n:\"RK\", f:parse_RK },\r\n\t0x0293: { n:\"Style\", f:parse_Style },\r\n\t0x0418: { n:\"BigName\", f:parse_BigName },\r\n\t0x041e: { n:\"Format\", f:parse_Format },\r\n\t0x043c: { n:\"ContinueBigName\", f:parse_ContinueBigName },\r\n\t0x04bc: { n:\"ShrFmla\", f:parse_ShrFmla },\r\n\t0x0800: { n:\"HLinkTooltip\", f:parse_HLinkTooltip },\r\n\t0x0801: { n:\"WebPub\", f:parse_WebPub },\r\n\t0x0802: { n:\"QsiSXTag\", f:parse_QsiSXTag },\r\n\t0x0803: { n:\"DBQueryExt\", f:parse_DBQueryExt },\r\n\t0x0804: { n:\"ExtString\", f:parse_ExtString },\r\n\t0x0805: { n:\"TxtQry\", f:parse_TxtQry },\r\n\t0x0806: { n:\"Qsir\", f:parse_Qsir },\r\n\t0x0807: { n:\"Qsif\", f:parse_Qsif },\r\n\t0x0808: { n:\"RRDTQSIF\", f:parse_RRDTQSIF },\r\n\t0x0809: { n:'BOF', f:parse_BOF },\r\n\t0x080a: { n:\"OleDbConn\", f:parse_OleDbConn },\r\n\t0x080b: { n:\"WOpt\", f:parse_WOpt },\r\n\t0x080c: { n:\"SXViewEx\", f:parse_SXViewEx },\r\n\t0x080d: { n:\"SXTH\", f:parse_SXTH },\r\n\t0x080e: { n:\"SXPIEx\", f:parse_SXPIEx },\r\n\t0x080f: { n:\"SXVDTEx\", f:parse_SXVDTEx },\r\n\t0x0810: { n:\"SXViewEx9\", f:parse_SXViewEx9 },\r\n\t0x0812: { n:\"ContinueFrt\", f:parse_ContinueFrt },\r\n\t0x0813: { n:\"RealTimeData\", f:parse_RealTimeData },\r\n\t0x0850: { n:\"ChartFrtInfo\", f:parse_ChartFrtInfo },\r\n\t0x0851: { n:\"FrtWrapper\", f:parse_FrtWrapper },\r\n\t0x0852: { n:\"StartBlock\", f:parse_StartBlock },\r\n\t0x0853: { n:\"EndBlock\", f:parse_EndBlock },\r\n\t0x0854: { n:\"StartObject\", f:parse_StartObject },\r\n\t0x0855: { n:\"EndObject\", f:parse_EndObject },\r\n\t0x0856: { n:\"CatLab\", f:parse_CatLab },\r\n\t0x0857: { n:\"YMult\", f:parse_YMult },\r\n\t0x0858: { n:\"SXViewLink\", f:parse_SXViewLink },\r\n\t0x0859: { n:\"PivotChartBits\", f:parse_PivotChartBits },\r\n\t0x085a: { n:\"FrtFontList\", f:parse_FrtFontList },\r\n\t0x0862: { n:\"SheetExt\", f:parse_SheetExt },\r\n\t0x0863: { n:\"BookExt\", f:parse_BookExt, r:12},\r\n\t0x0864: { n:\"SXAddl\", f:parse_SXAddl },\r\n\t0x0865: { n:\"CrErr\", f:parse_CrErr },\r\n\t0x0866: { n:\"HFPicture\", f:parse_HFPicture },\r\n\t0x0867: { n:'FeatHdr', f:parse_FeatHdr },\r\n\t0x0868: { n:\"Feat\", f:parse_Feat },\r\n\t0x086a: { n:\"DataLabExt\", f:parse_DataLabExt },\r\n\t0x086b: { n:\"DataLabExtContents\", f:parse_DataLabExtContents },\r\n\t0x086c: { n:\"CellWatch\", f:parse_CellWatch },\r\n\t0x0871: { n:\"FeatHdr11\", f:parse_FeatHdr11 },\r\n\t0x0872: { n:\"Feature11\", f:parse_Feature11 },\r\n\t0x0874: { n:\"DropDownObjIds\", f:parse_DropDownObjIds },\r\n\t0x0875: { n:\"ContinueFrt11\", f:parse_ContinueFrt11 },\r\n\t0x0876: { n:\"DConn\", f:parse_DConn },\r\n\t0x0877: { n:\"List12\", f:parse_List12 },\r\n\t0x0878: { n:\"Feature12\", f:parse_Feature12 },\r\n\t0x0879: { n:\"CondFmt12\", f:parse_CondFmt12 },\r\n\t0x087a: { n:\"CF12\", f:parse_CF12 },\r\n\t0x087b: { n:\"CFEx\", f:parse_CFEx },\r\n\t0x087c: { n:\"XFCRC\", f:parse_XFCRC, r:12 },\r\n\t0x087d: { n:\"XFExt\", f:parse_XFExt, r:12 },\r\n\t0x087e: { n:\"AutoFilter12\", f:parse_AutoFilter12 },\r\n\t0x087f: { n:\"ContinueFrt12\", f:parse_ContinueFrt12 },\r\n\t0x0884: { n:\"MDTInfo\", f:parse_MDTInfo },\r\n\t0x0885: { n:\"MDXStr\", f:parse_MDXStr },\r\n\t0x0886: { n:\"MDXTuple\", f:parse_MDXTuple },\r\n\t0x0887: { n:\"MDXSet\", f:parse_MDXSet },\r\n\t0x0888: { n:\"MDXProp\", f:parse_MDXProp },\r\n\t0x0889: { n:\"MDXKPI\", f:parse_MDXKPI },\r\n\t0x088a: { n:\"MDB\", f:parse_MDB },\r\n\t0x088b: { n:\"PLV\", f:parse_PLV },\r\n\t0x088c: { n:\"Compat12\", f:parse_Compat12, r:12 },\r\n\t0x088d: { n:\"DXF\", f:parse_DXF },\r\n\t0x088e: { n:\"TableStyles\", f:parse_TableStyles, r:12 },\r\n\t0x088f: { n:\"TableStyle\", f:parse_TableStyle },\r\n\t0x0890: { n:\"TableStyleElement\", f:parse_TableStyleElement },\r\n\t0x0892: { n:\"StyleExt\", f:parse_StyleExt },\r\n\t0x0893: { n:\"NamePublish\", f:parse_NamePublish },\r\n\t0x0894: { n:\"NameCmt\", f:parse_NameCmt },\r\n\t0x0895: { n:\"SortData\", f:parse_SortData },\r\n\t0x0896: { n:\"Theme\", f:parse_Theme, r:12 },\r\n\t0x0897: { n:\"GUIDTypeLib\", f:parse_GUIDTypeLib },\r\n\t0x0898: { n:\"FnGrp12\", f:parse_FnGrp12 },\r\n\t0x0899: { n:\"NameFnGrp12\", f:parse_NameFnGrp12 },\r\n\t0x089a: { n:\"MTRSettings\", f:parse_MTRSettings, r:12 },\r\n\t0x089b: { n:\"CompressPictures\", f:parse_CompressPictures },\r\n\t0x089c: { n:\"HeaderFooter\", f:parse_HeaderFooter },\r\n\t0x089d: { n:\"CrtLayout12\", f:parse_CrtLayout12 },\r\n\t0x089e: { n:\"CrtMlFrt\", f:parse_CrtMlFrt },\r\n\t0x089f: { n:\"CrtMlFrtContinue\", f:parse_CrtMlFrtContinue },\r\n\t0x08a3: { n:\"ForceFullCalculation\", f:parse_ForceFullCalculation },\r\n\t0x08a4: { n:\"ShapePropsStream\", f:parse_ShapePropsStream },\r\n\t0x08a5: { n:\"TextPropsStream\", f:parse_TextPropsStream },\r\n\t0x08a6: { n:\"RichTextStream\", f:parse_RichTextStream },\r\n\t0x08a7: { n:\"CrtLayout12A\", f:parse_CrtLayout12A },\r\n\t0x1001: { n:\"Units\", f:parse_Units },\r\n\t0x1002: { n:\"Chart\", f:parse_Chart },\r\n\t0x1003: { n:\"Series\", f:parse_Series },\r\n\t0x1006: { n:\"DataFormat\", f:parse_DataFormat },\r\n\t0x1007: { n:\"LineFormat\", f:parse_LineFormat },\r\n\t0x1009: { n:\"MarkerFormat\", f:parse_MarkerFormat },\r\n\t0x100a: { n:\"AreaFormat\", f:parse_AreaFormat },\r\n\t0x100b: { n:\"PieFormat\", f:parse_PieFormat },\r\n\t0x100c: { n:\"AttachedLabel\", f:parse_AttachedLabel },\r\n\t0x100d: { n:\"SeriesText\", f:parse_SeriesText },\r\n\t0x1014: { n:\"ChartFormat\", f:parse_ChartFormat },\r\n\t0x1015: { n:\"Legend\", f:parse_Legend },\r\n\t0x1016: { n:\"SeriesList\", f:parse_SeriesList },\r\n\t0x1017: { n:\"Bar\", f:parse_Bar },\r\n\t0x1018: { n:\"Line\", f:parse_Line },\r\n\t0x1019: { n:\"Pie\", f:parse_Pie },\r\n\t0x101a: { n:\"Area\", f:parse_Area },\r\n\t0x101b: { n:\"Scatter\", f:parse_Scatter },\r\n\t0x101c: { n:\"CrtLine\", f:parse_CrtLine },\r\n\t0x101d: { n:\"Axis\", f:parse_Axis },\r\n\t0x101e: { n:\"Tick\", f:parse_Tick },\r\n\t0x101f: { n:\"ValueRange\", f:parse_ValueRange },\r\n\t0x1020: { n:\"CatSerRange\", f:parse_CatSerRange },\r\n\t0x1021: { n:\"AxisLine\", f:parse_AxisLine },\r\n\t0x1022: { n:\"CrtLink\", f:parse_CrtLink },\r\n\t0x1024: { n:\"DefaultText\", f:parse_DefaultText },\r\n\t0x1025: { n:\"Text\", f:parse_Text },\r\n\t0x1026: { n:\"FontX\", f:parse_FontX },\r\n\t0x1027: { n:\"ObjectLink\", f:parse_ObjectLink },\r\n\t0x1032: { n:\"Frame\", f:parse_Frame },\r\n\t0x1033: { n:\"Begin\", f:parse_Begin },\r\n\t0x1034: { n:\"End\", f:parse_End },\r\n\t0x1035: { n:\"PlotArea\", f:parse_PlotArea },\r\n\t0x103a: { n:\"Chart3d\", f:parse_Chart3d },\r\n\t0x103c: { n:\"PicF\", f:parse_PicF },\r\n\t0x103d: { n:\"DropBar\", f:parse_DropBar },\r\n\t0x103e: { n:\"Radar\", f:parse_Radar },\r\n\t0x103f: { n:\"Surf\", f:parse_Surf },\r\n\t0x1040: { n:\"RadarArea\", f:parse_RadarArea },\r\n\t0x1041: { n:\"AxisParent\", f:parse_AxisParent },\r\n\t0x1043: { n:\"LegendException\", f:parse_LegendException },\r\n\t0x1044: { n:\"ShtProps\", f:parse_ShtProps },\r\n\t0x1045: { n:\"SerToCrt\", f:parse_SerToCrt },\r\n\t0x1046: { n:\"AxesUsed\", f:parse_AxesUsed },\r\n\t0x1048: { n:\"SBaseRef\", f:parse_SBaseRef },\r\n\t0x104a: { n:\"SerParent\", f:parse_SerParent },\r\n\t0x104b: { n:\"SerAuxTrend\", f:parse_SerAuxTrend },\r\n\t0x104e: { n:\"IFmtRecord\", f:parse_IFmtRecord },\r\n\t0x104f: { n:\"Pos\", f:parse_Pos },\r\n\t0x1050: { n:\"AlRuns\", f:parse_AlRuns },\r\n\t0x1051: { n:\"BRAI\", f:parse_BRAI },\r\n\t0x105b: { n:\"SerAuxErrBar\", f:parse_SerAuxErrBar },\r\n\t0x105c: { n:\"ClrtClient\", f:parse_ClrtClient },\r\n\t0x105d: { n:\"SerFmt\", f:parse_SerFmt },\r\n\t0x105f: { n:\"Chart3DBarShape\", f:parse_Chart3DBarShape },\r\n\t0x1060: { n:\"Fbi\", f:parse_Fbi },\r\n\t0x1061: { n:\"BopPop\", f:parse_BopPop },\r\n\t0x1062: { n:\"AxcExt\", f:parse_AxcExt },\r\n\t0x1063: { n:\"Dat\", f:parse_Dat },\r\n\t0x1064: { n:\"PlotGrowth\", f:parse_PlotGrowth },\r\n\t0x1065: { n:\"SIIndex\", f:parse_SIIndex },\r\n\t0x1066: { n:\"GelFrame\", f:parse_GelFrame },\r\n\t0x1067: { n:\"BopPopCustom\", f:parse_BopPopCustom },\r\n\t0x1068: { n:\"Fbi2\", f:parse_Fbi2 },\r\n\r\n\t/* These are specified in an older version of the spec */\r\n\t0x0016: { n:\"ExternCount\", f:parsenoop },\r\n\t0x007e: { n:\"RK\", f:parsenoop }, /* Not necessarily same as 0x027e */\r\n\t0x007f: { n:\"ImData\", f:parsenoop },\r\n\t0x0087: { n:\"Addin\", f:parsenoop },\r\n\t0x0088: { n:\"Edg\", f:parsenoop },\r\n\t0x0089: { n:\"Pub\", f:parsenoop },\r\n\t0x0091: { n:\"Sub\", f:parsenoop },\r\n\t0x0094: { n:\"LHRecord\", f:parsenoop },\r\n\t0x0095: { n:\"LHNGraph\", f:parsenoop },\r\n\t0x0096: { n:\"Sound\", f:parsenoop },\r\n\t0x00a9: { n:\"CoordList\", f:parsenoop },\r\n\t0x00ab: { n:\"GCW\", f:parsenoop },\r\n\t0x00bc: { n:\"ShrFmla\", f:parsenoop }, /* Not necessarily same as 0x04bc */\r\n\t0x00c2: { n:\"AddMenu\", f:parsenoop },\r\n\t0x00c3: { n:\"DelMenu\", f:parsenoop },\r\n\t0x00d6: { n:\"RString\", f:parsenoop },\r\n\t0x00df: { n:\"UDDesc\", f:parsenoop },\r\n\t0x00ea: { n:\"TabIdConf\", f:parsenoop },\r\n\t0x0162: { n:\"XL5Modify\", f:parsenoop },\r\n\t0x01a5: { n:\"FileSharing2\", f:parsenoop },\r\n\t0x0218: { n:\"Name\", f:parsenoop },\r\n\t0x0223: { n:\"ExternName\", f:parse_ExternName },\r\n\t0x0231: { n:\"Font\", f:parsenoop },\r\n\t0x0406: { n:\"Formula\", f:parse_Formula },\r\n\t0x086d: { n:\"FeatInfo\", f:parsenoop },\r\n\t0x0873: { n:\"FeatInfo11\", f:parsenoop },\r\n\t0x0881: { n:\"SXAddl12\", f:parsenoop },\r\n\t0x08c0: { n:\"AutoWebPub\", f:parsenoop },\r\n\t0x08c1: { n:\"ListObj\", f:parsenoop },\r\n\t0x08c2: { n:\"ListField\", f:parsenoop },\r\n\t0x08c3: { n:\"ListDV\", f:parsenoop },\r\n\t0x08c4: { n:\"ListCondFmt\", f:parsenoop },\r\n\t0x08c5: { n:\"ListCF\", f:parsenoop },\r\n\t0x08c6: { n:\"FMQry\", f:parsenoop },\r\n\t0x08c7: { n:\"FMSQry\", f:parsenoop },\r\n\t0x08c8: { n:\"PLV\", f:parsenoop }, /* supposedly PLV for Excel 11 */\r\n\t0x08c9: { n:\"LnExt\", f:parsenoop },\r\n\t0x08ca: { n:\"MkrExt\", f:parsenoop },\r\n\t0x08cb: { n:\"CrtCoopt\", f:parsenoop },\r\n\r\n\t0x0000: {}\r\n};\r\n\r\n\r\n/* Helper function to call out to ODS parser */\r\nfunction parse_ods(zip, opts) {\r\n\tif(typeof module !== \"undefined\" && typeof require !== 'undefined' && typeof ODS === 'undefined') ODS = require('./od' + 's');\r\n\tif(typeof ODS === 'undefined' || !ODS.parse_ods) throw new Error(\"Unsupported ODS\");\r\n\treturn ODS.parse_ods(zip, opts);\r\n}\r\nfunction fix_opts_func(defaults) {\r\n\treturn function fix_opts(opts) {\r\n\t\tfor(var i = 0; i != defaults.length; ++i) {\r\n\t\t\tvar d = defaults[i];\r\n\t\t\tif(opts[d[0]] === undefined) opts[d[0]] = d[1];\r\n\t\t\tif(d[2] === 'n') opts[d[0]] = Number(opts[d[0]]);\r\n\t\t}\r\n\t};\r\n}\r\n\r\nvar fix_read_opts = fix_opts_func([\r\n\t['cellNF', false], /* emit cell number format string as .z */\r\n\t['cellHTML', true], /* emit html string as .h */\r\n\t['cellFormula', true], /* emit formulae as .f */\r\n\t['cellStyles', false], /* emits style/theme as .s */\r\n\t['cellDates', false], /* emit date cells with type `d` */\r\n\r\n\t['sheetStubs', false], /* emit empty cells */\r\n\t['sheetRows', 0, 'n'], /* read n rows (0 = read all rows) */\r\n\r\n\t['bookDeps', false], /* parse calculation chains */\r\n\t['bookSheets', false], /* only try to get sheet names (no Sheets) */\r\n\t['bookProps', false], /* only try to get properties (no Sheets) */\r\n\t['bookFiles', false], /* include raw file structure (keys, files, cfb) */\r\n\t['bookVBA', false], /* include vba raw data (vbaraw) */\r\n\r\n\t['password',''], /* password */\r\n\t['WTF', false] /* WTF mode (throws errors) */\r\n]);\r\n\r\n\r\nvar fix_write_opts = fix_opts_func([\r\n\t['cellDates', false], /* write date cells with type `d` */\r\n\r\n\t['bookSST', false], /* Generate Shared String Table */\r\n\r\n\t['bookType', 'xlsx'], /* Type of workbook (xlsx/m/b) */\r\n\r\n\t['WTF', false] /* WTF mode (throws errors) */\r\n]);\r\nfunction safe_parse_wbrels(wbrels, sheets) {\r\n\tif(!wbrels) return 0;\r\n\ttry {\r\n\t\twbrels = sheets.map(function pwbr(w) { return [w.name, wbrels['!id'][w.id].Target]; });\r\n\t} catch(e) { return null; }\r\n\treturn !wbrels || wbrels.length === 0 ? null : wbrels;\r\n}\r\n\r\nfunction safe_parse_ws(zip, path, relsPath, sheet, sheetRels, sheets, opts) {\r\n\ttry {\r\n\t\tsheetRels[sheet]=parse_rels(getzipdata(zip, relsPath, true), path);\r\n\t\tsheets[sheet]=parse_ws(getzipdata(zip, path),path,opts,sheetRels[sheet]);\r\n\t} catch(e) { if(opts.WTF) throw e; }\r\n}\r\n\r\nvar nodirs = function nodirs(x){return x.substr(-1) != '/';};\r\nfunction parse_zip(zip, opts) {\r\n\tmake_ssf(SSF);\r\n\topts = opts || {};\r\n\tfix_read_opts(opts);\r\n\treset_cp();\r\n\r\n\t/* OpenDocument Part 3 Section 2.2.1 OpenDocument Package */\r\n\tif(safegetzipfile(zip, 'META-INF/manifest.xml')) return parse_ods(zip, opts);\r\n\r\n\tvar entries = keys(zip.files).filter(nodirs).sort();\r\n\tvar dir = parse_ct(getzipdata(zip, '[Content_Types].xml'), opts);\r\n\tvar xlsb = false;\r\n\tvar sheets, binname;\r\n\tif(dir.workbooks.length === 0) {\r\n\t\tbinname = \"xl/workbook.xml\";\r\n\t\tif(getzipdata(zip,binname, true)) dir.workbooks.push(binname);\r\n\t}\r\n\tif(dir.workbooks.length === 0) {\r\n\t\tbinname = \"xl/workbook.bin\";\r\n\t\tif(!getzipfile(zip,binname,true)) throw new Error(\"Could not find workbook\");\r\n\t\tdir.workbooks.push(binname);\r\n\t\txlsb = true;\r\n\t}\r\n\tif(dir.workbooks[0].substr(-3) == \"bin\") xlsb = true;\r\n\tif(xlsb) set_cp(1200);\r\n\r\n\tif(!opts.bookSheets && !opts.bookProps) {\r\n\t\tstrs = [];\r\n\t\tif(dir.sst) strs=parse_sst(getzipdata(zip, dir.sst.replace(/^\\//,'')), dir.sst, opts);\r\n\r\n    // parse themes before styles so that we can reliably decode theme/tint into rgb when parsing styles\r\n    themes = {};\r\n    if(opts.cellStyles && dir.themes.length) themes = parse_theme(getzipdata(zip, dir.themes[0].replace(/^\\//,''), true),dir.themes[0], opts);\r\n\r\n    styles = {};\r\n\t\tif(dir.style) styles = parse_sty(getzipdata(zip, dir.style.replace(/^\\//,'')),dir.style, opts);\r\n\r\n\t}\r\n\r\n\tvar wb = parse_wb(getzipdata(zip, dir.workbooks[0].replace(/^\\//,'')), dir.workbooks[0], opts);\r\n\r\n\tvar props = {}, propdata = \"\";\r\n\r\n\tif(dir.coreprops.length !== 0) {\r\n\t\tpropdata = getzipdata(zip, dir.coreprops[0].replace(/^\\//,''), true);\r\n\t\tif(propdata) props = parse_core_props(propdata);\r\n\t\tif(dir.extprops.length !== 0) {\r\n\t\t\tpropdata = getzipdata(zip, dir.extprops[0].replace(/^\\//,''), true);\r\n\t\t\tif(propdata) parse_ext_props(propdata, props);\r\n\t\t}\r\n\t}\r\n\r\n\tvar custprops = {};\r\n\tif(!opts.bookSheets || opts.bookProps) {\r\n\t\tif (dir.custprops.length !== 0) {\r\n\t\t\tpropdata = getzipdata(zip, dir.custprops[0].replace(/^\\//,''), true);\r\n\t\t\tif(propdata) custprops = parse_cust_props(propdata, opts);\r\n\t\t}\r\n\t}\r\n\r\n\tvar out = {};\r\n\tif(opts.bookSheets || opts.bookProps) {\r\n\t\tif(props.Worksheets && props.SheetNames.length > 0) sheets=props.SheetNames;\r\n\t\telse if(wb.Sheets) sheets = wb.Sheets.map(function pluck(x){ return x.name; });\r\n\t\tif(opts.bookProps) { out.Props = props; out.Custprops = custprops; }\r\n\t\tif(typeof sheets !== 'undefined') out.SheetNames = sheets;\r\n\t\tif(opts.bookSheets ? out.SheetNames : opts.bookProps) return out;\r\n\t}\r\n\tsheets = {};\r\n\r\n\tvar deps = {};\r\n\tif(opts.bookDeps && dir.calcchain) deps=parse_cc(getzipdata(zip, dir.calcchain.replace(/^\\//,'')),dir.calcchain,opts);\r\n\r\n\tvar i=0;\r\n\tvar sheetRels = {};\r\n\tvar path, relsPath;\r\n\tif(!props.Worksheets) {\r\n\t\tvar wbsheets = wb.Sheets;\r\n\t\tprops.Worksheets = wbsheets.length;\r\n\t\tprops.SheetNames = [];\r\n\t\tfor(var j = 0; j != wbsheets.length; ++j) {\r\n\t\t\tprops.SheetNames[j] = wbsheets[j].name;\r\n\t\t}\r\n\t}\r\n\r\n\tvar wbext = xlsb ? \"bin\" : \"xml\";\r\n\tvar wbrelsfile = 'xl/_rels/workbook.' + wbext + '.rels';\r\n\tvar wbrels = parse_rels(getzipdata(zip, wbrelsfile, true), wbrelsfile);\r\n\tif(wbrels) wbrels = safe_parse_wbrels(wbrels, wb.Sheets);\r\n\t/* Numbers iOS hack */\r\n\tvar nmode = (getzipdata(zip,\"xl/worksheets/sheet.xml\",true))?1:0;\r\n\tfor(i = 0; i != props.Worksheets; ++i) {\r\n\t\tif(wbrels) path = 'xl/' + (wbrels[i][1]).replace(/[\\/]?xl\\//, \"\");\r\n\t\telse {\r\n\t\t\tpath = 'xl/worksheets/sheet'+(i+1-nmode)+\".\" + wbext;\r\n\t\t\tpath = path.replace(/sheet0\\./,\"sheet.\");\r\n\t\t}\r\n\t\trelsPath = path.replace(/^(.*)(\\/)([^\\/]*)$/, \"$1/_rels/$3.rels\");\r\n\t\tsafe_parse_ws(zip, path, relsPath, props.SheetNames[i], sheetRels, sheets, opts);\r\n\t}\r\n\r\n\tif(dir.comments) parse_comments(zip, dir.comments, sheets, sheetRels, opts);\r\n\r\n\tout = {\r\n\t\tDirectory: dir,\r\n\t\tWorkbook: wb,\r\n\t\tProps: props,\r\n\t\tCustprops: custprops,\r\n\t\tDeps: deps,\r\n\t\tSheets: sheets,\r\n\t\tSheetNames: props.SheetNames,\r\n\t\tStrings: strs,\r\n\t\tStyles: styles,\r\n\t\tThemes: themes,\r\n\t\tSSF: SSF.get_table()\r\n\t};\r\n\tif(opts.bookFiles) {\r\n\t\tout.keys = entries;\r\n\t\tout.files = zip.files;\r\n\t}\r\n\tif(opts.bookVBA) {\r\n\t\tif(dir.vba.length > 0) out.vbaraw = getzipdata(zip,dir.vba[0],true);\r\n\t\telse if(dir.defaults.bin === 'application/vnd.ms-office.vbaProject') out.vbaraw = getzipdata(zip,'xl/vbaProject.bin',true);\r\n\t}\r\n\treturn out;\r\n}\r\nfunction add_rels(rels, rId, f, type, relobj) {\r\n\tif(!relobj) relobj = {};\r\n\tif(!rels['!id']) rels['!id'] = {};\r\n\trelobj.Id = 'rId' + rId;\r\n\trelobj.Type = type;\r\n\trelobj.Target = f;\r\n\tif(rels['!id'][relobj.Id]) throw new Error(\"Cannot rewrite rId \" + rId);\r\n\trels['!id'][relobj.Id] = relobj;\r\n\trels[('/' + relobj.Target).replace(\"//\",\"/\")] = relobj;\r\n}\r\n\r\nfunction write_zip(wb, opts) {\r\n\tif(wb && !wb.SSF) {\r\n\t\twb.SSF = SSF.get_table();\r\n\t}\r\n\tif(wb && wb.SSF) {\r\n\t\tmake_ssf(SSF); SSF.load_table(wb.SSF);\r\n\t\topts.revssf = evert_num(wb.SSF); opts.revssf[wb.SSF[65535]] = 0;\r\n\t}\r\n\topts.rels = {}; opts.wbrels = {};\r\n\topts.Strings = []; opts.Strings.Count = 0; opts.Strings.Unique = 0;\r\n\tvar wbext = opts.bookType == \"xlsb\" ? \"bin\" : \"xml\";\r\n\tvar ct = { workbooks: [], sheets: [], calcchains: [], themes: [], styles: [],\r\n\t\tcoreprops: [], extprops: [], custprops: [], strs:[], comments: [], vba: [],\r\n\t\tTODO:[], rels:[], xmlns: \"\" };\r\n\tfix_write_opts(opts = opts || {});\r\n\tvar zip = new jszip();\r\n\tvar f = \"\", rId = 0;\r\n\r\n\topts.cellXfs = [];\r\n\tget_cell_style(opts.cellXfs, {}, {revssf:{\"General\":0}});\r\n\r\n\tf = \"docProps/core.xml\";\r\n\tzip.file(f, write_core_props(wb.Props, opts));\r\n\tct.coreprops.push(f);\r\n\tadd_rels(opts.rels, 2, f, RELS.CORE_PROPS);\r\n\r\n\tf = \"docProps/app.xml\";\r\n\tif(!wb.Props) wb.Props = {};\r\n\twb.Props.SheetNames = wb.SheetNames;\r\n\twb.Props.Worksheets = wb.SheetNames.length;\r\n\tzip.file(f, write_ext_props(wb.Props, opts));\r\n\tct.extprops.push(f);\r\n\tadd_rels(opts.rels, 3, f, RELS.EXT_PROPS);\r\n\r\n\tif(wb.Custprops !== wb.Props && keys(wb.Custprops||{}).length > 0) {\r\n\t\tf = \"docProps/custom.xml\";\r\n\t\tzip.file(f, write_cust_props(wb.Custprops, opts));\r\n\t\tct.custprops.push(f);\r\n\t\tadd_rels(opts.rels, 4, f, RELS.CUST_PROPS);\r\n\t}\r\n\r\n\tf = \"xl/workbook.\" + wbext;\r\n\tzip.file(f, write_wb(wb, f, opts));\r\n\tct.workbooks.push(f);\r\n\tadd_rels(opts.rels, 1, f, RELS.WB);\r\n\r\n\tfor(rId=1;rId <= wb.SheetNames.length; ++rId) {\r\n\t\tf = \"xl/worksheets/sheet\" + rId + \".\" + wbext;\r\n\t\tzip.file(f, write_ws(rId-1, f, opts, wb));\r\n\t\tct.sheets.push(f);\r\n\t\tadd_rels(opts.wbrels, rId, \"worksheets/sheet\" + rId + \".\" + wbext, RELS.WS);\r\n\t}\r\n\r\n\tif(opts.Strings != null && opts.Strings.length > 0) {\r\n\t\tf = \"xl/sharedStrings.\" + wbext;\r\n\t\tzip.file(f, write_sst(opts.Strings, f, opts));\r\n\t\tct.strs.push(f);\r\n\t\tadd_rels(opts.wbrels, ++rId, \"sharedStrings.\" + wbext, RELS.SST);\r\n\t}\r\n\r\n\t/* TODO: something more intelligent with themes */\r\n\r\n\tf = \"xl/theme/theme1.xml\";\r\n  zip.file(f, write_theme(opts));\r\n\tct.themes.push(f);\r\n\tadd_rels(opts.wbrels, ++rId, \"theme/theme1.xml\", RELS.THEME);\r\n\r\n\t/* TODO: something more intelligent with styles */\r\n\r\n\tf = \"xl/styles.\" + wbext;\r\n\tzip.file(f, write_sty(wb, f, opts));\r\n\tct.styles.push(f);\r\n\tadd_rels(opts.wbrels, ++rId, \"styles.\" + wbext, RELS.STY);\r\n\r\n\tzip.file(\"[Content_Types].xml\", write_ct(ct, opts));\r\n\tzip.file('_rels/.rels', write_rels(opts.rels));\r\n\tzip.file('xl/_rels/workbook.' + wbext + '.rels', write_rels(opts.wbrels));\r\n\treturn zip;\r\n}\r\nfunction firstbyte(f,o) {\r\n\tswitch((o||{}).type || \"base64\") {\r\n\t\tcase 'buffer': return f[0];\r\n\t\tcase 'base64': return Base64.decode(f.substr(0,12)).charCodeAt(0);\r\n\t\tcase 'binary': return f.charCodeAt(0);\r\n\t\tcase 'array': return f[0];\r\n\t\tdefault: throw new Error(\"Unrecognized type \" + o.type);\r\n\t}\r\n}\r\n\r\nfunction read_zip(data, opts) {\r\n\tvar zip, d = data;\r\n\tvar o = opts||{};\r\n\tif(!o.type) o.type = (has_buf && Buffer.isBuffer(data)) ? \"buffer\" : \"base64\";\r\n\tswitch(o.type) {\r\n\t\tcase \"base64\": zip = new jszip(d, { base64:true }); break;\r\n\t\tcase \"binary\": case \"array\": zip = new jszip(d, { base64:false }); break;\r\n\t\tcase \"buffer\": zip = new jszip(d); break;\r\n\t\tcase \"file\": zip=new jszip(d=_fs.readFileSync(data)); break;\r\n\t\tdefault: throw new Error(\"Unrecognized type \" + o.type);\r\n\t}\r\n\treturn parse_zip(zip, o);\r\n}\r\n\r\nfunction readSync(data, opts) {\r\n\tvar zip, d = data, isfile = false, n;\r\n\tvar o = opts||{};\r\n\tif(!o.type) o.type = (has_buf && Buffer.isBuffer(data)) ? \"buffer\" : \"base64\";\r\n\tif(o.type == \"file\") { isfile = true; o.type = \"buffer\"; d = _fs.readFileSync(data); }\r\n\tswitch((n = firstbyte(d, o))) {\r\n\t\tcase 0xD0:\r\n\t\t\tif(isfile) o.type = \"file\";\r\n\t\t\treturn parse_xlscfb(CFB.read(data, o), o);\r\n\t\tcase 0x09: return parse_xlscfb(s2a(o.type === 'base64' ? Base64.decode(data) : data), o);\r\n\t\tcase 0x3C: return parse_xlml(d, o);\r\n\t\tcase 0x50:\r\n\t\t\tif(isfile) o.type = \"file\";\r\n\t\t\treturn read_zip(data, opts);\r\n\t\tdefault: throw new Error(\"Unsupported file \" + n);\r\n\t}\r\n}\r\n\r\nfunction readFileSync(data, opts) {\r\n\tvar o = opts||{}; o.type = 'file'\r\n  var wb = readSync(data, o);\r\n  wb.FILENAME = data;\r\n\treturn wb;\r\n}\r\nfunction write_zip_type(wb, opts) {\r\n\tvar o = opts||{};\r\n  style_builder  = new StyleBuilder(opts);\r\n\r\n  var z = write_zip(wb, o);\r\n\tswitch(o.type) {\r\n\t\tcase \"base64\": return z.generate({type:\"base64\"});\r\n\t\tcase \"binary\": return z.generate({type:\"string\"});\r\n\t\tcase \"buffer\": return z.generate({type:\"nodebuffer\"});\r\n\t\tcase \"file\": return _fs.writeFileSync(o.file, z.generate({type:\"nodebuffer\"}));\r\n\t\tdefault: throw new Error(\"Unrecognized type \" + o.type);\r\n\t}\r\n}\r\n\r\nfunction writeSync(wb, opts) {\r\n\tvar o = opts||{};\r\n\tswitch(o.bookType) {\r\n\t\tcase 'xml': return write_xlml(wb, o);\r\n\t\tdefault: return write_zip_type(wb, o);\r\n\t}\r\n}\r\n\r\nfunction writeFileSync(wb, filename, opts) {\r\n\tvar o = opts||{}; o.type = 'file';\r\n\r\n\to.file = filename;\r\n\tswitch(o.file.substr(-5).toLowerCase()) {\r\n\t\tcase '.xlsx': o.bookType = 'xlsx'; break;\r\n\t\tcase '.xlsm': o.bookType = 'xlsm'; break;\r\n\t\tcase '.xlsb': o.bookType = 'xlsb'; break;\r\n\tdefault: switch(o.file.substr(-4).toLowerCase()) {\r\n\t\tcase '.xls': o.bookType = 'xls'; break;\r\n\t\tcase '.xml': o.bookType = 'xml'; break;\r\n\t}}\r\n\treturn writeSync(wb, o);\r\n}\r\n\r\nfunction decode_row(rowstr) { return parseInt(unfix_row(rowstr),10) - 1; }\r\nfunction encode_row(row) { return \"\" + (row + 1); }\r\nfunction fix_row(cstr) { return cstr.replace(/([A-Z]|^)(\\d+)$/,\"$1$$$2\"); }\r\nfunction unfix_row(cstr) { return cstr.replace(/\\$(\\d+)$/,\"$1\"); }\r\n\r\nfunction decode_col(colstr) { var c = unfix_col(colstr), d = 0, i = 0; for(; i !== c.length; ++i) d = 26*d + c.charCodeAt(i) - 64; return d - 1; }\r\nfunction encode_col(col) { var s=\"\"; for(++col; col; col=Math.floor((col-1)/26)) s = String.fromCharCode(((col-1)%26) + 65) + s; return s; }\r\nfunction fix_col(cstr) { return cstr.replace(/^([A-Z])/,\"$$$1\"); }\r\nfunction unfix_col(cstr) { return cstr.replace(/^\\$([A-Z])/,\"$1\"); }\r\n\r\nfunction split_cell(cstr) { return cstr.replace(/(\\$?[A-Z]*)(\\$?\\d*)/,\"$1,$2\").split(\",\"); }\r\nfunction decode_cell(cstr) { var splt = split_cell(cstr); return { c:decode_col(splt[0]), r:decode_row(splt[1]) }; }\r\nfunction encode_cell(cell) { return encode_col(cell.c) + encode_row(cell.r); }\r\nfunction fix_cell(cstr) { return fix_col(fix_row(cstr)); }\r\nfunction unfix_cell(cstr) { return unfix_col(unfix_row(cstr)); }\r\nfunction decode_range(range) { var x =range.split(\":\").map(decode_cell); return {s:x[0],e:x[x.length-1]}; }\r\nfunction encode_range(cs,ce) {\r\n\tif(ce === undefined || typeof ce === 'number') return encode_range(cs.s, cs.e);\r\n\tif(typeof cs !== 'string') cs = encode_cell(cs); if(typeof ce !== 'string') ce = encode_cell(ce);\r\n\treturn cs == ce ? cs : cs + \":\" + ce;\r\n}\r\n\r\nfunction safe_decode_range(range) {\r\n\tvar o = {s:{c:0,r:0},e:{c:0,r:0}};\r\n\tvar idx = 0, i = 0, cc = 0;\r\n\tvar len = range.length;\r\n\tfor(idx = 0; i < len; ++i) {\r\n\t\tif((cc=range.charCodeAt(i)-64) < 1 || cc > 26) break;\r\n\t\tidx = 26*idx + cc;\r\n\t}\r\n\to.s.c = --idx;\r\n\r\n\tfor(idx = 0; i < len; ++i) {\r\n\t\tif((cc=range.charCodeAt(i)-48) < 0 || cc > 9) break;\r\n\t\tidx = 10*idx + cc;\r\n\t}\r\n\to.s.r = --idx;\r\n\r\n\tif(i === len || range.charCodeAt(++i) === 58) { o.e.c=o.s.c; o.e.r=o.s.r; return o; }\r\n\r\n\tfor(idx = 0; i != len; ++i) {\r\n\t\tif((cc=range.charCodeAt(i)-64) < 1 || cc > 26) break;\r\n\t\tidx = 26*idx + cc;\r\n\t}\r\n\to.e.c = --idx;\r\n\r\n\tfor(idx = 0; i != len; ++i) {\r\n\t\tif((cc=range.charCodeAt(i)-48) < 0 || cc > 9) break;\r\n\t\tidx = 10*idx + cc;\r\n\t}\r\n\to.e.r = --idx;\r\n\treturn o;\r\n}\r\n\r\nfunction safe_format_cell(cell, v) {\r\n\tif(cell.z !== undefined) try { return (cell.w = SSF.format(cell.z, v)); } catch(e) { }\r\n\tif(!cell.XF) return v;\r\n\ttry { return (cell.w = SSF.format(cell.XF.ifmt||0, v)); } catch(e) { return ''+v; }\r\n}\r\n\r\nfunction format_cell(cell, v) {\r\n\tif(cell == null || cell.t == null) return \"\";\r\n\tif(cell.w !== undefined) return cell.w;\r\n\tif(v === undefined) return safe_format_cell(cell, cell.v);\r\n\treturn safe_format_cell(cell, v);\r\n}\r\n\r\nfunction sheet_to_json(sheet, opts){\r\n\tvar val, row, range, header = 0, offset = 1, r, hdr = [], isempty, R, C, v;\r\n\tvar o = opts != null ? opts : {};\r\n\tvar raw = o.raw;\r\n\tif(sheet == null || sheet[\"!ref\"] == null) return [];\r\n\trange = o.range !== undefined ? o.range : sheet[\"!ref\"];\r\n\tif(o.header === 1) header = 1;\r\n\telse if(o.header === \"A\") header = 2;\r\n\telse if(Array.isArray(o.header)) header = 3;\r\n\tswitch(typeof range) {\r\n\t\tcase 'string': r = safe_decode_range(range); break;\r\n\t\tcase 'number': r = safe_decode_range(sheet[\"!ref\"]); r.s.r = range; break;\r\n\t\tdefault: r = range;\r\n\t}\r\n\tif(header > 0) offset = 0;\r\n\tvar rr = encode_row(r.s.r);\r\n\tvar cols = new Array(r.e.c-r.s.c+1);\r\n\tvar out = new Array(r.e.r-r.s.r-offset+1);\r\n\tvar outi = 0;\r\n\tfor(C = r.s.c; C <= r.e.c; ++C) {\r\n\t\tcols[C] = encode_col(C);\r\n\t\tval = sheet[cols[C] + rr];\r\n\t\tswitch(header) {\r\n\t\t\tcase 1: hdr[C] = C; break;\r\n\t\t\tcase 2: hdr[C] = cols[C]; break;\r\n\t\t\tcase 3: hdr[C] = o.header[C - r.s.c]; break;\r\n\t\t\tdefault:\r\n\t\t\t\tif(val === undefined) continue;\r\n\t\t\t\thdr[C] = format_cell(val);\r\n\t\t}\r\n\t}\r\n\r\n\tfor (R = r.s.r + offset; R <= r.e.r; ++R) {\r\n\t\trr = encode_row(R);\r\n\t\tisempty = true;\r\n\t\tif(header === 1) row = [];\r\n\t\telse {\r\n\t\t\trow = {};\r\n\t\t\tif(Object.defineProperty) Object.defineProperty(row, '__rowNum__', {value:R, enumerable:false});\r\n\t\t\telse row.__rowNum__ = R;\r\n\t\t}\r\n\t\tfor (C = r.s.c; C <= r.e.c; ++C) {\r\n\t\t\tval = sheet[cols[C] + rr];\r\n\t\t\tif(val === undefined || val.t === undefined) continue;\r\n\t\t\tv = val.v;\r\n\t\t\tswitch(val.t){\r\n\t\t\t\tcase 'e': continue;\r\n\t\t\t\tcase 's': break;\r\n\t\t\t\tcase 'b': case 'n': break;\r\n\t\t\t\tdefault: throw 'unrecognized type ' + val.t;\r\n\t\t\t}\r\n\t\t\tif(v !== undefined) {\r\n\t\t\t\trow[hdr[C]] = raw ? v : format_cell(val,v);\r\n\t\t\t\tisempty = false;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(isempty === false || header === 1) out[outi++] = row;\r\n\t}\r\n\tout.length = outi;\r\n\treturn out;\r\n}\r\n\r\nfunction sheet_to_row_object_array(sheet, opts) { return sheet_to_json(sheet, opts != null ? opts : {}); }\r\n\r\nfunction sheet_to_csv(sheet, opts) {\r\n\tvar out = \"\", txt = \"\", qreg = /\"/g;\r\n\tvar o = opts == null ? {} : opts;\r\n\tif(sheet == null || sheet[\"!ref\"] == null) return \"\";\r\n\tvar r = safe_decode_range(sheet[\"!ref\"]);\r\n\tvar FS = o.FS !== undefined ? o.FS : \",\", fs = FS.charCodeAt(0);\r\n\tvar RS = o.RS !== undefined ? o.RS : \"\\n\", rs = RS.charCodeAt(0);\r\n\tvar row = \"\", rr = \"\", cols = [];\r\n\tvar i = 0, cc = 0, val;\r\n\tvar R = 0, C = 0;\r\n\tfor(C = r.s.c; C <= r.e.c; ++C) cols[C] = encode_col(C);\r\n\tfor(R = r.s.r; R <= r.e.r; ++R) {\r\n\t\trow = \"\";\r\n\t\trr = encode_row(R);\r\n\t\tfor(C = r.s.c; C <= r.e.c; ++C) {\r\n\t\t\tval = sheet[cols[C] + rr];\r\n\t\t\ttxt = val !== undefined ? ''+format_cell(val) : \"\";\r\n\t\t\tfor(i = 0, cc = 0; i !== txt.length; ++i) if((cc = txt.charCodeAt(i)) === fs || cc === rs || cc === 34) {\r\n\t\t\t\ttxt = \"\\\"\" + txt.replace(qreg, '\"\"') + \"\\\"\"; break; }\r\n\t\t\trow += (C === r.s.c ? \"\" : FS) + txt;\r\n\t\t}\r\n\t\tout += row + RS;\r\n\t}\r\n\treturn out;\r\n}\r\nvar make_csv = sheet_to_csv;\r\n\r\nfunction sheet_to_formulae(sheet) {\r\n\tvar cmds, y = \"\", x, val=\"\";\r\n\tif(sheet == null || sheet[\"!ref\"] == null) return \"\";\r\n\tvar r = safe_decode_range(sheet['!ref']), rr = \"\", cols = [], C;\r\n\tcmds = new Array((r.e.r-r.s.r+1)*(r.e.c-r.s.c+1));\r\n\tvar i = 0;\r\n\tfor(C = r.s.c; C <= r.e.c; ++C) cols[C] = encode_col(C);\r\n\tfor(var R = r.s.r; R <= r.e.r; ++R) {\r\n\t\trr = encode_row(R);\r\n\t\tfor(C = r.s.c; C <= r.e.c; ++C) {\r\n\t\t\ty = cols[C] + rr;\r\n\t\t\tx = sheet[y];\r\n\t\t\tval = \"\";\r\n\t\t\tif(x === undefined) continue;\r\n\t\t\tif(x.f != null) val = x.f;\r\n\t\t\telse if(x.w !== undefined) val = \"'\" + x.w;\r\n\t\t\telse if(x.v === undefined) continue;\r\n\t\t\telse val = \"\"+x.v;\r\n\t\t\tcmds[i++] = y + \"=\" + val;\r\n\t\t}\r\n\t}\r\n\tcmds.length = i;\r\n\treturn cmds;\r\n}\r\n\r\nvar utils = {\r\n\tencode_col: encode_col,\r\n\tencode_row: encode_row,\r\n\tencode_cell: encode_cell,\r\n\tencode_range: encode_range,\r\n\tdecode_col: decode_col,\r\n\tdecode_row: decode_row,\r\n\tsplit_cell: split_cell,\r\n\tdecode_cell: decode_cell,\r\n\tdecode_range: decode_range,\r\n\tformat_cell: format_cell,\r\n\tget_formulae: sheet_to_formulae,\r\n\tmake_csv: sheet_to_csv,\r\n\tmake_json: sheet_to_json,\r\n\tmake_formulae: sheet_to_formulae,\r\n\tsheet_to_csv: sheet_to_csv,\r\n\tsheet_to_json: sheet_to_json,\r\n\tsheet_to_formulae: sheet_to_formulae,\r\n\tsheet_to_row_object_array: sheet_to_row_object_array\r\n};\r\n\r\n\r\n\r\n\r\n/////////////////////////////////////////////////////////////////////////////////////////////////////\r\nvar XmlNode = (function () {\r\n  function XmlNode(tagName, attributes, children) {\r\n\r\n    if (!(this instanceof XmlNode)) {\r\n      return new XmlNode(tagName, attributes, children);\r\n    }\r\n    this.tagName = tagName;\r\n    this._attributes = attributes || {};\r\n    this._children = children || [];\r\n    this._prefix = '';\r\n    return this;\r\n  }\r\n\r\n  XmlNode.prototype.createElement = function () {\r\n    return new XmlNode(arguments)\r\n  }\r\n\r\n  XmlNode.prototype.children = function() {\r\n    return this._children;\r\n  }\r\n\r\n  XmlNode.prototype.append = function (node) {\r\n    this._children.push(node);\r\n    return this;\r\n  }\r\n\r\n  XmlNode.prototype.prefix = function (prefix) {\r\n    if (arguments.length==0) { return this._prefix;}\r\n    this._prefix = prefix;\r\n    return this;\r\n  }\r\n\r\n  XmlNode.prototype.attr = function (attr, value) {\r\n    if (value == undefined) {\r\n      delete this._attributes[attr];\r\n      return this;\r\n    }\r\n    if (arguments.length == 0) {\r\n      return this._attributes;\r\n    }\r\n    else if (typeof attr == 'string' && arguments.length == 1) {\r\n      return this._attributes.attr[attr];\r\n    }\r\n    if (typeof attr == 'object' && arguments.length == 1) {\r\n      for (var key in attr) {\r\n        this._attributes[key] = attr[key];\r\n      }\r\n    }\r\n    else if (arguments.length == 2 && typeof attr == 'string') {\r\n      this._attributes[attr] = value;\r\n    }\r\n    return this;\r\n  }\r\n\r\n  var APOS = \"'\"; QUOTE = '\"'\r\n  var ESCAPED_QUOTE = {  }\r\n  ESCAPED_QUOTE[QUOTE] = '&quot;'\r\n  ESCAPED_QUOTE[APOS] = '&apos;'\r\n\r\n  XmlNode.prototype.escapeAttributeValue = function(att_value) {\r\n    return '\"' + att_value.replace(/\\\"/g,'&quot;') + '\"';// TODO Extend with four other codes\r\n\r\n  }\r\n\r\n  XmlNode.prototype.toXml = function (node) {\r\n    if (!node) node = this;\r\n    var xml = node._prefix;\r\n    xml += '<' + node.tagName;\r\n    if (node._attributes) {\r\n      for (var key in node._attributes) {\r\n        xml += ' ' + key + '=' + this.escapeAttributeValue(''+node._attributes[key]) + ''\r\n      }\r\n    }\r\n    if (node._children && node._children.length > 0) {\r\n      xml += \">\";\r\n      for (var i = 0; i < node._children.length; i++) {\r\n        xml += this.toXml(node._children[i]);\r\n      }\r\n      xml += '</' + node.tagName + '>';\r\n    }\r\n    else {\r\n      xml += '/>';\r\n    }\r\n    return xml;\r\n  }\r\n  return XmlNode;\r\n})();\r\n/////////////////////////////////////////////////////////////////////////////////////////////////////\r\n\r\n  var StyleBuilder = function (options) {\r\n\r\n    var customNumFmtId = 164;\r\n\r\n\r\n\r\n    var table_fmt = {\r\n      0:  'General',\r\n      1:  '0',\r\n      2:  '0.00',\r\n      3:  '#,##0',\r\n      4:  '#,##0.00',\r\n      9:  '0%',\r\n      10: '0.00%',\r\n      11: '0.00E+00',\r\n      12: '# ?/?',\r\n      13: '# ??/??',\r\n      14: 'm/d/yy',\r\n      15: 'd-mmm-yy',\r\n      16: 'd-mmm',\r\n      17: 'mmm-yy',\r\n      18: 'h:mm AM/PM',\r\n      19: 'h:mm:ss AM/PM',\r\n      20: 'h:mm',\r\n      21: 'h:mm:ss',\r\n      22: 'm/d/yy h:mm',\r\n      37: '#,##0 ;(#,##0)',\r\n      38: '#,##0 ;[Red](#,##0)',\r\n      39: '#,##0.00;(#,##0.00)',\r\n      40: '#,##0.00;[Red](#,##0.00)',\r\n      45: 'mm:ss',\r\n      46: '[h]:mm:ss',\r\n      47: 'mmss.0',\r\n      48: '##0.0E+0',\r\n      49: '@',\r\n      56: '\"上午/下午 \"hh\"時\"mm\"分\"ss\"秒 \"'    };\r\n    var fmt_table = {};\r\n\r\n    for (var idx in table_fmt) {\r\n      fmt_table[table_fmt[idx]] = idx;\r\n    }\r\n\r\n\r\n    // cache style specs to avoid excessive duplication\r\n    _hashIndex = {};\r\n    _listIndex = [];\r\n\r\n    return {\r\n\r\n      initialize: function (options) {\r\n\r\n        this.$fonts = XmlNode('fonts').attr('count',0).attr(\"x14ac:knownFonts\",\"1\");\r\n        this.$fills = XmlNode('fills').attr('count',0);\r\n        this.$borders = XmlNode('borders').attr('count',0);\r\n        this.$numFmts = XmlNode('numFmts').attr('count',0);\r\n        this.$cellStyleXfs = XmlNode('cellStyleXfs');\r\n        this.$xf = XmlNode('xf')\r\n            .attr('numFmtId', 0)\r\n            .attr('fontId', 0)\r\n            .attr('fillId', 0)\r\n            .attr('borderId', 0);\r\n\r\n        this.$cellXfs = XmlNode('cellXfs').attr('count',0);\r\n        this.$cellStyles = XmlNode('cellStyles')\r\n            .append(XmlNode('cellStyle')\r\n                .attr('name', 'Normal')\r\n                .attr('xfId',0)\r\n                .attr('builtinId',0)\r\n            );\r\n        this.$dxfs = XmlNode('dxfs').attr('count', \"0\");\r\n        this.$tableStyles = XmlNode('tableStyles')\r\n            .attr('count','0')\r\n            .attr('defaultTableStyle','TableStyleMedium9')\r\n            .attr('defaultPivotStyle','PivotStyleMedium4')\r\n\r\n\r\n        this.$styles = XmlNode('styleSheet')\r\n            .attr('xmlns:mc','http://schemas.openxmlformats.org/markup-compatibility/2006')\r\n            .attr('xmlns:x14ac','http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac')\r\n            .attr('xmlns','http://schemas.openxmlformats.org/spreadsheetml/2006/main')\r\n            .attr('mc:Ignorable','x14ac')\r\n            .prefix('<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>')\r\n            .append(this.$numFmts)\r\n            .append(this.$fonts)\r\n            .append(this.$fills)\r\n            .append(this.$borders)\r\n            .append(this.$cellStyleXfs.append(this.$xf))\r\n            .append(this.$cellXfs)\r\n            .append(this.$cellStyles)\r\n            .append(this.$dxfs)\r\n            .append(this.$tableStyles);\r\n\r\n\r\n        // need to specify styles at index 0 and 1.\r\n        // the second style MUST be gray125 for some reason\r\n\r\n        var defaultStyle = options.defaultCellStyle || {};\r\n        if (!defaultStyle.font) defaultStyle.font = {name: 'Calibri', sz: '12'};\r\n        if (!defaultStyle.font.name) defaultStyle.font.name = 'Calibri';\r\n        if (!defaultStyle.font.sz) defaultStyle.font.sz = 11;\r\n        if (!defaultStyle.fill) defaultStyle.fill = {  patternType: \"none\", fgColor: {}};\r\n        if (!defaultStyle.border) defaultStyle.border = {};\r\n        if (!defaultStyle.numFmt) defaultStyle.numFmt = 0;\r\n\r\n        this.defaultStyle = defaultStyle;\r\n\r\n        var gray125Style = JSON.parse(JSON.stringify(defaultStyle));\r\n        gray125Style.fill = {patternType: \"gray125\", fgColor: { }}\r\n\r\n        this.addStyles([defaultStyle, gray125Style]);\r\n        return this;\r\n      },\r\n\r\n      // create a style entry and returns an integer index that can be used in the cell .s property\r\n      // these format of this object follows the emerging Common Spreadsheet Format\r\n      addStyle: function (attributes) {\r\n\r\n        var hashKey = JSON.stringify(attributes);\r\n        var index = _hashIndex[hashKey];\r\n        if (index == undefined) {\r\n\r\n          index = this._addXf(attributes); //_listIndex.push(attributes) -1;\r\n          _hashIndex[hashKey] = index;\r\n        }\r\n        else {\r\n          index = _hashIndex[hashKey];\r\n        }\r\n        return index;\r\n      },\r\n\r\n      // create style entries and returns array of integer indexes that can be used in cell .s property\r\n      addStyles: function (styles) {\r\n        var self = this;\r\n        return styles.map(function (style) {\r\n          return self.addStyle(style);\r\n        })\r\n      },\r\n\r\n      _duckTypeStyle: function(attributes) {\r\n\r\n        if (typeof attributes == 'object' && (attributes.patternFill || attributes.fgColor)) {\r\n          return {fill: attributes }; // this must be read via XLSX.parseFile(...)\r\n        }\r\n        else if (attributes.font || attributes.numFmt || attributes.border || attributes.fill) {\r\n          return attributes;\r\n        }\r\n        else {\r\n          return this._getStyleCSS(attributes)\r\n        }\r\n      },\r\n\r\n      _getStyleCSS: function(css) {\r\n        return css; //TODO\r\n      },\r\n\r\n      // Create an <xf> record for the style as well as corresponding <font>, <fill>, <border>, <numfmts>\r\n      // Right now this is simple and creates a <font>, <fill>, <border>, <numfmts> for every <xf>\r\n      // We could perhaps get fancier and avoid duplicating  auxiliary entries as Excel presumably intended, but bother.\r\n      _addXf: function (attributes) {\r\n\r\n\r\n        var fontId = this._addFont(attributes.font);\r\n        var fillId = this._addFill(attributes.fill);\r\n        var borderId = this._addBorder(attributes.border);\r\n        var numFmtId = this._addNumFmt(attributes.numFmt);\r\n\r\n        var $xf = XmlNode('xf')\r\n            .attr(\"numFmtId\", numFmtId)\r\n            .attr(\"fontId\", fontId)\r\n            .attr(\"fillId\", fillId)\r\n            .attr(\"borderId\", borderId)\r\n            .attr(\"xfId\", \"0\");\r\n\r\n        if (fontId > 0) {\r\n          $xf.attr('applyFont', \"1\");\r\n        }\r\n        if (fillId > 0) {\r\n          $xf.attr('applyFill', \"1\");\r\n        }\r\n        if (borderId > 0) {\r\n          $xf.attr('applyBorder', \"1\");\r\n        }\r\n        if (numFmtId > 0) {\r\n          $xf.attr('applyNumberFormat', \"1\");\r\n        }\r\n\r\n        if (attributes.alignment) {\r\n          var $alignment = XmlNode('alignment');\r\n          if (attributes.alignment.horizontal) { $alignment.attr('horizontal', attributes.alignment.horizontal);}\r\n          if (attributes.alignment.vertical)  { $alignment.attr('vertical', attributes.alignment.vertical);}\r\n          if (attributes.alignment.indent)  { $alignment.attr('indent', attributes.alignment.indent);}\r\n          if (attributes.alignment.readingOrder)  { $alignment.attr('readingOrder', attributes.alignment.readingOrder);}\r\n          if (attributes.alignment.wrapText)  { $alignment.attr('wrapText', attributes.alignment.wrapText);}\r\n          if (attributes.alignment.textRotation!=undefined)  { $alignment.attr('textRotation', attributes.alignment.textRotation);}\r\n\r\n          $xf.append($alignment).attr('applyAlignment',1)\r\n\r\n        }\r\n        this.$cellXfs.append($xf);\r\n        var count = +this.$cellXfs.children().length;\r\n\r\n        this.$cellXfs.attr('count', count);\r\n        return count - 1;\r\n      },\r\n\r\n      _addFont: function (attributes) {\r\n\r\n        if (!attributes) {  return 0; }\r\n\r\n        var $font = XmlNode('font')\r\n            .append(XmlNode('sz').attr('val', attributes.sz || this.defaultStyle.font.sz))\r\n            .append(XmlNode('name').attr('val', attributes.name || this.defaultStyle.font.name))\r\n\r\n        if (attributes.bold) $font.append(XmlNode('b'));\r\n        if (attributes.underline)  $font.append(XmlNode('u'));\r\n        if (attributes.italic)  $font.append(XmlNode('i'));\r\n        if (attributes.strike)  $font.append(XmlNode('strike'));\r\n        if (attributes.outline)  $font.append(XmlNode('outline'));\r\n        if (attributes.shadow)  $font.append(XmlNode('shadow'));\r\n\r\n        if (attributes.vertAlign) {\r\n          $font.append(XmlNode('vertAlign').attr('val', attributes.vertAlign))\r\n        }\r\n\r\n\r\n        if (attributes.color) {\r\n          if (attributes.color.theme) {\r\n            $font.append(XmlNode('color').attr('theme', attributes.color.theme))\r\n\r\n            if (attributes.color.tint) { //tint only if theme\r\n              $font.append(XmlNode('tint').attr('theme', attributes.color.tint))\r\n            }\r\n\r\n          } else if (attributes.color.rgb) { // not both rgb and theme\r\n            $font.append(XmlNode('color').attr('rgb', attributes.color.rgb))\r\n          }\r\n        }\r\n\r\n        this.$fonts.append($font);\r\n\r\n        var count = this.$fonts.children().length;\r\n        this.$fonts.attr('count', count);\r\n        return count - 1;\r\n      },\r\n\r\n        _addNumFmt: function (numFmt) {\r\n        if (!numFmt) { return 0; }\r\n\r\n        if (typeof numFmt == 'string') {\r\n          var numFmtIdx = fmt_table[numFmt];\r\n          if (numFmtIdx >= 0) {\r\n            return numFmtIdx; // we found a match against built in formats\r\n          }\r\n        }\r\n\r\n        if (/^[0-9]+$/.exec(numFmt)) {\r\n          return numFmt; // we're matching an integer against some known code\r\n        }\r\n        numFmt = numFmt\r\n            .replace(/&/g, '&amp;')\r\n            .replace(/</g, '&lt;')\r\n            .replace(/>/g, '&gt;')\r\n            .replace(/\"/g, '&quot;')\r\n            .replace(/'/g, '&apos;');\r\n\r\n        var $numFmt = XmlNode('numFmt')\r\n            .attr('numFmtId', (++customNumFmtId))\r\n            .attr('formatCode', numFmt);\r\n\r\n        this.$numFmts.append($numFmt);\r\n\r\n        var count = this.$numFmts.children().length;\r\n        this.$numFmts.attr('count', count);\r\n        return customNumFmtId ;\r\n      },\r\n\r\n      _addFill: function (attributes) {\r\n\r\n        if (!attributes) { return 0; }\r\n\r\n        var $patternFill = XmlNode('patternFill')\r\n            .attr('patternType', attributes.patternType || 'solid');\r\n\r\n        if (attributes.fgColor) {\r\n          var $fgColor = XmlNode('fgColor');\r\n\r\n          //Excel doesn't like it when we set both rgb and theme+tint, but xlsx.parseFile() sets both\r\n          //var $fgColor = createElement('<fgColor/>', null, null, {xmlMode: true}).attr(attributes.fgColor)\r\n          if (attributes.fgColor.rgb) {\r\n\r\n            if (attributes.fgColor.rgb.length == 6) {\r\n              attributes.fgColor.rgb = \"FF\" + attributes.fgColor.rgb /// add alpha to an RGB as Excel expects aRGB\r\n            }\r\n\r\n            $fgColor.attr('rgb', attributes.fgColor.rgb);\r\n            $patternFill.append($fgColor);\r\n          }\r\n          else if (attributes.fgColor.theme) {\r\n            $fgColor.attr('theme', attributes.fgColor.theme);\r\n            if (attributes.fgColor.tint) {\r\n              $fgColor.attr('tint', attributes.fgColor.tint);\r\n            }\r\n            $patternFill.append($fgColor);\r\n          }\r\n\r\n          if (!attributes.bgColor) {\r\n            attributes.bgColor = { \"indexed\": \"64\"}\r\n          }\r\n        }\r\n\r\n        if (attributes.bgColor) {\r\n          var $bgColor = XmlNode('bgColor').attr(attributes.bgColor);\r\n          $patternFill.append($bgColor);\r\n        }\r\n\r\n        var $fill = XmlNode('fill')\r\n            .append($patternFill);\r\n\r\n        this.$fills.append($fill);\r\n\r\n        var count = this.$fills.children().length;\r\n        this.$fills.attr('count', count);\r\n        return count - 1;\r\n      },\r\n\r\n      _getSubBorder: function(direction, spec) {\r\n\r\n        var $direction = XmlNode(direction);\r\n        if (spec){\r\n          if (spec.style) $direction.attr('style', spec.style);\r\n          if (spec.color) {\r\n            var $color = XmlNode('color');\r\n            if (spec.color.auto) {\r\n              $color.attr('auto', spec.color.auto);\r\n            }\r\n            else if (spec.color.rgb) {\r\n              $color.attr('rgb', spec.color.rgb);\r\n            }\r\n            else if (spec.color.theme || spec.color.tint) {\r\n              $color.attr('theme', spec.color.theme || \"1\");\r\n              $color.attr('tint', spec.color.tint || \"0\");\r\n            }\r\n            $direction.append($color)\r\n          }\r\n        }\r\n        return $direction;\r\n      },\r\n\r\n      _addBorder: function (attributes) {\r\n        if (!attributes) { return 0; }\r\n\r\n        var self = this;\r\n\r\n        var $border = XmlNode('border')\r\n            .attr(\"diagonalUp\",attributes.diagonalUp)\r\n            .attr(\"diagonalDown\",attributes.diagonalDown);\r\n\r\n        var directions = [\"left\",\"right\",\"top\",\"bottom\",\"diagonal\"];\r\n\r\n        directions.forEach(function(direction) {\r\n          $border.append(self._getSubBorder(direction, attributes[direction]))\r\n        });\r\n        this.$borders.append($border);\r\n\r\n        var count = this.$borders.children().length;\r\n        this.$borders.attr('count', count);\r\n        return count -1;\r\n      },\r\n\r\n      toXml: function () {\r\n        return this.$styles.toXml();\r\n      }\r\n    }.initialize(options||{});\r\n  }\r\n\r\n\r\nXLSX.parse_xlscfb = parse_xlscfb;\r\nXLSX.parse_zip = parse_zip;\r\nXLSX.read = readSync; //xlsread\r\nXLSX.readFile = readFileSync; //readFile\r\nXLSX.readFileSync = readFileSync;\r\nXLSX.write = writeSync;\r\nXLSX.writeFile = writeFileSync;\r\nXLSX.writeFileSync = writeFileSync;\r\nXLSX.utils = utils;\r\nXLSX.CFB = CFB;\r\nXLSX.SSF = SSF;\r\n})(typeof exports !== 'undefined' ? exports : XLSX);\r\nvar XLS = XLSX;\r\n"]},"metadata":{},"sourceType":"script"}